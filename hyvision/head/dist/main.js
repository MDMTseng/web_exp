!function(e){function t(t){for(var a,o,s=t[0],l=t[1],c=t[2],d=0,p=[];d<s.length;d++)o=s[d],i[o]&&p.push(i[o][0]),i[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);p.length;)p.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(a=!1)}a&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},i={0:0},r=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/dist/";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;r.push([529,1]),n()}({1015:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(84),o=m(n(1)),s=v(n(88)),l=m(n(210)),c=v(n(28)),u=v(n(55)),d=n(47),p=m(n(89)),f=m(n(175)),_=m(n(38)),h=v(n(37)),S=v(n(207));m(n(79));function v(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=m(n(1016)).default.RangePicker;h.getLogger("AnalysisUI");function k(e,t){var n=t,a=e.map((function(e){var t=n.map((function(t){return t.judgeReports.find((function(t){return t.id==e.id})).value})),a=t.reduce((function(e,t){return e+t}),0)/t.length,i=Math.sqrt(t.reduce((function(e,t){return e+(a-t)*(a-t)}),0)/t.length),r=(e.USL-a)/(3*i),o=(a-e.LSL)/(3*i),s=Math.min(r,o),l=(a-e.value)/((e.USL-e.LSL)/2),c=s*(1-Math.abs(l)),u=e.id,p=e.name,f=e.subtype;return r=(0,d.round)(r,.001),o=(0,d.round)(o,.001),s=(0,d.round)(s,.001),l=(0,d.round)(l,.001),c=(0,d.round)(c,.001),{id:u,name:p,subtype:f,measure:e,valArr:t,mean:a,sigma:i,CPU:r,CPL:o,CP:s,CA:l,CPK:c}}));return console.log(a),a}var T=function(e){function t(){return E(this,t),b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,e),i(t,[{key:"render",value:function(){var e=this.props.inspectionResults,t=k(this.props.reportStatisticState.statisticValue.measureList,e),n=["id","name","subtype","CA","CPU","CPL","CP","CPK"].map((function(e){return{title:e,dataIndex:e,key:e}}));return o.default.createElement(f.default,{dataSource:t,columns:n})}}]),t}(o.default.Component);function C(e){return"string"==typeof e||e instanceof String}function I(e,t){var n=k(e,t),a=[],i=n.reduce((function(e,t){return-1==e?t.valArr.length:e==t.valArr.length?e:NaN}),-1);if(-1==i||i!=i)return[];function r(e,t,n,i){C(n)&&(n=[n]),void 0===i&&(i=n[n.length-1]),a.push(i+","),t.forEach((function(e){var t=(0,d.GetObjElement)(e,n);void 0===t&&(t=""),a.push(t+",")})),a.push("\n")}["name","subtype"].forEach((function(e){return r(0,n,e)})),["value","LCL","UCL","LSL","USL"].forEach((function(e){return r(0,n,["measure",e])})),["mean","sigma","CA","CPU","CPL","CP","CPK"].forEach((function(e){return r(0,n,e)})),n.forEach((function(e){a.push(",")})),a.push("\n");for(var o=n[0].valArr.length,s=0;s<o;s++)r(0,n,["valArr",s],t[s].time_ms);return a}var A=function(e){function t(e){E(this,t);var n=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.ec_canvas=null,n.state={defFileSearchName:"",dateRange:[],inspectionRec:[]},n}return y(t,e),i(t,[{key:"componentDidMount",value:function(){this.props.edit_info.defModelPath}}]),i(t,[{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"genTarEditUI",value:function(e){var t=this;switch(e.type){case c.SHAPE_TYPE.aux_point:case c.SHAPE_TYPE.search_point:case c.SHAPE_TYPE.measure:return o.default.createElement(s.JsonEditBlock,{object:e,dict:p.default,dictTheme:e.type,key:"BASE_COM.JsonEditBlock",whiteListKey:{type:"div",subtype:"div",name:"input",angleDeg:"input-number",value:"input-number",margin:"input-number",USL:"input-number",LSL:"input-number",UCL:"input-number",LCL:"input-number",quadrant:"div",docheck:"checkbox",width:"input-number",ref:{__OBJ__:"div",0:{__OBJ__:"btn",id:"div",element:"div"},1:{__OBJ__:"btn",id:"div",element:"div"}}},jsonChange:function(e,n,a,i){if("btn"==a)"ref"==n.keyTrace[0]&&t.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(n.keyTrace);else{var r=n.keyTrace[n.keyTrace.length-1];switch(a){case"input-number":var o=parseFloat(i.target.value);if(isNaN(o))return;if(n.obj[r]=o,void 0!==n.obj.value){var s=n.obj.value;"LSL"==r?n.obj.LCL=(0,d.round)(s+(n.obj.LSL-s)/3,.001):"USL"==r&&(n.obj.UCL=(0,d.round)(s+(n.obj.USL-s)/3,.001))}break;case"input":n.obj[r]=i.target.value;break;case"checkbox":n.obj[r]=i.target.checked}t.ec_canvas.SetShape(e,e.id)}}});default:return o.default.createElement(s.JsonEditBlock,{object:e,dict:p.default,dictTheme:e.type,key:"BASE_COM.JsonEditBlock",jsonChange:function(e,n,a,i){var r=n.keyTrace[n.keyTrace.length-1];"input-number"==a?n.obj[r]=parseFloat(i.target.value):"input"==a&&(n.obj[r]=i.target.value),console.log(n.obj);var o=e;t.ec_canvas.SetShape(o,o.id)},whiteListKey:{type:"div",subtype:"div",name:"input",margin:"input-number",direction:"input-number"}})}}},{key:"stateUpdate",value:function(e){return this.setState(a({},this.state,e))}},{key:"render",value:function(){var e=this,t=[o.default.createElement(s.IconButton,{dict:p.default,key:"<",addClass:"layout black vbox",text:"<",onClick:function(){return e.props.ACT_EXIT()}})],n=2==this.state.dateRange.length&&this.state.dateRange.reduce((function(e,t){return e&&void 0!==t._d&&void 0!==t._d.getTime}),!0),a=this.state.dateRange.map((function(e){return e._d})),i=this.props.edit_info.DefFileHash,r=this.props.edit_info.DefFileName,c=C(this.props.edit_info.DefFileHash)&&this.props.edit_info.DefFileHash.length>5;return o.default.createElement("div",{className:"HXF"},o.default.createElement("div",{className:"overlayCon s overlayCon width12 HXF"},o.default.createElement("div",{className:"s height12"},o.default.createElement(g,{key:"RP",onChange:function(t){return e.stateUpdate({dateRange:t})}}),o.default.createElement(_.default,{type:"primary",icon:"search",disabled:!n||!c,onClick:function(){S.inspectionQuery(i,a[0],a[1]).then((function(t){console.log(t);var n=t.map((function(e){return e.InspectionData[0]}));e.stateUpdate({inspectionRec:n});I(e.props.reportStatisticState.statisticValue.measureList,n)})).catch((function(e){console.log(e)}))}}),o.default.createElement(_.default,{type:"primary",icon:"download",disabled:!n||!c||0==this.state.inspectionRec.length,onClick:function(){var t,n,a,i,o,s,l,c,u=I(e.props.reportStatisticState.statisticValue.measureList,e.state.inspectionRec);t=u.join(""),n="text/csv",a=r+"_"+(s=new Date,l=s.getMonth()+1,c=s.getDate(),[s.getFullYear(),(l>9?"":"0")+l,(c>9?"":"0")+c].join(""))+".csv",i=new Blob([t],{type:n}),(o=document.createElement("a")).download=a,o.href=URL.createObjectURL(i),o.dataset.downloadurl=[n,o.download,o.href].join(":"),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout((function(){URL.revokeObjectURL(o.href)}),1500)}}),o.default.createElement(T,{reportStatisticState:this.props.reportStatisticState,inspectionResults:this.state.inspectionRec})),o.default.createElement(l.default,{transitionName:"fadeIn"},o.default.createElement("div",{key:"k1",className:"s overlay scroll MenuAnim HXA",style:{top:"0px",width:"100px"}},t))))}}]),t}(o.default.Component),D=(0,r.connect)((function(e){return{c_state:e.UIData.c_state,edit_tar_info:e.UIData.edit_info.edit_tar_info,shape_list:e.UIData.edit_info.list,WS_ID:e.UIData.WS_ID,edit_info:e.UIData.edit_info,reportStatisticState:e.UIData.edit_info.reportStatisticState}}),(function(e,t){return{ACT_SUCCESS:function(t){e(c.EV_UI_ACT(u.EVENT.SUCCESS))},ACT_Fail:function(t){e(c.EV_UI_ACT(u.EVENT.FAIL))},ACT_EXIT:function(t){e(c.EV_UI_ACT(c.UI_SM_EVENT.EXIT))},ACT_WS_SEND:function(t,n,a,i,r){return e(c.EV_WS_SEND(t,n,a,i,r))},ACT_Report_Save:function(t,n,a){e(c.EV_WS_SEND(t,"SV",0,{filename:n},a))},ACT_Cache_Img_Save:function(t,n){e(c.EV_WS_SEND(t,"SV",0,{filename:n,type:"__CACHE_IMG__"}))}}}))(A);t.default=D},193:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InspectionEditorLogic=t.MEASURERSULTRESION_priority=t.MEASURERSULTRESION=void 0;var a,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.MEASURERSULTRESION_reducer=function(e,t){if(e==S.NA)return e;if(e==S.USNG||e==S.LSNG)return t==S.NA?t:e;if(e==S.UCNG||e==S.LCNG)return t==S.NA||t==S.USNG||t==S.LSNG?t:e;return t};var o,s=n(280),l=n(43),c=n(28),u=n(47),d=n(61),p=(o=d)&&o.__esModule?o:{default:o};function f(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(37)).getLogger("InspectionEditorLogic"),S=t.MEASURERSULTRESION={NA:"NA",UOK:"UOK",LOK:"LOK",OK:"OK",UCNG:"UCNG",LCNG:"LCNG",CNG:"CNG",USNG:"USNG",LSNG:"LSNG",SNG:"SNG",NG:"NG"};t.MEASURERSULTRESION_priority=(_(a={},S.NA,0),_(a,S.LSNG,1),_(a,S.USNG,1),_(a,S.SNG,1),_(a,S.NG,1),_(a,S.UCNG,2),_(a,S.LCNG,2),_(a,S.CNG,2),_(a,S.UOK,3),_(a,S.LOK,3),_(a,S.OK,3),a);t.InspectionEditorLogic=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reset()}return r(e,[{key:"reset",value:function(){this.shapeCount=0,this.shapeList=[],this.inherentShapeList=[],this.editShape=null,this.editPoint=null,this.state=null,this.sig360info=null,this.inspreport=null,this.img=null}},{key:"Setsig360info",value:function(e){h.info(e),this.sig360info=e}},{key:"SetInspectionReport",value:function(e){var t=this;this.inspreport=e,void 0!==this.inspreport.reports&&0!=this.inspreport.reports.length&&this.inspreport.reports.forEach((function(e){return e.judgeReports.forEach((function(e){var n=t.shapeList.find((function(t){return t.id==e.id}));void 0===n||e.status===l.INSPECTION_STATUS.NA?e.detailStatus=S.NA:e.value<n.LSL?e.detailStatus=S.LSNG:e.value<n.LCL?e.detailStatus=S.LCNG:e.value<n.value?e.detailStatus=S.LOK:e.value<n.UCL?e.detailStatus=S.UOK:e.value<n.USL?e.detailStatus=S.UCNG:e.detailStatus=S.USNG}))}))}},{key:"getsig360info_mmpp",value:function(){try{return this.sig360info.reports[0].mmpp}catch(e){}return 1}},{key:"getsig360infoCenter",value:function(){var e={x:0,y:0};try{e.x=this.sig360info.reports[0].cx,e.y=this.sig360info.reports[0].cy}catch(t){e.x=0,e.y=0}return e}},{key:"SetShapeList",value:function(e){this.shapeList=e;var t=0;this.shapeList.forEach((function(e){t<e.id&&(t=e.id)})),this.shapeCount=t}},{key:"SetDefInfo",value:function(e){this.SetShapeList(e.features);var t=e.inherentfeatures[0];t.signature.magnitude=t.signature.magnitude.map((function(e){return Math.round(1e3*e)/1e3})),t.signature.angle=t.signature.angle.map((function(e){return Math.round(1e3*e)/1e3})),this.Setsig360info({reports:[{cx:t.pt1.x,cy:t.pt1.y,area:t.area,orientation:t.orientation,signature:t.signature,mmpp:e.mmpp,cam_param:e.cam_param}]}),this.UpdateInherentShapeList();var n=this.findLostRefShapes();this.shapeList=this.shapeList.filter((function(e){return!n.includes(e)})),this.UpdateInherentShapeList()}},{key:"SetCameraParamInfo",value:function(e){this.cameraParam=e}},{key:"SetState",value:function(e){this.state!=e&&(this.shapeCount=0,this.editShape=null,this.editPoint=null)}},{key:"FindShape",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shapeList,a=n.findIndex((function(n){return n[e]==t}));return a<0?void 0:a}},{key:"FindShapeIdx",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;return this.FindShape("id",e,t)}},{key:"FindShapeObject",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shapeList,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.inherentShapeList,i=this.FindShape(e,t,n);return void 0!==i?n[i]:void 0!==(i=this.FindShape(e,t,a))?a[i]:void 0}},{key:"UpdateInherentShapeList",value:function(){var e=this;if(this.inherentShapeList=[],null!==this.sig360info&&void 0!==this.sig360info){var t=this.sig360info.reports[0];h.debug(t);var n=1e5,a=n;return this.inherentShapeList.push({id:a,type:c.SHAPE_TYPE.sign360,name:"@__SIGNATURE__",pt1:{x:t.cx,y:t.cy},pt2:{x:0,y:0},area:t.area,orientation:0,signature:t.signature}),n=a+1,this.inherentShapeList.push({id:n++,type:c.SHAPE_TYPE.aux_point,name:"@__SIGNATURE__.centre",ref:[{id:a,keyTrace:["pt2"]}]}),this.inherentShapeList.push({id:n++,type:c.SHAPE_TYPE.aux_line,name:"@__SIGNATURE__.orientation",ref:[{name:"@__SIGNATURE__",keyTrace:["orientation"]}]}),n=100100,this.shapeList.forEach((function(t){t.type==c.SHAPE_TYPE.arc&&e.inherentShapeList.push({id:n+10*t.id,type:c.SHAPE_TYPE.aux_point,name:t.name+".centre",ref:[{id:t.id,element:"centre"}]})})),this.inherentShapeList}}},{key:"GenerateFeature_sig360_circle_line",value:function(){return{type:"sig360_circle_line",ver:"0.0.1.0",unit:"px",mmpp:this.sig360info.reports[0].mmpp,cam_param:this.sig360info.reports[0].cam_param,features:this.shapeList,inherentfeatures:this.inherentShapeList}}},{key:"findLostRefShapes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shapeList,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.inherentShapeList,n=e.concat(t),a=n.filter((function(e){if(void 0===e.ref&&void 0===e.ref_baseLine)return!1;var t=e.ref;return void 0!==(0,u.GetObjElement)(e,["ref_baseLine","id"])&&(t=[].concat(f(t),[e.ref_baseLine])),!!t.reduce((function(e,t){return e||null==n.find((function(e){return t.id==e.id}))}),!1)}));return a}},{key:"FindShapeRefTree",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.inherentShapeList,i=n.concat(a),r=i.filter((function(t){return(void 0!==t.ref||void 0!==t.ref_baseLine)&&(!(void 0===t.ref.find((function(t){return t.id==e})))||(0,u.GetObjElement)(t,["ref_baseLine","id"])==e)})).map((function(e){var i=t.FindShapeRefTree(e.id,n,a);return 0==i.length?{id:e.id,shape:e}:{id:e.id,shape:e,ref_tree:i}}));return r}},{key:"FlatRefTree",value:function(e){var t=this,n=[];return e.forEach((function(e){n.push(e),void 0!==e.ref_tree&&(n=n.concat(t.FlatRefTree(e.ref_tree)))})),n}},{key:"SetShape",value:function(e,t){var n=null,a=void 0;if(null==e){if(void 0!==t&&(a=this.FindShapeIdx(t),h.debug("SETShape>",a),null!=a)){var r=this.FindShapeRefTree(t);console.log("refTree",r);var o=this.FlatRefTree(r);console.log("flatRefTree",o),this.shapeList=this.shapeList.filter((function(e){return void 0===o.find((function(t){return e.id==t.id}))})).filter((function(e){return t!=e.id}))}return n}if(h.info("SETShape>",this.shapeList,e,t),null!=this.FindShapeIdx(e.id,this.inherentShapeList))return h.error("Error:Shape id:"+t+" name:"+e.name+" is in inherentShapeList which is not changeable."),null;if(null!=t){var s=this.FindShapeIdx(t),l=this.FindShape("name",e.name);if(void 0!==l&&s!=l)return h.error("Error:Shape id:"+t+" Duplicated shape name:"+e.name+" with idx:"+l+" "),null;if(h.info("SETShape>",s),null==s)return h.error("Error:Shape id:"+t+" doesn't exist in the list...."),null;n=this.shapeList[s],a=s}else this.shapeCount++,t=this.shapeCount;var c=null;return c=i({},e,{id:t}),null==n?(void 0===c.name&&(c.name="@"+c.type+"_"+t),this.shapeList.push(c)):null!=a&&(this.shapeList[a]=c),null!==this.editShape&&this.editShape.id==t&&(this.editShape=c),c}},{key:"FindInspShapeObject",value:function(e,t){if(null!=t){var n=this.FindShapeIdx(e,t.detectedCircles);if(null!=n)return t.detectedCircles[n];var a=this.FindShapeIdx(e,t.detectedLines);if(null!=a)return t.detectedLines[a];var i=this.FindShapeIdx(e,t.auxPoints);if(null!=i)return t.auxPoints[i];var r=this.FindShapeIdx(e,t.searchPoints);if(null!=r)return t.searchPoints[r];var o=this.FindShapeIdx(e,t.judgeReports);return null!=o?t.judgeReports[o]:void 0}}},{key:"ShapeListAdjustsWithInspectionResult",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Math.cos(-t.rotate),r=Math.sin(-t.rotate),o=t.isFlipped?-1:1;e.forEach((function(e){if(null!=e){var l=n.FindInspShapeObject(e.id,t);if(null==t||null!=l){switch(e.inspection_status=l.status,["pt1","pt2","pt3"].forEach((function(n){void 0!==e[n]&&(e[n]=(0,s.PtRotate2d_sc)(e[n],r,i,o),e[n].x+=t.cx,e[n].y+=t.cy)})),e.type){case c.SHAPE_TYPE.line:if(["pt1","pt2"].forEach((function(t){e[t]=(0,s.closestPointOnLine)(l,e[t])})),t.isFlipped){var u=e.pt1;e.pt1=e.pt2,e.pt2=u}break;case c.SHAPE_TYPE.arc:["pt1","pt2","pt3"].forEach((function(t){e[t].x-=l.x,e[t].y-=l.y;var n=Math.hypot(e[t].x,e[t].y);e[t].x=e[t].x*l.r/n+l.x,e[t].y=e[t].y*l.r/n+l.y}));break;case c.SHAPE_TYPE.search_point:e.pt1.x=l.x,e.pt1.y=l.y,t.isFlipped&&(e.angleDeg=-e.angleDeg);break;case c.SHAPE_TYPE.measure:e.inspection_value=l.value}a&&["pt1","pt2","pt3"].forEach((function(n){void 0!==e[n]&&(e[n].x-=t.cx,e[n].y-=t.cy,e[n]=o<0?(0,s.PtRotate2d_sc)(e[n],r,i,-1):(0,s.PtRotate2d_sc)(e[n],-r,i,1))}))}}}))}},{key:"FindClosestCtrlPointInfo",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList,a={pt:null,key:null,shape:null,dist:Number.POSITIVE_INFINITY};return n.forEach((function(n){var i=void 0;switch(n.type){case c.SHAPE_TYPE.line:case c.SHAPE_TYPE.arc:case c.SHAPE_TYPE.search_point:case c.SHAPE_TYPE.measure:["pt1","pt2","pt3"].forEach((function(t){void 0!==n[t]&&(i=(0,s.distance_point_point)(n[t],e),a.dist>i&&(a.shape=n,a.key=t,a.pt=n[t],a.dist=i))}));break;case c.SHAPE_TYPE.aux_point:var r=t.auxPointParse(n);i=(0,s.distance_point_point)(r,e),a.dist>i&&(a.shape=n,a.key=void 0,a.pt=r,a.dist=i)}})),a}},{key:"FindClosestInherentPointInfo",value:function(e,t){var n=this,a={pt:null,key:null,shape:null,dist:Number.POSITIVE_INFINITY};return t.forEach((function(t){if(null!=t&&t.type==c.SHAPE_TYPE.aux_point){var i=n.auxPointParse(t),r=(0,s.distance_point_point)(i,e);a.dist>r&&(a.shape=t,a.key=null,a.pt=i,a.dist=r)}})),a}},{key:"auxPointParse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList,n=void 0;if(e.type!=c.SHAPE_TYPE.aux_point)return n;if(1==e.ref.length){var a=this.FindShapeObject("id",e.ref[0].id,t);if(void 0===a)return;if(void 0!==e.ref[0].keyTrace)n=(0,u.GetObjElement)(a,e.ref[0].keyTrace);else switch(a.type){case c.SHAPE_TYPE.arc:var i=a,r=(0,s.threePointToArc)(i.pt1,i.pt2,i.pt3);(n=r).ref=(0,p.default)(e.ref),n.ref[0]._obj=i}}else if(2==e.ref.length){var o=this.FindShapeObject("id",e.ref[0].id,t);if(void 0===o)return;var l=this.FindShapeObject("id",e.ref[1].id,t);if(void 0===l)return;var d=this.shapeVectorParse(o,t),f=this.shapeVectorParse(l,t);if(void 0===d||void 0===f)return;var _=this.shapeMiddlePointParse(o,t),h=this.shapeMiddlePointParse(l,t);if(void 0===_||void 0===h)return;(0,s.vecXY_addin)(d,_),(0,s.vecXY_addin)(f,h);var S=(0,s.intersectPoint)(_,d,h,f);return S}return n}},{key:"searchPointParse",value:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;var t=void 0;if(e.type==c.SHAPE_TYPE.search_point){if(1==e.ref.length){var n=this.FindShapeObject("id",e.ref[0].id);if(void 0===n)return;switch(n.type){case c.SHAPE_TYPE.line:t=e.pt1}}return t}}},{key:"shapeMiddlePointParse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;switch(e.type){case c.SHAPE_TYPE.line:return{x:(e.pt1.x+e.pt2.x)/2,y:(e.pt1.y+e.pt2.y)/2};case c.SHAPE_TYPE.arc:return(0,s.threePointToArc)(e.pt1,e.pt2,e.pt3);case c.SHAPE_TYPE.aux_point:return this.auxPointParse(e,t);case c.SHAPE_TYPE.search_point:return this.searchPointParse(e,t)}}},{key:"shapeVectorParse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;switch(e.type){case c.SHAPE_TYPE.line:return{x:e.pt2.x-e.pt1.x,y:e.pt2.y-e.pt1.y};case c.SHAPE_TYPE.search_point:if(void 0===e.ref||1!=e.ref.length)return;var n=this.FindShapeObject("id",e.ref[0].id,t);if(void 0===n||n.type!==c.SHAPE_TYPE.line)return;var a=this.shapeVectorParse(n,t);if(void 0===a)return;var i=Math.atan2(a.y,a.x)+e.angleDeg*Math.PI/180;return{x:Math.cos(i),y:Math.sin(i)}}}}]),e}()},207:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CusDisp_DB=t.inspectionQuery=t.defFileQuery=void 0;var a,i=n(445),r=(a=i)&&a.__esModule?a:{default:a};var o="http://hyv.decade.tw:8080/";function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"TIMEOUT";return new Promise((function(a,i){var o=void 0;t>0&&(o=setTimeout((function(){o=void 0,i(n)}),t)),(0,r.default)(e,(function(e,t){clearTimeout(o),null===e?a(t):i(e)}))}))}var l={read:function(e){return new Promise((function(t,n){var a="http://hyv.decade.tw:8080/QUERY/customDisplay?name="+e;s(a+='&projection={"name":1,"cat":1,"targetDeffiles":1}',null).then((function(e){t(e)})).catch((function(e){n(e)}))}))},create:function(e,t){return new Promise((function(n,a){var i="http://hyv.decade.tw:8080/insert/customdisplay?name="+e.name+"&full="+JSON.stringify(e);void 0!==t&&(i+="&_id="+t),s(i,null).then((function(e){n(e)})).catch((function(e){a(e)}))}))},delete:function(e){return new Promise((function(t,n){s("http://hyv.decade.tw:8080/delete/customdisplay?_id="+e,null).then((function(e){t(e)})).catch((function(e){n(e)}))}))},update:function(e,t){return new Promise((function(n,a){if(void 0===t)return a("Error:No id");l.create(e,t).then((function(e){n(e)})).catch((function(e){a(e)}))}))}};t.defFileQuery=function(e,t){var n=o+"query/deffile?";return n+="limit=1000",void 0!==e&&(n+="&name="+e),void 0!==t&&(n+="&featureSet_sha1="+t),new Promise((function(e,t){(0,r.default)(n,(function(n,a){null===n?e(a):t(n),console.log(n,a)}))}))},t.inspectionQuery=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i="query/inspection",s=o+i+"?";return s+="tStart="+t.toString()+"&tEnd="+n.toString()+"&",s+="limit="+a+"&page=1&",s+="subFeatureDefSha1="+e+"&",s+="projection="+JSON.stringify({_id:0,"InspectionData.time_ms":1,"InspectionData.subFeatureDefSha1":1,"InspectionData.judgeReports.id":1,"InspectionData.judgeReports.value":1,"InspectionData.judgeReports.status":1}),s+="",new Promise((function(e,t){(0,r.default)(s,(function(n,a){null===n?e(a):t(n),console.log(n,a)}))}))},t.CusDisp_DB=l},218:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MEASURE_RESULT_VISUAL_INFO=void 0;var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(28),o=n(193),s=h(n(55)),l=n(47),c=n(280),u=n(43),d=h(n(37)),p=_(n(61)),f=_(n(930));function _(e){return e&&e.__esModule?e:{default:e}}function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=t.MEASURE_RESULT_VISUAL_INFO=(E(a={},o.MEASURERSULTRESION.NA,{COLOR:"rgba(128,128,128,0.5)",TEXT:o.MEASURERSULTRESION.NA}),E(a,o.MEASURERSULTRESION.UOK,{COLOR:"rgba(128,200,128,0.7)",TEXT:o.MEASURERSULTRESION.UOK}),E(a,o.MEASURERSULTRESION.LOK,{COLOR:"rgba(128,200,128,0.7)",TEXT:o.MEASURERSULTRESION.LOK}),E(a,o.MEASURERSULTRESION.UCNG,{COLOR:"rgba(255,255,0,0.5)",TEXT:o.MEASURERSULTRESION.UCNG}),E(a,o.MEASURERSULTRESION.LCNG,{COLOR:"rgba(255,255,0,0.5)",TEXT:o.MEASURERSULTRESION.LCNG}),E(a,o.MEASURERSULTRESION.USNG,{COLOR:"rgba(255,0,0,0.5)",TEXT:o.MEASURERSULTRESION.USNG}),E(a,o.MEASURERSULTRESION.LSNG,{COLOR:"rgba(255,0,0,0.5)",TEXT:o.MEASURERSULTRESION.LSNG}),a),y=function(){function e(t){m(this,e),this.matrix=new DOMMatrix,this.tmpMatrix=new DOMMatrix,this.identityMat=new DOMMatrix,this.Scale(.1)}return i(e,[{key:"Scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=new DOMMatrix;n.translateSelf(t.x,t.y),n.scaleSelf(e,e),n.translateSelf(-t.x,-t.y),this.matrix.preMultiplySelf(n)}},{key:"StartDrag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.tmpMatrix.setMatrixValue(this.identityMat),this.tmpMatrix.translateSelf(e.x,e.y)}},{key:"EndDrag",value:function(){this.matrix.preMultiplySelf(this.tmpMatrix),this.tmpMatrix.setMatrixValue(this.identityMat)}},{key:"SetOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.matrix.m41=0,this.matrix.m42=0,this.matrix.translateSelf(e.x,e.y)}},{key:"GetCameraScale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.matrix;return Math.sqrt(e.m11*e.m22-e.m12*e.m21)}},{key:"GetCameraOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.matrix;return{x:e.m41,y:e.m42}}},{key:"CameraTransform",value:function(e){e.multiplySelf(this.tmpMatrix),e.multiplySelf(this.matrix)}}]),e}(),g=function(){function e(t,n){m(this,e),this.setEditor_db_obj(t),this.camCtrl=n,this.colorSet={unselected:"rgba(100,0,100,0.5)",inspection_Pass:"rgba(0,255,0,0.1)",inspection_production_Fail:"rgba(128,128,0,0.1)",inspection_Fail:"rgba(255,0,0,0.1)",inspection_NA:"rgba(128,128,128,0.1)",editShape:"rgba(255,0,0,0.7)",measure_info:"rgba(128,128,200,0.7)"},this.renderParam={base_Size:1,size_Multiplier:1,mmpp:.1,font_Base_Size:60,font_Style:"bold "}}return i(e,[{key:"get_mmpp",value:function(){return this.renderParam.mmpp}},{key:"getPrimitiveSize",value:function(){return this.renderParam.base_Size*this.renderParam.size_Multiplier*this.get_mmpp()}},{key:"getPointSize",value:function(){return 8*this.getPrimitiveSize()}},{key:"getIndicationLineSize",value:function(){return 8*this.getPrimitiveSize()}},{key:"getSearchDirectionLineSize",value:function(){return 8*this.getPrimitiveSize()}},{key:"getFontHeightPx",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.renderParam.font_Base_Size;return e*this.renderParam.size_Multiplier*this.get_mmpp()}},{key:"getFixSizingReg",value:function(){return 50/this.camCtrl.GetCameraScale()}},{key:"getFontStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getFontHeightPx();return this.renderParam.font_Style+e+"px Arial"}},{key:"setEditor_db_obj",value:function(e){this.db_obj=e}},{key:"setColorSet",value:function(e){this.colorSet=e}},{key:"drawReportLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};e.beginPath(),e.moveTo(t.x0+n.x,t.y0+n.y),e.lineTo(t.x1+n.x,t.y1+n.y),e.stroke()}},{key:"drawLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};e.beginPath(),e.moveTo(t.pt1.x+n.x,t.pt1.y+n.y),e.lineTo(t.pt2.x+n.x,t.pt2.y+n.y),e.stroke()}},{key:"drawReportArc",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};e.beginPath(),void 0===t.thetaS||void 0===t.thetaE?e.arc(t.x+n.x,t.y+n.y,t.r,0,2*Math.PI,!1):e.arc(t.x+n.x,t.y+n.y,t.r,t.thetaS,t.thetaE,!1),e.stroke()}},{key:"_drawpoint",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;e.beginPath(),"rect"==n&&e.rect(t.x-a/2,t.y-a/2,a,a),"cross"==n?(e.moveTo(t.x-a/2,t.y),e.lineTo(t.x+a/2,t.y),e.moveTo(t.x,t.y-a/2),e.lineTo(t.x,t.y+a/2)):e.arc(t.x,t.y,a/2,0,2*Math.PI,!1),e.stroke()}},{key:"drawpoint",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.getPointSize(),i=e.strokeStyle;e.lineWidth=2*a,e.strokeStyle="rgba(0,0,100,0.5)","cross"!=n&&this._drawpoint(e,t,n,2*a),e.lineWidth=a/2,e.strokeStyle=i,this._drawpoint(e,t,n,2*a)}},{key:"drawInherentShapeList",value:function(e,t){var n=this;void 0!==t&&null!=t&&t.forEach((function(t){if(null!=t)switch(t.type){case r.SHAPE_TYPE.aux_point:var a=n.db_obj.auxPointParse(t);null!=a&&(e.strokeStyle="black",n.drawpoint(e,a,"rect"))}}))}},{key:"canvas_arrow",value:function(e,t,n,a,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:10,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI/6,s=Math.atan2(i-n,a-t);e.beginPath(),e.moveTo(t,n),e.lineTo(a,i),e.moveTo(a,i),e.lineTo(a-r*Math.cos(s-o),i-r*Math.sin(s-o)),e.moveTo(a,i),e.lineTo(a-r*Math.cos(s+o),i-r*Math.sin(s+o)),e.stroke()}},{key:"drawArcArrow",value:function(e,t,n,a,i,r){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];e.beginPath(),e.arc(t,n,a,i,r,o),e.stroke();var s=Math.cos(r),l=Math.sin(r);t+=a*s,n+=a*l;var c=o?-1:1;c*=this.getPrimitiveSize();var u=50*this.getPrimitiveSize();this.canvas_arrow(e,t+c*l,n-c*s,t,n,u)}},{key:"drawLineArrow",value:function(e,t,n,a,i){}},{key:"drawText",value:function(e,t,n,a){e.fillText(t,n,a),e.strokeStyle="black",e.lineWidth=this.getIndicationLineSize(),e.strokeText(t,n,a)}},{key:"draw_Text",value:function(e,t,n,a,i){e.save(),e.translate(a,i),e.scale(n,n),e.fillText(t,0,0),e.strokeText(t,0,0),e.restore()}},{key:"drawMeasureDistance",value:function(e,t,n,a,i){var r,o,s;e.lineWidth=this.getIndicationLineSize();var l=this.db_obj;o=l.shapeMiddlePointParse(n[0],a),s=l.shapeMiddlePointParse(n[1],a);var u=void 0;void 0!==t.ref_baseLine&&void 0!==t.ref_baseLine.id&&(u=a.find((function(e){return e.id==t.ref_baseLine.id}))),void 0===u&&(u=n[0]);var d=l.shapeVectorParse(u,a);if(void 0===d&&(d={x:-(s.y-o.y),y:s.x-o.x}),r={x1:o.x,y1:o.y,x2:o.x+d.x,y2:o.y+d.y},null!=s&&null!=r){var p=(0,c.closestPointOnLine)(r,s),f=(0,c.closestPointOnLine)(r,t.pt1),_={x0:f.x,y0:f.y,x1:f.x+(s.x-p.x),y1:f.y+(s.y-p.y)};e.setLineDash([5*this.getPrimitiveSize(),15*this.getPrimitiveSize()]),this.drawReportLine(e,{x0:_.x0,y0:_.y0,x1:o.x,y1:o.y}),this.drawReportLine(e,{x0:_.x1,y0:_.y1,x1:s.x,y1:s.y}),this.drawReportLine(e,{x0:_.x1,y0:_.y1,x1:t.pt1.x,y1:t.pt1.y}),e.setLineDash([]),this.drawReportLine(e,_),this.drawpoint(e,t.pt1);var h=this.getFontHeightPx()*this.getFixSizingReg();e.font=this.getFontStyle(1),e.strokeStyle="black",e.lineWidth=this.getIndicationLineSize()/3;var S=void 0;if(void 0!==t.inspection_value){var v=0;this.draw_Text(e,t.name,h,t.pt1.x,t.pt1.y),v+=h,S="D"+(t.inspection_value*i.mult).toFixed(3)+i.unit,S+=":"+(100*(t.inspection_value>t.value?(t.inspection_value-t.value)/(t.USL-t.value):-(t.inspection_value-t.value)/(t.LSL-t.value))).toFixed(1)+"%",this.draw_Text(e,S,h,t.pt1.x,t.pt1.y+v)}else{e.save();var m=0;this.draw_Text(e,t.name,h,t.pt1.x,t.pt1.y),m+=h;var E="D"+t.value.toFixed(3)+i.unit;this.draw_Text(e,E,h,t.pt1.x,t.pt1.y+m),m+=h/2,h/=2,E="L:"+t.LSL*i.mult.toFixed(3)+i.unit+" U:"+t.USL*i.mult.toFixed(3)+i.unit,this.draw_Text(e,E,h,t.pt1.x,t.pt1.y+m),m+=h,E="Now:"+(Math.hypot(s.x-p.x,s.y-p.y)*i.mult).toFixed(3)+i.unit,this.draw_Text(e,E,h,t.pt1.x,t.pt1.y+m)}}}},{key:"drawSignature",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36;e.beginPath(),e.moveTo(t.magnitude[0]*Math.cos(t.angle[0]),t.magnitude[0]*Math.sin(t.angle[0]));for(var a=1;a<t.angle.length;a+=n)e.lineTo(t.magnitude[a]*Math.cos(t.angle[a]),t.magnitude[a]*Math.sin(t.angle[a]));e.closePath()}},{key:"drawShapeList",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments[4],o=this,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{unit:"mm",mult:1},l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=null;null!=n&&(u=(0,f.default)(n).desaturate(.6).string()),t.forEach((function(t){if(null!=t&&void 0===a.find((function(e){return t.id==e})))switch(e.strokeStyle=null!=n?n:t.color,t.type){case r.SHAPE_TYPE.line:e.lineWidth=2*t.margin,o.drawReportLine(e,{x0:t.pt1.x,y0:t.pt1.y,x1:t.pt2.x,y1:t.pt2.y});var d=(0,c.LineCentralNormal)(t);e.lineWidth=o.getSearchDirectionLineSize(),e.strokeStyle="rgba(100,50,100,0.8)";var p=t.margin+e.lineWidth/2;t.direction<0&&(p=-p),o.drawReportLine(e,{x0:t.pt1.x+d.vx*p,y0:t.pt1.y+d.vy*p,x1:t.pt2.x+d.vx*p,y1:t.pt2.y+d.vy*p}),e.strokeStyle="gray",o.drawpoint(e,t.pt1),o.drawpoint(e,t.pt2);break;case r.SHAPE_TYPE.aux_point:var f=o.db_obj,_=t.ref.map((function(e){return f.FindShape("id",e.id,i)})).map((function(e){return e>=0?i[e]:null}));if(l&&o.drawShapeList(e,_,u,a,i,s,l),void 0===t.id)break;var h=o.db_obj.auxPointParse(t,i);void 0!==h&&2==_.length&&(e.setLineDash([5*o.getPrimitiveSize(),15*o.getPrimitiveSize()]),e.beginPath(),e.moveTo(h.x,h.y),e.lineTo(_[0].pt1.x,_[0].pt1.y),e.stroke(),e.beginPath(),e.moveTo(h.x,h.y),e.lineTo(_[1].pt1.x,_[1].pt1.y),e.stroke(),e.setLineDash([]),e.strokeStyle="gray",o.drawpoint(e,h));break;case r.SHAPE_TYPE.aux_line:var S=o.db_obj,v=t.ref.map((function(e){return S.FindShape("id",e.id,i)})).map((function(e){return e>=0?i[e]:null}));if(l&&o.drawShapeList(e,v,u,a,i,s,l),void 0===t.id)break;2==v.length&&(e.setLineDash([5*o.getPrimitiveSize(),15*o.getPrimitiveSize()]),e.strokeStyle="gray",e.beginPath(),e.moveTo(v[0].pt1.x,v[0].pt1.y),e.lineTo(v[1].pt1.x,v[1].pt1.y),e.stroke(),e.setLineDash([]));break;case r.SHAPE_TYPE.arc:var m=(0,c.threePointToArc)(t.pt1,t.pt2,t.pt3);e.lineWidth=2*t.margin,o.drawReportArc(e,m),e.lineWidth=o.getSearchDirectionLineSize(),e.strokeStyle="rgba(100,50,100,0.8)";var E=t.margin+e.lineWidth/2;t.direction<0&&(E=-E),m.r+=E,o.drawReportArc(e,m),e.strokeStyle="gray",o.drawpoint(e,t.pt1),o.drawpoint(e,t.pt2),o.drawpoint(e,t.pt3);break;case r.SHAPE_TYPE.search_point:var b=o.db_obj,y=t.ref.map((function(e){return b.FindShape("id",e.id,i)})).map((function(e){return e>=0?i[e]:null}));if(null==y[0])break;y[0];var g=b.shapeVectorParse(t,i),k={x:-g.y,y:g.x},T=t.width/2;g.x*=T,g.y*=T,e.lineWidth=2*t.margin,o.drawReportLine(e,{x0:t.pt1.x-g.x,y0:t.pt1.y-g.y,x1:t.pt1.x+g.x,y1:t.pt1.y+g.y}),e.lineWidth=o.getSearchDirectionLineSize(),e.strokeStyle="rgba(100,50,100,0.8)";var C=t.margin+e.lineWidth/2;o.drawReportLine(e,{x0:t.pt1.x-g.x+k.x*C,y0:t.pt1.y-g.y+k.y*C,x1:t.pt1.x+g.x+k.x*C,y1:t.pt1.y+g.y+k.y*C}),l&&o.drawShapeList(e,y,u,a,i,s,l),e.strokeStyle="gray",o.drawpoint(e,t.pt1);break;case r.SHAPE_TYPE.measure:var I=o.db_obj;if(void 0===t.ref)break;var A=t.ref.map((function(e){return I.FindShapeObject("id",e.id,i)}));if(l&&o.drawShapeList(e,A,u,a,i,s,l),!A.reduce((function(e,t){return e&&void 0!==t}),!0))break;switch(null==n||null==n?void 0!==t.color?(e.strokeStyle=t.color,e.fillStyle=t.color):(e.strokeStyle=o.colorSet.measure_info,e.fillStyle=o.colorSet.measure_info):(e.strokeStyle=n,e.fillStyle=n),e.lineWidth=o.getIndicationLineSize(),t.subtype){case r.SHAPE_TYPE.measure_subtype.distance:o.drawMeasureDistance(e,t,A,i,s);break;case r.SHAPE_TYPE.measure_subtype.angle:var D=(0,c.intersectPoint)(A[0].pt1,A[0].pt2,A[1].pt1,A[1].pt2);e.lineWidth=o.getIndicationLineSize();var O=Math.atan2(A[0].pt1.y-D.y,A[0].pt1.x-D.x),N=Math.atan2(A[1].pt1.y-D.y,A[1].pt1.x-D.x),P=(N-O)%(2*Math.PI);P<0&&(P+=2*Math.PI),P>Math.PI&&(P-=Math.PI);var w=0,x=(Math.atan2(t.pt1.y-D.y,t.pt1.x-D.x)-O)%(2*Math.PI);x<0&&(x+=2*Math.PI),w=x<P?1:x<Math.PI?2:x<Math.PI+P?3:4,t.quadrant=w;var U,M=Math.hypot(t.pt1.y-D.y,t.pt1.x-D.x),L=(t.margin,Math.PI,O),R=O,F=N;switch(w%4){case 1:break;case 2:L+=P;break;case 3:L+=Math.PI;break;case 0:L=L+P+Math.PI}w%2==0&&(P=Math.PI-P),U=L+P,w%2==0?(R=U,F=L):(R=L,F=U),o.drawArcArrow(e,D.x,D.y,M,L,U),o.drawpoint(e,t.pt1);var j=180*P/Math.PI;e.setLineDash([5*o.getPrimitiveSize(),15*o.getPrimitiveSize()]),o.drawReportLine(e,{x0:A[0].pt1.x,y0:A[0].pt1.y,x1:D.x+M*Math.cos(R),y1:D.y+M*Math.sin(R)}),o.drawReportLine(e,{x0:A[1].pt1.x,y0:A[1].pt1.y,x1:D.x+M*Math.cos(F),y1:D.y+M*Math.sin(F)}),e.setLineDash([]);var W=t.pt1.x+(t.pt1.x-D.x)/M*4*o.getPrimitiveSize(),B=t.pt1.y+(t.pt1.y-D.y)/M*4*o.getPrimitiveSize(),H=o.getFontHeightPx()*o.getFixSizingReg();e.font=o.getFontStyle(1);var G=void 0;if(void 0!==t.inspection_value){var z=0;e.strokeStyle="black",e.lineWidth=o.getIndicationLineSize()/3,o.draw_Text(e,t.name,H,W,B),z+=H,G=t.inspection_value.toFixed(2)+"º",G+=":"+(100*(t.inspection_value>t.value?(t.inspection_value-t.value)/(t.USL-t.value):-(t.inspection_value-t.value)/(t.LSL-t.value))).toFixed(1)+"%",o.draw_Text(e,G,H,W,B+z)}else{e.save();var V=0;e.strokeStyle="black",e.lineWidth=o.getIndicationLineSize()/3,o.draw_Text(e,t.name,H,t.pt1.x,t.pt1.y),V+=H;var X=t.value.toFixed(3)+"º";o.draw_Text(e,X,H,W,B+V),V+=H/2,H/=2,X="L:"+t.LSL.toFixed(3)+"º U:"+t.USL.toFixed(3)+"º",o.draw_Text(e,X,H,W,B+V),V+=H,X="Now:"+j.toFixed(3)+"º",o.draw_Text(e,X,H,t.pt1.x,t.pt1.y+V)}break;case r.SHAPE_TYPE.measure_subtype.radius:e.lineWidth=o.getIndicationLineSize()/3,e.font=o.getFontStyle();var Y=(0,c.threePointToArc)(A[0].pt1,A[0].pt2,A[0].pt3),K={x:t.pt1.x-Y.x,y:t.pt1.y-Y.y},J=Math.hypot(K.x,K.y),Q={x:K.x/J,y:K.y/J};K.x*=Y.r/J,K.y*=Y.r/J;var q=50*o.getPrimitiveSize();o.canvas_arrow(e,t.pt1.x,t.pt1.y,Y.x+K.x,Y.y+K.y,q),o.drawpoint(e,t.pt1),Q.x*=40*o.getPrimitiveSize(),Q.y*=40*o.getPrimitiveSize();var $=o.getFontHeightPx()*o.getFixSizingReg();e.font=o.getFontStyle(1);if(void 0!==t.inspection_value){var Z="R"+(t.inspection_value*s.mult).toFixed(3)+s.unit;Z+=":"+(100*(t.inspection_value>t.value?(t.inspection_value-t.value)/(t.USL-t.value):-(t.inspection_value-t.value)/(t.LSL-t.value))).toFixed(1)+"%",e.strokeStyle="black",e.lineWidth=o.getIndicationLineSize()/3,o.draw_Text(e,t.name,$,t.pt1.x+Q.x,t.pt1.y+Q.y);var ee=$;o.draw_Text(e,Z,$,t.pt1.x+Q.x,t.pt1.y+Q.y+ee)}else{e.save();var te=0;e.strokeStyle="black",e.lineWidth=o.getIndicationLineSize()/3,o.draw_Text(e,t.name,$,t.pt1.x,t.pt1.y),te+=$;var ne="R"+t.value.toFixed(3)+s.unit;o.draw_Text(e,ne,$,t.pt1.x,t.pt1.y+te),te+=$/2,$/=2,ne="L:"+t.LSL*s.mult.toFixed(3)+s.unit+" U:"+t.USL*s.mult.toFixed(3)+s.unit,o.draw_Text(e,ne,$,t.pt1.x,t.pt1.y+te),te+=$,ne="Now:"+(Y.r*s.mult).toFixed(3)+s.unit,o.draw_Text(e,ne,$,t.pt1.x,t.pt1.y+te)}}}}))}},{key:"drawInspectionShapeList",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments[4],o=this,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{unit:"mm",mult:1},l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=[];t.forEach((function(t){if(null!=t&&void 0===a.find((function(e){return t.id==e})))switch(e.strokeStyle=null!=n?n:t.color,t.type){case r.SHAPE_TYPE.line:e.lineWidth=o.getIndicationLineSize(),o.drawReportLine(e,{x0:t.pt1.x,y0:t.pt1.y,x1:t.pt2.x,y1:t.pt2.y});break;case r.SHAPE_TYPE.arc:var s=(0,c.threePointToArc)(t.pt1,t.pt2,t.pt3);e.lineWidth=o.getIndicationLineSize(),o.drawReportArc(e,s);break;case r.SHAPE_TYPE.search_point:e.strokeStyle="rgba(179, 0, 0,0.5)",o.drawpoint(e,t.pt1,"cross",150*o.getPointSize()/o.camCtrl.GetCameraScale()),e.lineWidth=o.getIndicationLineSize();break;case r.SHAPE_TYPE.aux_point:var l=o.db_obj,d=t.ref.map((function(e){return l.FindShape("id",e.id,i)})).map((function(e){return e>=0?i[e]:null}));if(void 0===t.id)break;e.lineWidth=o.getIndicationLineSize();var p=o.db_obj.auxPointParse(t,i);void 0!==p&&2==d.length&&(e.setLineDash([5*o.getPrimitiveSize(),15*o.getPrimitiveSize()]),e.beginPath(),e.moveTo(p.x,p.y),e.lineTo(d[0].pt1.x,d[0].pt1.y),e.stroke(),e.beginPath(),e.moveTo(p.x,p.y),e.lineTo(d[1].pt1.x,d[1].pt1.y),e.stroke(),e.setLineDash([]),e.strokeStyle="gray",o.drawpoint(e,p,"cross"));break;case r.SHAPE_TYPE.measure:u.push(t)}})),this.drawShapeList(e,u,n,a,i,s,l)}}]),e}(),k=function(){function e(t){var n=this;m(this,e),this.canvas=t,this.canvas.onmousemove=this.onmousemove.bind(this),this.canvas.onmousedown=this.onmousedown.bind(this),this.canvas.onmouseup=this.onmouseup.bind(this),this.canvas.onmouseout=this.onmouseout.bind(this),this.multiTouchInfo={ptouchStatus:[],touchStatus:[],dragInfo:{},pinchInfo:{}};var a=function(e){var t=n.multiTouchInfo;t.ptouchStatus=t.touchStatus,t.touchStatus=n.copyTouchPositionInfo(e);var a=10*t.ptouchStatus.length+t.touchStatus.length;switch(a){case 20:case 21:n.multiTouchInfo.pinchInfo={};break;case 10:case 12:n.multiTouchInfo.dragInfo={},n.onmouseup(t.ptouchStatus[0])}switch(a){case 11:n.onmousemove(t.touchStatus[0]);break;case 22:var i=n.multiTouchInfo.pinchInfo.pts_cur,r=t.touchStatus;n.multiTouchInfo.pinchInfo={pts_pre:i,pts_cur:t.touchStatus};var o=Math.hypot(r[0].clientX-r[1].clientX,r[0].clientY-r[1].clientY)/Math.hypot(i[0].clientX-i[1].clientX,i[0].clientY-i[1].clientY),s={x:(i[0].clientX+i[1].clientX)/2,y:(i[0].clientY+i[1].clientY)/2};n.scaleCanvas(s,1,o)}switch(a){case 1:case 21:n.multiTouchInfo.dragInfo={start:t.touchStatus[0]},n.onmousedown(t.touchStatus[0]);break;case 2:case 12:n.multiTouchInfo.pinchInfo={pts_cur:t.touchStatus,pts_start:t.touchStatus}}};this.canvas.addEventListener("touchstart",(function(e){a(e)}),!1),this.canvas.addEventListener("touchmove",(function(e){a(e),e.preventDefault()}),!1),this.canvas.addEventListener("touchend",(function(e){a(e)}),!1),this.canvas.addEventListener("wheel",this.onmouseswheel.bind(this),!1),this.mouseStatus={x:-1,y:-1,px:-1,py:-1,status:0,pstatus:0},this.secCanvas_rawImg=null,this.secCanvas=document.createElement("canvas"),this.identityMat=new DOMMatrix,this.Mouse2SecCanvas=new DOMMatrix,this.camera=new y,this.camera.Scale(100),this.colorSet={unselected:"rgba(100,0,100,0.5)",inspection_Pass:"rgba(0,255,0,0.1)",inspection_Fail:"rgba(255,0,0,0.1)",editShape:"rgba(255,0,0,0.7)",measure_info:"rgba(128,128,200,0.7)"},this.rUtil=new g(null,this.camera),this.rUtil.setColorSet(this.colorSet),this.debounce_zoom_emit=this.throttle(this.zoom_emit.bind(this),100)}return i(e,[{key:"getMousePos",value:function(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}},{key:"copyTouchPositionInfo",value:function(e){var t=[];return Object.keys(e.touches).forEach((function(n){var a=e.touches[n];"length"!==n&&t.push({clientX:a.clientX,clientY:a.clientY,force:a.force,identifier:a.identifier,pageX:a.pageX,pageY:a.pageY,radiusX:a.radiusX,radiusY:a.radiusY,rotationAngle:a.rotationAngle,screenX:a.screenX,screenY:a.screenY})})),t}}]),i(e,[{key:"resourceClean",value:function(){this.canvas.removeEventListener("wheel",this.onmouseswheel.bind(this)),d.debug("resourceClean......")}},{key:"SetImg",value:function(e){if(null!=e&&e!=this.img_info){this.img_info=e;var t=e.img;this.secCanvas.width=t.width,this.secCanvas.height=t.height,this.secCanvas_rawImg=t;var n=this.secCanvas.getContext("2d");n.putImageData(t,0,0),d.debug("SetImg::: UPDATE",n)}}},{key:"debounce",value:function(e,t,n){var a;return function(){var i=this,r=arguments,o=function(){a=null,n||e.apply(i,r)},s=n&&!a;clearTimeout(a),a=setTimeout(o,t),s&&e.apply(i,r)}}},{key:"throttle",value:function(e,t,n){var a,i,r,o=null,s=0;n||(n={});var l=function(){s=!1===n.leading?0:Date.now(),o=null,r=e.apply(a,i),o||(a=i=null)};return function(){var c=Date.now();s||!1!==n.leading||(s=c);var u=t-(c-s);return a=this,i=arguments,u<=0||u>t?(o&&(clearTimeout(o),o=null),s=c,r=e.apply(a,i),o||(a=i=null)):o||!1===n.trailing||(o=setTimeout(l,u)),r}}},{key:"zoom_emit",value:function(){var e=.2*-this.canvas.width,t=.2*-this.canvas.height,n=this.canvas.width-2*e,a=this.canvas.height-2*t,i=this.camera.GetCameraScale(),r=this.camera.GetCameraOffset(),o=[(e-r.x-this.canvas.width/2)/i,(t-r.y-this.canvas.height/2)/i,n/i,a/i],s=1*o[2]/this.canvas.width;this.EmitEvent({type:"asdasdas",data:{down_samp_level:s,crop:o}})}},{key:"onmouseswheel",value:function(e){var t=this.scaleCanvas(this.mouseStatus,e.deltaY/4);return this.debounce_zoom_emit(),t}},{key:"scaleCanvas",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/1.01;return t>50&&(t=1),t<-50&&(t=-1),n=Math.pow(n,t),this.camera.Scale(n,{x:e.x-this.canvas.width/2,y:e.y-this.canvas.height/2}),this.draw(),!1}},{key:"onmousemove",value:function(e){var t=this.getMousePos(this.canvas,e);this.mouseStatus.x=t.x,this.mouseStatus.y=t.y;var n=!1;switch(this.state.substate){case r.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(null!=this.EditPoint)break;case r.UI_SM_STATES.DEFCONF_MODE_NEUTRAL:case r.UI_SM_STATES.INSP_MODE_NEUTRAL:n=!0}this.state.state===r.UI_SM_STATES.MAIN&&(n=!0),n&&1==this.mouseStatus.status&&this.camera.StartDrag({x:t.x-this.mouseStatus.px,y:t.y-this.mouseStatus.py}),this.ctrlLogic(),this.draw()}},{key:"onmousedown",value:function(e){var t=this.getMousePos(this.canvas,e);this.mouseStatus.px=t.x,this.mouseStatus.py=t.y,this.mouseStatus.x=t.x,this.mouseStatus.y=t.y,this.mouseStatus.status=1,this.ctrlLogic(),this.draw()}},{key:"onmouseup",value:function(e){var t=this.getMousePos(this.canvas,e);this.mouseStatus.x=t.x,this.mouseStatus.y=t.y,this.mouseStatus.status=0,this.camera.EndDrag(),this.debounce_zoom_emit(),this.ctrlLogic(),this.draw()}},{key:"onmouseout",value:function(e){1==this.mouseStatus.status&&this.onmouseup(e)}},{key:"resize",value:function(e,t){this.canvas.width=e,this.canvas.height=t,this.draw()}},{key:"worldTransform",value:function(){var e=new DOMMatrix;return e.translateSelf(this.canvas.width/2,this.canvas.height/2),this.camera.CameraTransform(e),e}},{key:"VecX2DMat",value:function(e,t){return{x:e.x*t.a+e.y*t.c+t.e,y:e.x*t.b+e.y*t.d+t.f}}}]),e}(),T=function(e){function t(e){m(this,t);var n=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.edit_DB_info=null,n.db_obj=null,n.mouse_close_dist=10,n.state=void 0,n.EditShape=null,n.CandEditPointInfo=null,n.EditPoint=null,n.EmitEvent=function(e){d.debug(e)},n}return v(t,e),i(t,[{key:"SetState",value:function(e){d.debug(e);var t=(0,l.xstate_GetCurrentMainState)(e),n=JSON.stringify(t);JSON.stringify(this.state)!==n&&(this.state=JSON.parse(n),this.state.state==r.UI_SM_STATES.DEFCONF_MODE&&this.state.substate==r.UI_SM_STATES.DEFCONF_MODE_NEUTRAL&&(this.EmitEvent(s.Edit_Tar_Update(null)),this.EditShape=null,this.EditPoint=null))}},{key:"EditDBInfoSync",value:function(e){if(this.edit_DB_info=e,this.db_obj=e._obj,void 0!==this.db_obj&&null!=this.db_obj&&void 0!==this.db_obj.cameraParam){this.rUtil.setEditor_db_obj(this.db_obj),this.SetImg(e.img);var t=this.db_obj.getsig360info_mmpp();this.rUtil.renderParam.mmpp=t}}},{key:"fitCameraToShape",value:function(e){if(null!=e&&void 0!==e){var t={x:0,y:0};switch(e.type){case r.SHAPE_TYPE.line:t.x=(e.pt1.x+e.pt2.x)/2,t.y=(e.pt1.y+e.pt2.y)/2;break;case r.SHAPE_TYPE.arc:var n=(0,c.threePointToArc)(e.pt1,e.pt2,e.pt3);n.r>500?(t.x=(e.pt1.x+e.pt3.x)/2,t.y=(e.pt1.y+e.pt3.y)/2):(t.x=n.x,t.y=n.y);break;case r.SHAPE_TYPE.aux_point:var a=this.db_obj.auxPointParse(e);if(null==a)return;t=a;break;case r.SHAPE_TYPE.search_point:t=e.pt1;break;default:return}this.camera.SetOffset({x:-t.x,y:-t.y})}}},{key:"ctrlLogic",value:function(){}},{key:"setMatrix",value:function(e,t){e.setTransform(t.a,t.b,t.c,t.d,t.e,t.f)}},{key:"draw",value:function(){if(void 0!==this.db_obj&&null!=this.db_obj&&void 0!==this.db_obj.cameraParam){var e=this.rUtil.get_mmpp(),t=this.canvas.getContext("2d");this.secCanvas.getContext("2d");t.lineWidth=this.rUtil.getIndicationLineSize(),this.setMatrix(t,this.identityMat),t.clearRect(0,0,this.canvas.width,this.canvas.height);var n=this.worldTransform();this.setMatrix(t,n);var a=this.db_obj.getsig360infoCenter();t.save(),t.translate(-a.x,-a.y);var i=1;void 0!==this.img_info&&void 0!==this.img_info.scale&&(i=this.img_info.scale),t.scale(i*e,i*e),void 0!==this.img_info&&void 0!==this.img_info.offsetX&&void 0!==this.img_info.offsetY&&t.translate(this.img_info.offsetX/i,this.img_info.offsetY/i),t.drawImage(this.secCanvas,0,0),t.restore();this.Mouse2SecCanvas=n.invertSelf();var r=this.Mouse2SecCanvas,o=this.mouseStatus;this.VecX2DMat(o,r);t.closePath(),t.save();this.rUtil.drawShapeList(t,this.edit_DB_info.list,null,[],this.edit_DB_info.list,{unit:"mm",mult:1}),this.rUtil.drawInherentShapeList(t,this.edit_DB_info.inherentShapeList)}}}]),t}(k),C=function(e){function t(e){m(this,t);var n=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.ERROR_LOCK=!1,n.edit_DB_info=null,n.db_obj=null,n.mouse_close_dist=10,n.colorSet=Object.assign(n.colorSet,{inspection_Pass:"rgba(0,255,0,0.1)",inspection_production_Fail:"rgba(128,128,0,0.3)",inspection_Fail:"rgba(255,0,0,0.1)",inspection_NA:"rgba(64,64,64,0.1)",color_NA:"rgba(128,128,128,0.5)",color_SUCCESS:n.colorSet.measure_info,color_FAILURE_opt:{submargin1:"rgba(255,255,0,0.5)"},color_FAILURE:"rgba(255,0,0,0.5)"}),n.state=void 0,n.EditShape=null,n.CandEditPointInfo=null,n.EditPoint=null,n.EmitEvent=function(e){d.info(e)},n}return v(t,e),i(t,[{key:"SetState",value:function(e){d.debug(e);var t=(0,l.xstate_GetCurrentMainState)(e),n=JSON.stringify(t);JSON.stringify(this.state)!==n&&(this.state=JSON.parse(n))}},{key:"EditDBInfoSync",value:function(e){this.edit_DB_info=e,this.db_obj=e._obj,this.rUtil.setEditor_db_obj(this.db_obj),this.SetImg(e.img);var t=this.db_obj.cameraParam.mmpb2b/this.db_obj.cameraParam.ppb2b;this.rUtil.renderParam.mmpp=t}},{key:"SetShape",value:function(e,t){this.tmp_EditShape_id=t,this.EmitEvent(s.Shape_Set({shape:e,id:t}))}},{key:"inspectionResult",value:function(e){var t=e.judgeReports.reduce((function(e,t){return e==u.INSPECTION_STATUS.NA?e:e==u.INSPECTION_STATUS.FAILURE?t.status==u.INSPECTION_STATUS.NA?u.INSPECTION_STATUS.NA:e:t.status}),u.INSPECTION_STATUS.SUCCESS);return null==t?u.INSPECTION_STATUS.NA:t}},{key:"draw",value:function(){this.draw_INSP()}},{key:"draw_INSP",value:function(){var e=this;if(!this.ERROR_LOCK&&null!=this.edit_DB_info&&null!=this.edit_DB_info.inspReport&&null!=this.edit_DB_info.inspReport){var t,n=this.edit_DB_info.reportStatisticState.trackingWindow.filter((function(e){return e.isCurObj}));t={unit:"mm",mult:1};var a=this.canvas.getContext("2d");this.secCanvas.getContext("2d");a.lineWidth=this.rUtil.getIndicationLineSize(),a.resetTransform(),a.clearRect(0,0,this.canvas.width,this.canvas.height);var i=this.worldTransform();a.setTransform(i.a,i.b,i.c,i.d,i.e,i.f);var o=this.rUtil.get_mmpp(),s=1;void 0!==this.img_info&&void 0!==this.img_info.scale&&(s=this.img_info.scale);var l=s*o;a.save(),a.scale(l,l),void 0!==this.img_info&&void 0!==this.img_info.offsetX&&void 0!==this.img_info.offsetY&&a.translate((this.img_info.offsetX-.5)/s,(this.img_info.offsetY-.5)/s),a.translate(-1*l,-1*l),a.drawImage(this.secCanvas,0,0),a.restore();void 0!==this.edit_DB_info.list&&this.edit_DB_info.list.reduce((function(e,t){return t.type==r.SHAPE_TYPE.measure&&e.push(t),e}),[]),n.forEach((function(t,n){switch(a.save(),a.translate(t.cx,t.cy),a.rotate(-t.rotate),t.isFlipped&&a.scale(1,-1),a.scale(1,1),e.rUtil.drawSignature(a,e.edit_DB_info.inherentShapeList[0].signature,5),e.inspectionResult(t)){case u.INSPECTION_STATUS.NA:a.fillStyle=e.colorSet.inspection_NA;break;case u.INSPECTION_STATUS.SUCCESS:a.fillStyle=e.colorSet.inspection_Pass;Number.MAX_VALUE;e.edit_DB_info.list.forEach((function(e){if(e.type===r.SHAPE_TYPE.measure){var n=e.id,i=t.judgeReports.find((function(e){return e.id===n}));if(void 0===i)return;a.fillStyle=b[i.detailStatus].COLOR}}));break;case u.INSPECTION_STATUS.FAILURE:a.fillStyle=e.colorSet.inspection_Fail}a.fill(),a.restore(),a.strokeStyle="black"})),n.forEach((function(n,i){var o=(0,p.default)(e.edit_DB_info.list);e.db_obj.ShapeListAdjustsWithInspectionResult(o,n),o.forEach((function(t){switch(t.inspection_status){case u.INSPECTION_STATUS.NA:t.color=e.colorSet.color_NA;break;case u.INSPECTION_STATUS.SUCCESS:if(t.color=e.colorSet.color_SUCCESS,t.type===r.SHAPE_TYPE.measure){var a=t.id,i=n.judgeReports.find((function(e){return e.id===a}));if(void 0===i)break;t.color=b[i.detailStatus].COLOR}break;case u.INSPECTION_STATUS.FAILURE:t.color=e.colorSet.color_FAILURE}})),e.rUtil.drawInspectionShapeList(a,o,null,[],o,t,!1)}))}}},{key:"ctrlLogic",value:function(){if(null===this.edit_DB_info.inherentShapeList||void 0===this.edit_DB_info.inherentShapeList||0==this.edit_DB_info.inherentShapeList.length)return this.ERROR_LOCK=!0,void this.EmitEvent({type:"ERROR",data:"Define Config is not valid or the corrupted..."});var e=this.worldTransform(),t=(new DOMMatrix).setMatrixValue(e).invertSelf(),n=this.mouseStatus,a=this.VecX2DMat(n,t),i={x:this.mouseStatus.px,y:this.mouseStatus.py};this.VecX2DMat(i,t),this.mouseStatus.status,this.mouseStatus.pstatus;this.EmitEvent((0,r.EV_UI_Canvas_Mouse_Location)(a))}}]),t}(k),I=function(e){function t(e){m(this,t);var n=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.edit_DB_info=null,n.db_obj=null,n.mouse_close_dist=10,n.state=void 0,n.EditShape=null,n.CandEditPointInfo=null,n.EditPoint=null,n.EmitEvent=function(e){d.debug(e)},n}return v(t,e),i(t,[{key:"SetState",value:function(e){d.debug(e);var t=(0,l.xstate_GetCurrentMainState)(e),n=JSON.stringify(t);JSON.stringify(this.state)!==n&&(this.state=JSON.parse(n),this.state.state==r.UI_SM_STATES.DEFCONF_MODE&&this.state.substate==r.UI_SM_STATES.DEFCONF_MODE_NEUTRAL&&(this.EmitEvent(s.Edit_Tar_Update(null)),this.EditShape=null,this.EditPoint=null))}},{key:"EditDBInfoSync",value:function(e){this.edit_DB_info=e,this.db_obj=e._obj,this.rUtil.setEditor_db_obj(this.db_obj),this.SetImg(e.img),this.SetEditShape(e.edit_tar_info);var t=this.db_obj.getsig360info_mmpp();this.rUtil.renderParam.mmpp=t}},{key:"SetShape",value:function(e,t){this.tmp_EditShape_id=t,this.EmitEvent(s.Shape_Set({shape:e,id:t}))}},{key:"SetEditShape",value:function(e){this.EditShape=e,d.debug(this.tmp_EditShape_id),null!=this.EditShape&&null!=this.EditShape.id&&this.tmp_EditShape_id!=this.EditShape.id&&(null!=this.tmp_EditShape_id&&this.fitCameraToShape(this.EditShape),this.tmp_EditShape_id=this.EditShape.id)}},{key:"AvailableShapeFilter",value:function(e){var t=void 0,n=void 0;switch(this.state.substate){case r.UI_SM_STATES.DEFCONF_MODE_LINE_CREATE:t=r.SHAPE_TYPE.line;break;case r.UI_SM_STATES.DEFCONF_MODE_ARC_CREATE:t=r.SHAPE_TYPE.arc;break;case r.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:t=r.SHAPE_TYPE.aux_point;break;case r.UI_SM_STATES.DEFCONF_MODE_AUX_LINE_CREATE:t=r.SHAPE_TYPE.aux_line;break;case r.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:t=r.SHAPE_TYPE.search_point;break;case r.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:t=r.SHAPE_TYPE.measure,void 0!==this.EditShape&&null!==this.EditShape&&(n=this.EditShape.subtype);break;case r.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:var a=this.edit_DB_info.edit_tar_ele_trace,i=this.edit_DB_info.edit_tar_info;void 0!==i&&null!==a&&(n=i.subtype,t=i.type)}switch(t){case r.SHAPE_TYPE.line:case r.SHAPE_TYPE.arc:return[];case r.SHAPE_TYPE.aux_point:return e.filter((function(e){return e.type===r.SHAPE_TYPE.line||e.type===r.SHAPE_TYPE.search_point}));case r.SHAPE_TYPE.aux_line:return e.filter((function(e){return e.type===r.SHAPE_TYPE.arc||e.type===r.SHAPE_TYPE.search_point}));case r.SHAPE_TYPE.search_point:return e.filter((function(e){return e.type===r.SHAPE_TYPE.line}));case r.SHAPE_TYPE.measure:switch(n){case r.SHAPE_TYPE.measure_subtype.distance:return e.filter((function(e){return e.type!==r.SHAPE_TYPE.measure}));case r.SHAPE_TYPE.measure_subtype.angle:return e.filter((function(e){return e.type===r.SHAPE_TYPE.line}));case r.SHAPE_TYPE.measure_subtype.radius:return e.filter((function(e){return e.type===r.SHAPE_TYPE.arc}))}}return e}},{key:"fitCameraToShape",value:function(e){if(null!=e&&void 0!==e){var t={x:0,y:0};switch(e.type){case r.SHAPE_TYPE.line:t.x=(e.pt1.x+e.pt2.x)/2,t.y=(e.pt1.y+e.pt2.y)/2;break;case r.SHAPE_TYPE.arc:var n=(0,c.threePointToArc)(e.pt1,e.pt2,e.pt3);n.r>500?(t.x=(e.pt1.x+e.pt3.x)/2,t.y=(e.pt1.y+e.pt3.y)/2):(t.x=n.x,t.y=n.y);break;case r.SHAPE_TYPE.aux_point:var a=this.db_obj.auxPointParse(e);if(null==a)return;t=a;break;case r.SHAPE_TYPE.search_point:t=e.pt1;break;default:return}this.camera.SetOffset({x:-t.x,y:-t.y})}}},{key:"draw",value:function(){this.draw_DEFCONF()}},{key:"ctrlLogic",value:function(){this.ctrlLogic_DEFCONF()}},{key:"setMatrix",value:function(e,t){e.setTransform(t.a,t.b,t.c,t.d,t.e,t.f)}},{key:"draw_DEFCONF",value:function(){var e=this.rUtil.get_mmpp(),t=this.canvas.getContext("2d");this.secCanvas.getContext("2d");t.lineWidth=this.rUtil.getIndicationLineSize(),this.setMatrix(t,this.identityMat),t.clearRect(0,0,this.canvas.width,this.canvas.height);var n=this.worldTransform();this.setMatrix(t,n);var a=this.db_obj.getsig360infoCenter();t.save(),t.translate(-a.x,-a.y);var i=1;void 0!==this.img_info&&void 0!==this.img_info.scale&&(i=this.img_info.scale),t.scale(i*e,i*e),void 0!==this.img_info&&void 0!==this.img_info.offsetX&&void 0!==this.img_info.offsetY&&t.translate(this.img_info.offsetX/i,this.img_info.offsetY/i),t.drawImage(this.secCanvas,0,0),t.restore();var r={unit:"mm",mult:1};this.Mouse2SecCanvas=n.invertSelf();var o=this.Mouse2SecCanvas,s=this.mouseStatus;this.VecX2DMat(s,o);t.closePath(),t.save();var l=this.AvailableShapeFilter(this.edit_DB_info.list),c=!1,u=[];if(null!=this.EditShape&&(c=!0,u.push(this.EditShape.id),t.strokeStyle=this.colorSet.editShape,this.rUtil.drawShapeList(t,[this.EditShape],this.colorSet.editShape,[],this.edit_DB_info.list,r,!0)),null!=this.CandEditPointInfo){c=!0;var d=this.CandEditPointInfo;if(void 0===u.find(function(e){return d.shape.id==e}.bind(this))){u.push(d.shape.id);var p="rgba(255,0,255,0.5)";t.strokeStyle=p,this.rUtil.drawShapeList(t,[d.shape],p,[],this.edit_DB_info.list,r,!0)}}l!=this.edit_DB_info.list?this.rUtil.drawShapeList(t,l,null,u,l,r):c||this.rUtil.drawShapeList(t,this.edit_DB_info.list,null,u,this.edit_DB_info.list,r),this.rUtil.drawInherentShapeList(t,this.edit_DB_info.inherentShapeList),null!=this.EditPoint&&(t.strokeStyle="green",this.rUtil.drawpoint(t,this.EditPoint,2*this.rUtil.getPointSize())),null!=this.CandEditPointInfo&&(t.strokeStyle="rgba(0,255,0,0.3)",this.rUtil.drawpoint(t,this.CandEditPointInfo.pt,2*this.rUtil.getPointSize()))}},{key:"ctrlLogic_DEFCONF",value:function(){this.rUtil.get_mmpp();var e=this.worldTransform(),t=(new DOMMatrix).setMatrixValue(e).invertSelf(),n=this.mouseStatus,a=this.VecX2DMat(n,t),i={x:this.mouseStatus.px,y:this.mouseStatus.py},o=this.VecX2DMat(i,t),l=this.mouseStatus.status!=this.mouseStatus.pstatus;switch(this.state.substate){case r.UI_SM_STATES.DEFCONF_MODE_LINE_CREATE:1==this.mouseStatus.status?this.EditShape={type:r.SHAPE_TYPE.line,pt1:a,pt2:o,margin:.3,color:this.colorSet.unselected,direction:1}:null!=this.EditShape&&l&&(this.SetShape(this.EditShape),this.EmitEvent(s.SUCCESS()));break;case r.UI_SM_STATES.DEFCONF_MODE_ARC_CREATE:if(1==this.mouseStatus.status){var u=(0,c.LineCentralNormal)({pt1:a,pt2:o});this.EditShape={type:r.SHAPE_TYPE.arc,pt1:a,pt2:{x:u.x+u.vx,y:u.y+u.vy},pt3:o,margin:.3,color:this.colorSet.unselected,direction:1}}else null!=this.EditShape&&l&&(this.SetShape(this.EditShape),this.EmitEvent(s.SUCCESS()));break;case r.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:case r.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:case r.UI_SM_STATES.DEFCONF_MODE_AUX_LINE_CREATE:case r.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:if(1==this.mouseStatus.status)l&&null!=this.CandEditPointInfo&&(this.state.substate==r.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE?(this.EditShape={type:r.SHAPE_TYPE.search_point,pt1:{x:0,y:0},angleDeg:90,margin:.15,width:.5,ref:[{id:this.CandEditPointInfo.shape.id,element:this.CandEditPointInfo.shape.type}],color:this.colorSet.unselected},this.SetShape(this.EditShape),this.EmitEvent(s.SUCCESS())):(d.debug(l,this.CandEditPointInfo),this.EmitEvent(s.Edit_Tar_Ele_Cand_Update(this.CandEditPointInfo))));else{var f=this.AvailableShapeFilter(this.edit_DB_info.list),_=this.db_obj.FindClosestCtrlPointInfo(a,f),h=this.AvailableShapeFilter(this.edit_DB_info.inherentShapeList),S=this.db_obj.FindClosestInherentPointInfo(a,h);_.dist>S.dist&&(_=S),null!=_.pt&&_.dist<this.mouse_close_dist/this.camera.GetCameraScale()?this.CandEditPointInfo=_:this.CandEditPointInfo=null}break;case r.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(1==this.mouseStatus.status)if(l){var v=this.edit_DB_info.edit_tar_ele_trace;if(null==v||void 0===v){if(null!=this.CandEditPointInfo){var m=this.CandEditPointInfo;this.CandEditPointInfo=null,this.EditShape=(0,p.default)(m.shape),this.EditPoint=this.EditShape[m.key],this.tmp_EditShape_id=this.EditShape.id}else this.EditPoint=null,this.EditShape=null;this.EmitEvent(s.Edit_Tar_Update(this.EditShape))}else null!=this.CandEditPointInfo?this.EmitEvent(s.Edit_Tar_Ele_Cand_Update(this.CandEditPointInfo)):this.EmitEvent(s.Edit_Tar_Ele_Trace_Update(null))}else null!=this.EditPoint&&(this.EditPoint.x=a.x,this.EditPoint.y=a.y,this.EmitEvent(s.Edit_Tar_Update(this.EditShape)));else{null!=this.EditShape&&l&&this.SetShape(this.EditShape,this.EditShape.id);var E=this.AvailableShapeFilter(this.edit_DB_info.list),b=this.db_obj.FindClosestCtrlPointInfo(a,E),y=this.AvailableShapeFilter(this.edit_DB_info.inherentShapeList),g=this.db_obj.FindClosestInherentPointInfo(a,y);b.dist>g.dist&&(b=g),null!=b.pt&&b.dist<this.mouse_close_dist/this.camera.GetCameraScale()?this.CandEditPointInfo=b:this.CandEditPointInfo=null}}this.mouseStatus.pstatus=this.mouseStatus.status}}]),t}(k);t.default={Preview_CanvasComponent:T,INSP_CanvasComponent:C,DEFCONF_CanvasComponent:I}},279:function(e,t,n){"use strict";var a,i,r,o,s,l,c,u,d,p,f,_,h,S;Object.defineProperty(t,"__esModule",{value:!0}),t.ReduxStoreSetUp=function(e){var t=(0,v.combineReducers)({UIData:m.default,InspData:b.default,Peripheral:(0,v.combineReducers)({uInsp:E.default})}),n=(0,v.applyMiddleware)(T.default,new k.MWWebSocket({}),new g.ECStateMachine({ev_state_update:"ev_state_update",state_config:U}),new y.ActionThrottle({time:100,posEdge:!0}));return(0,v.createStore)(t,e,n)};var v=n(226),m=A(n(704)),E=A(n(793)),b=A(n(794)),y=n(795),g=n(796),k=n(316),T=A(n(797)),C=n(28),I=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(55));function A(e){return e&&e.__esModule?e:{default:e}}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=C.UI_SM_STATES,N=C.UI_SM_EVENT,P={initial:O.DEFCONF_MODE_NEUTRAL,states:(d={},D(d,O.DEFCONF_MODE_NEUTRAL,{on:(a={},D(a,N.Line_Create,O.DEFCONF_MODE_LINE_CREATE),D(a,N.Arc_Create,O.DEFCONF_MODE_ARC_CREATE),D(a,N.Search_Point_Create,O.DEFCONF_MODE_SEARCH_POINT_CREATE),D(a,N.Aux_Point_Create,O.DEFCONF_MODE_AUX_POINT_CREATE),D(a,N.Aux_Line_Create,O.DEFCONF_MODE_AUX_LINE_CREATE),D(a,N.Shape_Edit,O.DEFCONF_MODE_SHAPE_EDIT),D(a,N.Measure_Create,O.DEFCONF_MODE_MEASURE_CREATE),a)}),D(d,O.DEFCONF_MODE_SEARCH_POINT_CREATE,{on:(i={},D(i,I.EVENT.SUCCESS,O.DEFCONF_MODE_SHAPE_EDIT),D(i,I.EVENT.FAIL,O.DEFCONF_MODE_NEUTRAL),i)}),D(d,O.DEFCONF_MODE_AUX_POINT_CREATE,{on:(r={},D(r,I.EVENT.SUCCESS,O.DEFCONF_MODE_SHAPE_EDIT),D(r,I.EVENT.FAIL,O.DEFCONF_MODE_NEUTRAL),r)}),D(d,O.DEFCONF_MODE_AUX_LINE_CREATE,{on:(o={},D(o,I.EVENT.SUCCESS,O.DEFCONF_MODE_SHAPE_EDIT),D(o,I.EVENT.FAIL,O.DEFCONF_MODE_NEUTRAL),o)}),D(d,O.DEFCONF_MODE_LINE_CREATE,{on:(s={},D(s,I.EVENT.SUCCESS,O.DEFCONF_MODE_SHAPE_EDIT),D(s,I.EVENT.FAIL,O.DEFCONF_MODE_NEUTRAL),s)}),D(d,O.DEFCONF_MODE_ARC_CREATE,{on:(l={},D(l,I.EVENT.SUCCESS,O.DEFCONF_MODE_SHAPE_EDIT),D(l,I.EVENT.FAIL,O.DEFCONF_MODE_NEUTRAL),l)}),D(d,O.DEFCONF_MODE_SHAPE_EDIT,{on:(c={},D(c,I.EVENT.SUCCESS,O.DEFCONF_MODE_NEUTRAL),D(c,I.EVENT.FAIL,O.DEFCONF_MODE_NEUTRAL),c)}),D(d,O.DEFCONF_MODE_MEASURE_CREATE,{on:(u={},D(u,I.EVENT.SUCCESS,O.DEFCONF_MODE_SHAPE_EDIT),D(u,I.EVENT.FAIL,O.DEFCONF_MODE_NEUTRAL),u)}),d)},w={initial:O.INSP_MODE_NEUTRAL,states:D({},O.INSP_MODE_NEUTRAL,{on:{}})},x={initial:O.ANALYSIS_MODE_NEUTRAL,states:D({},O.ANALYSIS_MODE_NEUTRAL,{on:{}})},U={initial:O.SPLASH,states:(S={},D(S,O.SPLASH,{on:D({},N.Connected,O.MAIN)}),D(S,O.MAIN,{on:(p={},D(p,N.Edit_Mode,O.DEFCONF_MODE),D(p,N.Insp_Mode,O.INSP_MODE),D(p,N.Analysis_Mode,O.ANALYSIS_MODE),D(p,N.Disonnected,O.SPLASH),D(p,N.EXIT,O.SPLASH),p)}),D(S,O.DEFCONF_MODE,Object.assign({on:(f={},D(f,N.Disonnected,O.SPLASH),D(f,N.EXIT,O.MAIN),f)},P)),D(S,O.INSP_MODE,Object.assign({on:(_={},D(_,N.Disonnected,O.SPLASH),D(_,N.ERROR,O.MAIN),D(_,N.EXIT,O.MAIN),_)},w)),D(S,O.ANALYSIS_MODE,Object.assign({on:(h={},D(h,N.Disonnected,O.SPLASH),D(h,N.ERROR,O.MAIN),D(h,N.EXIT,O.MAIN),h)},x)),S)}},28:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.UI_SM_EVENT=t.DEFAULT_UNIT=t.SHAPE_TYPE=t.SAK=t.SHAPE_ATTR_KEY=t.UI_SM_STATES=void 0,t.EV_WS_ChannelUpdate=function(e){return{type:s.WS_channel,data:e}},t.EV_UI_EC_Save_Def_Config=function(e){return{type:s.EC_Save_Def_Config,data:e}},t.EV_UI_EC_Load_Def_Config=function(e){return{type:s.EC_Load_Def_Config,data:e}},t.EV_UI_Version_Map_Update=function(e){return{type:s.Version_Map_Update,data:e}},t.EV_WS_Connected=function(e){return{type:s.Connected,data:e}},t.EV_WS_Disconnected=function(e){return{type:s.Disonnected,data:e}},t.EV_UI_Edit_Mode=function(){return{type:s.Edit_Mode}},t.EV_UI_Insp_Mode=function(){return{type:s.Insp_Mode}},t.EV_UI_Analysis_Mode=function(){return{type:s.Analysis_Mode}},t.EV_UI_ACT=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:e,data:t,misc:n}},t.Def_Model_Path_Update=function(e){return{type:s.Def_Model_Path_Update,data:e}},t.EV_UI_Canvas_Mouse_Location=function(e){return{type:s.Canvas_Mouse_Location,data:e}},t.EV_WS_Inspection_Report=function(e){return{type:s.Inspection_Report,data:e}},t.EV_WS_Image_Update=function(e){return{type:s.Image_Update,data:e}},t.EV_StatSettingParam_Update=function(e){return{type:s.StatSettingParam_Update,data:e}},t.EV_WS_Define_File_Update=function(e){return{type:s.Define_File_Update,data:e}},t.EV_WS_SIG360_Extraction=function(e){return{type:s.SIG360_Extraction,data:e}},t.EV_WS_SIG360_Report_Update=function(e){return{type:s.SIG360_Report_Update,data:e}},t.EV_WS_PD_DATA_Update=function(e){return{type:s.PD_DATA_Update,data:e}},t.EV_WS_uInsp_Machine_Info_Update=function(e){return{type:s.uInsp_Machine_Info_Update,data:e}},t.EV_WS_SEND=function(e,t,n,a,i,r){return{type:"MWWS_SEND",data:{id:e,data:{tl:t,prop:n,data:a,uintArr:i},promiseCBs:r}}};n(43);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.UI_SM_STATES={SPLASH:"SPLASH",MAIN:"MAIN",DEFCONF_MODE:"DEFCONF_MODE",DEFCONF_MODE_NEUTRAL:"DEFCONF_MODE_NEUTRAL",DEFCONF_MODE_LINE_CREATE:"LINE_CREATE",DEFCONF_MODE_AUX_LINE_CREATE:"AUX_LINE_CREATE",DEFCONF_MODE_AUX_POINT_CREATE:"AUX_POINT_CREATE",DEFCONF_MODE_SEARCH_POINT_CREATE:"SEARCH_POINT_CREATE",DEFCONF_MODE_MEASURE_CREATE:"MEASURE_CREATE",DEFCONF_MODE_ARC_CREATE:"ARC_CREATE",DEFCONF_MODE_SHAPE_EDIT:"SHAPE_EDIT",INSP_MODE:"INSP_MODE",INSP_MODE_NEUTRAL:"INSP_MODE_NEUTRAL",ANALYSIS_MODE:"ANALYSIS_MODE",ANALYSIS_MODE_NEUTRAL:"ANALYSIS_MODE_NEUTRAL"};var r=t.SHAPE_ATTR_KEY={id:"id",name:"name",color:"color",type:"type",ref:"ref",element:"element"},o=(t.SAK=r,t.SHAPE_TYPE={sign360:"sign360",point:"point",line:"line",arc:"arc",aux_point:"aux_point",aux_line:"aux_line",search_point:"search_point",measure:"measure",measure_subtype:{NA:"NA",distance:"distance",angle:"angle",radius:"radius"}}),s=(t.DEFAULT_UNIT=(i(a={},o.measure_subtype.sigma,"mm"),i(a,o.measure_subtype.distance,"mm"),i(a,o.measure_subtype.angle,"º"),i(a,o.measure_subtype.radius,"mm"),i(a,o.measure_subtype.calc,""),a),t.UI_SM_EVENT={Connected:"Connected",Disonnected:"Disonnected",_SUCCESS:"_SUCCESS",_FAIL:"_FAIL",EXIT:"EXIT",ERROR:"ERROR",Version_Map_Update:"Version_Map_Update",Def_Model_Path_Update:"Def_Model_Path_Update",WS_channel:"WS_channel",Edit_Mode:"Edit_Mode",Insp_Mode:"Insp_Mode",Analysis_Mode:"Analysis_Mode",Inspection_Report:"Inspection_Report",Image_Update:"Image_Update",StatSettingParam_Update:"StatSettingParam_Update",Define_File_Update:"Define_File_Update",SIG360_Report_Update:"SIG360_Report_Update",SIG360_Extraction:"SIG360_Extraction",PD_DATA_Update:"PD_DATA_Update",uInsp_Machine_Info_Update:"uInsp_Machine_Info_Update",Line_Create:"Line_Create",Arc_Create:"Arc_Create",Aux_Line_Create:"Aux_Line_Create",Search_Point_Create:"Search_Point_Create",Aux_Point_Create:"Aux_Point_Create",Shape_Edit:"Shape_Edit",Measure_Create:"Measure_Create",EC_Save_Def_Config:"EC_Save_Def_Config",EC_Load_Def_Config:"EC_Load_Def_Config",Control_SM_Panel:"Control_SM_Panel",Canvas_Mouse_Location:"Canvas_Mouse_Location"})},280:function(e,t,n){"use strict";function a(e,t){var n=void 0;n=void 0===e.vx?{x:(e.x1+e.x2)/2,y:(e.y1+e.y2)/2,vx:e.x2-e.x1,vy:e.y2-e.y1}:{x:e.cx,y:e.cy,vx:e.vx,vy:e.vy};var a=Math.hypot(n.vx,n.vy);n.vx/=a,n.vy/=a;var i={x:t.x,y:t.y};i.x-=n.x,i.y-=n.y;var r=n.vx*i.x+n.vy*i.y;return n.x+=r*n.vx,n.y+=r*n.vy,n.dist=r,n}function i(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return a=a>=0?1:-1,{x:e.x*n-a*e.y*t,y:e.x*t+a*e.y*n}}Object.defineProperty(t,"__esModule",{value:!0}),t.distance_point_point=function(e,t){return Math.hypot(e.x-t.x,e.y-t.y)},t.distance_arc_point=function(e,t){var n=Math.atan2(t.y-e.y,t.x-e.x),a=n,i=e.angleFrom,r=e.angleTo;n-=i,r-=i,n%=2*Math.PI,r%=2*Math.PI,n<0&&(n+=2*Math.PI);r<0&&(r+=2*Math.PI);if(i=0,n<r)return n=a,{x:e.r*Math.cos(n)+e.x,y:e.r*Math.sin(n)+e.y,dist:Math.abs(Math.hypot(t.x-e.x,t.y-e.y)-e.r)};i=e.angleFrom,r=e.angleTo;var o={x:e.r*Math.cos(r)+e.x,y:e.r*Math.sin(r)+e.y},s={x:e.r*Math.cos(i)+e.x,y:e.r*Math.sin(i)+e.y},l=Math.hypot(t.x-o.x,t.y-o.y),c=Math.hypot(t.x-s.x,t.y-s.y);if(l<c)return o.dist=l,o;return s.dist=c,s},t.closestPointOnLine=a,t.intersectPoint=function(e,t,n,a){var i,r={x:0,y:0},o=e.x-t.x,s=n.x-a.x,l=e.y-t.y,c=n.y-a.y;i=o*c-l*s;var u=e.x*t.y-e.y*t.x,d=n.x*a.y-n.y*a.x;return r.x=(u*s-o*d)/i,r.y=(u*c-l*d)/i,r},t.vecXY_addin=function(e,t){return e.x+=t.x,e.y+=t.y,e},t.vecXY_mulin=function(e,t){return e.x*=t,e.y*=t,e},t.distance_line_point=function(e,t){var n=a(e,t),i=void 0;i=Math.abs(e.x2-e.x1)>Math.abs(e.y2-e.y1)?(n.x-e.x1)/(e.x2-e.x1):(n.y-e.y1)/(e.y2-e.y1);if(i>1){var r=Math.hypot(t.x-e.x2,t.y-e.y2);return{x:e.x2,y:e.y2,dist:r}}if(i>0){var o=Math.hypot(t.x-n.x,t.y-n.y);return n.dist=o,n}var s=Math.hypot(t.x-e.x1,t.y-e.y1);return{x:e.x1,y:e.y1,dist:s}},t.threePointToArc=function(e,t,n){var a=t.x*t.x+t.y*t.y,i=(e.x*e.x+e.y*e.y-a)/2,r=(a-n.x*n.x-n.y*n.y)/2,o=(e.x-t.x)*(t.y-n.y)-(t.x-n.x)*(e.y-t.y),s=(i*(t.y-n.y)-r*(e.y-t.y))/o,l=(r*(e.x-t.x)-i*(t.x-n.x))/o,c=Math.sqrt(Math.pow(t.x-s,2)+Math.pow(t.y-l,2)),u=Math.atan2(e.y-l,e.x-s),d=Math.atan2(t.y-l,t.x-s),p=Math.atan2(n.y-l,n.x-s),f=(u-d+4*Math.PI)%(2*Math.PI);(u-p+4*Math.PI)%(2*Math.PI)>f&&(f=u,u=p,p=f);return{x:s,y:l,r:c,thetaS:u,thetaE:p}},t.LineCentralNormal=function(e){var t=e.pt2.y-e.pt1.y,n=e.pt2.x-e.pt1.x,a=Math.hypot(t,n);return{x:(e.pt1.x+e.pt2.x)/2,y:(e.pt1.y+e.pt2.y)/2,vx:t/a,vy:-n/a}},t.PtRotate2d_sc=i,t.PtRotate2d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=Math.sin(t),r=Math.cos(t);return i(e,a,r,n)}},316:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=t.MWWS_EVENT={ERROR:"MWWS_ERROR",CONNECT:"MWWS_CONNECT",DISCONNECT:"MWWS_DISCONNECT",SEND:"MWWS_SEND"};t.MWWebSocket=function(e){return function(t){return function(n){return function(i){if(null==i.type||!i.type.startsWith("MWWS_"))return n(i);var r=i.data,o=r.id;if(void 0===o&&(o=r.url),void 0===o)return n({type:a.ERROR,data:{str:"no id/url is found",info:r}});switch(i.type){case a.CONNECT:void 0!==e[o]&&t.dispatch({type:a.DISCONNECT,data:e[o]}),e[o]=void 0,r.websocket=new WebSocket(r.url),void 0!==r.binaryType&&(r.websocket.binaryType=r.binaryType),r.websocket.onopen=function(e){this.onopen(e,this)}.bind(r),r.websocket.onmessage=function(e){this.onmessage(e,this)}.bind(r),r.websocket.onclose=function(t){this.onclose(t,this),e[this.id]=void 0}.bind(r),r.websocket.onerror=function(t){this.onerror(t,this),e[this.id]=void 0}.bind(r),e[o]=r;break;case a.SEND:if(void 0===e[o])return n({type:a.MWWS_ERROR});void 0===e[o].send?e[o].websocket.send(r.data):e[o].send(r.data,e[o],r.promiseCBs);break;case a.DISCONNECT:e[o].websocket.close()}return n(i)}}}}},43:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEF_EXTENSION=t.INSPECTION_STATUS=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(28));var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e.data instanceof ArrayBuffer&&e.data.byteLength>=9){var n=new Uint8ClampedArray(e.data,t,9),a={};return a.type=String.fromCharCode(n[0],n[1]),a.prop=n[2],a.pgID=(n[3]<<8)+n[4],a.length=n[5]<<24|n[6]<<16|n[7]<<8|n[8],a}return null},o=new TextEncoder,s=t.INSPECTION_STATUS={NA:-128,SUCCESS:0,FAILURE:-1};t.DEF_EXTENSION="hydef";t.default={raw2header:r,raw2obj_rawdata:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=r(e,t);return null==n?null:(n.rawdata=new Uint8ClampedArray(e.data,t+9,n.length),n)},raw2obj:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=r(e,t);if(null==n)return null;n.rawdata=new Uint8ClampedArray(e.data,t+9,n.length);var a=new TextDecoder("utf-8"),i=a.decode(n.rawdata);try{n.data=JSON.parse(i)}catch(e){n.data=i}return n},raw2Obj_IM:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=r(e,t);if(null==n)return null;var a=11,i=new Uint8ClampedArray(e.data,t+9,a);n.camera_id=i[0],n.session_id=i[1],n.offsetX=i[2]<<8|i[3],n.offsetY=i[4]<<8|i[5],n.width=i[6]<<8|i[7],n.height=i[8]<<8|i[9],n.scale=i[10];n.width,n.height;return n.image=new Uint8ClampedArray(e.data,t+9+a,4*n.width*n.height),n},objbarr2raw:function(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=null==a?"":JSON.stringify(a),s=o.encode(r),l=s.length,c=i instanceof Uint8Array?i.length:0,u=new Uint8Array(9+l+1+c);u[0]=e.charCodeAt(0),u[1]=e.charCodeAt(1),u[2]=t,u[3]=n>>8,u[4]=255&n;var d=u.length-9;return u[5]=d>>24,u[6]=d>>16,u[7]=d>>8,u[8]=d,0!=l&&u.set(s,9),u[9+l]=0,0!=c&&u.set(i,9+l+1),u},INSPECTION_STATUS:s,map_BPG_Packet2Act:function(e){var t=[];switch(e.type){case"HR":case"SS":break;case"IM":var n=e,r=new ImageData(n.image,n.width),o=a({},n,{img:r});delete o.image,t.push(i.EV_WS_Image_Update(o));break;case"IR":case"RP":var s=e;t.push(i.EV_WS_Inspection_Report(s.data));break;case"DF":var l=e;t.push(i.EV_WS_Define_File_Update(l.data));break;case"FL":var c=e;"binary_processing_group"===c.data.type&&t.push(i.EV_WS_Inspection_Report(c.data));break;case"SG":var u=e;t.push(i.EV_WS_SIG360_Report_Update(u.data));break;case"PD":t.push(i.EV_WS_PD_DATA_Update(e.data));break;default:}return t[0]}}},444:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagOptions_rdx=t.essentialTags=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.CustomDisplaySelectUI=function(e){var t=e.onSelect,n=(0,s.useState)(void 0),a=r(n,2),i=(a[0],a[1]),o=(0,s.useState)(void 0),c=r(o,2),u=c[0],p=c[1],f=(0,s.useState)(void 0),S=r(f,2);S[0],S[1];(0,s.useEffect)((function(){return i(void 0),p(void 0),_.CusDisp_DB.read(".").then((function(e){var t=e.prod;i(t);var n=t.map((function(e){return e.cat})).filter((function(e){return void 0!==e})),a=[].concat(v(new Set(n))).sort(),r={};a.forEach((function(e){var n={set:t.filter((function(t){return e.includes(t.cat)}))};r[e]=n})),r[void 0]={set:t.filter((function(e){return void 0===e.cat}))},p(r)})).catch((function(e){console.log(e)})),function(){console.log("1,didUpdate ret::")}}),[]);var E=[];void 0!==u&&(console.log(u),E=l.default.createElement(h.default,{defaultActiveKey:"0"},Object.keys(u).map((function(e,n){return l.default.createElement(m,{tab:e,key:""+n},u[e].set.map((function(e){return l.default.createElement(d.default,{onClick:function(){return t(e)}},e.name)})))}))));return l.default.createElement("div",null,E)};var o=n(84),s=n(1),l=S(s),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(55)),u=S(n(15)),d=(S(n(42)),S(n(38))),p=S(n(79)),f=S(n(139)),_=(S(n(132)),n(207)),h=S(n(808));function S(e){return e&&e.__esModule?e:{default:e}}function v(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var m=h.default.TabPane;var E=t.essentialTags=["01首件熱前","02首件熱後","11沖壓成形","21真空熱處理","31滾電金","31滾電錫","35清洗封孔","36連續鍍"],b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"render",value:function(){var e=this;return console.log(this.props.defFileTag),l.default.createElement("div",{className:this.props.className},l.default.createElement(f.default,{className:"large InspTag fixed",key:"MACH"},this.props.MachTag),this.props.defFileTag.map((function(e){return l.default.createElement(f.default,{className:"large InspTag fixed"},e)})),this.props.inspOptionalTag.map((function(t){return l.default.createElement(f.default,{closable:!0,className:"large InspTag optional",onClose:function(n){n.preventDefault();var a=t,i=e.props.inspOptionalTag.filter((function(e){return e!=a}));e.props.ACT_InspOptionalTag_Update(i)}},t)})),l.default.createElement("br",null),E.map((function(t,n,a){return l.default.createElement(f.default,{className:"large InspTag optional fixed",onClick:function(){var n=e.props.inspOptionalTag.filter((function(e){return-1==a.indexOf(e)}));e.props.ACT_InspOptionalTag_Update([].concat(v(n),[t]))}},t)})),"}",l.default.createElement(p.default,{placeholder:"新標籤",onChange:function(t){var n=t.target.value;e.setState(a({},e.state,{newTagStr:n}))},onPressEnter:function(t){var n=t.target.value.split(","),i=[].concat(v(e.props.inspOptionalTag),v(n));e.props.ACT_InspOptionalTag_Update(i),e.setState(a({},e.state,{newTagStr:""}))},className:"width3 "+(this.props.inspOptionalTag.find((function(t){return t==e.state.newTagStr}))?"error":""),allowClear:!0,value:this.state.newTagStr,prefix:l.default.createElement(u.default,{type:"tags"})}))}}]),t}(l.default.Component);t.TagOptions_rdx=(0,o.connect)((function(e){return{inspOptionalTag:e.UIData.edit_info.inspOptionalTag,defFileTag:e.UIData.edit_info.DefFileTag,MachTag:e.UIData.MachTag}}),(function(e,t){return{ACT_InspOptionalTag_Update:function(t){e(c.InspOptionalTag_Update(t))}}}))(b)},47:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});Object.assign;var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length-1,a=e,i=n+1;if(void 0!==e){for(var r=0;r<i;r++){var o=t[r];if(void 0===(a=a[o]))return}return a}}t.Num2Str_padding=function(e,t){return("0000000000000000"+t).substr(-e)},t.round=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=1/t,a=Math.round(n);0==a&&(a=n);return Math.round(e*a)/a},t.xstate_GetCurrentMainState=function(e){if("string"==typeof e.value)return{state:e.value,substate:null};var t=e.value,n=Object.keys(t)[0];return{state:n,substate:t[n]}},t.xstate_GetMainState=function(e){if("string"==typeof e.value)return e.value;var t=e.value;return Object.keys(t)[0]},t.xstate_GetSubState=function(e){if("string"==typeof e.value)return;var t=e.value,n=Object.keys(t)[0];return t[n]},t.GetObjElement=o,t.isString=function(e){return"string"==typeof e||e instanceof String},t.DictConv=function(e,t,n){var a=void 0===n?void 0:o(t,[n,e]);void 0===a&&(a=o(t,["fallback",e]));return a},t.undefFallback=s,t.dictLookUp=function(e,t,n){if(Array.isArray(e))return s(o(t,e),e[e.length-1]);var a=s(n,"fallback");return s(o(t,[a,e]),e)},t.twoEQXY=l,t.Calibration_MMPP_offset=function(e,t,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=e/r-o,c=n/r-o,u=l(s,1,c,1,t,i),d=a(u,2),p=d[0],f=d[1];return{mmpp:p,offset:f/p}},t.Exp2PostfixExp=d,t.PostfixExpCalc=p;t.websocket_autoReconnect=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;r(this,e),this.url=void 0,this.wsclose=!1,this.reconnectionCounter=0,this.reconnectGap_ms=5e3,this.connectionTimeout_ms=n,this.connectionTimer=null,this.readyState=void 0,this._connect(t)}return i(e,[{key:"onopen",value:function(e){}},{key:"onmessage",value:function(e){}},{key:"onerror",value:function(e){}},{key:"onclose",value:function(e){}},{key:"onreconnection",value:function(e){}},{key:"onconnectiontimeout",value:function(){}},{key:"setWebsocketCallbackUndefined",value:function(e){e.onopen=e.onmessage=e.onerror=e.onclose=void 0}},{key:"_connect",value:function(e){var t=this;if(!this.wsclose){if(console.log("_connect"),this.url=e,void 0!==this.websocket){this.reconnectionCounter++;var n=this.onreconnection(this.reconnectionCounter);if(void 0!==n&&1!=n)return void(this.websocket=void 0)}void 0!==this.connectionTimer&&clearTimeout(this.connectionTimer),this.connectionTimer=void 0,this.websocket=new WebSocket(e),this.OPEN=this.websocket.OPEN,this.CONNECTING=this.websocket.CONNECTING,this.CLOSED=this.websocket.CLOSED,this.CLOSING=this.websocket.CLOSING,this.onNewState(this.CONNECTING),this.connectionTimer=setTimeout((function(){t.close(),t.onconnectiontimeout()}),this.connectionTimeout_ms),this.websocket.onopen=function(e){return t.readyState=t.websocket.readyState,t.onNewState(t.readyState),clearTimeout(t.connectionTimer),t.connectionTimer=void 0,t.onopen(e)},this.websocket.onmessage=function(e){return t.onmessage(e)},this.websocket.onerror=function(e){return t.readyState=t.websocket.readyState,t.onNewState(t.readyState),t.onerror(e)},this.websocket.onclose=function(n){return t.readyState=t.websocket.readyState,t.onNewState(t.readyState),setTimeout((function(){return t._connect(e)}),t.reconnectGap_ms),t.onclose(n)}}}},{key:"reconnect",value:function(){console.log(this.wsclose,this.websocket),this.wsclose=!1,void 0!==this.websocket?this.websocket.readyState!=this.websocket.OPEN?(setWebsocketCallbackUndefined(this.websocket),this.websocket=void 0,this._connect(this.url)):this.websocket.close():this._connect(this.url)}},{key:"onNewState",value:function(e){this.curState!=e&&(this.onStateUpdate(e,this.curState),this.curState=e)}},{key:"onStateUpdate",value:function(e,t){}},{key:"close",value:function(){this.wsclose=!0,void 0!==this.connectionTimer&&clearTimeout(this.connectionTimer),this.connectionTimer=void 0,void 0!==this.websocket&&this.websocket.close()}},{key:"send",value:function(e){return this.websocket.send(e)}}]),e}(),t.websocket_reqTrack=function(){function e(t){var n=this;r(this,e);t.onopen,t.onmessage,t.onerror,t.onclose;this.trackWindow={},t.onopen=function(e){n.trackWindow={},n.readyState=n.websocket.readyState,n.onopen(e)},t.onclose=function(e){n.trackWindow={},n.readyState=n.websocket.readyState,n.onclose(e)},t.onmessage=function(e){n.readyState=n.websocket.readyState;var t=JSON.parse(e.data),a=t.type;if("ACK"==a||"NAK"==a){var i=t.req_id;if(void 0!==i){var r=n.trackWindow[i];void 0!==r?(delete n.trackWindow[i],"ACK"==a?r.resolve(t):r.reject(t)):i=void 0}void 0===i&&n.onTrackError({type:"ACK_TRACK_ERR",data:t})}n.onmessage(e,t)},t.onerror=function(e){n.trackWindow={},n.readyState=n.websocket.readyState,n.onerror(e)},this.websocket=t}return i(e,[{key:"onTrackError",value:function(e){}},{key:"onopen",value:function(e){}},{key:"onmessage",value:function(e){}},{key:"onerror",value:function(e){}},{key:"onclose",value:function(e){}},{key:"close",value:function(){return this.websocket.close()}},{key:"send_obj",value:function(e,t){for(var n=e.req_id;void 0===n||Object.keys(this.trackWindow).reduce((function(e,t){return e||t===n}),!1);)n=Math.floor(16777215*Math.random()).toString(16);e.req_id=n,this.websocket.send(JSON.stringify(e,t));var a={time:Date.now(),resolve:void 0,reject:void 0,data:e,rsp:void 0};return this.trackWindow[n]=a,new Promise((function(e,t){a.resolve=e,a.reject=t}))}}]),e}();function s(e,t){return void 0!==e?e:t}t.copyToClipboard=function(e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)};function l(e,t,n,a,i,r){var o=e*a-t*n;return 0!=o?[(i*a-t*r)/o,(e*r-i*n)/o]:[NaN,NaN]}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",n=e[e.length-1],a=n.match(/\(([^\(\)]+)\)/);if(null!==a&&a.length>0){e[e.length-1]=a[1];var i=n.replace(/\([^\(\)]+\)/,t);e.push(i)}return e}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\\-\\+",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"$",a=void 0,i=void 0;"$"==n&&(n+="$"),a=new RegExp("(.+)["+t+"](.+)"),i=new RegExp(".+(["+t+"]).+");var r=e.match(a);if(null==r)return[e];var o=e.replace(i,n+"$1"+n);return[r[1],r[2],o]}function d(e){for(var t=[e];;){if(t.length==(t=c(t,"$")).length)break}var n={default:function(e,t){if(void 0!==t){var n=e.split("$");e=n.reduce((function(e,n,a){return 0==a?n:e+"("+(a-1>=t.length?"$":t[a-1])+")"+n}),"")}return e}};for(t=t.map((function(e){return e=e.replace(/\$/g,"#"),p([",","\\-\\+","%","\\*\\/","\\^"].reduce((function(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\\-\\+",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"$";return e.map((function(e){if(","==t&&e.includes(",")){if(e.includes(",")){for(var a=e.split(","),i=n,r=1;r<a.length;r++)i+=","+n;return a.push(i),a}return e}for(var o=t,s=u(e,o,n);;){var l=u(s[0],o,n);if(1==l.length)break;s.shift(),s=l.concat(s)}return s})).flat()}(e,t,"$")}),[e]),n)[0].replace(/\#/g,"$")})),t=p(t,n);;){if(t.length==(t=c(t,"$")).length)break}return t}function p(e,t){var n=[];return e.forEach((function(e){var a=void 0;if(void 0!==e.includes&&e.includes("$")){var i=e.split("$").length-1,r=n.splice(n.length-i,9999999);a=void 0!==t[e]?t[e](r.flat()):t.default(e,r.flat())}else a=void 0!==t.default?t.default(e):parseFloat(e);n.push(a)})),n}t.CircularCounter=function(){function e(t){r(this,e),this._total_size=t,this.clear()}return i(e,[{key:"size",value:function(){return this._size}},{key:"clear",value:function(){this._sidx=0,this._eidx=0,this._size=0}},{key:"tsize",value:function(){return this._total_size}},{key:"f",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return(e+=1)>this._size?-1:(e+=this._sidx-e+this._total_size)%this._total_size}},{key:"r",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=this._size?-1:(e=this._eidx+e)%this._total_size}},{key:"enQ",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._size==this._total_size){if(!e)return!1;deQ()}return this._sidx+=1,this._sidx%=this._total_size,this._size++,!0}},{key:"deQ",value:function(){return!(this._size<=0)&&(this._eidx+=1,this._eidx%=this._total_size,this._size--,!0)}}]),e}()},529:function(e,t,n){"use strict";var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=(m(n(530)),m(n(533)),n(84)),r=m(n(1)),o=m(n(8)),s=(v(n(88)),m(n(43))),l=(n(43),n(279)),c=v(n(28)),u=(n(47),n(316)),d=m(n(798)),p=m(n(800)),f=m(n(1049)),_=m(n(89)),h=v(n(37)),S=m(n(445));m(n(38)),m(n(514)),m(n(42));function v(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}h.setLevel("info"),h.getLogger("InspectionEditorLogic").setLevel("INFO"),h.getLogger("UICtrlReducer").setLevel("INFO");var E=Object.assign({},f.default,_.default),b=(0,l.ReduxStoreSetUp)({}),y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.BPG_WS={reqWindow:{},pgIDCounter:0,onopen:function(e,t){b.dispatch(c.EV_WS_Connected(t))},onmessage:function(e,t){if(e.data instanceof ArrayBuffer){var a=s.default.raw2header(e),i=a.pgID,r=void 0,o=!1;switch(a.type){case"HR":var l=s.default.raw2obj(e),c=l.data.webUI_resource;void 0===c&&(c="http://hyv.idcircle.me"),c+="/version.jsonp?rand="+function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e6;return Math.floor(Math.random()*(t-e+1))+e}(),(0,S.default)(c,{name:"hyv_version_map"},(function(e,t){t.core_info=l.data,n.props.ACT_Version_Map_Update(t)})),n.props.ACT_WS_SEND(n.props.WS_ID,"HR",0,{a:["d"]}),setTimeout((function(){n.props.ACT_WS_SEND(n.props.WS_ID,"LD",0,{filename:"data/default_camera_param.json"})}),1e3);break;case"SS":var u=s.default.raw2obj(e);u.data.start&&(o=!0),r=u;break;case"IM":r=s.default.raw2Obj_IM(e);break;case"IR":case"RP":case"DF":case"FL":case"SG":case"PD":default:r=s.default.raw2obj(e)}if("PD"==a.type&&0==i&&(i=-1),-1===i){if(void 0!==r){var d=s.default.map_BPG_Packet2Act(r);void 0!==d&&n.props.DISPATCH(d)}}else{var p=n.BPG_WS.reqWindow[i];if(void 0!==p){if(void 0!==r&&p.pkts.push(r),!o&&"SS"==a.type){var f=n.BPG_WS.reqWindow[i].pkts;if(void 0===p._PGINFO_||!0!==p._PGINFO_.keep?delete n.BPG_WS.reqWindow[i]:n.BPG_WS.reqWindow[i].pkts=[],void 0!==p.promiseCBs)p.promiseCBs.resolve(p.pkts);else{var _={type:"ATBundle",ActionThrottle_type:"express",data:f.map((function(e){return s.default.map_BPG_Packet2Act(e)})).filter((function(e){return void 0!==e})),rawData:p};n.props.DISPATCH(_)}}}else if(o)n.BPG_WS.reqWindow[i]={time:(new Date).getTime(),pkts:[r]};else{var h=s.default.map_BPG_Packet2Act(r);void 0!==h&&n.props.DISPATCH(h)}}}},onclose:function(e,t){n.props.DISPATCH(c.EV_WS_Disconnected(e)),setTimeout((function(){n.props.ACT_WS_CONNECT(n.props.WS_ID,"ws://localhost:4090",n.BPG_WS)}),3e3)},onerror:function(e,t){},send:function(e,t,a){var i=void 0,r=void 0;e.data instanceof Object&&(i=e.data._PGID_,r=e.data._PGINFO_,delete e.data._PGID_,delete e.data._PGINFO_),void 0===i&&(i=n.BPG_WS.pgIDCounter,n.BPG_WS.pgIDCounter++,n.BPG_WS.pgIDCounter>1e4&&(n.BPG_WS.pgIDCounter=0)),e.data instanceof Uint8Array?t.websocket.send(s.default.objbarr2raw(e.tl,e.prop,i,null,e.data)):(n.BPG_WS.reqWindow[i]={time:(new Date).getTime(),pkts:[],promiseCBs:a,_PGINFO_:r},t.websocket.send(s.default.objbarr2raw(e.tl,e.prop,i,e.data,e.uintArr)))}},setTimeout((function(){return n.props.ACT_WS_CONNECT(n.props.WS_ID,"ws://localhost:4090",n.BPG_WS)}),3e3),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,null,[{key:"mapDispatchToProps",value:function(e,t){return{ACT_Ctrl_SM_Panel:function(t){return e({type:c.UI_SM_EVENT.Control_SM_Panel,data:t})},ACT_WS_CONNECT:function(t,n,a){return e({type:u.MWWS_EVENT.CONNECT,data:Object.assign({id:t,url:n,binaryType:"arraybuffer"},a)})},ACT_WS_DISCONNECT:function(t){return e({type:u.MWWS_EVENT.DISCONNECT,data:{id:t}})},DISPATCH:function(t){e(t)},DISPATCH_flush:function(t){t.ActionThrottle_type="flush",e(t)},ACT_WS_SEND:function(t,n,a,i,r){return e(c.EV_WS_SEND(t,n,a,i,r))},ACT_Version_Map_Update:function(t){return e(c.EV_UI_Version_Map_Update(t))}}}},{key:"mapStateToProps",value:function(e){return{showSplash:e.UIData.showSplash,showSM_graph:e.UIData.showSM_graph,stateMachine:e.UIData.sm,WS_CH:e.UIData.WS_CH,WS_ID:e.UIData.WS_ID}}},{key:"connect",value:function(){return(0,i.connect)(t.mapStateToProps,t.mapDispatchToProps)(t)}}]),a(t,[{key:"render",value:function(){h.debug("APPMasterX render",this.props);var e=void 0;return e=null,r.default.createElement("div",{className:"HXF"},e,this.props.showSplash?r.default.createElement("div",{key:"LOGO",className:"s HXF WXF overlay veleXY logoFrame white"},r.default.createElement("div",{className:"veleXY width6 height6"},r.default.createElement("img",{className:"height8 LOGOImg ",src:"resource/image/NotiMon.svg"}),r.default.createElement("div",{className:"HX0_5"}),r.default.createElement("div",{className:"s"},r.default.createElement("div",{className:"TitleTextCon showOverFlow HX4"},r.default.createElement("h1",{className:"Title"},"HY"),r.default.createElement("h1",{className:"Title"},"Vision"))))):r.default.createElement(p.default,{key:"APP"}))}}]),t}(r.default.Component).connect();h.info(E),o.default.render(r.default.createElement(i.Provider,{store:b},r.default.createElement(d.default,{locale:E},r.default.createElement(y,null))),document.getElementById("container"))},530:function(e,t,n){var a=n(531);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(153)(a,i);a.locals&&(e.exports=a.locals)},531:function(e,t,n){(e.exports=n(152)(!1)).push([e.i,"html, body {\r\n\theight: 100%;\r\n\twidth: 100%;\r\n\tmargin: 0;\r\n  padding: 0;\r\n\tbackground: none;\r\n}\r\n\r\n* {\r\n\tmargin: 0;\r\n\tpadding: 0;\r\n  box-sizing: border-box;\r\n}\r\n.body {\r\n\toverflow: scroll;\r\n\tposition: absolute;\r\n\t-webkit-overflow-scrolling: touch;\r\n}\r\n\r\n\r\n.vbox:before {/*invisible trick*/\r\n\tcontent: '';\r\n\tdisplay: inline-block;\r\n\tvertical-align: middle;\r\n\twidth: 0;\r\n\theight: 100%;\r\n}\r\n.vbox > * {\r\n\tvertical-align: middle;\r\n\tdisplay: inline-block;\r\n}\r\n\r\n.vboxImg > * {\r\n\tvertical-align: middle;\r\n\tdisplay: inline-block;\r\n}\r\n\r\n\r\n.veleY {\r\n\tposition: relative;\r\n\ttop: 50%;\r\n\ttransform: translateY(-50%);\r\n}\r\n\r\n\r\n.veleX {\r\n\tposition: relative;\r\n\tleft: 50%;\r\n\ttransform: translateX(-50%);\r\n}\r\n\r\n.veleXY {\r\n\tposition: relative;\r\n\ttop: 50%;\r\n\tleft: 50%;\r\n\ttransform: translate(-50%,-50%);\r\n}\r\n\r\n.vbox:before {/*invisible trick*/\r\n\tcontent: '';\r\n\tdisplay: inline-block;\r\n\tvertical-align: middle;\r\n\twidth: 0px;\r\n\theight: 100%;\r\n\tbackground: red;\r\n}\r\n.vbox  * {\r\n\tvertical-align: middle;\r\n\tdisplay: inline-block;\r\n}\r\n.cardblock{\r\n\tmargin:10px;\r\n\tbox-shadow:0 0px 10px #000;\r\n}\r\n\r\n.border{\r\n\tborder: 7px solid #FFF;\r\n}\r\n\r\n\r\n\r\n.blockS{\r\n}\r\n\r\n\r\n.blockS .layout {\r\n\tfloat: left;\r\n\tborder-style: none;\r\n\tbox-sizing: border-box;\r\n}\r\n.blockS .layoutRight {\r\n\tfloat: right;\r\n\tborder-style: none;\r\n\tbox-sizing: border-box;\r\n}\r\n.blockS .s {\r\n\tfloat: left;\r\n\tborder-style: none;\r\n\ttransition: background ease-in 0.2s, color ease-in 0.2s;\r\n\twidth: 100%;\r\n\theight: 50px;\r\n\tfont-family: 'Open Sans', sans-serif;\r\n\ttext-align: center;\r\n\tfont-size: 0.4cm;\r\n\tfont-weight:bold;\r\n\tbox-sizing: border-box;\r\n\tcolor:#FFF;\r\n  overflow:hidden;\r\n  \r\n\r\n  -webkit-user-select: none; /* webkit (safari, chrome) browsers */\r\n  -moz-user-select: none; /* mozilla browsers */\r\n  -khtml-user-select: none; /* webkit (konqueror) browsers */\r\n  -ms-user-select: none; /* IE10+ */\r\n}\r\n\r\n\r\n.blockS .scroll {\r\n\toverflow: auto;\r\n\t-webkit-overflow-scrolling: touch;\r\n}\r\n\r\n\r\n.blockS .textAlignLeft {\r\n  text-align: left;\r\n}\r\n\r\n\r\n\r\n.blockS .floatRight {\r\n  float: right;\r\n}\r\n\r\n\r\n.smallFontSize{\r\n\tfont-size: 0.3cm;\r\n}\r\n\r\n.blockS .noAnim {\r\n\ttransition: none;\r\n}\r\n\r\n\r\n.blockS .showOverFlow,.blockS .dropDown{\r\n  overflow: visible;\r\n}\r\n.blockS .dropdownBox,.blockS .dropDownContent{\r\n  position: relative;\r\n}\r\n\r\n.blockS .HCenter{\r\nmargin:auto; float: none;\r\n}\r\n\r\n\r\n.blockS .overlayCon {\r\n\tposition: relative;\r\n\toverflow:hidden;\r\n}\r\n.blockS .overlay {\r\n\tposition: absolute;\r\n\tbackground: none;\r\n}\r\n.blockS .overlaybtm {\r\n\r\n\tposition: absolute;\r\n\tbackground: none;\r\n\tbottom:0;\r\n}\r\n\r\n.blockS .overlayright {\r\n\r\n\tposition: absolute;\r\n\tbackground: none;\r\n\tright:0;\r\n}\r\n\r\n.blockS .HXA {\r\n\r\n  height: auto;\r\n  max-height: 100%;\r\n}\r\n.blockS .WXA {\r\n\r\n  width: auto;\r\n}\r\n.blockS .HX0 {\r\n\r\n\theight: 0px;\r\n}\r\n.blockS .HX0_1 {\r\n\r\n\theight: 5px;\r\n}\r\n.blockS .HX0_5 {\r\n\r\n\theight: 25px;\r\n}\r\n.blockS .HX1_5 {\r\n\r\n\theight: 75px;\r\n}\r\n.blockS .HX1 {\r\n\theight: 50px;\r\n}\r\n.blockS .HX2 {\r\n\r\n\theight: 100px;\r\n}\r\n.blockS .HX3 {\r\n\r\n\theight: 150px;\r\n}\r\n\r\n.blockS .HX4 {\r\n\r\n\theight:200px;\r\n}\r\n.blockS .HX5 {\r\n\r\n\theight:250px;\r\n}\r\n.blockS .HX6 {\r\n\r\n\theight:300px;\r\n}\r\n.blockS .HX7 {\r\n\r\n\theight:350px;\r\n}\r\n.blockS .HXF{\r\n\r\n\theight:100%;\r\n}\r\n.cl {\r\n\r\n\theight: 10px;\r\n}\r\n.blockS .input{\r\n\tbox-shadow: inset 0 -5px 0 black, inset 2px 0px 0 black;\r\n\r\n\tpadding-left: 5px;\r\n\ttext-align: left;\r\n\tbackground: #FAFAFA;\r\n\tcolor:#333;\r\n\tborder-radius: 0px;\r\n\tappearance: none;\r\n}\r\n\r\n.blockS .padding\r\n{\r\n    padding:0.3em;\r\n}\r\n\r\n.textarea {\r\n\toverflow: auto;\r\n\tborder: solid 5px #222;\r\n\tbackground: #FFF;\r\n\ttext-align: left;\r\n\tcolor:#333;\r\n}\r\n\r\n.blockS .width0 {\r\n\twidth: 0%;\r\n}\r\n.blockS .width1 {\r\n\twidth: 8.333%;\r\n}\r\n.blockS .width2 {\r\n\twidth: 16.666%;\r\n}\r\n.blockS .width3 {\r\n\twidth: 25%;\r\n}\r\n.blockS .width4 {\r\n\twidth: 33.333%;\r\n}\r\n.blockS .width5 {\r\n\twidth: 41.666%;\r\n}\r\n.blockS .width6 {\r\n\twidth: 50%;\r\n}\r\n.blockS .width7 {\r\n\twidth: 58.333%;\r\n}\r\n.blockS .width8 {\r\n\twidth: 66.666%;\r\n}\r\n.blockS .width9 {\r\n\twidth: 75%;\r\n}\r\n.blockS .width10 {\r\n\twidth: 83.333%;\r\n}\r\n.blockS .width11 {\r\n\twidth: 91.6666%;\r\n}\r\n\r\n.blockS .width005 {\r\n\twidth: 4.1666%;\r\n}\r\n.blockS .width12 {\r\n\twidth: 100%;\r\n}\r\n.blockS .WXF {\r\n\twidth: 100%;\r\n}\r\n\r\n.blockS .widthR{\r\n\r\n\twidth: unset;\r\n\tfloat:unset;\r\n}\r\n.blockS .height0 {\r\n\theight: 0%;\r\n\tdisplay: none;\r\n}\r\n.blockS .height1 {\r\n\theight: 8.333%;\r\n}\r\n.blockS .height2 {\r\n\theight: 16.666%;\r\n}\r\n.blockS .height3 {\r\n\theight: 25%;\r\n}\r\n.blockS .height4 {\r\n\theight: 33.333%;\r\n}\r\n.blockS .height5 {\r\n\theight: 41.666%;\r\n}\r\n.blockS .height6 {\r\n\theight: 50%;\r\n}\r\n.blockS .height7 {\r\n\theight: 58.333%;\r\n}\r\n.blockS .height8 {\r\n\theight: 66.666%;\r\n}\r\n.blockS .height9 {\r\n\theight: 75%;\r\n}\r\n.blockS .height10 {\r\n\theight: 83.333%;\r\n}\r\n.blockS .height11 {\r\n\theight: 91.6666%;\r\n}\r\n\r\n.blockS .height115 {\r\n\theight: 95.8333%;\r\n}\r\n.blockS .height005 {\r\n\theight: 4.1666%;\r\n}\r\n.blockS .height12 {\r\n\theight: 100%;\r\n}\r\n\r\n\r\n@media screen and (max-width: 800px) {\r\n\t.blockS .widthF800 {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.blockS .widthN800 {\r\n\t\tdisplay: none;\r\n\t}\r\n}\r\n\r\n@media screen and (max-width: 500px) {\r\n\t.blockS .widthF500 {\r\n\t\twidth: 100%;\r\n\t}\r\n\t.blockS .widthN500 {\r\n\t\tdisplay: none;\r\n\t}\r\n}\r\n.blockS .button {\r\n    outline:none;\r\n\tborder-bottom : 5px solid #111;\r\n\tborder-right : 3px solid #111;\r\n\r\n\tbackground: #333;\r\n}\r\n\r\n\r\n\r\n.blockS .button:active {\r\n\tborder-top: 5px solid #111;\r\n\tborder-bottom : 0;\r\n\tborder-right :0;\r\n\r\n\tbackground: #333;\r\n\tcolor:#eee;\r\n}\r\n\r\n\r\n.blockS *:disabled {\r\n\tbackground: #888;\r\n}\r\n\r\n.blockS .lgray {\r\n\r\n\tbackground: #999;\r\n}\r\n.blockS .lred {\r\n\r\n\tbackground: #ECC;\r\n}\r\n.blockS .lgreen {\r\n\r\n\tbackground: #CEC;\r\n}\r\n.blockS .lblue{\r\n\r\n\tbackground: #CCE;\r\n}\r\n.blockS .deepred {\r\n\r\n\tbackground: #F00;\r\n}\r\n\r\n.blockS .deepgreen{\r\n\r\n\tbackground: #0F0;\r\n}\r\n.blockS .red {\r\n\r\n\tbackground: #422;\r\n}\r\n\r\n.blockS .green {\r\n\tbackground: #242;\r\n}\r\n\r\n.blockS .blue {\r\n\r\n\tbackground: #224;\r\n}\r\n\r\n.blockS .black {\r\n\r\n  background: #000;\r\n}\r\n.blockS .white {\r\n  background: #FFF;\r\n}\r\n.blockS .blackText {\r\n\tcolor: #444;\r\n}\r\n.blockS .nocolor {\r\n\r\n\tbackground: none;\r\n}\r\n",""])},533:function(e,t,n){var a=n(534);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(153)(a,i);a.locals&&(e.exports=a.locals)},534:function(e,t,n){var a=n(535);(e.exports=n(152)(!1)).push([e.i,"\r\n.blockS .deepblue{\r\n\r\n  background: #0081ee;\r\n}\r\n.BK_Blink {\r\n  -webkit-animation: NAME-YOUR-ANIMATION 1s infinite;  /* Safari 4+ */\r\n  -moz-animation: NAME-YOUR-ANIMATION 1s infinite;  /* Fx 5+ */\r\n  -o-animation: NAME-YOUR-ANIMATION 1s infinite;  /* Opera 12+ */\r\n  animation: NAME-YOUR-ANIMATION 1s infinite;  /* IE 10+, Fx 29+ */\r\n}\r\n\r\n@-webkit-keyframes NAME-YOUR-ANIMATION {\r\n  0%, 49% {\r\n    background-color: #400000;\r\n  }\r\n  49%, 50% {\r\n      background-color: #e50000;\r\n  }\r\n  50%, 99% {\r\n    background-color: #a50000;\r\n  }\r\n  99%, 100% {\r\n    background-color: #a50000;\r\n  }\r\n}\r\n\r\n/*Start of ANT COlor*/\r\n.iconButtonSize > svg{ padding-left: 2px; width: 30px;height: 100%;}\r\n.iconTextPadding {padding-left: 5px;}\r\n.blockS .palatte-blue-1{background:#e6f7ff}\r\n.blockS .palatte-blue-2{background:#bae7ff}\r\n.blockS .palatte-blue-3{background:#91d5ff}.blockS .palatte-blue-4{background:#69c0ff}.blockS .palatte-blue-5{background:#40a9ff}.blockS .palatte-blue-6{background:#1890ff}.blockS .palatte-blue-7{background:#096dd9}.blockS .palatte-blue-8{background:#0050b3}.blockS .palatte-blue-9{background:#003a8c}.blockS .palatte-blue-10{background:#002766}.blockS .palatte-purple-1{background:#f9f0ff}.blockS .palatte-purple-2{background:#efdbff}.blockS .palatte-purple-3{background:#d3adf7}.blockS .palatte-purple-4{background:#b37feb}.blockS .palatte-purple-5{background:#9254de}.blockS .palatte-purple-6{background:#722ed1}.blockS .palatte-purple-7{background:#531dab}.blockS .palatte-purple-8{background:#391085}.blockS .palatte-purple-9{background:#22075e}.blockS .palatte-purple-10{background:#120338}.blockS .palatte-cyan-1{background:#e6fffb}.blockS .palatte-cyan-2{background:#b5f5ec}.blockS .palatte-cyan-3{background:#87e8de}.blockS .palatte-cyan-4{background:#5cdbd3}.blockS .palatte-cyan-5{background:#36cfc9}.blockS .palatte-cyan-6{background:#13c2c2}.blockS .palatte-cyan-7{background:#08979c}.blockS .palatte-cyan-8{background:#006d75}.blockS .palatte-cyan-9{background:#00474f}.blockS .palatte-cyan-10{background:#002329}.blockS .palatte-green-1{background:#f6ffed}.blockS .palatte-green-2{background:#d9f7be}.blockS .palatte-green-3{background:#b7eb8f}.blockS .palatte-green-4{background:#95de64}.blockS .palatte-green-5{background:#73d13d}.blockS .palatte-green-6{background:#52c41a}.blockS .palatte-green-7{background:#389e0d}.blockS .palatte-green-8{background:#237804}.blockS .palatte-green-9{background:#135200}.blockS .palatte-green-10{background:#092b00}.blockS .palatte-magenta-1{background:#fff0f6}.blockS .palatte-magenta-2{background:#ffd6e7}.blockS .palatte-magenta-3{background:#ffadd2}.blockS .palatte-magenta-4{background:#ff85c0}.blockS .palatte-magenta-5{background:#f759ab}.blockS .palatte-magenta-6{background:#eb2f96}.blockS .palatte-magenta-7{background:#c41d7f}.blockS .palatte-magenta-8{background:#9e1068}.blockS .palatte-magenta-9{background:#780650}.blockS .palatte-magenta-10{background:#520339}.blockS .palatte-red-1{background:#fff1f0}.blockS .palatte-red-2{background:#ffccc7}.blockS .palatte-red-3{background:#ffa39e}.blockS .palatte-red-4{background:#ff7875}.blockS .palatte-red-5{background:#ff4d4f}.blockS .palatte-red-6{background:#f5222d}.blockS .palatte-red-7{background:#cf1322}.blockS .palatte-red-8{background:#a8071a}.blockS .palatte-red-9{background:#820014}.blockS .palatte-red-10{background:#5c0011}.blockS .palatte-volcano-1{background:#fff2e8}.blockS .palatte-volcano-2{background:#ffd8bf}.blockS .palatte-volcano-3{background:#ffbb96}.blockS .palatte-volcano-4{background:#ff9c6e}.blockS .palatte-volcano-5{background:#ff7a45}.blockS .palatte-volcano-6{background:#fa541c}.blockS .palatte-volcano-7{background:#d4380d}.blockS .palatte-volcano-8{background:#ad2102}.blockS .palatte-volcano-9{background:#871400}.blockS .palatte-volcano-10{background:#610b00}.blockS .palatte-orange-1{background:#fff7e6}.blockS .palatte-orange-2{background:#ffe7ba}.blockS .palatte-orange-3{background:#ffd591}.blockS .palatte-orange-4{background:#ffc069}.blockS .palatte-orange-5{background:#ffa940}.blockS .palatte-orange-6{background:#fa8c16}.blockS .palatte-orange-7{background:#d46b08}.blockS .palatte-orange-8{background:#ad4e00}.blockS .palatte-orange-9{background:#873800}.blockS .palatte-orange-10{background:#612500}.blockS .palatte-gold-1{background:#fffbe6}.blockS .palatte-gold-2{background:#fff1b8}.blockS .palatte-gold-3{background:#ffe58f}.blockS .palatte-gold-4{background:#ffd666}.blockS .palatte-gold-5{background:#ffc53d}.blockS .palatte-gold-6{background:#faad14}.blockS .palatte-gold-7{background:#d48806}.blockS .palatte-gold-8{background:#ad6800}.blockS .palatte-gold-9{background:#874d00}.blockS .palatte-gold-10{background:#613400}.blockS .palatte-yellow-1{background:#feffe6}.blockS .palatte-yellow-2{background:#ffffb8}.blockS .palatte-yellow-3{background:#fffb8f}.blockS .palatte-yellow-4{background:#fff566}.blockS .palatte-yellow-5{background:#ffec3d}.blockS .palatte-yellow-6{background:#fadb14}.blockS .palatte-yellow-7{background:#d4b106}.blockS .palatte-yellow-8{background:#ad8b00}.blockS .palatte-yellow-9{background:#876800}.blockS .palatte-yellow-10{background:#614700}.blockS .palatte-lime-1{background:#fcffe6}.blockS .palatte-lime-2{background:#f4ffb8}.blockS .palatte-lime-3{background:#eaff8f}.blockS .palatte-lime-4{background:#d3f261}.blockS .palatte-lime-5{background:#bae637}.blockS .palatte-lime-6{background:#a0d911}.blockS .palatte-lime-7{background:#7cb305}.blockS .palatte-lime-8{background:#5b8c00}.blockS .palatte-lime-9{background:#3f6600}.blockS .palatte-lime-10{background:#254000}.blockS .palatte-geekblue-1{background:#f0f5ff}.blockS .palatte-geekblue-2{background:#d6e4ff}.blockS .palatte-geekblue-3{background:#adc6ff}.blockS .palatte-geekblue-4{background:#85a5ff}.blockS .palatte-geekblue-5{background:#597ef7}.blockS .palatte-geekblue-6{background:#2f54eb}.blockS .palatte-geekblue-7{background:#1d39c4}.blockS .palatte-geekblue-8{background:#10239e}.blockS .palatte-geekblue-9{background:#061178}.blockS .palatte-geekblue-10{background:#030852}.blockS .palatte-grey-1{background:#fff}.blockS .palatte-grey-2{background:#fafafa}.blockS .palatte-grey-3{background:#f5f5f5}.blockS .palatte-grey-4{background:#e8e8e8}.blockS .palatte-grey-5{background:#d9d9d9}.blockS .palatte-grey-6{background:#bfbfbf}.blockS .palatte-grey-7{background:#8c8c8c}.blockS .palatte-grey-8{background:#595959}.blockS .palatte-grey-9{background:#262626}.blockS .palatte-grey-10{background:#000}\r\n/*End of ANT COlor*/\r\n\r\nbody.sp_Style.blockS  {\r\n  overflow: hidden;\r\n  padding: 15px;\r\n  background: #EAEBEE;\r\n}\r\n.sp_Style.blockS *.shadow1 {\r\n  box-shadow:5px 10px 13px rgba(10,10,10,0.3);\r\n}\r\n\r\n.sp_Style.blockS .radarScanPanel {\r\n  box-shadow: inset 0px 0px 8px rgba(0,0,0,0.8);\r\n  border-radius: 50%;\r\n}\r\n.sp_Style.blockS .radarScanWave {\r\n  border-radius: 50%;\r\n  border: 5px solid gray;\r\n  animation: scanWave 5s infinite;\r\n}\r\n\r\n@keyframes scanWave{\r\n  0%,40%{\r\n    transform: translate3d(-50%,-50%,0) scale(0.05);\r\n    opacity: 0.4;\r\n  }\r\n  100%{\r\n    transform: translate3d(-50%,-50%,0) scale(0.8);\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\n\r\n\r\n.sp_Style.blockS .SMGraph{\r\n  top: 50%;\r\n  left: 0px;\r\n  opacity: 1;\r\n  transition:opacity 0.5s, transform ease-out 0.3s;\r\n  transform: translate(-0%,-50%);\r\n}\r\n.sp_Style.blockS .SMGraph.hide{\r\n  opacity: 0.1;\r\n  transform: translate(-90%,-50%);\r\n}\r\n\r\n.sp_Style .ant-input-affix-wrapper.error input{\r\n  background-color: #f99;\r\n} \r\n\r\n.sp_Style .ant-tag.large{\r\n  font-size:20px;margin-bottom: 8px;\r\n  padding: 5px;\r\n} \r\n\r\n.sp_Style .ant-tag.xlarge{\r\n  margin: 15px;\r\n  font-size: 30px;\r\n  padding: 10px;\r\n} \r\n\r\n.sp_Style .ant-tag.InspTag.fixed{\r\n  color: #ffffff;\r\n  background:#f50;\r\n  border-color: #f50;\r\n}\r\n\r\n.sp_Style .ant-tag.InspTag.optional{\r\n  color: #ffffff;\r\n  background: #108ee9;\r\n  border-color: #108ee9;\r\n} \r\n\r\n\r\n.sp_Style.blockS .MenuAnim{\r\n  transition:opacity 0.2s, transform 0.3s;\r\n  background-color: rgba(0,0,0,0.1);\r\n  width:200px;\r\n  transition-timing-function: cubic-bezier(.05,.88,.6,.87);\r\n  transform-origin: -20% 50%;\r\n  perspective: 200px;\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-enter{\r\n  transform: rotateY(-10deg);\r\n  opacity: 0;\r\n\r\n  z-index: 2;\r\n\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-enter.fadeIn-enter-active{\r\n  opacity: 1;\r\n  transform: rotateY(00deg);\r\n  z-index: 2;\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-leave{\r\n  opacity: 1;\r\n  z-index: 1;\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-leave.fadeIn-leave-active{\r\n  opacity: 0;\r\n  z-index: 1;\r\n}\r\n\r\n.sp_Style.blockS{\r\n  perspective:300px;\r\n  -webkit-perspective: 300px;\r\n}\r\n\r\n@font-face {\r\n    font-family: 'roboto_med';\r\n    src: url("+a(n(536))+");\r\n}\r\n\r\n\r\n.sp_Style.blockS .robotoFont  {\r\n  font-family: 'roboto_med';\r\n  color: #000;\r\n}\r\n\r\n.sp_Style.blockS .logoFrame .Title{\r\n  font-family: 'roboto_med';\r\n  color: #000;\r\n  font-size: 30pt;\r\n}\r\n\r\n.sp_Style.blockS .logoFrame .TitleTextCon{\r\n  transform: translate(0%,-50%);\r\n}\r\n.sp_Style.blockS .logoFrame-leave-active .TitleTextCon{\r\n  animation-delay: 0.2s;\r\n  animation-duration: 0.2s;\r\n  animation-name: LOGOTitleAnimation;\r\n  animation-fill-mode: forwards;\r\n  animation-timing-function: ease-in-out;\r\n}\r\n@keyframes LOGOTitleAnimation {\r\n  100% {\r\n      transform: none;\r\n  }\r\n}\r\n\r\n.sp_Style.blockS .logoFrame .LOGOImg{\r\n  transform-origin: 50% 50%;\r\n  animation-duration: 0.4s;\r\n  animation-timing-function: ease-in-out;\r\n  -webkit-filter: grayscale(100%);\r\n  transform: rotateZ(-360deg);\r\n}\r\n\r\n.sp_Style.blockS .logoFrame-leave-active .LOGOImg{\r\n  animation-delay: 0s;\r\n  animation-name: LOGOImgRotateAnimation;\r\n  animation-fill-mode: forwards;\r\n}\r\n\r\n@keyframes LOGOImgRotateAnimation {\r\n\r\n  50%  {\r\n  }\r\n\r\n  100% {\r\n      transform: none;\r\n      -webkit-filter: none;\r\n  }\r\n}\r\n\r\n\r\n\r\n.sp_Style.blockS .logoFrame{\r\n  transform-origin: 50% -120%;\r\n}\r\n.sp_Style.blockS .logoFrame-leave-active{\r\n  animation-delay: 0.7s;\r\n  animation-name: logoFrameAnimation;\r\n  animation-duration: 1.0s;\r\n  animation-timing-function: ease-in-out;\r\n}\r\n@keyframes logoFrameAnimation {\r\n\r\n  15%  {\r\n    transform: translate(-50%,-50%);\r\n  }\r\n  40%  {\r\n    transform: rotateX(2deg) translate(-50%,-50%) ;\r\n  }\r\n  100% {\r\n    transform: rotateX(0deg) translate(-50%,-100%) ;\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n.sp_Style.blockS .scroll::-webkit-scrollbar {\r\n\twidth: 5px;\r\n\theight: 0;\r\n\tbackground-color: #cccccc;\r\n}\r\n.sp_Style.blockS .scroll::-webkit-scrollbar-thumb {\r\n\tbackground-color: #555;\r\n}\r\n.sp_Style.blockS .scroll::-webkit-scrollbar-thumb:hover {\r\n\tborder: 1px solid #333333;\r\n}\r\n.sp_Style.blockS .scroll::-webkit-scrollbar-thumb:active {\r\n\tborder: 1px solid #333333;\r\n}\r\n\r\n.sp_Style.blockS *:not(.nblockS *){\r\n\tfont-size: 0.6cm;\r\n}\r\n\r\n.sp_Style.blockS .sFontSize{\r\n\tfont-size: 0.4cm;\r\n}\r\n.sp_Style.blockS .mFontSize{\r\n\tfont-size: 0.6cm;\r\n}\r\n.sp_Style.blockS .lFontSize{\r\n\tfont-size: 0.7cm;\r\n}\r\n\r\n\r\n.sp_Style.blockS button.sidebar{\r\n  border-bottom : 2px solid #EEE;\r\n  border-right : 4px solid #111;\r\n  background: white;\r\n  color: white;\r\n}\r\n\r\n.sp_Style.blockS button.sidebar:hover {\r\n  background: #222;\r\n}\r\n\r\n.sp_Style.blockS button.sidebar >p {\r\n  padding: 15px;\r\n  text-align: left;\r\n  color: #333;\r\n}\r\n\r\n\r\n.sp_Style.blockS button.sidebar >img {\r\n  width:20px;\r\n  margin-left: 8px;\r\n}\r\n\r\n.sp_Style.blockS button.sidebar:hover>p {\r\n  text-align: center;\r\n  color: white;\r\n\r\n}\r\n\r\n.sp_Style.blockS .pokemonSpriteCon>* {\r\n\r\n\ttransition: transform ease-out 0.5s;\r\n}\r\n\r\n.sp_Style.blockS .sysAPPBtn{\r\n\r\n\ttransition: transform ease-out 0.5s;\r\n}\r\n",""])},536:function(e,t,n){e.exports=n.p+"fe13e4170719c2fc586501e777bde143.ttf"},55:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Edit_Tar_Update=function(e){return{type:a.Edit_Tar_Update,data:e}},t.Edit_Tar_Ele_Trace_Update=function(e){return{type:a.Edit_Tar_Ele_Trace_Update,data:e}},t.Edit_Tar_Ele_Cand_Update=function(e){return{type:a.Edit_Tar_Ele_Cand_Update,data:e}},t.Shape_List_Update=function(e){return{type:a.Shape_List_Update,data:e}},t.Shape_Decoration_ID_Order_Update=function(e){return{type:a.Shape_Decoration_ID_Order_Update,data:e}},t.Matching_Face_Update=function(e){return{type:a.Matching_Face_Update,data:e}},t.Matching_Angle_Margin_Deg_Update=function(e){return{type:a.Matching_Angle_Margin_Deg_Update,data:e}},t.IntrusionSizeLimitRatio_Update=function(e){return{type:a.IntrusionSizeLimitRatio_Update,data:e}},t.DefFileHash_Update=function(e){return{type:a.DefFileHash_Update,data:e}},t.Shape_Set=function(e){return{type:a.Shape_Set,data:{shape:e.shape,id:e.id}}},t.DefFileName_Update=function(e){return{type:a.DefFileName_Update,data:e}},t.DefFileTag_Update=function(e){return{type:a.DefFileTag_Update,data:e}},t.MachTag_Update=function(e){return{type:a.MachTag_Update,data:e}},t.InspOptionalTag_Update=function(e){return{type:a.InspOptionalTag_Update,data:e}},t.SUCCESS=function(){return{type:a.SUCCESS}},t.FAIL=function(){return{type:a.FAIL}},t.ERROR=function(){return{type:a.ERROR}};var a=t.EVENT={Edit_Tar_Update:"Edit_Tar_Update",Edit_Tar_Ele_Trace_Update:"Edit_Tar_Ele_Trace_Update",Edit_Tar_Ele_Cand_Update:"Edit_Tar_Ele_Cand_Update",Shape_List_Update:"Shape_List_Update",Shape_Set:"Shape_Set",Shape_Decoration_ID_Order_Update:"Shape_Decoration_ID_Order_Update",DefFileName_Update:"DefFileName_Update",DefFileHash_Update:"DefFileHash_Update",DefFileTag_Update:"DefFileTag_Update",MachTag_Update:"MachTag_Update",Matching_Face_Update:"Matching_Face_Update",Matching_Angle_Margin_Deg_Update:"Matching_Angle_Margin_Deg_Update",IntrusionSizeLimitRatio_Update:"IntrusionSizeLimitRatio_Update",InspOptionalTag_Update:"InspOptionalTag_Update",SUCCESS:"DEFCONF_MODE_SUCCESS",FAIL:"DEFCONF_MODE_FAIL",ERROR:"ERROR"}},704:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=n(28),r=S(n(55)),o=n(47),s=n(193),l=n(43),c=h(n(705)),u=S(n(37)),d=h(n(61)),p=(n(706),h(n(707))),f=h(n(281)),_=h(n(792));function h(e){return e&&e.__esModule?e:{default:e}}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function v(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=u.getLogger("UICtrlReducer"),b=i.UI_SM_STATES,y=i.UI_SM_EVENT;function g(e){var t;console.log("Edit_info_reset");var n=(m(t={inspReport:void 0,reportStatisticState:{trackingWindow:[],historyReport:[],newAddedReport:[],statisticValue:void 0},statSetting:{keepInTrackingTime_ms:3e3,historyReportlimit:2e3,minReportRepeat:2,headReportSkip:3},sig360info:[],matching_angle_margin_deg:180,matching_angle_offset_deg:0,matching_face:0,intrusionSizeLimitRatio:.001,img:null,DefFileName:"",DefFileTag:[],DefFileHash:"",list:[],__decorator:{list_id_order:[]},inherentShapeList:[],edit_tar_info:null,edit_tar_ele_trace:null,edit_tar_ele_cand:null,mouseLocation:void 0,loadedDefFile:void 0},"DefFileHash",void 0),m(t,"DefFileHash_pre",void 0),m(t,"DefFileHash_root",void 0),t);e.edit_info=Object.assign({},e.edit_info,n),e.edit_info._obj.reset(),e.edit_info.edit_tar_info=null,e.edit_info.list=e.edit_info._obj.shapeList,e.edit_info.inherentShapeList=e.edit_info._obj.UpdateInherentShapeList()}function k(){var e={MENU_EXPEND:!1,showSplash:!0,showSM_graph:!1,WS_CH:void 0,edit_info:{defModelPath:"data/cache_def",_obj:new s.InspectionEditorLogic,inspReport:void 0,reportStatisticState:{trackingWindow:[],historyReport:[],newAddedReport:[],statisticValue:void 0,overallStat:{OK:0,WARN:0,NG:0,lastTS:0,T:0,soft_T:0,softIdx:.1}},sig360info:[],matching_angle_margin_deg:180,matching_angle_offset_deg:0,matching_face:0,img:null,DefFileName:"",DefFileTag:[],inspOptionalTag:[],list:[],__decorator:{listIDOrder:[]},inherentShapeList:[],edit_tar_info:null,edit_tar_ele_trace:null,edit_tar_ele_cand:null,camera_calibration_report:void 0,mouseLocation:void 0},version_map_info:void 0,WebUI_info:c.default,sm:null,c_state:null,p_state:null,state_count:0,WS_ID:"EverCheckWS",InspectionMonitor_URL:"http://gitexp.idcircle.me/hyvision_monitor/0.0.0/"};return g(e),e}function T(e,t){var n=e.filter((function(e){return t.find((function(t){return t.id==e}))})),a=t.filter((function(e){return void 0===n.find((function(t){return t==e.id}))})).map((function(e){return e.id}));return n=[].concat(v(n),v(a))}function C(e,t){if(e.state_count++,"ev_state_update"==t.type)switch(e.c_state=t.data.c_state,e.p_state=t.data.p_state,e.sm=t.data.sm,e.state_count=0,E.info(e.p_state.value," + ",t.data.action," > ",e.c_state.value),e.c_state.value){case b.MAIN:e.edit_info=a({},e.edit_info,{inspOptionalTag:[]})}if(t.type===y.Control_SM_Panel)return e.showSM_graph=t.data,e;switch(t.type){case y.Connected:return e.WS_CH=t.data,E.info("Connected",e.WS_CH),e;case y.Version_Map_Update:E.info("Version_Map_Update",t.data);var n=t.data;n.webUI_info=c.default;var s=n.core_info;n.recommend_ver={};var u=s.version;void 0===u&&(u="0.0.0");var h=n.core2wui[u];if(void 0!==h&&void 0!==h.ver){var S=h.ver,v="http://hyv.idcircle.me";void 0!==s.webUI_resource&&(v=s.webUI_resource);var m=_.default.clean(c.default.version),k=S.map((function(e){return _.default.clean(e)})).reduce((function(e,t){return _.default.gt(e,t)?e:t}));_.default.gt(k,m)&&(n.recommend_info={versions:S,url:v+"/"+S[S.length-1]})}return e=a({},e,{version_map_info:n});case y.Disonnected:return e.WS_CH=void 0,e;case y.Control_SM_Panel:return e.showSM_graph=t.data,e}switch(e.c_state.value){case b.SPLASH:return e.showSplash=!0,e}var C=(0,o.xstate_GetCurrentMainState)(e.c_state),I=C.substate;function A(e,t){return e.measureList.forEach((function(e){var n=t.judgeReports.find((function(t){return t.id==e.id})),a=e.statistic;if(void 0===n)return a.count_stat.NA++,void E.error("The incoming inspection report doesn't match the defFile");if(n.status==l.INSPECTION_STATUS.NA)return a.count_stat.NA++,void E.error("The measure["+n.name+"] is NA");var i=n.value;void 0===a.count_stat[n.detailStatus]?a.count_stat[n.detailStatus]=0:a.count_stat[n.detailStatus]++,a.count++,a.sum+=i,a.mean=a.sum/a.count,a.sqSum+=i*i,a.variance=a.sqSum/a.count-a.mean*a.mean,a.sigma=Math.sqrt(a.variance),a.CPU=(e.USL-a.mean)/(3*a.sigma),a.CPL=(a.mean-e.LSL)/(3*a.sigma),a.CP=Math.min(a.CPU,a.CPL),a.CK=(a.mean-e.value)/((e.USL-e.LSL)/2),a.CPK=a.CP*(1-Math.abs(a.CK)),a.histogram=function(e,t){if(t<e.xmin)return e.histo[0]++,e;if(t>e.xmax)return e.histo[e.histo.length-1]++,e;var n=e.histo.length-2,a=Math.floor(n*(t-e.xmin)/(e.xmax-e.xmin));return a>=n&&(a=n-1),e.histo[a+1]++,e}(a.histogram,i)})),e}switch(C.state){case b.SPLASH:return e.showSplash=!0,e;case b.MAIN:case b.DEFCONF_MODE:case b.INSP_MODE:switch(e.showSplash=!1,t.type){case y.StatSettingParam_Update:e.edit_info.statSetting=a({},e.edit_info.statSetting,t.data),console.log("StatSettingParam_Update",e.edit_info.statSetting);break;case y.Image_Update:e.edit_info=a({},e.edit_info,{img:t.data});break;case y.Def_Model_Path_Update:e.edit_info=a({},e.edit_info,{defModelPath:t.data});break;case i.UI_SM_EVENT.Canvas_Mouse_Location:e.edit_info.mouseLocation=t.data;break;case y.Inspection_Report:!function(e,t){var n=e.edit_info.statSetting,r=""+e.edit_info.inspOptionalTag;void 0!==e.DefFileTag&&0!=e.DefFileTag.length&&(r=e.edit_info.DefFileTag+","+r),void 0!==e.MachTag&&0!=e.MachTag.length&&(r=e.MachTag+","+r);var o=t.date.getTime(),s=e.edit_info._obj.cameraParam,c=void 0;c=void 0===s?void 0:s.mmpb2b/s.ppb2b;var u=t.data.subFeatureDefSha1,p=t.data.machine_hash;"binary_processing_group"===t.data.type&&t.data.reports.forEach((function(s){switch(s.type){case"sig360_extractor":case"sig360_circle_line":e.edit_info=a({},e.edit_info),e.edit_info._obj.SetInspectionReport(s);var f=e.edit_info._obj.inspreport;if(e.edit_info.inspReport=f,f.time_ms=o,void 0===c)break;var _=e.edit_info.reportStatisticState;if(_.newAddedReport=[],_.trackingWindow.forEach((function(e){e.isCurObj=!1})),_.trackingWindow=_.trackingWindow.filter((function(e){return o-e.time_ms<n.keepInTrackingTime_ms||(e.repeatTime>n.minReportRepeat&&0==e.headSkipTime?(_.statisticValue=A(_.statisticValue,e),_.historyReport.push(e),_.historyReport.length>n.historyReportlimit&&(_.historyReport=_.historyReport.slice(Math.max(_.historyReport.length-1e3,1))),_.newAddedReport.push(e)):(E.error("the current data only gets few samples, ignore","this error case is to remove abnormal sample that's caused by air blow"),E.error("repeatTime:",e.repeatTime),E.error("headSkipTime:",e.headSkipTime)),!1)})),void 0===f.reports)break;f.reports.forEach((function(t){var a=_.trackingWindow.reduce((function(e,n){if(void 0!==e)return e;if(t.isFlipped!=n.isFlipped)return e;var a=t.area/n.area;if(a>1.2||a<1/1.2)return e;var i=t.rotate-n.rotate;return i>180&&(i-=360),i>5||i<-5?e:Math.hypot(t.cx-n.cx,t.cy-n.cy)>c/2?e:n}),void 0);function s(e,t,n){return e+=1/(n+1)*(t-e)}if(void 0!==a)a.area=s(a.area,t.area,a.repeatTime),a.cx=s(a.cx,t.cx,a.repeatTime),a.cy=s(a.cy,t.cy,a.repeatTime),a.detectedLines.forEach((function(e){if(e.status!=l.INSPECTION_STATUS.NA){var n=e.id,i=t.detectedLines.find((function(e){return e.id==n}));void 0!==i&&i.status!=l.INSPECTION_STATUS.NA?(e.cx=s(e.cx,i.cx,a.repeatTime),e.cy=s(e.cy,i.cy,a.repeatTime),e.vx=s(e.vx,i.vx,a.repeatTime),e.vy=s(e.vy,i.vy,a.repeatTime)):e.status=l.INSPECTION_STATUS.NA}})),a.detectedCircles.forEach((function(e){if(e.status!=l.INSPECTION_STATUS.NA){var n=e.id,i=t.detectedCircles.find((function(e){return e.id==n}));void 0!==i&&i.status!=l.INSPECTION_STATUS.NA?(e.x=s(e.x,i.x,a.repeatTime),e.y=s(e.y,i.y,a.repeatTime),e.r=s(e.r,i.r,a.repeatTime),e.s=s(e.s,i.s,a.repeatTime)):e.status=l.INSPECTION_STATUS.NA}})),a.searchPoints.forEach((function(e){if(e.status!=l.INSPECTION_STATUS.NA){var n=e.id,i=t.searchPoints.find((function(e){return e.id==n}));void 0!==i&&i.status!=l.INSPECTION_STATUS.NA?(e.x=s(e.x,i.x,a.repeatTime),e.y=s(e.y,i.y,a.repeatTime)):e.status=l.INSPECTION_STATUS.NA}})),a.judgeReports.forEach((function(n){if(n!=l.INSPECTION_STATUS.NA){var r=n.id,o=t.judgeReports.find((function(e){return e.id==r}));if(void 0!==o){if(o.status==l.INSPECTION_STATUS.NA)return n.status=l.INSPECTION_STATUS.NA,void(n.value=NaN);if(n.value==n.value){var s=o.value-n.value;n.subtype===i.SHAPE_TYPE.measure_subtype.angle&&(s>Math.PI&&(s-=Math.PI),s<-Math.PI&&(s+=Math.PI)),s==s&&(n.value+=1/(a.repeatTime+1)*s)}else n.value=o.value;var c=e.edit_info.list.find((function(e){return e.id==r}));void 0!==c&&(n.value!=n.value?n.status=l.INSPECTION_STATUS.NA:n.value<c.USL&&n.value>c.LSL?n.status=l.INSPECTION_STATUS.SUCCESS:n.status=l.INSPECTION_STATUS.FAILURE)}}else n.value=NaN})),a.time_ms=o,a.repeatTime+=1,a.headSkipTime>0&&(a.headSkipTime--,0==a.headSkipTime&&(a.repeatTime=0)),a.isCurObj=!0;else{var f=(0,d.default)(t);f.time_ms=o,f.add_time_ms=o,f.subFeatureDefSha1=u,f.tag=r,f.machine_hash=p,f.repeatTime=1,f.headSkipTime=n.headReportSkip,f.isCurObj=!0,_.trackingWindow.push(f)}})),_.trackingWindow=_.trackingWindow.filter((function(e){return e.isCurObj||e.repeatTime>=n.minReportRepeat}));break;case"camera_calibration":void 0!==s.error&&0==s.error?(e.edit_info._obj.SetCameraParamInfo(s),e.edit_info.camera_calibration_report=t.data):(e.edit_info._obj.SetCameraParamInfo(void 0),e.edit_info.camera_calibration_report=void 0)}}))}(e,t);break;case y.Define_File_Update:var D=t.data;if("binary_processing_group"===D.type){var O=!1,N=(0,d.default)(D.featureSet);N.forEach((function(e){Object.keys(e).filter((function(e){return e.startsWith("__")})).forEach((function(t){return delete e[t]}))}));var P=f.default.digest(N,"sha1","hex");if(void 0!==D.featureSet_sha1)D.featureSet_sha1!==P&&(O=!0);if(g(e),O){e.edit_info.DefFileHash=void 0;break}if(e.edit_info.DefFileHash=P,e.edit_info.DefFileHash_pre=D.featureSet_sha1_pre,e.edit_info.DefFileHash_root=D.featureSet_sha1_root,void 0===D.name){var w=new Date,x=(0,p.default)(w,"yyyymmdd_HHMMss");e.edit_info.DefFileName="Sample_"+x}else e.edit_info.DefFileName=D.name;if(void 0!==D.tag){var U=D.tag;(0,o.isString)(U)&&(U=D.tag.split(",")),Array.isArray(U)&&(e.edit_info.DefFileTag=U)}e.edit_info.loadedDefFile=(0,d.default)(D),"number"==typeof D.intrusionSizeLimitRatio&&(e.edit_info.intrusionSizeLimitRatio=D.intrusionSizeLimitRatio),D.featureSet.forEach((function(n){switch(n.type){case"sig360_extractor":case"sig360_circle_line":void 0!==n.matching_angle_margin_deg&&(e.edit_info.matching_angle_margin_deg=n.matching_angle_margin_deg),void 0!==n.matching_angle_offset_deg&&(e.edit_info.matching_angle_offset_deg=n.matching_angle_offset_deg),void 0!==n.matching_face&&(e.edit_info.matching_face=n.matching_face),e.edit_info=Object.assign({},e.edit_info),e.edit_info._obj.SetDefInfo(n);var r=e.edit_info.reportStatisticState;e.edit_info.edit_tar_info=null,e.edit_info.list=e.edit_info._obj.shapeList,e.edit_info.__decorator=a({},e.edit_info.__decorator,n.__decorator),e.edit_info.__decorator.list_id_order=T(e.edit_info.__decorator.list_id_order,e.edit_info.list),e.edit_info.inherentShapeList=e.edit_info._obj.UpdateInherentShapeList(),E.info(e.edit_info.inherentShapeList);var o=(0,d.default)(e.edit_info.list.filter((function(e){return e.type==i.SHAPE_TYPE.measure}))).map((function(e){return e.statistic={count_stat:{NA:0,UOK:0,LOK:0,UCNG:0,LCNG:0,USNG:0,LSNG:0},histogram:{xmin:1.2*(e.LSL-e.value)+e.value,xmax:1.2*(e.USL-e.value)+e.value,histo:new Array(502).fill(0)},count:0,sum:0,sqSum:0,mean:0,variance:0,sigma:0,CP:0,CK:0,CPU:0,CPL:0,CPK:0},e}));r.statisticValue={measureList:o},E.info(r.statisticValue);break;case"camera_calibration":E.error(t)}}))}break;case y.SIG360_Report_Update:case y.SIG360_Extraction:e.edit_info=Object.assign({},e.edit_info),console.log(t.data),e.edit_info._obj.Setsig360info(t.data),e.edit_info.sig360info=e.edit_info._obj.sig360info;break;case r.EVENT.Shape_List_Update:e.edit_info._obj.SetShapeList(t.data),e.edit_info.edit_tar_info=null,e.edit_info.list=e.edit_info._obj.shapeList,e.edit_info.__decorator.list_id_order=T(e.edit_info.__decorator.list_id_order,e.edit_info.list),e.edit_info.inherentShapeList=e.edit_info._obj.UpdateInherentShapeList();break;case r.EVENT.Edit_Tar_Update:e.edit_info.edit_tar_info=null==t.data?null:Object.assign({},t.data),e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null;break;case r.EVENT.Edit_Tar_Ele_Trace_Update:e.edit_info.edit_tar_ele_trace=null==t.data?null:t.data.slice();break;case y.EC_Save_Def_Config:if(null==e.WS_CH)break;break;case r.EVENT.Edit_Tar_Ele_Cand_Update:e.edit_info.edit_tar_ele_cand=null==t.data?null:t.data instanceof Object?Object.assign({},t.data):t.data,E.info("DEFCONF_MODE_Edit_Tar_Ele_Cand_Update",e.edit_info.edit_tar_ele_cand);break;case r.EVENT.DefFileName_Update:e.edit_info=Object.assign({},e.edit_info,{DefFileName:t.data});break;case r.EVENT.DefFileTag_Update:e.edit_info=a({},e.edit_info,{DefFileTag:t.data});break;case r.EVENT.MachTag_Update:e=a({},e,{MachTag:t.data});break;case r.EVENT.Matching_Angle_Margin_Deg_Update:e.edit_info=a({},e.edit_info,{matching_angle_margin_deg:t.data});break;case r.EVENT.Matching_Face_Update:e.edit_info=a({},e.edit_info,{matching_face:t.data});break;case r.EVENT.IntrusionSizeLimitRatio_Update:"number"==typeof t.data&&(e.edit_info=a({},e.edit_info,{intrusionSizeLimitRatio:t.data}));break;case r.EVENT.DefFileHash_Update:var M=e.edit_info.DefFileHash_root,L=e.edit_info.DefFileHash,R=t.data;void 0===M&&void 0===(M=L)&&(M=R),e.edit_info=a({},e.edit_info,{DefFileHash_root:M,DefFileHash_pre:L,DefFileHash:R});break;case r.EVENT.InspOptionalTag_Update:var F=t.data,j=F;F=j=j.filter((function(e,t){if(0==e.length)return!1;for(var n=0;n<t;n++)if(j[n]==e)return!1;return!0})),e.edit_info=a({},e.edit_info,{inspOptionalTag:F});break;case r.EVENT.Shape_Decoration_ID_Order_Update:E.info("action.data:",t.data),e.edit_info.__decorator.list_id_order=T(t.data,e.edit_info.list);case r.EVENT.Shape_Set:var W=t.data.id;E.info("newID:",W);var B=e.edit_info._obj.SetShape(t.data.shape,W);if(e.edit_info.list=e.edit_info._obj.shapeList,e.edit_info.__decorator.list_id_order=T(e.edit_info.__decorator.list_id_order,e.edit_info.list),e.edit_info.inherentShapeList=e.edit_info._obj.UpdateInherentShapeList(),void 0!==W){var H=e.edit_info._obj.FindShapeIdx(W);E.info(H),e.edit_info.edit_tar_info=void 0===H?null:(0,d.default)(e.edit_info.list[H])}else e.edit_info.edit_tar_info=(0,d.default)(B);e.edit_info=Object.assign({},e.edit_info)}switch(I){case i.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:if(null==e.edit_info.edit_tar_info){e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null;break}if(null!=e.edit_info.edit_tar_ele_trace&&null!=e.edit_info.edit_tar_ele_cand){var G=e.edit_info.edit_tar_ele_trace,z=(0,o.GetObjElement)(e.edit_info.edit_tar_info,G,G.length-2),V=e.edit_info.edit_tar_ele_cand;E.info("GetObjElement",z,G[G.length-1]),z[G[G.length-1]]={id:V.shape.id,type:V.shape.type},E.info(z,e.edit_info.edit_tar_info),e.edit_info.edit_tar_info=Object.assign({},e.edit_info.edit_tar_info),e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null}break;case i.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:case i.UI_SM_STATES.DEFCONF_MODE_AUX_LINE_CREATE:if(null==e.edit_info.edit_tar_info){e.edit_info.edit_tar_info={type:I==i.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE?i.SHAPE_TYPE.aux_point:i.SHAPE_TYPE.aux_line,ref:[{},{}]},e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null;break}if(E.info(e.edit_info.edit_tar_ele_trace,e.edit_info.edit_tar_ele_cand),null!=e.edit_info.edit_tar_ele_trace&&null!=e.edit_info.edit_tar_ele_cand){var X=e.edit_info.edit_tar_ele_trace,Y=(0,o.GetObjElement)(e.edit_info.edit_tar_info,X,X.length-2),K=e.edit_info.edit_tar_ele_cand;E.info("GetObjElement",Y,X[X.length-1]),Y[X[X.length-1]]={id:K.shape.id,type:K.shape.type},E.info(Y,e.edit_info.edit_tar_info),e.edit_info.edit_tar_info=Object.assign({},e.edit_info.edit_tar_info),e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null}break;case i.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:if(null==e.edit_info.edit_tar_info&&(e.edit_info.edit_tar_info={type:i.SHAPE_TYPE.measure,subtype:i.SHAPE_TYPE.measure_subtype.NA,docheck:!0,back_value_setup:!1},e.edit_info.edit_tar_ele_trace=["subtype"],e.edit_info.edit_tar_ele_cand=null),E.info(e.edit_info.edit_tar_ele_trace,e.edit_info.edit_tar_ele_cand),null!=e.edit_info.edit_tar_ele_trace&&null!=e.edit_info.edit_tar_ele_cand){var J=e.edit_info.edit_tar_ele_trace,Q=(0,o.GetObjElement)(e.edit_info.edit_tar_info,J,J.length-2),q=e.edit_info.edit_tar_ele_cand;if("ref"==J[0]&&void 0!==q.shape){var $=!0,Z=e.edit_info.edit_tar_info.subtype;switch(Z){case i.SHAPE_TYPE.measure_subtype.sigma:break;case i.SHAPE_TYPE.measure_subtype.distance:q.shape.type==i.SHAPE_TYPE.search_point||q.shape.type==i.SHAPE_TYPE.aux_point||q.shape.type==i.SHAPE_TYPE.arc||q.shape.type==i.SHAPE_TYPE.line||(E.info("Error: "+Z+" doesn't accept "+q.shape.type),$=!1);break;case i.SHAPE_TYPE.measure_subtype.radius:q.shape.type!=i.SHAPE_TYPE.arc&&(E.info("Error: "+Z+" Only accepts arc"),$=!1);break;case i.SHAPE_TYPE.measure_subtype.angle:q.shape.type!=i.SHAPE_TYPE.line&&(E.info("Error: "+Z+" Only accepts line"),$=!1);break;case i.SHAPE_TYPE.measure_subtype.calc:q.shape.type!=i.SHAPE_TYPE.measure&&(E.info("Error: "+Z+" Only accepts measure"),$=!1);break;default:E.info("Error: "+Z+" is not in the measure_subtype list"),$=!1}$&&(E.info("GetObjElement",Q,J[J.length-1]),Q[J[J.length-1]]={id:q.shape.id,type:q.shape.type})}else if("subtype"==J[0]){var ee=!0;switch(q){case i.SHAPE_TYPE.measure_subtype.sigma:case i.SHAPE_TYPE.measure_subtype.radius:e.edit_info.edit_tar_info.ref=[{}];break;case i.SHAPE_TYPE.measure_subtype.calc:e.edit_info.edit_tar_info.ref=[{},{},{},{}],e.edit_info.edit_tar_info.calc_f={exp:"",post_exp:[]};break;case i.SHAPE_TYPE.measure_subtype.distance:e.edit_info.edit_tar_info.ref=[{},{}],e.edit_info.edit_tar_info.ref_baseLine={};break;case i.SHAPE_TYPE.measure_subtype.angle:e.edit_info.edit_tar_info.ref=[{},{}];break;default:E.info("Error: "+q+" is not in the measure_subtype list"),ee=!1}e.edit_info.edit_tar_info=Object.assign(e.edit_info.edit_tar_info,{pt1:{x:0,y:0},value:0,USL:0,LSL:0,UCL:0,LCL:0}),ee&&(Q[J[J.length-1]]=q)}else"ref_baseLine"==J[0]&&(Q[J[J.length-1]]={id:q.shape.id,type:q.shape.type});E.info(Q,e.edit_info.edit_tar_info),e.edit_info.edit_tar_info=Object.assign({},e.edit_info.edit_tar_info),e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null}break;case i.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(null!=e.edit_info.edit_tar_ele_trace&&null!=e.edit_info.edit_tar_ele_cand){var te=e.edit_info.edit_tar_ele_trace,ne=(0,o.GetObjElement)(e.edit_info.edit_tar_info,te,te.length-2),ae=e.edit_info.edit_tar_ele_cand;E.info("GetObjElement",ne,te[te.length-1]),ne[te[te.length-1]]={id:ae.shape.id,type:ae.shape.type},e.edit_info.edit_tar_info=Object.assign({},e.edit_info.edit_tar_info),e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null}}return e}return e}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k(),t=arguments[1];if(void 0===t.type||t.type.includes("@@redux/"))return e;var n=Object.assign({},e),a=new Date;return"ATBundle"===t.type?n=t.data.reduce((function(e,t){return t.date=a,C(e,t)}),n):(t.date=a,n=C(n,t),E.debug(n),n)}},705:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={version:"1.0.7"}},709:function(e,t){},711:function(e,t){},745:function(e,t){},746:function(e,t){},793:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(n(37));var i=n(28).UI_SM_EVENT,r=function(e,t){switch(t.type){case"MWWS_SEND":if("EverCheckWS"!==t.data.id||void 0===t.data.data)break;var n=t.data.data;if(void 0===n.data||void 0===n.data.msg)break;"PD"==n.tl&&"PING"==n.data.msg.type&&(e=e.alive<=0?a({},e,{connected:!1,alive:0}):a({},e,{alive:e.alive-1}));break;case i.uInsp_Machine_Info_Update:e=a({},e,{machineInfo:a({},e.machineInfo,t.data)}),console.log(e);break;case i.PD_DATA_Update:var r=t.data;switch(r.type){case"CONNECT":console.log("CONNECT"),e=a({},e,{connected:!0,alive:1});break;case"DISCONNECT":console.log("DISCONNECT"),e=a({},e,{connected:!1,alive:0});break;case"MESSAGE":switch(r.msg.type){case"PONG":e=a({},e,{alive:1,error_codes:r.msg.error_codes,res_count:r.msg.res_count});break;case"error_info":e=a({},e,{error_codes:r.msg.error_codes});break;case"res_count":e=a({},e,{res_count:r.msg.res_count});break;case"get_setup_rsp":var o=r.msg;delete o.id,delete o.type,delete o.st,e=a({},e,{machineInfo:o}),console.log("get_setup_rsp",e)}}}return e};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{connected:!1,alive:0,machineInfo:void 0},t=arguments[1];if(void 0===t.type||t.type.includes("@@redux/"))return e;var n=new Date,a=e;return"ATBundle"===t.type?a=t.data.reduce((function(e,t){return t.date=n,r(e,t)}),a):(t.date=n,a=r(a,t))}},794:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(n(37));n(28).UI_SM_EVENT;var a=function(e,t){return t.type,e};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{inspReport:void 0,reportStatisticState:{trackingWindow:[],historyReport:[],newAddedReport:[],statisticValue:void 0}},t=arguments[1];if(void 0===t.type||t.type.includes("@@redux/"))return e;var n=new Date,i=e;return"ATBundle"===t.type?i=t.data.reduce((function(e,t){return t.date=n,a(e,t)}),i):(t.date=n,i=a(i,t))}},795:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionThrottle=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n(28);(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t})(n(37)).getLogger("ActionThrottle"),t.ActionThrottle=function(e){return function(t){return function(n){return function(i){if(e.ATID!=i.ATID)return n(i);switch(void 0===e.initted&&(a(e.time)!=a(0)&&(e.time=30),a(e.posEdge)!=a(!0)&&(e.posEdge=!0),e.actions=[],e.initted=!0,e.timeout_obj=null),i.ActionThrottle_type){case"express":return i.ATID=e.ExATID,n(i);case"flush":if(clearTimeout(e.timeout_obj),e.timeout_obj=null,0==e.actions.length)return;e.actions.push(i);var r=e.actions;return e.actions=[],r.forEach((function(e){void 0!==e.type&&n(e)})),null;default:if(null==e.timeout_obj){if(e.timeout_obj=setTimeout((function(){t.dispatch({ActionThrottle_type:"flush"})}),e.time),e.posEdge){if(void 0===i.type)return;return i.ATID=e.ExATID,n(i)}return void e.actions.push(i)}return void e.actions.push(i)}return i.ATID=e.ExATID,n(i)}}}}},796:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ECStateMachine=void 0;n(28);var a=n(1054);t.ECStateMachine=function(e){return function(t){return function(t){return function(n){if(void 0!==e.initted&&e.initted||(e.sm=(0,a.Machine)(e.state_config),e.c_state=e.sm.initialState,t({type:e.ev_state_update,data:{p_state:e.c_state,c_state:e.c_state,sm:e.sm,action:{type:e.ev_state_update}}}),e.initted=!0),null==n.type)return t(n);var i=e.sm.transition(e.c_state,n.type);if(JSON.stringify(e.c_state.value)!==JSON.stringify(i.value)){var r=e.c_state;e.c_state=i,t({type:e.ev_state_update,data:{p_state:r,c_state:i,sm:e.sm,action:n}})}return t(n)}}}}},799:function(e,t,n){var a={"./af":317,"./af.js":317,"./ar":318,"./ar-dz":319,"./ar-dz.js":319,"./ar-kw":320,"./ar-kw.js":320,"./ar-ly":321,"./ar-ly.js":321,"./ar-ma":322,"./ar-ma.js":322,"./ar-sa":323,"./ar-sa.js":323,"./ar-tn":324,"./ar-tn.js":324,"./ar.js":318,"./az":325,"./az.js":325,"./be":326,"./be.js":326,"./bg":327,"./bg.js":327,"./bm":328,"./bm.js":328,"./bn":329,"./bn.js":329,"./bo":330,"./bo.js":330,"./br":331,"./br.js":331,"./bs":332,"./bs.js":332,"./ca":333,"./ca.js":333,"./cs":334,"./cs.js":334,"./cv":335,"./cv.js":335,"./cy":336,"./cy.js":336,"./da":337,"./da.js":337,"./de":338,"./de-at":339,"./de-at.js":339,"./de-ch":340,"./de-ch.js":340,"./de.js":338,"./dv":341,"./dv.js":341,"./el":342,"./el.js":342,"./en-SG":343,"./en-SG.js":343,"./en-au":344,"./en-au.js":344,"./en-ca":345,"./en-ca.js":345,"./en-gb":346,"./en-gb.js":346,"./en-ie":347,"./en-ie.js":347,"./en-il":348,"./en-il.js":348,"./en-nz":349,"./en-nz.js":349,"./eo":350,"./eo.js":350,"./es":351,"./es-do":352,"./es-do.js":352,"./es-us":353,"./es-us.js":353,"./es.js":351,"./et":354,"./et.js":354,"./eu":355,"./eu.js":355,"./fa":356,"./fa.js":356,"./fi":357,"./fi.js":357,"./fo":358,"./fo.js":358,"./fr":359,"./fr-ca":360,"./fr-ca.js":360,"./fr-ch":361,"./fr-ch.js":361,"./fr.js":359,"./fy":362,"./fy.js":362,"./ga":363,"./ga.js":363,"./gd":364,"./gd.js":364,"./gl":365,"./gl.js":365,"./gom-latn":366,"./gom-latn.js":366,"./gu":367,"./gu.js":367,"./he":368,"./he.js":368,"./hi":369,"./hi.js":369,"./hr":370,"./hr.js":370,"./hu":371,"./hu.js":371,"./hy-am":372,"./hy-am.js":372,"./id":373,"./id.js":373,"./is":374,"./is.js":374,"./it":375,"./it-ch":376,"./it-ch.js":376,"./it.js":375,"./ja":377,"./ja.js":377,"./jv":378,"./jv.js":378,"./ka":379,"./ka.js":379,"./kk":380,"./kk.js":380,"./km":381,"./km.js":381,"./kn":382,"./kn.js":382,"./ko":383,"./ko.js":383,"./ku":384,"./ku.js":384,"./ky":385,"./ky.js":385,"./lb":386,"./lb.js":386,"./lo":387,"./lo.js":387,"./lt":388,"./lt.js":388,"./lv":389,"./lv.js":389,"./me":390,"./me.js":390,"./mi":391,"./mi.js":391,"./mk":392,"./mk.js":392,"./ml":393,"./ml.js":393,"./mn":394,"./mn.js":394,"./mr":395,"./mr.js":395,"./ms":396,"./ms-my":397,"./ms-my.js":397,"./ms.js":396,"./mt":398,"./mt.js":398,"./my":399,"./my.js":399,"./nb":400,"./nb.js":400,"./ne":401,"./ne.js":401,"./nl":402,"./nl-be":403,"./nl-be.js":403,"./nl.js":402,"./nn":404,"./nn.js":404,"./pa-in":405,"./pa-in.js":405,"./pl":406,"./pl.js":406,"./pt":407,"./pt-br":408,"./pt-br.js":408,"./pt.js":407,"./ro":409,"./ro.js":409,"./ru":410,"./ru.js":410,"./sd":411,"./sd.js":411,"./se":412,"./se.js":412,"./si":413,"./si.js":413,"./sk":414,"./sk.js":414,"./sl":415,"./sl.js":415,"./sq":416,"./sq.js":416,"./sr":417,"./sr-cyrl":418,"./sr-cyrl.js":418,"./sr.js":417,"./ss":419,"./ss.js":419,"./sv":420,"./sv.js":420,"./sw":421,"./sw.js":421,"./ta":422,"./ta.js":422,"./te":423,"./te.js":423,"./tet":424,"./tet.js":424,"./tg":425,"./tg.js":425,"./th":426,"./th.js":426,"./tl-ph":427,"./tl-ph.js":427,"./tlh":428,"./tlh.js":428,"./tr":429,"./tr.js":429,"./tzl":430,"./tzl.js":430,"./tzm":431,"./tzm-latn":432,"./tzm-latn.js":432,"./tzm.js":431,"./ug-cn":433,"./ug-cn.js":433,"./uk":434,"./uk.js":434,"./ur":435,"./ur.js":435,"./uz":436,"./uz-latn":437,"./uz-latn.js":437,"./uz.js":436,"./vi":438,"./vi.js":438,"./x-pseudo":439,"./x-pseudo.js":439,"./yo":440,"./yo.js":440,"./zh-cn":441,"./zh-cn.js":441,"./zh-hk":442,"./zh-hk.js":442,"./zh-tw":443,"./zh-tw.js":443};function i(e){var t=r(e);return n(t)}function r(e){var t=a[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id=799},800:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,i=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){i=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(801);var o=n(84),s=n(1),l=R(s),c=n(88),u=L(c),d=n(444),p=n(43),f=R(n(820)),_=R(n(61)),h=n(207),S=L(n(28)),v=L(n(55)),m=R(n(841)),E=R(n(948)),b=R(n(1015)),y=R(n(220)),g=n(47),k=R(n(218)),T=R(n(225)),C=R(n(38)),I=R(n(1043)),A=R(n(498)),D=R(n(514)),O=R(n(143)),N=R(n(15)),P=R(n(42)),w=R(n(1048)),x=R(n(116)),U=R(n(79)),M=R(n(139));R(n(132));function L(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function R(e){return e&&e.__esModule?e:{default:e}}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function W(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}w.default.Header;var B=w.default.Content,H=(w.default.Footer,w.default.Sider),G=(P.default.SubMenu,A.default.Paragraph),z=A.default.Title,V=(D.default.Panel,function(e){function t(e){return F(this,t),j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return W(t,e),r(t,[{key:"ec_canvas_EmitEvent",value:function(e){}},{key:"componentDidMount",value:function(){this.ec_canvas=new k.default.Preview_CanvasComponent(this.refs.canvas),this.ec_canvas.EmitEvent=this.ec_canvas_EmitEvent.bind(this),void 0!==this.props.onCanvasInit&&this.props.onCanvasInit(this.ec_canvas),this.updateCanvas(this.props.c_state)}},{key:"componentWillUnmount",value:function(){this.ec_canvas.resourceClean()}},{key:"updateCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;void 0!==this.ec_canvas&&(this.ec_canvas.EditDBInfoSync(t.edit_info),this.ec_canvas.SetState(e),this.ec_canvas.draw())}},{key:"onResize",value:function(e,t){void 0!==this.ec_canvas&&this.ec_canvas.resize(e,t)}},{key:"componentDidUpdate",value:function(e,t){console.log("CanvasComponent render",this.props.c_state),console.log(this.props.edit_info.inherentShapeList),this.updateCanvas(this.props.c_state,this.props)}},{key:"render",value:function(){return l.default.createElement("div",{className:this.props.className},l.default.createElement("canvas",{ref:"canvas",className:"width12 HXF"}),l.default.createElement(T.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),t}(l.default.Component)),X=function(e){function t(e){F(this,t);var n=j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.QR_Content="",n.state={canvas:void 0,fUpdateC:0},n}return W(t,e),r(t,[{key:"componentDidMount",value:function(){this.setState(i({},this.state,{canvas:this.refs.canvas}))}},{key:"onResize",value:function(e,t){this.refs.canvas.width=e,this.refs.canvas.height=t,this.setState(i({},this.state,{fUpdateC:this.state.fUpdateC++}))}},{key:"componentDidUpdate",value:function(e,t){this.QR_Content=this.props.QR_Content}},{key:"render",value:function(){return void 0!==this.refs.canvas&&f.default.toCanvas(this.refs.canvas,this.props.QR_Content,{errorCorrectionLevel:"L"},(function(e){e&&console.error(e),console.log("success!")})),l.default.createElement("div",{className:this.props.className},l.default.createElement("canvas",{ref:"canvas",className:"width12 HXF",onClick:this.props.onClick}),l.default.createElement(T.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),t}(l.default.Component),Y=(0,o.connect)((function(e){return{c_state:e.UIData.c_state,edit_info:e.UIData.edit_info}}),(function(e,t){return{}}))(V);function K(e){return"string"==typeof e||e instanceof String}function J(e){var t=e.displayInfo;l.default.useRef(null);return l.default.createElement("div",null,l.default.createElement(z,{level:2},t.name),"Name:",t.name,l.default.createElement("br",null),"Cat:",t.cat,l.default.createElement("br",null),l.default.createElement("pre",null,t.targetDeffiles.map((function(e,n){return"Def["+n+"]:"+JSON.stringify(t.targetDeffiles[n],null,2)}))))}function Q(e){var t=e.displayInfo,n=e.onUpdate,i=e.onCancel,r=e.BPG_Channel,o=(0,s.useState)(void 0),u=a(o,2),d=u[0],f=u[1],h=function(e){return"DIR"==e.type||e.name.includes("."+p.DEF_EXTENSION)},S=(0,s.useState)(void 0),v=a(S,2),m=v[0],E=v[1];return(0,s.useEffect)((function(){f((0,_.default)(t))}),[t]),void 0===d?null:l.default.createElement("div",null,l.default.createElement(U.default,{addonBefore:"Name:",className:"s width4",value:d.name,onChange:function(e){var t=(0,_.default)(d);t.name=e.target.value,f(t)}}),l.default.createElement("div",{className:"s width6"}),l.default.createElement(U.default,{addonBefore:"Cat:",className:"s width2",value:d.cat,onChange:function(e){var t=(0,_.default)(d);t.cat=e.target.value,f(t)}}),d.targetDeffiles.map((function(e,t){return[l.default.createElement(U.default,{addonBefore:"Tag:",value:e.tags,onChange:function(e){var n=(0,_.default)(d);n.targetDeffiles[t].tags=e.target.value,f(n)}}),"Def["+t+"]:"+e.name+":"+e.featureSet_sha1+"  "+e.path,l.default.createElement(C.default,{key:"sdsdfk_",onClick:function(){E({path:"data/",selected:function(e,n){console.log(e,n);var a=[new Promise((function(t,n){r("LD",0,{filename:e},void 0,{resolve:t,reject:n}),setTimeout((function(){return n("Timeout")}),5e3)})),new Promise((function(e,t){r("FB",0,{path:"./",depth:0},void 0,{resolve:e,reject:t}),setTimeout((function(){return t("Timeout")}),5e3)}))];Promise.all(a).then((function(n){if(console.log(n),"FL"==n[0][0].type&&"FS"==n[1][0].type){var a=n[1][0].data.path,i=n[0][0].data,r=(0,_.default)(d),o=r.targetDeffiles[t];o.hash=i.featureSet_sha1,o.featureSet_sha1=i.featureSet_sha1,o.featureSet_sha1_pre=i.featureSet_sha1_pre,o.featureSet_sha1_root=i.featureSet_sha1_root,o.path=e.replace(a,"").replace(/^\//,""),o.name=i.name,f(r)}})).catch((function(e){console.log(e)}))},filter:h})},style:{width:"30%"}},"loadDefFile")]})),void 0===m?null:l.default.createElement(c.BPG_FileBrowser,{key:"BPG_FileBrowser",searchDepth:4,path:m.path,visible:!0,BPG_Channel:r,onFileSelected:function(e,t){m.selected(e,t),E(void 0)},onCancel:function(){E(void 0)},fileFilter:m.filter}),l.default.createElement(C.default,{key:"onUpdate_btn",onClick:function(){return n(d)},style:{width:"30%"}},"OK"),l.default.createElement(C.default,{key:"onCancel_btn",onClick:i,style:{width:"30%"}},"Cancel"))}function q(e){var t=e.BPG_Channel,n=(e.defaultFolderPath,(0,s.useState)(void 0)),i=a(n,2),r=i[0],o=i[1],c=(0,s.useState)(void 0),u=a(c,2),d=u[0],p=u[1];(0,s.useEffect)((function(){return o(void 0),h.CusDisp_DB.read(".").then((function(e){o(e.prod)})).catch((function(e){console.log(e)})),function(){console.log("1,didUpdate ret::")}}),[]);var f=[];return void 0!==r&&(console.log(r),f=[],void 0===d?(f.push(r.map((function(e){return l.default.createElement("div",null,l.default.createElement(J,{displayInfo:e}),l.default.createElement(C.default,{onClick:function(){p(e)},style:{width:"30%"}},"EDIT"),l.default.createElement(C.default,{type:"dashed",onClick:function(){o(void 0),h.CusDisp_DB.delete(e._id).then((function(){h.CusDisp_DB.read(".").then((function(e){console.log(r),o(e.prod)})).catch((function(e){console.log(e)}))}))},style:{width:"60%"}},"Ｘ"))}))),f.push(l.default.createElement(C.default,{type:"dashed",onClick:function(){h.CusDisp_DB.create({name:"新設定",targetDeffiles:[{}]},void 0).then((function(){h.CusDisp_DB.read(".").then((function(e){console.log(r),o(e.prod),p(e.prod[e.prod.length-1])})).catch((function(e){console.log(e)}))}))},style:{width:"60%"}},"Add field"))):f.push(l.default.createElement("div",null,l.default.createElement(Q,{displayInfo:d,BPG_Channel:t,onUpdate:function(e){console.log(e),h.CusDisp_DB.update(e,d._id).then((function(){h.CusDisp_DB.read(".").then((function(e){console.log(r),o(e.prod),p()})).catch((function(e){console.log(e)}))}))},onCancel:function(){p()}})))),l.default.createElement(w.default,{style:{height:"100%"}},l.default.createElement(w.default,null,l.default.createElement(w.default.Content,{style:{padding:"50px 50px",overflow:"scroll"}},f),l.default.createElement(w.default.Footer,null,"Custom UI v0.0.0")))}var $=function(e){function t(e){F(this,t);var n=j(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fileSelectedCallBack:void 0,fileSelectFilter:void 0,fileStaticList:void 0,popUpUIInfo:void 0,menuSelect:"Overview",additionalUI:[],menuCollapsed:!0,calibCalcInfo:{curMea1:.8,calibMea1:.82,curMea2:.4,calibMea2:.44}},n}return W(t,e),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.defModelPath;this.props.ACT_WS_SEND(this.props.WS_ID,"LD",0,{deffile:t+"."+p.DEF_EXTENSION,imgsrc:t}),new Promise((function(t,n){e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{filename:"data/machine_info"},void 0,{resolve:t,reject:n})})).then((function(t){if("FL"==t[0].type){var n=t[0].data;n.length<16&&e.props.ACT_MachTag_Update(n)}})).catch((function(e){console.log(e)}))}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"FrontDoor",value:function(){var e=l.default.createElement("div",{className:"content"},l.default.createElement(G,null,"HYVision 2019 is the most famous vision-check system in the world."),l.default.createElement(G,null,l.default.createElement("p",null,"HYVision 2019 - v1 (http://hyv.idcircle.me)"),l.default.createElement("p",null,"HYVision 2019 - v2 (http://hyv.idcircle.me)"),l.default.createElement("p",null,"HYVision 2019 - v3 (http://hyv.idcircle.me)")),l.default.createElement("p",{className:"contentLink"},l.default.createElement("a",null,l.default.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/MjEImQtenlyueSmVEfUD.svg",alt:"start"})," Quick Start"),l.default.createElement("a",null,l.default.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/NbuDUAuBlIApFuDvWiND.svg",alt:"info"}),"Product Info"),l.default.createElement("a",null,l.default.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/ohOEPSYdDTNnyMbGuyLb.svg",alt:"doc"}),"Product Doc"))),t=l.default.createElement("img",{src:"https://gw.alipayobjects.com/mdn/mpaas_user/afts/img/A*KsfVQbuLRlYAAAAAAAAAAABjAQAAAQ/original",alt:"content"});return l.default.createElement(I.default,{title:"HYVision 2019",breadcrumb:{routes:[{path:"index",breadcrumbName:"HYV"},{path:"first",breadcrumbName:"HOME"},{path:"second",breadcrumbName:"Manual"}]}},l.default.createElement("div",{className:"wrap"},l.default.createElement("div",{className:"content"},e),l.default.createElement("div",{className:"extraContent"},t)))}},{key:"calibInfoUpdate",value:function(e){console.log(e),this.setState({calibCalcInfo:i({},this.state.calibCalcInfo,e)})}},{key:"render",value:function(){var e=this,t=[];if(null==this.props.c_state)return null;var n=(0,g.xstate_GetCurrentMainState)(this.props.c_state);if(n.state===S.UI_SM_STATES.MAIN){var a=this.props.defModelPath.substr(0,this.props.defModelPath.lastIndexOf("/")+1),r=function(t){e.setState(i({},e.state,{menuSelect:t.key}))},o=void 0;if(void 0!==this.props.camera_calibration_report){var s=this.props.isp_db.cameraParam;o=s.mmpb2b/s.ppb2b}var f=void 0;K(this.props.defModelHash)&&this.props.defModelHash.length>5&&(f=this.props.InspectionMonitor_URL+"?v=0&name="+this.props.defModelName+"&hash="+this.props.defModelHash,f=encodeURI(f));var h=this.state.calibCalcInfo;console.log(h);var v=(0,g.Calibration_MMPP_offset)(h.curMea1,h.calibMea1,h.curMea2,h.calibMea2,o,0),k={Overview:{icon:"info-circle",content:l.default.createElement("div",{style:{padding:24,background:"#fff",height:"100%"}},l.default.createElement("div",{className:"s black"},this.props.WebUI_info.version),l.default.createElement("div",{className:"s height11"},l.default.createElement(C.default,{size:"large",onClick:function(){var t=localStorage.getItem("RecentDefFiles");try{t=JSON.parse(t)}catch(e){t=[]}var n=[{name:"history",list:t}];e.setState({fileSelectedCallBack:function(t,n){if(void 0!==localStorage){var a=localStorage.getItem("RecentDefFiles");try{a=JSON.parse(a)}catch(e){a=[]}a instanceof Array||(a=[]),console.log(a),(a=a.filter((function(e){return e.name!=n.name||e.path!=n.path}))).unshift(n),a=a.slice(0,100),localStorage.setItem("RecentDefFiles",JSON.stringify(a)),console.log(localStorage.getItem("RecentDefFiles"))}t=t.replace("."+p.DEF_EXTENSION,""),e.setState({fileSelectedCallBack:void 0}),e.props.ACT_Def_Model_Path_Update(t),e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{deffile:t+"."+p.DEF_EXTENSION,imgsrc:t})},fileSelectFilter:function(e){return"DIR"==e.type||e.name.includes("."+p.DEF_EXTENSION)},fileGroups:n})}},l.default.createElement(N.default,{type:"file-add"}),this.props.defModelPath),l.default.createElement(z,{level:2},this.props.defModelName),l.default.createElement("div",{className:"s width8 HXA"},l.default.createElement(d.TagOptions_rdx,{className:"s width12 HXA"}),l.default.createElement(C.default,{size:"large",onClick:function(){var t={title:"機台設定",onOK:function(){},onCancel:function(){},content:l.default.createElement(d.CustomDisplaySelectUI,{onSelect:function(t){var n=t.targetDeffiles[0],a=n.path;if(void 0!==a){a=a.replace("."+p.DEF_EXTENSION,""),e.setState({popUpUIInfo:void 0}),e.props.ACT_Def_Model_Path_Update(a),e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{deffile:a+"."+p.DEF_EXTENSION,imgsrc:a});var i=[];try{i=n.tags.split(",")}catch(e){i=[]}e.props.ACT_InspOptionalTag_Update(i)}}})};e.setState({popUpUIInfo:t})}},"機台設定選擇")),K(f)?l.default.createElement(X,{className:"s width4 HXA",onClick:function(){return window.open(f)},QR_Content:f}):null,l.default.createElement(Y,{className:"height9"})),l.default.createElement(c.BPG_FileBrowser,{key:"BPG_FileBrowser",searchDepth:4,path:a,visible:void 0!==this.state.fileSelectedCallBack,BPG_Channel:function(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.props).ACT_WS_SEND.apply(t,[e.props.WS_ID].concat(a))},onFileSelected:this.state.fileSelectedCallBack,fileGroups:this.state.fileGroups,onCancel:function(){e.setState(i({},e.state,{fileSelectedCallBack:void 0}))},fileFilter:this.state.fileSelectFilter}),l.default.createElement(x.default,{title:void 0===this.state.popUpUIInfo?"":this.state.popUpUIInfo.title,visible:void 0!==this.state.popUpUIInfo,onOk:function(){e.state.popUpUIInfo.onOK(),e.setState({popUpUIInfo:void 0})},onCancel:function(){e.state.popUpUIInfo.onCancel(),e.setState({popUpUIInfo:void 0})}},void 0===this.state.popUpUIInfo?null:this.state.popUpUIInfo.content),this.state.additionalUI),onSelected:r},EDIT:{icon:"edit",content:null,onSelected:this.props.EV_UI_Edit_Mode},Inspect:{icon:"scan",content:null,onSelected:function(){console.log(e.state.menuSelect),"Overview"===e.state.menuSelect&&(e.props.inspOptionalTag.reduce((function(e,t){return e||d.essentialTags.includes(t)}),!1)?e.props.EV_UI_Insp_Mode():e.setState({additionalUI:[l.default.createElement(x.default,{title:"警告",visible:!0,onOk:function(){e.setState({additionalUI:[]})},onCancel:function(){e.setState({additionalUI:[]})},cancelButtonProps:{style:{display:"none"}}},l.default.createElement("div",{style:{height:"auto"}},"警告：沒有設定 必要Tag",l.default.createElement("br",null),"必要Tag 如下",l.default.createElement("br",null),d.essentialTags.map((function(e,t,n){return l.default.createElement(M.default,{className:" InspTag optional fixed"},e)}))))]}))}},SDD:{icon:"database",content:l.default.createElement(q,{BPG_Channel:function(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.props).ACT_WS_SEND.apply(t,[e.props.WS_ID].concat(a))}}),onSelected:r},Setting:{icon:"setting",content:l.default.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},l.default.createElement(O.default,{orientation:"left"},"MISC"),l.default.createElement(C.default,{key:"Reconnect CAM",onClick:function(){e.props.ACT_WS_SEND(e.props.WS_ID,"RC",0,{target:"camera_ez_reconnect"})}},"Reconnect CAM")," ",l.default.createElement(C.default,{key:"camera Calib",onClick:function(){e.setState(i({},e.state,{fileSelectedCallBack:function(t,n){console.log(t,n),e.props.ACT_WS_SEND(e.props.WS_ID,"II",0,{deffile:"data/cameraCalibration.json",imgsrc:t})}}))}},"camera Calib"),l.default.createElement(O.default,{orientation:"left"},"µInsp"),l.default.createElement(C.default.Group,null,l.default.createElement(C.default,{type:"primary",key:"Connect uInsp",disabled:this.props.uInspData.connected,icon:"link",onClick:function(){new Promise((function(t,n){e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{ip:"192.168.2.2",port:5213},void 0,{resolve:t,reject:n})})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},"(re)Connect"),l.default.createElement(C.default,{type:"danger",key:"Disconnect uInsp",disabled:!this.props.uInspData.connected,icon:"disconnect",onClick:function(){new Promise((function(t,n){e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{},void 0,{resolve:t,reject:n})})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},"Disconnect"))," ",l.default.createElement(C.default,{key:"ping uInsp",disabled:!this.props.uInspData.connected,onClick:function(){new Promise((function(t,n){e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"PING",id:443}},void 0,{resolve:t,reject:n})})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},"PING:",this.props.uInspData.alive)," ",l.default.createElement(C.default,{key:"get_setup",disabled:!this.props.uInspData.connected,onClick:function(){new Promise((function(t,n){e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"get_setup",id:4423}},void 0,{resolve:t,reject:n})})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},"get_setup")," ",l.default.createElement(C.default,{key:"set_setup",disabled:void 0===this.props.uInspData.machineInfo,onClick:function(){var t=(0,_.default)(e.props.uInspData.machineInfo);new Promise((function(n,a){e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:i({},t,{type:"set_setup",id:356})},void 0,{resolve:n,reject:a})})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},"set_setup"),l.default.createElement(C.default,{key:"save_setup",disabled:void 0===this.props.uInspData.machineInfo,onClick:function(){var t=new TextEncoder;e.props.ACT_Report_Save(e.props.WS_ID,"data/uInspSetting.json",t.encode(JSON.stringify(e.props.uInspData.machineInfo,null,4)))}},"save_setup"),l.default.createElement(C.default,{key:"file_set_setup",disabled:void 0===this.props.uInspData.machineInfo,onClick:function(){new Promise((function(t,n){e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{filename:"data/uInspSetting.json"},void 0,{resolve:t,reject:n}),setTimeout((function(){return n("Timeout")}),5e3)})).then((function(t){if("FL"==t[0].type){var n=t[0].data;e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:i({},n,{type:"set_setup",id:356})})}})).catch((function(e){}))}},"file_set_setup"),l.default.createElement(O.default,{orientation:"left"},"SolveCalib"),"CurMea1: ",l.default.createElement(y.default,{size:"large",defaultValue:this.state.calibCalcInfo.curMea1,step:.001,onChange:function(t){return e.calibInfoUpdate({curMea1:t})}}),"  CalibMea1:",l.default.createElement(y.default,{size:"large",defaultValue:this.state.calibCalcInfo.calibMea1,step:.001,onChange:function(t){return e.calibInfoUpdate({calibMea1:t})}}),l.default.createElement("br",null),"CurMea2:",l.default.createElement(y.default,{size:"large",defaultValue:this.state.calibCalcInfo.curMea2,step:.001,onChange:function(t){return e.calibInfoUpdate({curMea2:t})}}),"  CalibMea2:",l.default.createElement(y.default,{size:"large",defaultValue:this.state.calibCalcInfo.calibMea2,step:.001,onChange:function(t){return e.calibInfoUpdate({calibMea2:t})}}),l.default.createElement("br",null),"--------------------------------",l.default.createElement("br",null),"MMPP:",v.mmpp,l.default.createElement("br",null),"OFFSET:",v.offset,l.default.createElement(c.BPG_FileBrowser,{key:"BPG_FileBrowser",searchDepth:4,path:a,visible:void 0!==this.state.fileSelectedCallBack,BPG_Channel:function(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.props).ACT_WS_SEND.apply(t,[e.props.WS_ID].concat(a))},onFileSelected:function(t,n){e.setState(i({},e.state,{fileSelectedCallBack:void 0})),e.state.fileSelectedCallBack(t,n)},onCancel:function(){e.setState(i({},e.state,{fileSelectedCallBack:void 0}))},fileFilter:this.state.fileSelectFilter}),l.default.createElement(c.BPG_FileSavingBrowser,{key:"BPG_FileSavingBrowser",searchDepth:4,path:a,visible:void 0!==this.state.fileSavingCallBack,defaultName:"",BPG_Channel:function(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.props).ACT_WS_SEND.apply(t,[e.props.WS_ID].concat(a))},onOk:function(t,n,a){e.state.fileSavingCallBack(t,n,a)},onCancel:function(){e.setState(i({},e.state,{fileSavingCallBack:void 0}))},fileFilter:this.state.fileSelectFilter})),onSelected:r},Collapse:{icon:this.state.menuCollapsed?"right":"left",content:null,onSelected:function(){return e.setState(i({},e.state,{menuCollapsed:!e.state.menuCollapsed}))}}},T=this.props.version_map_info,I=(0,g.GetObjElement)(T,["recommend_info","url"]);void 0!==I&&-1==I.indexOf()&&(k.UPDATE={icon:"cloud-download",content:null,onSelected:function(){window.location.href=I}}),t.push(l.default.createElement(w.default,{className:"HXF"},l.default.createElement(H,{trigger:null,collapsible:!0,collapsed:this.state.menuCollapsed},l.default.createElement(P.default,{theme:"dark",mode:"inline",defaultSelectedKeys:[this.state.menuSelect],onClick:function(e){return k[e.key].onSelected(e)}},Object.keys(k).map((function(e){return l.default.createElement(P.default.Item,{key:e},l.default.createElement(N.default,{type:k[e].icon}),l.default.createElement("span",null,e))})))),l.default.createElement(w.default,null,l.default.createElement(B,null,k[this.state.menuSelect].content))))}else n.state===S.UI_SM_STATES.DEFCONF_MODE?t=l.default.createElement(m.default,null):n.state===S.UI_SM_STATES.INSP_MODE?t=l.default.createElement(E.default,null):n.state===S.UI_SM_STATES.ANALYSIS_MODE&&(t=l.default.createElement(b.default,null));return l.default.createElement(u.CardFrameWarp,{addClass:"width12 height12",fixedFrame:!0},t)}}]),t}(l.default.Component),Z=(0,o.connect)((function(e){return{defModelName:e.UIData.edit_info.DefFileName,defFileTag:e.UIData.edit_info.DefFileTag,inspOptionalTag:e.UIData.edit_info.inspOptionalTag,defModelPath:e.UIData.edit_info.defModelPath,defModelHash:e.UIData.edit_info.DefFileHash,c_state:e.UIData.c_state,camera_calibration_report:e.UIData.edit_info.camera_calibration_report,isp_db:e.UIData.edit_info._obj,WS_CH:e.UIData.WS_CH,WS_ID:e.UIData.WS_ID,version_map_info:e.UIData.version_map_info,WebUI_info:e.UIData.WebUI_info,InspectionMonitor_URL:e.UIData.InspectionMonitor_URL,uInspData:e.Peripheral.uInsp}}),(function(e,t){return{EV_UI_Edit_Mode:function(t){e(S.EV_UI_Edit_Mode())},EV_UI_Insp_Mode:function(){e(S.EV_UI_Insp_Mode())},EV_UI_Analysis_Mode:function(){e(S.EV_UI_Analysis_Mode())},ACT_Def_Model_Path_Update:function(t){e(S.Def_Model_Path_Update(t))},ACT_MachTag_Update:function(t){e(v.MachTag_Update(t))},ACT_InspOptionalTag_Update:function(t){e(v.InspOptionalTag_Update(t))},ACT_WS_SEND:function(t,n,a,i,r,o){return e(S.EV_WS_SEND(t,n,a,i,r,o))},ACT_Report_Save:function(t,n,a){var i=S.EV_WS_SEND(t,"SV",0,{filename:n},a);console.log(i),e(i)}}}))($);t.default=Z},841:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(84),o=N(n(1)),s=N(n(210)),l=O(n(88)),c=N(n(852)),u=N(n(225)),d=n(43),p=N(n(43)),f=N(n(218)),_=(n(279),O(n(28))),h=O(n(55)),S=n(47),v=N(n(281)),m=O(n(37)),E=N(n(61)),b=N(n(116)),y=N(n(42)),g=N(n(133)),k=N(n(220)),T=N(n(79)),C=N(n(143)),I=N(n(480)),A=N(n(482)),D=N(n(89));function O(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function N(e){return e&&e.__esModule?e:{default:e}}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var U=l.BPG_FileBrowser,M=l.BPG_FileSavingBrowser,L=function(e){function t(e){return P(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return x(t,e),i(t,[{key:"ec_canvas_EmitEvent",value:function(e){switch(e.type){case h.EVENT.SUCCESS:this.props.ACT_SUCCESS();break;case h.EVENT.FAIL:this.props.ACT_Fail();break;case h.EVENT.Edit_Tar_Update:this.props.ACT_EDIT_TAR_UPDATE(e.data);break;case h.EVENT.Edit_Tar_Ele_Cand_Update:this.props.ACT_EDIT_TAR_ELE_CAND_UPDATE(e.data);break;case h.EVENT.Shape_List_Update:console.log(e),this.props.ACT_EDIT_SHAPELIST_UPDATE(e.data);break;case h.EVENT.Shape_Set:console.log(e),this.props.ACT_EDIT_SHAPE_SET(e.data);break;case h.EVENT.Edit_Tar_Ele_Trace_Update:this.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(e.data)}}},{key:"componentDidMount",value:function(){this.ec_canvas=new f.default.DEFCONF_CanvasComponent(this.refs.canvas),this.ec_canvas.EmitEvent=this.ec_canvas_EmitEvent.bind(this),this.props.onCanvasInit(this.ec_canvas),this.updateCanvas(this.props.c_state)}},{key:"componentWillUnmount",value:function(){this.ec_canvas.resourceClean()}},{key:"updateCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;void 0!==this.ec_canvas&&(this.ec_canvas.EditDBInfoSync(t.edit_info),this.ec_canvas.SetState(e),this.ec_canvas.draw())}},{key:"onResize",value:function(e,t){void 0!==this.ec_canvas&&(this.ec_canvas.resize(e,t),this.updateCanvas(this.props.c_state),this.ec_canvas.ctrlLogic(),this.ec_canvas.draw())}},{key:"componentWillUpdate",value:function(e,t){console.log("CanvasComponent render",e.c_state),console.log(e.edit_info.inherentShapeList),this.updateCanvas(e.c_state,e)}},{key:"render",value:function(){return o.default.createElement("div",{className:this.props.addClass+" HXF"},o.default.createElement("canvas",{ref:"canvas",className:"width12 HXF"}),o.default.createElement(u.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),t}(o.default.Component),R=(0,r.connect)((function(e){return{c_state:e.UIData.c_state,edit_info:e.UIData.edit_info}}),(function(e,t){return{ACT_SUCCESS:function(t){e(_.EV_UI_ACT(h.EVENT.SUCCESS))},ACT_Fail:function(t){e(_.EV_UI_ACT(h.EVENT.FAIL))},ACT_EXIT:function(t){e(_.EV_UI_ACT(_.UI_SM_EVENT.EXIT))},ACT_EDIT_TAR_UPDATE:function(t){e(h.Edit_Tar_Update(t))},ACT_EDIT_TAR_ELE_CAND_UPDATE:function(t){e(h.Edit_Tar_Ele_Cand_Update(t))},ACT_EDIT_SHAPELIST_UPDATE:function(t){e(h.Shape_List_Update(t))},ACT_EDIT_SHAPE_SET:function(t){e(h.Shape_Set(t))},ACT_EDIT_TAR_ELE_TRACE_UPDATE:function(t){e(h.Edit_Tar_Ele_Trace_Update(t))}}}))(L),F=(function(e){function t(e){P(this,t);var n=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}x(t,e),i(t,[{key:"dragStart",value:function(e){this.dragged=e.currentTarget,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.dragged)}},{key:"dragEnd",value:function(e){}},{key:"dragOver",value:function(e){e.preventDefault(),this.dragged.style.display="none","placeholder"!==e.target.className&&(this.over=e.target,e.target.parentNode.insertBefore(placeholder,e.target))}},{key:"render",value:function(){var e=this,t=this.props.items.map((function(t,n){var a=e.props.itemRenderer(t,n,"true",e.dragEnd.bind(e),e.dragStart.bind(e));return console.log(a),a}));return o.default.createElement("ul",{onDragOver:this.dragOver.bind(this)},t)}}])}(o.default.Component),function(e){function t(e){P(this,t);var n=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={OK:!1},n}return x(t,e),i(t,[{key:"render",value:function(){m.info(this.props);var e=this.props.target,t=(0,S.GetObjElement)(e.obj,e.keyTrace),n=o.default.createElement(y.default,{onClick:function(e){console.log(e)}},this.props.measure_list.map((function(e,t){return o.default.createElement(y.default.Item,{key:t},o.default.createElement("a",{target:"_blank",rel:"noopener noreferrer"},e.id))})));o.default.createElement(I.default,{overlay:n},o.default.createElement("a",{className:"HX1 layout palatte-blue-8 vbox width6",href:"#"},"aaa"));return o.default.createElement(T.default,{placeholder:t.exp,onChange:function(e){var t=(0,S.Exp2PostfixExp)(e.target.value);console.log(t)}})}}]),t}(o.default.Component)),j=function(e){function t(e){P(this,t);var n=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.ec_canvas=null,n.state={fileSelectedCallBack:void 0,fileSavingCallBack:void 0,modal_view:void 0},n}return x(t,e),i(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.edit_info.defModelPath;new Promise((function(n,a){e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{deffile:t+"."+d.DEF_EXTENSION,imgsrc:t},void 0,{resolve:n,reject:a}),setTimeout((function(){return a("Timeout")}),5e3)})).then((function(t){e.props.DISPATCH({type:"ATBundle",ActionThrottle_type:"express",data:t.map((function(e){return p.default.map_BPG_Packet2Act(e)})).filter((function(e){return void 0!==e}))})})).catch((function(e){m.info(e)}));var n=new S.websocket_autoReconnect("ws://hyv.decade.tw:8080/insert/def",1e4);this.WS_DEF_DB_Insert=new S.websocket_reqTrack(n),this.WS_DEF_DB_Insert.onreconnection=function(e){return m.info("onreconnection"+e),!(e>10)},this.WS_DEF_DB_Insert.onopen=function(){return m.info("WS_DEF_DB_Insert:onopen")},this.WS_DEF_DB_Insert.onmessage=function(e){return m.info("WS_DEF_DB_Insert:onmessage::",e)},this.WS_DEF_DB_Insert.onconnectiontimeout=function(){return m.info("WS_DEF_DB_Insert:onconnectiontimeout")},this.WS_DEF_DB_Insert.onclose=function(){return m.info("WS_DEF_DB_Insert:onclose")},this.WS_DEF_DB_Insert.onerror=function(){return m.info("WS_DEF_DB_Insert:onerror")}}},{key:"componentWillUnmount",value:function(){this.WS_DEF_DB_Insert.close(),this.props.ACT_ClearImage()}}]),i(t,[{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"genTarEditUI",value:function(e){var t=this;switch(e.type){case _.SHAPE_TYPE.aux_point:case _.SHAPE_TYPE.aux_line:case _.SHAPE_TYPE.search_point:case _.SHAPE_TYPE.measure:return o.default.createElement(l.JsonEditBlock,{object:e,dict:D.default,dictTheme:e.type,key:"BASE_COM.JsonEditBlock",whiteListKey:{id:"div",type:"div",subtype:"div",name:"input",angleDeg:"input-number",margin:"input-number",value:"input-number",USL:"input-number",LSL:"input-number",UCL:"input-number",LCL:"input-number",value_b:"input-number",USL_b:"input-number",LSL_b:"input-number",UCL_b:"input-number",LCL_b:"input-number",quadrant:"div",back_value_setup:"checkbox",docheck:"checkbox",width:"input-number",ref:a({__OBJ__:"div"},[0,1,2].reduce((function(e,t){return e[t+""]={__OBJ__:"btn",id:"div",element:"div"},e}),{})),ref_baseLine:{__OBJ__:"btn",id:"div",element:"div"}},jsonChange:function(e,n,a,i){if("btn"==a)"ref"!=n.keyTrace[0]&&"ref_baseLine"!=n.keyTrace[0]||t.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(n.keyTrace);else{var r=n.keyTrace[n.keyTrace.length-1];switch(a){case"input-number":var o=parseFloat(i.target.value);if(isNaN(o))return;if(n.obj[r]=o,void 0!==n.obj.value)switch(r){case"LSL":n.obj.LCL=(0,S.round)(n.obj.value+2*(n.obj.LSL-n.obj.value)/3,.001);break;case"USL":n.obj.UCL=(0,S.round)(n.obj.value+2*(n.obj.USL-n.obj.value)/3,.001);break;case"LSL_b":n.obj.LCL_b=(0,S.round)(n.obj.value_b+2*(n.obj.LSL_b-n.obj.value_b)/3,.001);break;case"USL_b":n.obj.UCL_b=(0,S.round)(n.obj.value_b+2*(n.obj.USL_b-n.obj.value_b)/3,.001)}break;case"input":n.obj[r]=i.target.value;break;case"checkbox":n.obj[r]=i.target.checked,"back_value_setup"==r&&(0==i.target.checked?(delete n.obj.value_b,delete n.obj.USL_b,delete n.obj.LSL_b,delete n.obj.UCL_b,delete n.obj.LCL_b):(n.obj.value_b=n.obj.value,n.obj.USL_b=n.obj.USL,n.obj.LSL_b=n.obj.LSL,n.obj.UCL_b=n.obj.UCL,n.obj.LCL_b=n.obj.LCL))}t.ec_canvas.SetShape(e,e.id)}}});default:return o.default.createElement(l.JsonEditBlock,{object:e,dict:D.default,dictTheme:e.type,key:"BASE_COM.JsonEditBlock",jsonChange:function(e,n,a,i){var r=n.keyTrace[n.keyTrace.length-1];"input-number"==a?n.obj[r]=parseFloat(i.target.value):"input"==a&&(n.obj[r]=i.target.value),console.log(n.obj);var o=e;t.ec_canvas.SetShape(o,o.id)},whiteListKey:{type:"div",subtype:"div",name:"input",margin:"input-number",direction:"input-number"}})}}},{key:"render",value:function(){var e=this,t=[],n="HXA";console.log("CanvasComponent render");var i=this.props.c_state.value[_.UI_SM_STATES.DEFCONF_MODE],r=this.props.edit_info.defModelPath;switch(i){case _.UI_SM_STATES.DEFCONF_MODE_NEUTRAL:n="HXA",t=[o.default.createElement(l.IconButton,{dict:D.default,key:"<",addClass:"layout black vbox",text:"<",onClick:function(){return e.props.ACT_EXIT()}}),o.default.createElement(l.JsonEditBlock,{object:{DefFileName:this.props.edit_info.DefFileName},dict:D.default,key:"this.props.edit_info.DefFileName",jsonChange:function(t,n,a,i){e.props.ACT_DefFileName_Update(i.target.value)},whiteListKey:{DefFileName:"input"}}),o.default.createElement(l.JsonEditBlock,{object:{DefFileTag:this.props.edit_info.DefFileTag.join(",")},dict:D.default,key:"this.props.edit_info.DefFileTag",jsonChange:function(t,n,a,i){e.props.ACT_DefFileTag_Update(i.target.value.split(","))},whiteListKey:{DefFileTag:"input"}}),o.default.createElement(l.IconButton,{dict:D.default,addClass:"layout palatte-blue-8 vbox",key:"LINE",text:"line",onClick:function(){return e.props.ACT_Line_Add_Mode()}}),o.default.createElement(l.IconButton,{dict:D.default,addClass:"layout palatte-blue-8 vbox",key:"ARC",text:"arc",onClick:function(){return e.props.ACT_Arc_Add_Mode()}}),o.default.createElement(l.IconButton,{dict:D.default,addClass:"layout palatte-blue-8 vbox",key:"APOINT",text:"apoint",onClick:function(){return e.props.ACT_Aux_Point_Add_Mode()}}),o.default.createElement(l.IconButton,{dict:D.default,addClass:"layout palatte-blue-8 vbox",key:"SPOINT",text:"spoint",onClick:function(){return e.props.ACT_Search_Point_Add_Mode()}}),o.default.createElement(l.IconButton,{iconType:"form",addClass:"layout palatte-blue-8",key:"MEASURE",dict:D.default,text:"measure",onClick:function(){return e.props.ACT_Measure_Add_Mode()}}),o.default.createElement(l.IconButton,{iconType:"edit",dict:D.default,addClass:"layout palatte-blue-5 vbox",key:"EDIT",text:"edit",onClick:function(){return e.props.ACT_Shape_Edit_Mode()}}),o.default.createElement(l.IconButton,{iconType:"save",dict:D.default,addClass:"layout palatte-gold-7 vbox",key:"SAVE",text:"save",onClick:function(){e.setState(a({},e.state,{fileSavingCallBack:function(t,n,i){var r=t.path+"/"+n.replace("."+d.DEF_EXTENSION,"");console.log(r);var o=new TextEncoder,s=e.props.edit_info._obj.GenerateFeature_sig360_circle_line(),l=e.props.edit_info.loadedDefFile;void 0===l&&(l={});var c=a({},l,{type:"binary_processing_group",intrusionSizeLimitRatio:e.props.edit_info.intrusionSizeLimitRatio,featureSet:[s]});delete c.featureSet_sha1,c.name=e.props.edit_info.DefFileName,c.tag=e.props.edit_info.DefFileTag,c.featureSet[0].matching_angle_margin_deg=e.props.edit_info.matching_angle_margin_deg,c.featureSet[0].matching_angle_offset_deg=e.props.edit_info.matching_angle_offset_deg,c.featureSet[0].matching_face=e.props.edit_info.matching_face;var u=v.default.digest(c.featureSet,"sha1","hex");c.featureSet[0].__decorator=e.props.Info_decorator,c.featureSet_sha1=u,e.props.ACT_DefFileHash_Update(u),c.featureSet_sha1_pre=e.props.edit_info.DefFileHash,void 0===e.props.edit_info.DefFileHash_root?void 0===e.props.edit_info.featureSet_sha1_pre?c.featureSet_sha1_root=u:c.featureSet_sha1_root=e.props.edit_info.featureSet_sha1_pre:c.featureSet_sha1_root=e.props.edit_info.DefFileHash_root,console.log("ACT_Report_Save"),e.props.ACT_Report_Save(e.props.WS_ID,r+"."+d.DEF_EXTENSION,o.encode(JSON.stringify(c,null,2))),console.log("ACT_Cache_Img_Save"),e.props.ACT_Cache_Img_Save(e.props.WS_ID,r),e.props.ACT_Def_Model_Path_Update(r),e.setState(a({},e.state,{fileSavingCallBack:void 0}));var p={dbcmd:{db_action:"insert"},data:c};e.WS_DEF_DB_Insert.send_obj(p).then((function(e){return console.log("then",e)})).catch((function(e){return console.log("catch",e)}))},fileSelectFooter:o.default.createElement("div",null,"ddd")}))}}),o.default.createElement(l.IconButton,{iconType:"export",dict:D.default,addClass:"layout palatte-gold-7 vbox",key:"LOAD",text:"load",onClick:function(){e.setState(a({},e.state,{fileSelectedCallBack:function(t){var n=t.replace("."+d.DEF_EXTENSION,"");console.log(n),e.props.ACT_Def_Model_Path_Update(n),e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{deffile:n+"."+d.DEF_EXTENSION,imgsrc:n}),e.setState(a({},e.state,{fileSelectedCallBack:void 0}))}}))}}),o.default.createElement(l.IconButton,{dict:D.default,iconType:"setting",addClass:"layout palatte-gray-8 vbox",key:"setting",text:"setting",onClick:function(){return e.setState(a({},e.state,{modal_view:{title:"Setup",view_update:function(){return[o.default.createElement(g.default,{checked:90==e.props.edit_info.matching_angle_margin_deg,onChange:function(t){90==e.props.edit_info.matching_angle_margin_deg?e.props.ACT_Matching_Angle_Margin_Deg_Update(180):e.props.ACT_Matching_Angle_Margin_Deg_Update(90)}},(0,S.dictLookUp)("matchingAngleLimit180",D.default)),o.default.createElement("br",null),o.default.createElement(g.default,{checked:1==e.props.edit_info.matching_face,onChange:function(t){1==e.props.edit_info.matching_face?e.props.ACT_Matching_Face_Update(0):e.props.ACT_Matching_Face_Update(1),console.log(t.target.checked)}},(0,S.dictLookUp)("matchingFaceFrontOnly",D.default)),o.default.createElement(C.default,{orientation:"left"},"IntrusionSizeLimitRatio"),o.default.createElement(A.default,{min:0,step:.01,max:1,included:!0,marks:{0:"",.01:"",.05:"",.1:"0.1",.3:"0.2",.5:"0.5",1:""},onChange:e.props.ACT_IntrusionSizeLimitRatio_Update,value:e.props.edit_info.intrusionSizeLimitRatio}),o.default.createElement(k.default,{min:0,max:1,value:e.props.edit_info.intrusionSizeLimitRatio,onChange:e.props.ACT_IntrusionSizeLimitRatio_Update})]}}}))}}),o.default.createElement(l.IconButton,{iconType:"camera",dict:D.default,addClass:"layout palatte-purple-8 vbox",key:"TAKE",text:"take",onClick:function(){e.setState(a({},e.state,{modal_view:{onOk:function(){new Promise((function(t,n){e.props.ACT_WS_SEND(e.props.WS_ID,"EX",0,{},void 0,{resolve:t,reject:n}),setTimeout((function(){return n("Timeout")}),3e3)})).then((function(t){e.props.DISPATCH({type:"ATBundle",ActionThrottle_type:"express",data:t.map((function(e){return p.default.map_BPG_Packet2Act(e)})).filter((function(e){return void 0!==e}))})})).catch((function(e){m.info(e)})),e.props.ACT_Shape_List_Reset()},onCancel:function(){console.log("onCancel")},title:"WARNING",view_update:function(){return"確定要重新設定嗎？"}}}))}})];var u=r.substr(0,r.lastIndexOf("/")+1);if(void 0!==this.state.fileSelectedCallBack&&t.push(o.default.createElement(U,{key:"BPG_FileBrowser",searchDepth:4,path:u,visible:void 0!==this.state.fileSelectedCallBack,BPG_Channel:function(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.props).ACT_WS_SEND.apply(t,[e.props.WS_ID].concat(a))},onFileSelected:function(t,n){e.state.fileSelectedCallBack(t,n)},onOk:function(e){console.log(e)},onCancel:function(){e.setState(a({},e.state,{fileSelectedCallBack:void 0}))},fileFilter:function(e){return"DIR"==e.type||e.name.includes("."+d.DEF_EXTENSION)}})),void 0!==this.state.fileSavingCallBack){var f=r.substr(r.lastIndexOf("/")+1);t.push(o.default.createElement(M,{key:"BPG_FileSavingBrowser",searchDepth:4,path:u,visible:void 0!==this.state.fileSavingCallBack,defaultName:f,BPG_Channel:function(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.props).ACT_WS_SEND.apply(t,[e.props.WS_ID].concat(a))},onOk:function(t,n,a){e.state.fileSavingCallBack(t,n,a)},onCancel:function(){e.setState(a({},e.state,{fileSavingCallBack:void 0}))},fileFilter:function(e){return"DIR"==e.type||e.name.includes("."+d.DEF_EXTENSION)}}))}break;case _.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:if(t=[o.default.createElement(l.Button,{addClass:"layout black vbox width4",key:"<",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"MEASURE",className:"s width8 lblue vbox"},"MEASURE")],null!=this.props.edit_tar_info){if(console.log("BASE_COM.JsonEditBlock:",this.props.edit_tar_info),t.push(o.default.createElement(l.JsonEditBlock,{object:this.props.edit_tar_info,dict:D.default,key:"BASE_COM.JsonEditBlock",whiteListKey:{name:"input",subtype:"div",calc_f:{__OBJ__:function(t){return o.default.createElement(F,a({},t,{measure_list:e.props.shape_list.filter((function(e){return e.type==_.SHAPE_TYPE.measure}))}))}},ref:a({__OBJ__:"div"},[0,1,2,3,4,5,6,7,8,9].reduce((function(e,t){return e[t+""]={__OBJ__:"btn",id:"div",element:"div"},e}),{})),ref_baseLine:{__OBJ__:"btn",id:"div",element:"div"}},jsonChange:function(t,n,a,i){if(console.log(n),"btn"==a)"ref"!=n.keyTrace[0]&&"ref_baseLine"!=n.keyTrace[0]||e.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(n.keyTrace);else{var r=n.keyTrace[n.keyTrace.length-1];"input-number"==a?n.obj[r]=parseFloat(i.target.value):"input"==a&&(n.obj[r]=i.target.value),e.ec_canvas.SetShape(t,t.id)}}})),this.props.edit_tar_info.subtype==_.SHAPE_TYPE.measure_subtype.NA)for(var h in _.SHAPE_TYPE.measure_subtype)"NA"!=h&&t.push(o.default.createElement(l.IconButton,{dict:D.default,key:"MSUB__"+h,addClass:"layout red vbox",text:h,onClick:function(t,n){console.log(n.props.text),e.props.ACT_EDIT_TAR_ELE_CAND_UPDATE(n.props.text)}}));var y=this.props.edit_tar_info;if(console.log(y.ref),void 0!==y.ref){var T=!1;y.ref.forEach((function(e){void 0===e.id&&(T=!0)})),T||t.push(o.default.createElement(l.Button,{key:"ADD_BTN",addClass:"layout red vbox",text:"ADD",onClick:function(){e.ec_canvas.SetShape(e.props.edit_tar_info),e.props.ACT_SUCCESS()}}))}}break;case _.UI_SM_STATES.DEFCONF_MODE_LINE_CREATE:t=[o.default.createElement(l.IconButton,{dict:D.default,addClass:"layout black vbox width4",key:"<",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"LINE",className:"s width8 lred vbox"},"LINE")];break;case _.UI_SM_STATES.DEFCONF_MODE_ARC_CREATE:t=[o.default.createElement(l.IconButton,{dict:D.default,addClass:"layout black vbox width4",key:"<",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"ARC",className:"s width8 lred vbox"},"ARC")];break;case _.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:if(t=[o.default.createElement(l.IconButton,{dict:D.default,addClass:"layout black vbox",key:"<",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"SEARCH_POINT",className:"s lred vbox"},"SPOINT")],null!=this.props.edit_tar_info)console.log("BASE_COM.JsonEditBlock:",this.props.edit_tar_info),t.push(this.genTarEditUI(this.props.edit_tar_info)),void 0!==this.props.edit_tar_info.ref[0].id&&t.push(o.default.createElement(l.Button,{key:"ADD_BTN",addClass:"layout red vbox",text:"ADD",onClick:function(){e.ec_canvas.SetShape(e.props.edit_tar_info),e.props.ACT_SUCCESS()}}));break;case _.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:if(t=[o.default.createElement(l.Button,{addClass:"layout black vbox",key:"<",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"AUX_POINT",className:"s lred vbox"},"APOINT")],null!=this.props.edit_tar_info){console.log("BASE_COM.JsonEditBlock:",this.props.edit_tar_info),t.push(this.genTarEditUI(this.props.edit_tar_info));var I=this.props.edit_tar_info;console.log(I.ref),void 0!==I.ref[0].id&&void 0!==I.ref[1].id&&I.ref[0].id!=I.ref[1].id&&t.push(o.default.createElement(l.Button,{key:"ADD_BTN",addClass:"layout red vbox",text:"ADD",onClick:function(){e.ec_canvas.SetShape(e.props.edit_tar_info),e.props.ACT_SUCCESS()}}))}break;case _.UI_SM_STATES.DEFCONF_MODE_AUX_LINE_CREATE:if(t=[o.default.createElement(l.Button,{addClass:"layout black vbox",key:"<",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"AUX_POINT",className:"s lred vbox"},"ALINE")],console.log("BASE_COM.JsonEditBlock:",this.props.edit_tar_info),null!=this.props.edit_tar_info){console.log("BASE_COM.JsonEditBlock:",this.props.edit_tar_info),t.push(this.genTarEditUI(this.props.edit_tar_info));var O=this.props.edit_tar_info;console.log(O.ref),void 0!==O.ref[0].id&&void 0!==O.ref[1].id&&O.ref[0].id!=O.ref[1].id&&t.push(o.default.createElement(l.Button,{key:"ADD_BTN",addClass:"layout red vbox",text:"ADD",onClick:function(){e.ec_canvas.SetShape(e.props.edit_tar_info),e.props.ACT_SUCCESS()}}))}break;case _.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(t=[o.default.createElement(l.Button,{key:"<",addClass:"layout black vbox width4",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"EDIT_Text",className:"s width8 lblue vbox"},"EDIT"),o.default.createElement("div",{key:"HLINE",className:"s HX0_1"})],null!=this.props.edit_tar_info){t.push(this.genTarEditUI(this.props.edit_tar_info));void 0!==this.props.edit_tar_info.id&&(t.push(o.default.createElement(l.Button,{key:"COPY_BTN",addClass:"layout blue vbox",text:"COPY",onClick:function(){return t=e.props.edit_tar_info,(n=(0,E.default)(t)).id=void 0,console.log(n),["pt1","pt2","pt3"].forEach((function(e){void 0!==n[e]&&(n[e].x+=1,n[e].y+=1)})),n.name+="_copy",void e.ec_canvas.SetShape(n,void 0);var t,n}})),t.push(o.default.createElement(l.Button,{key:"DEL_BTN",addClass:"layout red vbox",text:"DEL",onClick:function(){var t=e.props.edit_tar_info,n="確定要刪除:"+t.name+" ?",i=e.props.edit_info._obj.FindShapeRefTree(t.id),r=e.props.edit_info._obj.FlatRefTree(i);0!==(r=r.filter((function(t){return e.props.shape_list.find((function(e){return e.id==t.id}))}))).length&&(n=o.default.createElement("div",null,n,o.default.createElement("br",null),"相關連之物件如下",r.map((function(e){return[o.default.createElement("br",null),e.shape.name]})))),console.log(i,r),e.setState(a({},e.state,{modal_view:{title:"WARNING",onOk:function(){var n;n=t.id,e.ec_canvas.SetShape(null,n),console.log("onOK")},onCancel:function(){console.log("onCancel")},view_update:function(){return n}}}))}})))}else{console.log(this.props.shape_list);var N=this.props.shape_list;console.log(this.props.Info_decorator.list_id_order),this.props.Info_decorator.list_id_order.length==N.length&&(N=this.props.Info_decorator.list_id_order.map((function(t){return e.props.shape_list.find((function(e){return e.id==t}))}))),t.push(o.default.createElement("div",{className:"s HXA"},o.default.createElement(c.default,{items:N.map((function(t,n){return{content:o.default.createElement("div",{key:"shape_listing_"+t.id,className:"button lred",style:{height:"40px"},onClick:function(){return e.props.ACT_EDIT_TAR_UPDATE(t)}},t.name),shape_id:t.id}})),onSort:function(t){var n=t.map((function(e){return e.shape_id}));e.props.ACT_Shape_Decoration_ID_Order_Update(n),console.log("onSort",t,n)},dropBackTransitionDuration:.3,type:"vertical"})))}}return console.log("APP_DEFCONF_MODE render"),o.default.createElement("div",{className:"overlayCon HXF"},o.default.createElement(b.default,a({},this.state.modal_view,{visible:void 0!==this.state.modal_view,onCancel:function(t){void 0!==e.state.modal_view.onCancel&&e.state.modal_view.onCancel(t),e.setState(a({},e.state,{modal_view:void 0}))},onOk:function(t){void 0!==e.state.modal_view.onOk&&e.state.modal_view.onOk(t),e.setState(a({},e.state,{modal_view:void 0}))}}),void 0===this.state.modal_view?null:this.state.modal_view.view_update()),o.default.createElement(R,{addClass:"layout width12",onCanvasInit:function(t){e.ec_canvas=t}}),o.default.createElement(s.default,{transitionName:"fadeIn"},o.default.createElement("div",{key:i,className:"s overlay scroll shadow1 MenuAnim "+n},t)))}}]),t}(o.default.Component),W=(0,r.connect)((function(e){return{c_state:e.UIData.c_state,edit_tar_info:e.UIData.edit_info.edit_tar_info,shape_list:e.UIData.edit_info.list,Info_decorator:e.UIData.edit_info.__decorator,WS_ID:e.UIData.WS_ID,edit_info:e.UIData.edit_info}}),(function(e,t){return{ACT_Line_Add_Mode:function(t){e(_.EV_UI_ACT(_.UI_SM_EVENT.Line_Create))},ACT_Arc_Add_Mode:function(t){e(_.EV_UI_ACT(_.UI_SM_EVENT.Arc_Create))},ACT_Search_Point_Add_Mode:function(t){e(_.EV_UI_ACT(_.UI_SM_EVENT.Search_Point_Create))},ACT_Aux_Point_Add_Mode:function(t){e(_.EV_UI_ACT(_.UI_SM_EVENT.Aux_Point_Create))},ACT_Aux_Line_Add_Mode:function(t){e(_.EV_UI_ACT(_.UI_SM_EVENT.Aux_Line_Create))},ACT_Shape_Edit_Mode:function(t){e(_.EV_UI_ACT(_.UI_SM_EVENT.Shape_Edit))},ACT_Measure_Add_Mode:function(t){e(_.EV_UI_ACT(_.UI_SM_EVENT.Measure_Create))},ACT_DefFileName_Update:function(t){e(h.DefFileName_Update(t))},ACT_DefFileTag_Update:function(t){e(h.DefFileTag_Update(t))},ACT_EDIT_TAR_ELE_TRACE_UPDATE:function(t){e(h.Edit_Tar_Ele_Trace_Update(t))},ACT_EDIT_TAR_ELE_CAND_UPDATE:function(t){e(h.Edit_Tar_Ele_Cand_Update(t))},ACT_EDIT_TAR_UPDATE:function(t){e(h.Edit_Tar_Update(t))},ACT_Shape_List_Reset:function(){e(h.Shape_List_Update([]))},ACT_Save_Def_Config:function(t){e(_.EV_UI_EC_Save_Def_Config(t))},ACT_Load_Def_Config:function(t){e(_.EV_UI_EC_Load_Def_Config(t))},ACT_SUCCESS:function(t){e(_.EV_UI_ACT(h.EVENT.SUCCESS))},ACT_Fail:function(t){e(_.EV_UI_ACT(h.EVENT.FAIL))},ACT_EXIT:function(t){e(_.EV_UI_ACT(_.UI_SM_EVENT.EXIT))},ACT_Def_Model_Path_Update:function(t){e(_.Def_Model_Path_Update(t))},ACT_WS_SEND:function(){return e(_.EV_WS_SEND.apply(_,arguments))},ACT_ClearImage:function(){e(_.EV_WS_Image_Update(null))},ACT_Shape_Decoration_ID_Order_Update:function(t){e(h.Shape_Decoration_ID_Order_Update(t))},ACT_Matching_Angle_Margin_Deg_Update:function(t){e(h.Matching_Angle_Margin_Deg_Update(t))},ACT_Matching_Face_Update:function(t){e(h.Matching_Face_Update(t))},ACT_IntrusionSizeLimitRatio_Update:function(t){e(h.IntrusionSizeLimitRatio_Update(t))},ACT_DefFileHash_Update:function(t){e(h.DefFileHash_Update(t))},ACT_Report_Save:function(t,n,a){var i=_.EV_WS_SEND(t,"SV",0,{filename:n},a);console.log(i),e(i)},ACT_Cache_Img_Save:function(t,n){e(_.EV_WS_SEND(t,"SV",0,{filename:n,type:"__CACHE_IMG__"}))},ACT_SIG360_Extraction:function(t){return e(_.EV_WS_SIG360_Extraction(t))},DISPATCH:function(t){e(t)}}}))(j);t.default=W},88:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwitchButton=t.ImgSprite=t.Button=t.IconButton=t.AButton=t.DropDown=t.BPG_FileBrowser_proto=t.BPG_FolderBrowser=t.BPG_FileSavingBrowser=t.BPG_FileBrowser=t.DropDownWarp=t.CardFrameWarp=t.JsonEditBlock=t.JsonElement=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=m(n(1)),s=m(n(545)),l=n(47),c=m(n(61)),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(37)),d=m(n(89)),p=m(n(38)),f=m(n(116)),_=m(n(175)),h=m(n(15)),S=m(n(42)),v=m(n(79));function m(e){return e&&e.__esModule?e:{default:e}}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=p.default.Group,k=u.getLogger("baseComponent"),T=t.JsonElement=function(e){function t(){return E(this,t),b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,e),r(t,[{key:"render",value:function(){return void 0!==this.props.type.type?this.renderComplex():this.renderSimple()}},{key:"renderComplex",value:function(){switch(this.props.type.type){case"droplist":return o.default.createElement("div",{key:this.props.id,className:this.props.className},this.props.children)}}},{key:"renderSimple",value:function(){var e=this,t=this.props.children,n=void 0;switch("div"==this.props.type&&void 0===(n=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,t]))&&(n=(0,l.GetObjElement)(this.props.dict,["fallback",t])),void 0===n&&(n=t),this.props.type){case"input-number":return n+="",o.default.createElement("input",{key:this.props.id,className:this.props.className,type:"number",step:"0.1",pattern:"^[-+]?[0-9]*(\\.[0-9]*)?",value:n,onChange:function(t){return e.props.onChange(e.props.target,e.props.type,t)}});case"input":return o.default.createElement("input",{key:this.props.id,className:this.props.className,value:n,onChange:function(t){return e.props.onChange(e.props.target,e.props.type,t)}});case"checkbox":return o.default.createElement("input",{key:this.props.id,className:this.props.className,type:"checkbox",checked:n,onChange:function(t){return e.props.onChange(e.props.target,e.props.type,t)}});case"btn":return o.default.createElement("button",{key:this.props.id,className:this.props.className,onClick:function(t){return e.props.onChange(e.props.target,e.props.type,t)}},n);case"div":default:return void 0!==this.props.renderLib&&void 0!==this.props.renderLib[this.props.type]?(0,this.props.renderLib[this.props.type])(this.props):o.default.createElement("div",{key:this.props.id,className:this.props.className},n," ")}}}]),t}(o.default.Component),C=(t.JsonEditBlock=function(e){function t(e){E(this,t);var n=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.tmp={object:{}},n}return y(t,e),r(t,[{key:"onChangeX",value:function(e,t,n){return this.props.jsonChange(this.tmp.object,e,t,n),!0}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"composeObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=[],s=null==t?e:t;for(var c in s){var u=e[c],d=null==t?null:t[c];if(void 0!==u&&void 0!==d){var p=a.slice();p.push(c);var f=void 0;void 0===(f=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,c]))&&(f=(0,l.GetObjElement)(this.props.dict,["fallback",c])),void 0===f&&(f=c);var _=void 0;if("function"==typeof d.__OBJ__?_=d.__OBJ__:void 0!==this.props.renderLib&&"function"==typeof this.props.renderLib[d.__OBJ__]&&(_=this.props.renderLib[d.__OBJ__]),void 0===_)switch(void 0===u?"undefined":i(u)){case"string":case"boolean":case"number":null==d&&(d="div"),r.push(o.default.createElement("div",{key:n+"_"+c+"_txt",className:"s HX1 width4 vbox black"},f)),r.push(o.default.createElement(T,{key:n+"_"+c+"_ele",className:"s HX1 width8 vbox blackText",type:d,target:{obj:e,keyTrace:p},dict:this.props.dict,onChange:this.onChangeX.bind(this)},u));break;case"object":r.push(o.default.createElement("div",{key:n+"_"+c+"_HL",className:"s HX0_1 WXF  vbox"}));var h=null==d?"div":d.__OBJ__;null==h&&(h="div"),r.push(o.default.createElement(T,{key:n+"_"+c+"_ele",dict:this.props.dict,className:"s HX1 WXF vbox black",type:h,onChange:this.onChangeX.bind(this),target:{obj:e,keyTrace:p}},f)),r.push(o.default.createElement("div",{key:n+"_"+c+"__",className:"s HX1 width1"})),r.push(o.default.createElement("div",{key:n+"_"+c+"_C",className:"s HXA width11"},this.composeObject(u,d,n+"_"+c,p))),r.push(o.default.createElement("div",{key:n+"_"+c+"_HL2",className:"s HX0_1 WXF  vbox"}));break;default:r.push(o.default.createElement("div",{key:n+"_"+c+"_txt",className:"s HX1 width3 vbox black"},c)),r.push(o.default.createElement("div",{key:n+"_"+c+"_XXX",className:"s HX1 width9 vbox lblue"},"Not supported"))}else r.push(_({className:"s WXF vbox black",onChange:this.onChangeX.bind(this),target:{obj:e,keyTrace:p},displayMethod:d}))}}return r}},{key:"render",value:function(){this.tmp.object=(0,c.default)(this.props.object);var e=this.composeObject(this.tmp.object,this.props.whiteListKey);return o.default.createElement("div",{className:"WXF HXA"},e)}}]),t}(o.default.Component),t.CardFrameWarp=(0,s.default)({getDefaultProps:function(){return{boxShadow:"1px 2px 10px #000",addClass:""}},render:function(){var e=this.props.fixedFrame?"HXF":"HXA",t=this.props.addClass+(this.props.fixedFrame?"":" HXA");return o.default.createElement("div",{className:"padding "+t},o.default.createElement("div",{className:e+" white padding ",style:{boxShadow:this.props.boxShadow}},this.props.children))}})),I=t.DropDownWarp=(0,s.default)({render:function(){var e="HXA dropDownContent "+(this.props.ifShowDropDown?"":"hide ")+this.props.dropdownClass;return o.default.createElement("div",{className:"dropDown "+this.props.containerClass},this.props.children[0],o.default.createElement("div",{className:e,style:this.props.dropdownStyle},this.props.children.slice(1,this.props.children.length)))}}),A=(t.BPG_FileBrowser=function(e){function t(){return E(this,t),b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,e),r(t,[{key:"render",value:function(){return o.default.createElement(A,a({},this.props,{footer:null}))}}]),t}(o.default.Component),t.BPG_FileSavingBrowser=function(e){function t(e){E(this,t);var n=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fileName:void 0===e.defaultName?"":e.defaultName,folderInfo:void 0},n}return y(t,e),r(t,[{key:"isASCII",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(t?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(e)}},{key:"render",value:function(){var e=this,t=null!=this.state.folderInfo&&void 0!==this.state.folderInfo.files.find((function(t){return t.name==e.state.fileName}));return console.log(t),o.default.createElement(A,a({},this.props,{onFileSelected:function(t){var n=t.substr(t.lastIndexOf("/")+1);e.setState(a({},e.state,{fileName:n}))},footer:o.default.createElement("div",null,o.default.createElement(v.default,{className:"width9",placeholder:"File Name",value:this.state.fileName,onChange:function(t){var n=t.target.value;e.isASCII(n)&&e.setState(a({},e.state,{fileName:n}))}}),o.default.createElement(g,{className:"width2"},o.default.createElement(p.default,{onClick:this.props.onCancel},"Cancel"),o.default.createElement(p.default,{onClick:function(){return e.props.onOk(e.state.folderInfo,e.state.fileName,t)},type:t?"danger":"primary",disabled:0==this.state.fileName.length||void 0===this.state.folderInfo},"OK"))),onFolderLoaded:function(t){e.setState(a({},e.state,{folderInfo:t}))}}))}}]),t}(o.default.Component),t.BPG_FolderBrowser=function(e){function t(){return E(this,t),b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,e),r(t,[{key:"render",value:function(){return o.default.createElement(A,a({},this.props,{footer:null}))}}]),t}(o.default.Component),t.BPG_FileBrowser_proto=function(e){function t(e){E(this,t);var n=b(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={folderStruct:{},history:["./"],searchText:void 0,searchFolderStruct:void 0,selectedFileGroupInfo:void 0},n}return y(t,e),r(t,[{key:"fetchDirFiles",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise((function(a,i){t.props.BPG_Channel("FB",0,{path:e,depth:n},void 0,{resolve:a,reject:i}),setTimeout((function(){return i("Timeout")}),5e3)}))}},{key:"goDir",value:function(e){var t=this;if(void 0===e){if(this.state.history.length<=1)return;this.state.history.pop(),e=this.state.history[this.state.history.length-1]}else{if(e==this.state.history[this.state.history.length-1])return void console.log(">>>>>");this.state.history.push(e)}this.fetchDirFiles(e).then((function(e){console.log("fetchDirFiles OK:",e);var n={};e[1].data.ACK&&(n=e[0].data),t.setState(a({},t.state,{folderStruct:n,searchText:void 0,searchFolderStruct:void 0})),void 0!==t.props.onFolderLoaded&&t.props.onFolderLoaded(n)})).catch((function(e){console.log("fetchDirFiles exception",e),t.setState(a({},t.state,{folderStruct:[]})),void 0!==t.props.onFolderLoaded&&t.props.onFolderLoaded({})}))}},{key:"componentWillMount",value:function(){this.goDir(this.props.path)}},{key:"componentDidUpdate",value:function(e){1==this.props.visible&&0==e.visible&&this.goDir(this.props.path)}},{key:"bytesToSize",value:function(e){if(0==e)return"0 Byte";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t]}},{key:"fList",value:function(e,t){var n=this;if(void 0===e||void 0===e.files)return[];var a=e.files;return void 0!==t&&(a=a.filter(t)),a.forEach((function(t){t.key=t.path=e.path+"/"+t.name,t.size=n.bytesToSize(t.size_bytes)})),a=e.files.reduce((function(e,a){return"DIR"!=a.type?e:e.concat(n.fList(a.struct,t))}),a)}},{key:"render",value:function(){var e,t=this,n=[],a=void 0,i=[],r=void 0,s="width10";if(void 0!==this.state.searchText&&this.state.searchText.length>0)(i=["type","name","path"].map((function(e){return{title:e,dataIndex:e,key:e}})))[0].render=function(e,t){var n="DIR"==e?"folder":"file";return o.default.createElement(h.default,{type:n})},i[0].width=64,r=null==this.state.selectedFileGroupInfo?this.fList(this.state.searchFolderStruct,(function(e){return"."!=e.name&&".."!=e.name&&e.name.includes(t.state.searchText)&&(void 0===t.props.fileFilter||t.props.fileFilter(e))})):this.state.selectedFileGroupInfo.filter((function(e){return"."!=e.name&&".."!=e.name&&e.name.includes(t.state.searchText)&&(void 0===t.props.fileFilter||t.props.fileFilter(e))})),console.log(this.state.selectedFileGroupInfo,r),s="width12";else if(void 0!==this.state.selectedFileGroupInfo)(i=["type","name","path"].map((function(e){return{title:e,dataIndex:e,key:e}})))[0].render=function(e,t){var n="DIR"==e?"folder":"file";return o.default.createElement(h.default,{type:n})},i[0].width=64,r=this.state.selectedFileGroupInfo,s="width10";else{(i=["type","name","size"].map((function(e){return{title:e,dataIndex:e,key:e}})))[0].render=function(e,t){var n="DIR"==e?"folder":"file";return o.default.createElement(h.default,{type:n})},i[0].width=64,r=this.fList(this.state.folderStruct,(function(e){return"."!=e.name&&".."!=e.name&&(void 0===t.props.fileFilter||t.props.fileFilter(e))}));var l="string"==typeof this.state.folderStruct.path?this.state.folderStruct.path.replace(/\\+/g,"/").split("/"):[];(l=l.map((function(e){return{name:e}}))).reduce((function(e,t){return e=e+t.name+"/",t.path=e,e}),""),a=o.default.createElement("div",null,o.default.createElement(g,null,o.default.createElement(p.default,{type:"primary",onClick:function(){return t.goDir()}},o.default.createElement(h.default,{type:"left"}))),"   ",o.default.createElement(g,null,l.map((function(e,n){return o.default.createElement(p.default,{key:e.name+"_"+n,onClick:function(){return t.goDir(e.path)}},e.name)}))))}if("width12"!==s){var c=void 0===this.props.fileGroups?[]:[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this.props.fileGroups));c.push({name:"origin",path:"./"}),n.push(o.default.createElement("div",{className:"s height12 width2 scroll",key:"sideMenu"},o.default.createElement(S.default,{onClick:function(e){if(void 0===e.item.props.list)t.setState({selectedFileGroupInfo:void 0}),void 0!==e.item.props.path&&t.goDir(e.item.props.path);else{var n=e.item.props.list;void 0===t.state.selectedFileGroupInfo?t.setState({selectedFileGroupInfo:n}):t.setState({selectedFileGroupInfo:void 0})}},mode:"inline"},c.map((function(e,t){return o.default.createElement(S.default.Item,{key:e.name+"_"+t,path:e.path,list:e.list},e.name)})))))}return e=o.default.createElement("div",null,a,this.props.searchDepth>=0||void 0===this.props.searchDepth?o.default.createElement(v.default.Search,{key:"Search",className:"width3",allowClear:!0,disable:!0,size:"small",value:this.state.searchText,placeholder:"Search",onChange:function(e){if(void 0===t.state.searchFolderStruct){t.state.searchFolderStruct={};var n=t.state.folderStruct.path;t.fetchDirFiles(n,t.props.searchDepth).then((function(e){var n={};e[1].data.ACK&&(n=e[0].data),t.setState({searchFolderStruct:n})})).catch((function(e){t.setState({searchFolderStruct:void 0})}))}t.setState({searchText:e.target.value})}}):null),n.push(o.default.createElement("div",{className:"height12 scroll "+s,key:"folderView"},o.default.createElement(_.default,{key:"fileList",onRow:function(e){return{onClick:function(n){console.log(n),"DIR"!=e.type?t.props.onFileSelected(e.path,e):t.goDir(e.path),t.setState({selectedFileGroupInfo:void 0})}}},pagination:!1,columns:i,dataSource:r}))),o.default.createElement(f.default,{title:e,visible:this.props.visible,width:void 0===this.props.width?900:this.props.width,onCancel:this.props.onCancel,onOk:this.props.onOk,footer:this.props.footer},o.default.createElement("div",{style:{height:void 0===this.props.height?400:this.props.height}},n))}}]),t}(o.default.Component)),D=(t.DropDown=(0,s.default)({handleClick:function(e,t){this.props.onClick(e,t)},shouldComponentUpdate:function(e,t){return e!=this.props},render:function(){var e=[],t=!0,n=!1,a=void 0;try{for(var i,r=this.props.dropMenu[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value,l=[],c=!0,u=!1,d=void 0;try{for(var p,f=s.ele[Symbol.iterator]();!(c=(p=f.next()).done);c=!0){var _=p.value;l.push(o.default.createElement(D,{addClass:" textAlignLeft dropDownBtn",key:_.id,id:_.id,text:_.text,onClick:s.callBack}))}}catch(e){u=!0,d=e}finally{try{!c&&f.return&&f.return()}finally{if(u)throw d}}var h="black HX"+s.ele.length+" ";e.push(o.default.createElement("div",{key:s.id+"_div"},o.default.createElement("div",{key:s.text,className:h+"width1 rotateContent"},o.default.createElement("p",null,s.text)),o.default.createElement("div",{key:s.id+"_block",className:h+"width11"},l))),e.push(o.default.createElement("div",{key:s.id+"_",className:"black HX0_1 "}))}}catch(e){n=!0,a=e}finally{try{!t&&r.return&&r.return()}finally{if(n)throw a}}return o.default.createElement(I,{containerClass:this.props.className,ifShowDropDown:this.props.ifShowDropDown,dropdownClass:"aniFlipin",dropdownStyle:{width:"300px"}},o.default.createElement(D,{addClass:"HXF lgreen",text:"...",onClick:this.handleClick}),o.default.createElement(C,{boxShadow:"1px 2px 20px #333"},e))}}),t.AButton=(0,s.default)({handleClick:function(e){this.props.onClick(e,this)},render:function(){var e=void 0;return void 0===(e=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,this.props.text]))&&(e=(0,l.GetObjElement)(this.props.dict,["fallback",this.props.text])),void 0===e&&(e=this.props.text),o.default.createElement(p.default,{block:!0,type:this.props.type,shape:"round",icon:this.props.icon,size:this.props.size,dict:d.default,onClick:this.handleClick},e)}}),t.IconButton=(0,s.default)({handleClick:function(e){this.props.onClick(e,this)},render:function(){k.debug(this.props),k.debug(this.context);var e="button s "+this.props.addClass,t=void 0;return void 0!==this.props.dict&&void 0===(t=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,this.props.text]))&&(t=(0,l.GetObjElement)(this.props.dict,["fallback",this.props.text])),void 0===t&&(t=this.props.text),o.default.createElement("div",{onClick:this.handleClick,className:e},void 0===this.props.iconType?null:o.default.createElement(h.default,{className:"layout iconButtonSize veleY",type:this.props.iconType}),o.default.createElement("p",{className:"layout veleY iconTextPadding"},t))}}),t.Button=(0,s.default)({handleClick:function(e){this.props.onClick(e,this)},render:function(){var e="button s vbox "+this.props.addClass;return o.default.createElement("div",{onClick:this.handleClick,className:e},o.default.createElement("p",null,this.props.text))}}));t.ImgSprite=(0,s.default)({shouldComponentUpdate:function(e,t){return e.position!=this.props.position||e.id!=this.props.id||e.style!=this.props.style||e.offset!=this.props.offset},render:function(){var e=this.props.spriteInfo,t=null!=this.props.spriteScale?this.props.spriteScale:1,n=null!=this.props.offset?this.props.offset:{x:0,y:0},a=-this.props.id%e.xLimit,i=-Math.floor(this.props.id/e.xLimit),r=Object.assign({},this.props.style,{width:e.sWidth*t+"px",height:e.sHeight*t+"px",background:"url("+e.url+") "+(n.x+e.sWidth*a)*t+"px "+(n.y+e.sHeight*i)*t+"px",backgroundSize:e.width*t+"px "+e.height*t+"px"});return o.default.createElement("div",{style:r,className:this.props.className})}}),t.SwitchButton=(0,s.default)({handleClick:function(e){this.props.onClick(e,this)},render:function(){var e="lgray vbox "+this.props.addClass;return o.default.createElement("button",{onClick:this.handleClick,className:e},o.default.createElement("p",null,this.props.text))}})},89:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={fallback:{ReconnectAirDevice:"重新連接噴氣裝置",line:"線段/Line",arc:"弧/Arc",spoint:"搜尋點/SPOINT",search_point:"搜尋點",apoint:"交點/APOINT",aux_point:"交點","<":"< 返回",measure:"測量定義/MEASURE",edit:"編輯測量定義/Edit",save:"儲存定義/SAVE",load:"讀取定義/LOAD",take:"重新設定/TAKE",type:"類型",subtype:"次類型",value:"出貨目標",margin:"範圍",submargin1:"生產目標",margin2:"次範圍",direction:"方向",angleDeg:"角度°",width:"寬",ref:"參考物件",ref_baseLine:"參考線",id:"編號",sigma:"標準差",distance:"距離/D",angle:"角度/A",radius:"半徑/R",calc:"計算/C",name:"名稱",docheck:"必要判定",DefFileName:"設定檔名",DefFileTag:"標籤","Info Graphs":"資料圖表",matchingAngleLimit180:"角度限制180",matchingFaceFrontOnly:"僅正面",setting:"設定"},measure:{back_value_setup:"背面目標設定",value_b:"目標(背)",USL_b:"規格上限(背)",LSL_b:"規格下限(背)",UCL_b:"管制上限(背)",LCL_b:"管制下限(背)",value:"目標",USL:"規格上限",LSL:"規格下限",UCL:"管制上限",LCL:"管制下限",docheck:"必要判定",quadrant:"量測象限"}}},948:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InspectionResultDisplay_FullScren=t.OK_NG_BOX_COLOR_TEXT=void 0;var a,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(84),l=W(n(1)),c=W(n(210)),u=j(n(88)),d=W(n(225)),p=n(444),f=W(n(61)),_=W(n(218)),h=n(28),S=j(h),v=n(47),m=W(n(89)),E=n(193),b=n(43),y=j(n(37)),g=j(n(55)),k=W(n(949)),T=W(n(957)),C=W(n(482)),I=W(n(175)),A=W(n(958)),D=W(n(139)),O=(W(n(79)),W(n(220))),N=W(n(191)),P=W(n(38)),w=W(n(42)),x=W(n(15)),U=W(n(143)),M=W(n(490));n(1001);var L=W(n(116)),R=W(n(480)),F=W(n(498));function j(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function W(e){return e&&e.__esModule?e:{default:e}}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function G(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var V=n(1014),X=y.getLogger("InspectionUI"),Y=F.default.Paragraph,K=(F.default.Title,P.default.Group),J=N.default.Option,Q=(l.default.createElement(N.default,{defaultValue:"Http://",style:{width:90}},l.default.createElement(J,{value:"Http://"},"Http://"),l.default.createElement(J,{value:"Https://"},"Https://")),l.default.createElement(N.default,{defaultValue:".com",style:{width:80}},l.default.createElement(J,{value:".com"},".com"),l.default.createElement(J,{value:".jp"},".jp"),l.default.createElement(J,{value:".cn"},".cn"),l.default.createElement(J,{value:".org"},".org")),w.default.SubMenu),q=(w.default.ItemGroup,function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;z(this,e),this.cC=new v.CircularCounter(n),this.queue=new Array(n),this.term=!1,this.inPromise=!1,this.consumePromiseFunc=t}return o(e,[{key:"size",value:function(){return this.cC.size()}},{key:"f",value:function(e){var t=this.cC.f(e);if(-1!==t)return this.queue[t]}},{key:"enQ",value:function(e){return!(this.cC.size()>=this.cC.tsize())&&(this.queue[this.cC.f()]=e,this.cC.enQ(),!0)}},{key:"deQ",value:function(){if(0!=this.cC.size()){var e=this.queue[this.cC.r()];return this.cC.deQ(),e}}},{key:"termination",value:function(){this.term=!0}},{key:"kick",value:function(){var e=this;this.inPromise||(this.inPromise=!0,this.consumePromiseFunc(this).then((function(t){e.inPromise=!1,e.term||0!=e.cC.size()&&e.kick()})).catch((function(t){console.log("Consume failed... e=",t),e.inPromise=!1})))}}]),e}()),$=function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n.pull_skip_count=0,n.WS_DB_Inser=void 0,n.WS_DB_Query=void 0,n.retryQCount=0,n.cQ=new q((function(e){return new Promise((function(t,a){if(void 0===n.WS_DB_Insert||n.WS_DB_Insert.readyState!==WebSocket.OPEN||0==e.size())return a(),void(void 0!==n.props.onDBInsertFail&&n.props.onDBInsertFail(void 0,"DB/Connection issue/Data empty"));var i=e.deQ();if(void 0===i)return t(),void(void 0!==n.props.onDBInsertFail&&n.props.onDBInsertFail(void 0,"Data empty"));var r={dbcmd:{db_action:"insert",checked:!0},data:i},o=setTimeout((function(){o=void 0,console.log("consumeQueue>>timeout"),a("Timeout"),void 0!==n.props.onDBInsertFail&&n.props.onDBInsertFail(i,"Timeout")}),3e3);n.WS_DB_Insert.send_obj(r,(function(e,t){return t.toFixed?Number(t.toFixed(5)):t})).then((function(e){clearTimeout(o),n.retryQCount=0,t(),n.props.onDBInsertSuccess(i,e)})).catch((function(a){clearTimeout(o),n.retryQCount++,e.enQ(i),t(),void 0!==n.props.onDBInsertFail&&n.props.onDBInsertFail(i,a)}))}))})),n}return G(t,e),o(t,[{key:"componentWillUnmount",value:function(){this.websocketClose()}},{key:"componentWillMount",value:function(){this.websocketConnect(this.props.url)}},{key:"componentDidUpdate",value:function(e,t,n){if(this.props.reportStatisticState.newAddedReport.length>0){if(0==this.pull_skip_count){var a=this.props.reportStatisticState.newAddedReport;this.cQ.enQ(a)||(X.error("enQ failed size()="+this.cQ.size()),void 0!==this.props.onDBInsertFail&&this.props.onDBInsertFail(a,"Cannot enQ the data")),this.cQ.size()>0&&this.cQ.kick()}void 0!==this.props.pull_skip&&(this.pull_skip_count++,this.pull_skip_count>=this.props.pull_skip&&(this.pull_skip_count=0))}}},{key:"handleLocalStorage",value:function(e){return V?(X.error("Local Storage: Supported"),V.setItem("HYVision",JSON.stringify(e)),V.length):(console.log("Local Storage: Unsupported"),0)}},{key:"send2WS_Query",value:function(e){}},{key:"websocketClose",value:function(){this.WS_DB_Insert.close(),this.WS_DB_Query.close()}},{key:"onConnectionStateUpdate",value:function(e,t){void 0!==this.props.onConnectionStateUpdate&&this.props.onConnectionStateUpdate(e,t)}},{key:"websocketConnect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ws://hyv.decade.tw:8080/";if(void 0===this.WS_DB_Insert){X.info("[init][WS]"+t+"insert/insp");var n=new v.websocket_autoReconnect(t+"insert/insp",1e4);n.onStateUpdate=this.onConnectionStateUpdate.bind(this),this.WS_DB_Insert=new v.websocket_reqTrack(n),this.WS_DB_Insert.onreconnection=function(e){return X.info("onreconnection"+e),!0},this.WS_DB_Insert.onconnectiontimeout=function(){return X.info("onconnectiontimeout")},this.WS_DB_Insert.onopen=this.onOpen.bind(this),this.WS_DB_Insert.onmessage=this.onMessage.bind(this),this.WS_DB_Insert.onclose=function(){return X.info("WS_DB_Insert:onclose")},this.WS_DB_Insert.onerror=function(){return e.onError.bind(e)}}if(void 0===this.WS_DB_Query){X.info("[init][WS]"+t+"query/insp");var a=new v.websocket_autoReconnect(t+"query/insp",1e4);this.WS_DB_Query=new v.websocket_reqTrack(a),this.WS_DB_Query.onreconnection=function(e){return X.info("onreconnection"+e),!0},this.WS_DB_Query.onconnectiontimeout=function(){return X.info("onconnectiontimeout")},this.WS_DB_Query.onopen=this.onOpen.bind(this),this.WS_DB_Query.onmessage=this.onMessage.bind(this),this.WS_DB_Query.onclose=function(){return X.info("WS_DB_Query:onclose")},this.WS_DB_Query.onerror=function(){return e.onError.bind(e)}}}},{key:"onError",value:function(e){X.error("onError RAW_InspectionReportPull")}},{key:"onOpen",value:function(e){X.info("onOpen RAW_InspectionReportPull")}},{key:"onMessage",value:function(e){X.debug(e)}},{key:"render",value:function(){return null}}]),t}(l.default.Component),Z=(function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.resultDB=void 0,n.state={db_open:!1,resultX:void 0},n}G(t,e),o(t,[{key:"componentDidMount",value:function(){}},{key:"echoTime",value:function(){return""+(new Date).getSeconds()}},{key:"query",value:function(){var e=this;return this.resultDB="[!]",fetch("http://127.0.0.1:4000/gui",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:"{ hello }"})}).then((function(e){return e.json()})).then((function(t){X.info("[O]DB data returned:",JSON.stringify(t)),e.resultDB=JSON.stringify(t)})),this.resultDB}},{key:"render",value:function(){return l.default.createElement("div",{style:{display:"inline-block"}},l.default.createElement("p",null))}}])}(l.default.Component),t.OK_NG_BOX_COLOR_TEXT=(B(a={},E.MEASURERSULTRESION.NA,{COLOR:"#aaa",TEXT:E.MEASURERSULTRESION.NA}),B(a,E.MEASURERSULTRESION.UOK,{COLOR:"#87d068",TEXT:E.MEASURERSULTRESION.UOK}),B(a,E.MEASURERSULTRESION.LOK,{COLOR:"#87d068",TEXT:E.MEASURERSULTRESION.LOK}),B(a,E.MEASURERSULTRESION.OK,{COLOR:"#87d068",TEXT:E.MEASURERSULTRESION.OK}),B(a,E.MEASURERSULTRESION.UCNG,{COLOR:"#d0d068",TEXT:E.MEASURERSULTRESION.UCNG}),B(a,E.MEASURERSULTRESION.LCNG,{COLOR:"#d0d068",TEXT:E.MEASURERSULTRESION.LCNG}),B(a,E.MEASURERSULTRESION.CNG,{COLOR:"#d0d068",TEXT:E.MEASURERSULTRESION.CNG}),B(a,E.MEASURERSULTRESION.USNG,{COLOR:"#f50",TEXT:E.MEASURERSULTRESION.USNG}),B(a,E.MEASURERSULTRESION.LSNG,{COLOR:"#f50",TEXT:E.MEASURERSULTRESION.LSNG}),B(a,E.MEASURERSULTRESION.SNG,{COLOR:"#f50",TEXT:E.MEASURERSULTRESION.SNG}),B(a,E.MEASURERSULTRESION.NG,{COLOR:"#f50",TEXT:E.MEASURERSULTRESION.SNG}),a)),ee=t.InspectionResultDisplay_FullScren=function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={folderStruct:{},history:["./"]},n}return G(t,e),o(t,[{key:"render",value:function(){var e=this.props.IR;if(!Array.isArray(e))return null;var t=this.props.resultMenuCopy,n=l.default.createElement("div",null,"Object List Window"),a=t.map((function(e,t,n){return"sub1"+t})),i=t.map((function(e){return l.default.createElement(T.default,{span:8},l.default.createElement(w.default,{selectable:!0,defaultSelectedKeys:["functionMenu"],defaultOpenKeys:a,mode:"inline"},e))}));return l.default.createElement(L.default,{title:n,visible:this.props.visible,width:void 0===this.props.width?900:this.props.width,onCancel:this.props.onCancel,onOk:this.props.onOk,footer:null},l.default.createElement("div",{style:{height:void 0===this.props.height?400:this.props.height}},l.default.createElement(k.default,{type:"flex",justify:"start",align:"top"},i)))}}]),t}(l.default.Component),te=function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return G(t,e),o(t,[{key:"clickFullScreen",value:function(){this.props.fullScreenToggleCallback()}},{key:"showResultValueCheck",value:function(e){return e.status==E.MEASURERSULTRESION.NA?"NaN ":e.value===+e.value?e.value.toFixed(3):"NaN "}},{key:"render",value:function(){var e=this.props.singleInspection;return l.default.createElement("div",{className:"s black",style:{borderBottom:"6px solid #A9A9A9",height:70}},l.default.createElement("div",{className:"s width8  HXF"},l.default.createElement("div",{className:"s vbox height4"},l.default.createElement(x.default,{type:"fullscreen",onClick:this.clickFullScreen.bind(this)}),e.name),l.default.createElement("div",{className:"s vbox  height8",style:{fontSize:25}},this.showResultValueCheck(e)+h.DEFAULT_UNIT[e.subtype])),l.default.createElement("div",{className:"s vbox width4 HXF"},l.default.createElement(D.default,{style:{fontSize:18},color:Z[e.detailStatus].COLOR},Z[e.detailStatus].TEXT)))}}]),t}(l.default.Component),ne=function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return G(t,e),o(t,[{key:"render",value:function(){return l.default.createElement("div",{style:{display:"inline-block"}},l.default.createElement(D.default,{style:{fontSize:20},color:Z[this.props.detailStatus].COLOR},Z[this.props.detailStatus].TEXT),this.props.children)}}]),t}(l.default.Component),ae=function(){function e(t){z(this,e),this.data={DoImageTransfer:!0,emptyResultCount:0,cameraSpeedMode:-1,speedSwitchingCount:100},this.ws_ch=t.ws_ch,this.ev_speedModeChange=t.ev_speedModeChange,void 0===this.ev_speedModeChange&&(this.ev_speedModeChange=function(){}),this.ev_emptyResultCountChange=t.ev_emptyResultCountChange,void 0===this.ev_emptyResultCountChange&&(this.ev_emptyResultCountChange=function(){}),this.setSpeedSwitchingCount(1e3),this.setCameraSpeed_HIGH()}return o(e,[{key:"setCameraImageTransfer",value:function(e){void 0===e&&(e=!this.data.DoImageTransfer),this.data.DoImageTransfer=e,this.ws_ch({DoImageTransfer:e})}},{key:"setCameraSpeedMode",value:function(e){this.data.cameraSpeedMode!=e&&(X.info("setCameraSpeedMode:"+e),this.data.cameraSpeedMode=e,this.ev_speedModeChange(e),this.ws_ch({CameraSetting:{framerate_mode:e}}))}},{key:"setSpeedSwitchingCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;this.data.speedSwitchingCount=e}},{key:"setCameraSpeed_HIGH",value:function(){this.setCameraSpeedMode(2)}},{key:"setCameraSpeed_LOW",value:function(){this.setCameraSpeedMode(0)}},{key:"updateInspectionReport",value:function(e){if(void 0===e||0==e.reports.length)return this.data.emptyResultCount++,this.data.emptyResultCount>this.data.speedSwitchingCount&&this.setCameraSpeed_LOW(),void this.ev_emptyResultCountChange(this.data.emptyResultCount);0!=this.data.emptyResultCount&&(this.ev_emptyResultCountChange(this.data.emptyResultCount),this.data.emptyResultCount=0,this.setCameraSpeed_HIGH())}}]),e}(),ie=function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={collapsed:!1,fullScreen:!1},n}return G(t,e),o(t,[{key:"toggleCollapsed",value:function(){this.setState(r({},this.state,{collapsed:!this.state.collapsed}))}},{key:"toggleFullscreen",value:function(){X.info("[XLINX2]fullScreen="+this.state.fullScreen),this.setState(r({},this.state,{fullScreen:!this.state.fullScreen}))}},{key:"render",value:function(){var e,t=this,n=this.props.IR,a=this.props.IR_decotrator;if(!Array.isArray(n))return null;var i=n.filter((function(e){return e.isCurObj})),o=void 0;void 0!==a&&(o=a.list_id_order),e=i.map((function(e,n){var a,i=e.judgeReports;void 0!==o&&(i=o.map((function(e){return i.find((function(t){return t.id==e}))})).filter((function(e){return void 0!==e}))),a=i.map((function(e,a){var i;return l.default.createElement(te,(B(i={key:"i"+n+e.name},"key",a),B(i,"singleInspection",e),B(i,"fullScreenToggleCallback",t.toggleFullscreen.bind(t)),i))}));var r=i.reduce((function(e,t){return(0,E.MEASURERSULTRESION_reducer)(e,t.detailStatus)}),void 0);return l.default.createElement(Q,{style:{textAlign:"left"},key:"sub1"+n,title:l.default.createElement("span",null,l.default.createElement(x.default,{type:"paper-clip"}),l.default.createElement("span",null,n," ",l.default.createElement(ne,{detailStatus:r})))},a)}));var s=l.default.createElement(ee,r({},this.state,{resultMenuCopy:e,IR:n,visible:this.state.fullScreen,onCancel:this.toggleFullscreen.bind(this),width:"90%"}));return l.default.createElement("div",null,l.default.createElement(w.default,{onClick:this.handleClick,selectable:!0,defaultSelectedKeys:["functionMenu"],mode:"inline"},l.default.createElement(Q,{style:{textAlign:"left"},key:"functionMenu",title:l.default.createElement("span",null,l.default.createElement(x.default,{type:"setting"}),"平台功能操作")},l.default.createElement(se,{url:"ws://192.168.2.43:5213"})),e),s)}}]),t}(l.default.Component),re=function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!1,iconLoading:!1,websocketAirTime:10,STOP:!0},n.websocketAir=void 0,n.heartBeat={timer:void 0,PINGcount:0,PONGcount:0,PONGPace:0},n}return G(t,e),o(t,[{key:"keyEventX",value:function(e){var t=e.keyCode||e.which,n=String.fromCharCode(t);switch(X.info("keyEvent>>",t,n),n){case"R":this.blowAir_RIGHTa();break;case"L":this.blowAir_LEFTa();break;case"B":this.blowAir_StartStop();break;case"1":this.blowAir_TIMEADD(10);break;case"2":this.blowAir_TIMESUB(10);break;case"T":this.blowAir_TEST();break;case"I":this.getCameraImage_StartStop()}}},{key:"blowAir_TEST",value:function(){X.debug("[WS]/cue/TEST"),1===this.websocketAir.readyState?(X.debug("[O][WS]/cue/TEST"),this.websocketAir.send("/cue/TEST")):X.debug("[X][WS]/cue/TEST")}},{key:"blowAir_LEFTa",value:function(){this.websocketAir.readyState===this.websocketAir.OPEN?this.websocketAir.send("/cue/LEFT"):X.debug("[X][WS]/cue/LEFT")}},{key:"blowAir_RIGHTa",value:function(){this.websocketAir.readyState===this.websocketAir.OPEN?this.websocketAir.send("/cue/RIGHT"):X.debug("[X][WS]/cue/RIGHT")}},{key:"blowAir_TIMEUpdate",value:function(){this.setState(Object.assign({},this.state)),this.websocketAir.readyState===this.websocketAir.OPEN&&this.websocketAir.send("/cue/TIME/"+this.state.websocketAirTime)}},{key:"blowAir_StartStop",value:function(){this.state.STOP=!this.state.STOP,this.setState(Object.assign({},this.state))}},{key:"blowAir_TIMEADD",value:function(e){this.state.websocketAirTime+=e,this.blowAir_TIMEUpdate()}},{key:"blowAir_TIMESUB",value:function(e){this.state.websocketAirTime-=e,this.state.websocketAirTime<10&&(this.state.websocketAirTime=10),this.blowAir_TIMEUpdate()}},{key:"enterLoading",value:function(){this.setState(r({},this.state,{loading:!0}))}},{key:"sendHeartBeat",value:function(){if(void 0!==this.websocketAir&&this.websocketAir.readyState==this.websocketAir.OPEN){if(X.info("sendHeartBeat: PING:"+this.heartBeat.PINGcount," PONG:"+this.heartBeat.PONGPace+"/"+this.heartBeat.PONGcount),this.heartBeat.PINGcount>this.heartBeat.PONGPace+2)return X.error("Heart beat ERROR: PINGcount > PONGPace+2"),this.websocketAir.reconnect(),void(this.heartBeat.PINGcount=this.heartBeat.PONGPace=0);this.websocketAir.send("/cue/PING"),this.heartBeat.PINGcount++}}},{key:"componentWillMount",value:function(){var e=this;this._keyEventX=this.keyEventX.bind(this),X.info("[init][componentWillMount]"),this.websocketConnect(this.props.url),this.websocketAir=new v.websocket_autoReconnect(this.props.url,1e4),this.websocketAir.onreconnection=function(e){return console.log(e)},this.websocketAir.onmessage=this.onMessage.bind(this),this.websocketAir.onerror=this.onError.bind(this),this.websocketAir.onopen=function(t){e.setState(r({},e.state,{loading:!1})),X.info("onopen:",t),e.props.ACT_StatSettingParam_Update(),e.heartBeat.PINGcount=0,e.heartBeat.PONGcount=0},this.websocketAir.onclose=function(t){e.props.ACT_StatSettingParam_Update(),e.setState(r({},e.state,{loading:!0})),3001==t.code?X.info("ws closed",t):X.error("ws connection error",t)},document.addEventListener("keydown",this._keyEventX),this.heartBeat.timer=setInterval(this.sendHeartBeat.bind(this),3e3)}},{key:"componentWillUnmount",value:function(){void 0!==this.websocketAir&&(this.websocketAir.close(),this.websocketAir=void 0),document.removeEventListener("keydown",this._keyEventX),clearInterval(this.heartBeat.timer),this.heartBeat.timer=void 0}},{key:"websocketConnect",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];X.info("[init][WS][OK]"),X.info(this.websocketAir)}},{key:"onError",value:function(e){this.setState(r({},this.state,{loading:!1})),X.info("onError")}},{key:"onMessage",value:function(e){X.debug(e);e.timeStamp;"/rsp/PONG"===e.data&&(this.heartBeat.PONGcount++,this.heartBeat.PONGPace=this.heartBeat.PINGcount)}},{key:"enterIconLoading",value:function(){}},{key:"componentWillReceiveProps",value:function(e){this.state.STOP||e.checkResult2AirAction.ver!=this.props.checkResult2AirAction.ver&&("left"===e.checkResult2AirAction.direction?this.blowAir_LEFTa():"right"===e.checkResult2AirAction.direction&&this.blowAir_RIGHTa())}},{key:"render",value:function(){var e=this;return void 0===this.websocketAir||this.websocketAir.readyState!=this.websocketAir.OPEN?l.default.createElement(u.AButton,{block:!0,text:"ReconnectAirDevice",type:"primary",shape:"round",icon:"loading",size:"large",dict:m.default,onClick:function(){e.websocketConnect(e.props.url)}}):l.default.createElement("div",null,l.default.createElement(P.default,{block:!0,style:{marginTop:2,marginBottom:2},type:"primary",size:"small",onClick:function(){return e.blowAir_StartStop()}},"噴氣功能(B): ",this.state.STOP?" 暫停=":" 啟動=",this.state.websocketAirTime,"ms"),l.default.createElement(K,null,l.default.createElement(P.default,{style:{backgroundColor:"#c41d7f",marginBottom:2},type:"primary",size:"large",onClick:this.blowAir_LEFTa.bind(this)},l.default.createElement(x.default,{type:"double-left"}),"NG左"),l.default.createElement(P.default,{style:{backgroundColor:"#7cb305",marginBottom:2},type:"primary",size:"large",onClick:function(){return e.blowAir_RIGHTa()}},"右OK",l.default.createElement(x.default,{type:"double-right"}))),l.default.createElement(P.default,{block:!0,style:{marginBottom:2},type:"primary",size:"small",onClick:function(){return e.blowAir_TIMEADD(10)}},l.default.createElement(x.default,{type:"up-circle"}),"增加噴氣時間(1)"),l.default.createElement(P.default,{block:!0,style:{marginBottom:2},type:"primary",size:"small",onClick:function(){return e.blowAir_TIMESUB(10)}},l.default.createElement(x.default,{type:"down-circle"}),"漸少噴氣時間(2)"),l.default.createElement(P.default,{block:!0,style:{marginBottom:2},type:"primary",size:"small",onClick:function(){return e.blowAir_TEST()}},l.default.createElement(x.default,{type:"swap"}),"測試左右噴氣(T)",l.default.createElement(x.default,{type:"swap"})),l.default.createElement("div",null))}}]),t}(l.default.Component),oe=((0,s.connect)((function(e){return{}}),(function(e,t){return{ACT_StatSettingParam_Update:function(t){e(S.ACT_StatSettingParam_Update(t))}}}))(re),function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={settingPanelVisible:!1},n.prevConnectedState=0,n}return G(t,e),o(t,[{key:"componentWillMount",value:function(){var e=this;this.ping_interval=setInterval((function(){e.props.uInspData.connected&&e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"PING",id:443}})}),3e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.ping_interval),this.ping_interval=void 0}},{key:"componentDidUpdate",value:function(e,t,n){var a=this;this.props.uInspData.connected!==e.uInspData.connected&&this.props.uInspData.connected&&(this.LoaduInspSettingToMachine(),setTimeout((function(){a.props.ACT_WS_SEND(a.props.WS_ID,"PD",0,{msg:{type:"get_setup",id:4423}})}),100))}},{key:"LoaduInspSettingToMachine",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data/uInspSetting.json";X.info("LoaduInspSettingToMachine step1"),new Promise((function(n,a){X.info("LoaduInspSettingToMachine step2"),e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{filename:t},void 0,{resolve:n,reject:a}),setTimeout((function(){return a("Timeout")}),1e3)})).then((function(t){if(X.info("LoaduInspSettingToMachine>> step3",t),"FL"==t[0].type){var n=t[0].data;e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:r({},n,{type:"set_setup",id:356})})}})).catch((function(e){X.info("LoaduInspSettingToMachine>> step3-error",e)}))}},{key:"render",value:function(){var e=this,t=[];if(void 0!==this.props.uInspMachineInfo&&this.props.uInspData.connected){var n=this.props.uInspMachineInfo;t.push(l.default.createElement(P.default,{key:"ping uInsp",onClick:function(){e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"PING",id:443}})}},0==this.props.uInspData.alive?l.default.createElement(x.default,{type:"heart"}):l.default.createElement(x.default,{type:"heart",theme:"twoTone",twoToneColor:"#eb2f96"}))),t.push(l.default.createElement(P.default,{key:"opt uInsp",icon:"setting",onClick:function(){e.setState(r({},e.state,{settingPanelVisible:!0}))}})),l.default.createElement("br",null),t.push(l.default.createElement(U.default,{orientation:"left",key:"divi"},"uInsp")),void 0!==this.props.res_count&&(t.push(l.default.createElement(D.default,{style:{fontSize:30},color:Z.OK.COLOR},this.props.res_count.OK)),t.push(l.default.createElement(D.default,{style:{fontSize:30},color:Z.NG.COLOR},this.props.res_count.NG)),t.push(l.default.createElement(D.default,{style:{fontSize:30},color:Z.NA.COLOR},this.props.res_count.NA))),void 0!==n.pulse_hz&&t.push(l.default.createElement(C.default,{key:"speedSlider",min:0,max:2e4,onChange:function(t){var n={pulse_hz:t};e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:r({},n,{type:"set_setup",id:356})}),e.props.ACT_Machine_Info_Update(n)},value:n.pulse_hz,step:100})),void 0!==n.state_pulseOffset&&t.push(n.state_pulseOffset.map((function(t,a){return l.default.createElement(O.default,{value:t,size:"small",key:"poff"+a,onChange:function(t){var i=(0,f.default)(n.state_pulseOffset);i[a]=t,e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{state_pulseOffset:i,type:"set_setup",id:356}}),e.props.ACT_Machine_Info_Update({state_pulseOffset:i})}})}))),t.push(l.default.createElement(L.default,{title:"",key:"settingModal",visible:this.state.settingPanelVisible,onCancel:function(){return e.setState(r({},e.state,{settingPanelVisible:!1}))},onOk:function(){return e.setState(r({},e.state,{settingPanelVisible:!1}))},footer:null},l.default.createElement("div",{style:{height:"600px"}},l.default.createElement(P.default.Group,{key:"GGGG"},l.default.createElement(P.default,{key:"L_ON",onClick:function(){return e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"MISC/BACK_LIGHT/ON"}})}},"ON"),l.default.createElement(P.default,{key:"L_OFF",onClick:function(){return e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"MISC/BACK_LIGHT/OFF"}})}},"OFF"),l.default.createElement(P.default,{icon:"camera",key:"CAM",onClick:function(){return e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"MISC/CAM_TRIGGER"}})}}),l.default.createElement(P.default,{icon:"save",key:"SaveToFile",onClick:function(){var t=new TextEncoder;e.props.ACT_Report_Save(e.props.WS_ID,"data/uInspSetting.json",t.encode(JSON.stringify(e.props.uInspMachineInfo,null,4)))}},"Save machine setting"),l.default.createElement(P.default,{key:"MachineSet",onClick:function(){e.LoaduInspSettingToMachine()}},"MachineSet")),l.default.createElement(U.default,{orientation:"left",key:"ERROR"},"ERROR"),l.default.createElement(P.default.Group,{key:"ERRORG"},l.default.createElement(P.default,{key:"error_get",onClick:function(){return e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"error_get"}})}},"error_get:",this.props.error_codes),l.default.createElement(P.default,{key:"error_clear",onClick:function(){return e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"error_clear"}})}},"error_clear"),l.default.createElement(P.default,{key:"speed_set",onClick:function(){e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{pulse_hz:n.pulse_hz,type:"set_setup",id:356}})}},"speed_set")),l.default.createElement(U.default,{orientation:"left"},"MISC"),l.default.createElement(P.default.Group,{key:"MISC_BB"},l.default.createElement(P.default,{key:"res_count_clear",onClick:function(){return e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"res_count_clear"}})}},"res_count_clear")),l.default.createElement(U.default,{orientation:"left"},"MODE"),l.default.createElement(P.default.Group,{key:"MODE_G"},l.default.createElement(P.default,{key:"MODE:TEST",onClick:function(){return e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"mode_set",mode:"TEST"}})}},"TEST"),l.default.createElement(P.default,{key:"MODE:NORMAL",onClick:function(){return e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{msg:{type:"mode_set",mode:"NORMAL"}})}},"NORMAL"),l.default.createElement(P.default,{type:"danger",key:"Disconnect uInsp",icon:"disconnect",onClick:function(){new Promise((function(t,n){e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{},void 0,{resolve:t,reject:n})})).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}},"Disconnect")))))}return l.default.createElement("div",null,this.props.uInspData.connected?null:l.default.createElement(P.default,{type:"primary",key:"Connect uInsp",disabled:this.props.uInspData.connected,icon:"link",onClick:function(){e.props.ACT_WS_SEND(e.props.WS_ID,"PD",0,{ip:"192.168.2.43",port:5213})}},"連線"),t)}}]),t}(l.default.Component)),se=(0,s.connect)((function(e){return{WS_CH:e.UIData.WS_CH,WS_ID:e.UIData.WS_ID,uInspData:e.Peripheral.uInsp,error_codes:e.Peripheral.uInsp.error_codes,res_count:e.Peripheral.uInsp.res_count,uInspMachineInfo:e.Peripheral.uInsp.machineInfo}}),(function(e,t){return{ACT_WS_SEND:function(t,n,a,i,r,o){return e(S.EV_WS_SEND(t,n,a,i,r,o))},ACT_Machine_Info_Update:function(t){return e(S.EV_WS_uInsp_Machine_Info_Update(t))},ACT_Report_Save:function(t,n,a){var i=S.EV_WS_SEND(t,"SV",0,{filename:n},a);console.log(i),e(i)}}}))(oe),le=function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.windowSize={},n}return G(t,e),o(t,[{key:"ec_canvas_EmitEvent",value:function(e){switch(e.type){case g.EVENT.ERROR:X.error(e),this.props.ACT_ERROR();break;case"asdasdas":var t=this.props.camera_calibration_report.reports[0],n=t.mmpb2b/t.ppb2b,a=e.data.crop.map((function(e){return e/n})),i=Math.floor(e.data.down_samp_level/n*2)+1;i<=0?i=1:i>15&&(i=15),this.props.ACT_WS_SEND(this.props.WS_ID,"ST",0,{CameraSetting:{down_samp_level:i},ImageTransferSetup:{crop:a}})}}},{key:"componentDidMount",value:function(){this.ec_canvas=new _.default.INSP_CanvasComponent(this.refs.canvas),this.ec_canvas.EmitEvent=this.ec_canvas_EmitEvent.bind(this),this.props.onCanvasInit(this.ec_canvas),this.updateCanvas(this.props.c_state)}},{key:"componentWillUnmount",value:function(){this.ec_canvas.resourceClean()}},{key:"updateCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;void 0!==this.ec_canvas&&(X.debug("updateCanvas>>",t.edit_info),this.ec_canvas.EditDBInfoSync(t.edit_info),this.ec_canvas.SetState(e),this.ec_canvas.draw())}},{key:"onResize",value:function(e,t){Math.hypot(this.windowSize.width-e,this.windowSize.height-t)<5||void 0!==this.ec_canvas&&(this.ec_canvas.resize(e,t),this.windowSize={width:e,height:t},this.updateCanvas(this.props.c_state))}},{key:"componentWillUpdate",value:function(e,t){this.updateCanvas(e.c_state,e)}},{key:"render",value:function(){return l.default.createElement("div",{className:this.props.addClass},l.default.createElement("canvas",{ref:"canvas",className:"width12 HXF"}),l.default.createElement(d.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),t}(l.default.Component),ce=(0,s.connect)((function(e){return{c_state:e.UIData.c_state,edit_info:e.UIData.edit_info}}),(function(e,t){return{ACT_EXIT:function(t){e(S.EV_UI_ACT(S.UI_SM_EVENT.EXIT))},ACT_ERROR:function(t){e(S.EV_UI_ACT(S.UI_SM_EVENT.ERROR))}}}))(le),ue=function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.divID="ControlChart_ID_"+Math.round(1e4*Math.random()),n.charObj=void 0,n.state={chartOpt:{type:"line",data:{labels:[],datasets:[{type:"line",borderColor:"rgb(100, 255, 100)",lineTension:.2,data:[],pointBackgroundColor:[]}]},bezierCurve:!1,options:{scales:{xAxes:[{ticks:{callback:function(e,t,n){return e}}}]},elements:{line:{fill:!1},point:{radius:6}},bezierCurve:!1,animation:{duration:0},maintainAspectRatio:!1,responsive:!0,title:{display:!0,text:""},annotation:{annotations:[]},legend:{display:!1},tooltips:{enabled:!0}}}},n.default_annotationTargets=[{type:"USL",color:"rgba(200, 0, 0,0.2)"},{type:"LSL",color:"rgba(200, 0, 0,0.2)"},{type:"UCL",color:"rgba(100, 100, 0,0.2)"},{type:"LCL",color:"rgba(100, 100, 0,0.2)"},{type:"value",color:"rgba(0, 0, 0,0.2)"}],n}return G(t,e),o(t,[{key:"componentWillUpdate",value:function(e,t){this.state.chartOpt.data.labels=[],this.state.chartOpt.data.datasets.forEach((function(e){e.data=[],e.pointBackgroundColor=[]}));var n=e.reportArray.length;if(0!=n){var a=e.reportArray[n-1].time_ms;this.state.chartOpt.options.title.text=e.reportArray[0].judgeReports.find((function(t){return t.id==e.targetMeasure.id})).name,e.reportArray.reduce((function(t,n,i){t.labels.push((a-n.time_ms)/1e3);var r=n.judgeReports.find((function(t){return t.id==e.targetMeasure.id})),o=void 0,s=r.value;return void 0===(o=Z[r.detailStatus].COLOR)&&(o="#AA0000"),r.detailStatus===E.MEASURERSULTRESION.NA&&(s=void 0),t.datasets[0].pointBackgroundColor.push(o),t.datasets[0].data.push(s),t}),this.state.chartOpt.data);var i=this.props.nnotationTargets;void 0===i&&(i=this.default_annotationTargets),this.state.chartOpt.options.annotation.annotations=i.map((function(t){return{type:"line",mode:"horizontal",scaleID:"y-axis-0",value:e.targetMeasure[t.type],borderColor:t.color,borderWidth:4,borderDash:[12,12],label:{position:"right",enabled:!0,content:t.type}}})),this.charObj.update()}}},{key:"componentDidMount",value:function(){var e=document.getElementById(this.divID).getContext("2d");this.charObj=new M.default(e,this.state.chartOpt)}},{key:"onResize",value:function(e,t){}},{key:"render",value:function(){return l.default.createElement("div",{className:this.props.className},l.default.createElement("canvas",{id:this.divID,style:{height:"400px"}}),l.default.createElement(d.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),t}(l.default.Component),de=function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={drawList:[]},n}return G(t,e),o(t,[{key:"shouldComponentUpdate",value:function(e){var t=e.reportStatisticState;if(void 0===t.historyReport)return!1;var n=t.historyReport;return 0!=n.length&&(!(n.length>0&&this.pre_last_rep==n[n.length-1])&&(this.pre_last_rep=n[n.length-1],!0))}},{key:"render",value:function(){var e=this,t=this.props.reportStatisticState;if(void 0===t.statisticValue)return null;var n=t.statisticValue.measureList,a=n.map((function(e){return{id:e.id,name:e.name,subtype:e.subtype,count:e.statistic.count,mean:(0,v.round)(e.statistic.mean,.001),sigma:(0,v.round)(e.statistic.sigma,1e-4),OK:["UOK","LOK","UCNG","LCNG"].reduce((function(t,n){return t+e.statistic.count_stat[n]}),0),NG:["USNG","LSNG"].reduce((function(t,n){return t+e.statistic.count_stat[n]}),0),NA:e.statistic.count_stat.NA,WARN:["UCNG","LCNG"].reduce((function(t,n){return t+e.statistic.count_stat[n]}),0),CK:(0,v.round)(e.statistic.CK,.001),CP:(0,v.round)(e.statistic.CP,.001),CPK:(0,v.round)(e.statistic.CPK,.001)}}));if(0==a.length)return null;var i=a,r=["name","subtype","count","mean","sigma","OK","NG","NA","WARN","CK","CP","CPK"].map((function(e){return{title:e,dataIndex:e,key:e}})).map((function(e){return"number"==typeof a[0][e.title]?Object.assign(e,{sorter:function(t,n){return t[e.title]-n[e.title]}}):e}));r.push({title:"Draw Toggle",key:"draw",fixed:"right",render:function(t,n){return l.default.createElement(A.default,{onChange:function(t){e.state.drawList[n.id]=t}})}});var o=Object.keys(this.state.drawList).map((function(a,i){if(1==e.state.drawList[a]){var r=n.find((function(e){return e.id==a})),o=t.historyReport.slice(Math.max(t.historyReport.length-500,1));return l.default.createElement(ue,{reportArray:o,targetMeasure:r})}return null}));return l.default.createElement("div",{className:this.props.className},l.default.createElement(I.default,{key:"dat_table",dataSource:i,columns:r,scroll:{x:1e3},pagination:!1}),o)}}]),t}(l.default.Component),pe=(function(e){function t(e){return z(this,t),H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}G(t,e),o(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}}]),o(t,[{key:"render",value:function(){var e=this.props.inspection_Info.statisticValue;if(void 0===e)return null;var t=e.measureList.map((function(e){return l.default.createElement("div",null,e.statistic.mean)}));return l.default.createElement("div",{className:this.props.addClass},t)}}])}(l.default.Component),0),fe=function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.state={target_line:void 0,target_measure:void 0,target_spoint:void 0,angledOffsetTable:{},angleStatTable:[],updateCount:0,shape_list:void 0,camera_calibration_report:void 0,mmpp:-1};for(var a=0;a<6;a++)n.state.angleStatTable.push({w:0,value:0});return n}return G(t,e),o(t,[{key:"render",value:function(){var e=this,t=this.state.shape_list.filter((function(e){return"measure"==e.type&&"distance"==e.subtype})),n=l.default.createElement(w.default,{onClick:function(t){if(-1!=t.key){var n=e.state.shape_list,a=n.find((function(e){return e.id==t.key})),i=a,r=i.ref[0].id,o=void 0,s=i=n.find((function(e){return e.id==r}));console.log(i,r),"search_point"==i.type&&(o=i,r=i.ref[0].id,s=i=n.find((function(e){return e.id==r})));var l=(0,f.default)(e.state.angleStatTable);l.forEach((function(e){e.w=e.value=0})),e.setState({target_measure:a,target_line:s,target_spoint:o,angledOffsetTable:{},angleStatTable:l,updateCount:0})}else e.setState({target_measure:void 0,target_line:void 0,target_spoint:void 0,angledOffsetTable:{},updateCount:0})}},t.concat([{id:-1,name:"CANCEL"}]).map((function(e,t){return l.default.createElement(w.default.Item,{key:e.id},l.default.createElement("a",{target:"_blank",rel:"noopener noreferrer"},e.id+":  "+e.name))}))),a=l.default.createElement(R.default,{overlay:n},l.default.createElement("a",{className:"ant-dropdown-link HX1",href:"#"},void 0===this.state.target_measure?"SELECT":">>>"+this.state.target_measure.name,l.default.createElement(x.default,{type:"down"})));return l.default.createElement("div",{className:this.props.className},l.default.createElement("div",{className:"s HXA width12",style:{padding:"10px"}},l.default.createElement(U.default,{orientation:"left",key:"divi"},"Angled Calib"),a,l.default.createElement(P.default,{type:"primary",icon:"download",onClick:function(){(0,v.copyToClipboard)(JSON.stringify(e.state.angledOffsetTable))}},this.state.updateCount)))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=t;if(void 0===n.shapeList){var a=(0,f.default)(e.shape_list);n=r({},n,{shape_list:a})}if(void 0===n.shape_list)return n;if(e.camera_calibration_report!=t.camera_calibration_report){var i=e.camera_calibration_report.reports[0],o=i.mmpb2b/i.ppb2b;n=r({},n,{camera_calibration_report:e.camera_calibration_report,mmpp:o})}if(void 0!==n.target_measure&&void 0!==n.target_line&&void 0!==e.reportStatisticState.newAddedReport&&0!==e.reportStatisticState.newAddedReport.length&&(e.reportStatisticState.newAddedReport.forEach((function(e){var a=e.judgeReports.find((function(e){return e.id==t.target_measure.id})),i=e.detectedLines.find((function(e){return e.id==t.target_line.id})),r=180*Math.atan2(i.vy,i.vx)/Math.PI+90;function o(e,t){return e-Math.floor(e/t)*t}void 0!==t.target_spoint&&(r+=t.target_spoint.angleDeg-180),r=o(r,360);var s=a.value/n.mmpp;function l(e,t,a){var i=n.angleStatTable[e];void 0!==i&&(i.w+=t,i.value+=t*a)}function c(e,t){var a=(e=o(e,360))/(360/n.angleStatTable.length),i=Math.floor(a),r=1-(a-i),s=i,c=(i+1)%n.angleStatTable.length;l(s,r,t),l(c,1-r,t)}c(r,s),c(r+180,s)})),pe++%10==0)){for(var s=(0,f.default)(n.angleStatTable),l=0;l<s.length;l++){var c=l+s.length,u=n.angleStatTable[(c-1)%s.length],d=n.angleStatTable[(c-0)%s.length],p=n.angleStatTable[(c+1)%s.length],_=s[l];_.w=(u.w+4*d.w+p.w)/6,_.value=(u.value+4*d.value+p.value)/6}var h=s.reduce((function(e,t){return e+t.value/(t.w+1e-4)}),0)/s.length,S=s.map((function(e){return e.value/(e.w+1e-4)-h})),m={};S.forEach((function(e,t){var n=""+360*t/S.length;m[n]=-(0,v.round)(e,1e-5)})),console.log(JSON.stringify(m,null,4));var E=void 0===n.updateCount?0:n.updateCount+1;n=r({},n,{angledOffsetTable:m,updateCount:E})}return n}}]),t}(l.default.Component),_e=function(e){function t(e){z(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.ec_canvas=null,n.checkResult2AirAction={direction:"none",ver:0},n.state={GraphUIDisplayMode:0,CanvasWindowRatio:9,InspStyle:void 0,ROIs:{},ROI_key:void 0,DB_Conn_state:void 0,inspUploadedCount:0},n.CameraCtrl=new ae({ws_ch:function(e,t){n.props.ACT_WS_SEND(n.props.WS_ID,"ST",0,e,void 0,t)},ev_speedModeChange:function(e){console.log(e)}}),new Promise((function(e,t){n.props.ACT_WS_SEND(n.props.WS_ID,"LD",0,{filename:"data/default_camera_setting.json"},void 0,{resolve:e,reject:t}),setTimeout((function(){return t("Timeout")}),2e3)})).then((function(e){if("FL"==e[0].type){var t=e[0].data;if("object"===i(t.ROIs)){var a=t.ROIs;console.log(">>>>",a),n.setState({ROIs:a,ROI_key:void 0})}}})).catch((function(e){})),n}return G(t,e),o(t,[{key:"componentDidMount",value:function(){this.CameraCtrl.setCameraImageTransfer(!0)}},{key:"componentWillUnmount",value:function(){this.props.ACT_WS_SEND(this.props.WS_ID,"CI",0,{_PGID_:10004,_PGINFO_:{keep:!1}})}}]),o(t,[{key:"componentDidUpdate",value:function(){this.CameraCtrl.updateInspectionReport(this.props.inspectionReport),this.props.statSetting.Insp_mode!=this.state.InspStyle&&("FI"==this.state.InspStyle?this.props.ACT_StatSettingParam_Update({keepInTrackingTime_ms:0,minReportRepeat:0,headReportSkip:0,Insp_mode:this.state.InspStyle}):"CI"==this.state.InspStyle&&this.props.ACT_StatSettingParam_Update({keepInTrackingTime_ms:1e3,historyReportlimit:2e3,minReportRepeat:4,headReportSkip:4,Insp_mode:this.state.InspStyle}))}},{key:"render",value:function(){var e,t=this;if(void 0===this.state.InspStyle)return l.default.createElement("div",null,l.default.createElement(P.default,{size:"large",key:"<",onClick:function(){t.props.ACT_WS_SEND(t.props.WS_ID,"FI",0,{_PGID_:10004,_PGINFO_:{keep:!0},deffile:t.props.defModelPath+"."+b.DEF_EXTENSION}),t.setState(r({},t.state,{InspStyle:"FI"}))}},"全檢"),l.default.createElement(P.default,{size:"large",key:">",onClick:function(){t.props.ACT_WS_SEND(t.props.WS_ID,"CI",0,{_PGID_:10004,_PGINFO_:{keep:!0},deffile:t.props.defModelPath+"."+b.DEF_EXTENSION}),t.setState(r({},t.state,{InspStyle:"CI"}))}},"品管"));var n=void 0;if(void 0!==this.props.inspectionReport&&(n=this.props.inspectionReport).reports.length>0){var a=n.reports.map((function(e){return e.judgeReports.reduce((function(e,t){return e==b.INSPECTION_STATUS.NA?e:e==b.INSPECTION_STATUS.FAILURE?t.status==b.INSPECTION_STATUS.NA?b.INSPECTION_STATUS.NA:e:t.status}),b.INSPECTION_STATUS.SUCCESS)})).reduce((function(e,t){return void 0===e?t:e==b.INSPECTION_STATUS.NA||t==b.INSPECTION_STATUS.NA?b.INSPECTION_STATUS.NA:e!=t?b.INSPECTION_STATUS.NA:t}),void 0);a==b.INSPECTION_STATUS.SUCCESS?this.checkResult2AirAction={direction:"right",ver:this.checkResult2AirAction.ver+1}:a==b.INSPECTION_STATUS.FAILURE&&(this.checkResult2AirAction={direction:"left",ver:this.checkResult2AirAction.ver+1})}var i=[];X.debug("CanvasComponent render");var o=12,s=1,d=[];switch(i=[l.default.createElement(u.IconButton,{dict:m.default,key:"<",addClass:"layout black vbox",text:"<",onClick:this.props.ACT_EXIT}),l.default.createElement(u.IconButton,{iconType:1==this.state.DB_Conn_state?"disconnect-outlined":"link-outlined",key:"LOADDef",addClass:"blockS layout gray-1 vbox "+(1==this.state.DB_Conn_state?"blackText lgreen":"BK_Blink"),text:1==this.state.DB_Conn_state?"已連結伺服器":"斷線!! 數據不會上傳",onClick:function(){}}),l.default.createElement("div",{className:"s black width12 HXA"},l.default.createElement(D.default,{className:"large",color:"red",key:"MACH"},this.props.machTag),this.props.defModelTag.map((function(e){return l.default.createElement(D.default,{className:"large",color:"red"},e)})),this.props.inspOptionalTag.map((function(e){return l.default.createElement(D.default,{className:"large",color:"green"},e)})),l.default.createElement(D.default,{className:"large",color:"gray",onClick:function(){return t.setState({additionalUI:[l.default.createElement(L.default,{title:"警告",visible:!0,onOk:function(){t.setState({additionalUI:[]}),t.props.EV_UI_Insp_Mode()},onCancel:function(){t.setState({additionalUI:[]})}},l.default.createElement("div",{style:{height:"500px"}},l.default.createElement(p.TagOptions_rdx,{className:"s width12 HXA"})))]})}},l.default.createElement(x.default,{type:"tags-o"}))),this.state.additionalUI],this.state.GraphUIDisplayMode){case 0:o=12,s=1;break;case 1:o=4,s=.3;break;case 2:o=0,s=.3;break;case 3:o=3,s=.3}i.push(l.default.createElement("div",{className:"s black width12 HXA"},l.default.createElement(k.default,null,l.default.createElement(T.default,{span:6},l.default.createElement(Y,{style:{color:"white"}},"已上傳：")),l.default.createElement(T.default,{span:18},l.default.createElement(D.default,{className:"width9 large",color:"gray",key:"upC",onClick:function(){return t.setState({inspUploadedCount:0})}},this.state.inspUploadedCount))))),d.push(l.default.createElement(u.IconButton,{dict:m.default,iconType:"up-square",key:"DoImageTransfer",addClass:"layout palatte-blue-8 vbox",text:"傳輸相機影像(I): "+(this.CameraCtrl.data.DoImageTransfer?"暫停":"啟動"),onClick:function(){return t.CameraCtrl.setCameraImageTransfer()}})),d.push(l.default.createElement(u.IconButton,{dict:m.default,iconType:"bar-chart",key:"Info Graphs",addClass:"layout black vbox",text:"Info Graphs",onClick:function(){t.state.GraphUIDisplayMode=(t.state.GraphUIDisplayMode+1)%3,t.setState(Object.assign({},t.state))}})),d.push(l.default.createElement(u.IconButton,(B(e={dict:m.default,iconType:"up-square",key:"ZOOM OUT"},"iconType","zoom-out"),B(e,"addClass","layout palatte-blue-8 vbox width6"),B(e,"text",""),B(e,"onClick",(function(){return t.props.ACT_WS_SEND(t.props.WS_ID,"ST",0,{LoadCameraSetup:"data/"})})),e)));var f=l.default.createElement(w.default,{onClick:function(e){console.log(e);var n=t.state.ROIs[e.key];t.props.ACT_WS_SEND(t.props.WS_ID,"ST",0,{CameraSetting:{ROI:n}}),t.setState({ROI_key:e.key})}},Object.keys(this.state.ROIs).map((function(e,t){return l.default.createElement(w.default.Item,{key:e},l.default.createElement("a",{target:"_blank",rel:"noopener noreferrer"},e))})));d.push(l.default.createElement(R.default,{overlay:f},l.default.createElement("a",{className:"HX1 layout palatte-blue-8 vbox width6",href:"#"},this.state.ROI_key,l.default.createElement(x.default,{type:"down"})))),d.push(l.default.createElement(fe,{className:"s width12 HXA",reportStatisticState:this.props.reportStatisticState,shape_list:this.props.shape_list,camera_calibration_report:this.props.camera_calibration_report}));var _=this.props.reportStatisticState.trackingWindow;return i.push(l.default.createElement(ie,{IR:_,IR_decotrator:this.props.info_decorator,checkResult2AirAction:this.checkResult2AirAction,key:"ObjInfoList",WSCMD_CB:function(e,n,a,i){t.props.ACT_WS_SEND(t.props.WS_ID,e,n,a,i)}})),l.default.createElement("div",{className:"overlayCon HXF"},o<=0?null:l.default.createElement(ce,{addClass:"layout WXF height"+o,ACT_WS_SEND:this.props.ACT_WS_SEND,WS_ID:this.props.WS_ID,onCanvasInit:function(e){t.ec_canvas=e},camera_calibration_report:this.props.camera_calibration_report}),o>=12?null:l.default.createElement(de,{className:"s scroll WXF height"+(12-o),reportStatisticState:this.props.reportStatisticState}),l.default.createElement($,{reportStatisticState:this.props.reportStatisticState,onConnectionStateUpdate:function(e,n){t.setState({DB_Conn_state:e})},onDBInsertSuccess:function(e,n){X.info(e,n),t.setState({inspUploadedCount:t.state.inspUploadedCount+1})},onDBInsertFail:function(e,t){X.error(e,t)},url:"ws://hyv.decade.tw:8080/",pull_skip:"FI"==this.state.InspStyle?10:1}),l.default.createElement(c.default,{transitionName:"fadeIn"},l.default.createElement("div",{key:"MENU",className:"s overlay shadow1 scroll MenuAnim HXA",style:{opacity:s,width:"250px"}},i)),l.default.createElement(w.default,{onClick:this.handleClick,selectable:!0,defaultSelectedKeys:["functionMenu"],mode:"inline"},l.default.createElement(Q,{key:"sss",className:"s overlay overlayright scroll HXA WXA",style:{color:"#333"},title:l.default.createElement(x.default,{type:"setting"})},l.default.createElement("div",{key:"MENU",className:"s HXA",style:{width:"250px"}},d))))}}]),t}(l.default.Component),he=(0,s.connect)((function(e){return{c_state:e.UIData.c_state,shape_list:e.UIData.edit_info.list,info_decorator:e.UIData.edit_info.__decorator,defModelName:e.UIData.edit_info.DefFileName,defModelTag:e.UIData.edit_info.DefFileTag,machTag:e.UIData.MachTag,inspOptionalTag:e.UIData.edit_info.inspOptionalTag,defModelPath:e.UIData.edit_info.defModelPath,WS_ID:e.UIData.WS_ID,inspectionReport:e.UIData.edit_info.inspReport,reportStatisticState:e.UIData.edit_info.reportStatisticState,statSetting:e.UIData.edit_info.statSetting,camera_calibration_report:e.UIData.edit_info.camera_calibration_report}}),(function(e,t){return{ACT_EXIT:function(t){e(S.EV_UI_ACT(S.UI_SM_EVENT.EXIT))},ACT_WS_SEND:function(t,n,a,i,r,o){return e(S.EV_WS_SEND(t,n,a,i,r,o))},ACT_StatSettingParam_Update:function(t){return e(S.EV_StatSettingParam_Update(t))}}}))(_e);t.default=he}});