!function(e){function t(t){for(var a,o,s=t[0],l=t[1],u=t[2],c=0,p=[];c<s.length;c++)o=s[c],i[o]&&p.push(i[o][0]),i[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(d&&d(t);p.length;)p.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(a=!1)}a&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},i={0:0},r=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/dist/";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var d=l;r.push([540,1]),n()}({1051:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(104),o=E(n(1)),s=v(n(84)),l=E(n(209)),u=v(n(33)),d=v(n(63)),c=n(44),p=E(n(86)),h=E(n(176)),f=E(n(46)),S=v(n(45)),_=v(n(1052));E(n(133));function v(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function E(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=E(n(1056)).default.RangePicker;S.getLogger("AnalysisUI");function k(e,t){var n=t,a=e.map(function(e){var t=n.map(function(t){return t.judgeReports.find(function(t){return t.id==e.id}).value}),a=t.reduce(function(e,t){return e+t},0)/t.length,i=Math.sqrt(t.reduce(function(e,t){return e+(a-t)*(a-t)},0)/t.length),r=(e.USL-a)/(3*i),o=(a-e.LSL)/(3*i),s=Math.min(r,o),l=(a-e.value)/((e.USL-e.LSL)/2),u=s*(1-Math.abs(l)),d=e.id,p=e.name,h=e.subtype;return r=(0,c.round)(r,.001),o=(0,c.round)(o,.001),s=(0,c.round)(s,.001),l=(0,c.round)(l,.001),u=(0,c.round)(u,.001),{id:d,name:p,subtype:h,measure:e,valArr:t,mean:a,sigma:i,CPU:r,CPL:o,CP:s,CA:l,CPK:u}});return console.log(a),a}var T=function(e){function t(){return b(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,o.default.Component),i(t,[{key:"render",value:function(){var e=this.props.inspectionResults,t=k(this.props.reportStatisticState.statisticValue.measureList,e),n=["id","name","subtype","CA","CPU","CPL","CP","CPK"].map(function(e){return{title:e,dataIndex:e,key:e}});return o.default.createElement(h.default,{dataSource:t,columns:n})}}]),t}();function C(e){return"string"==typeof e||e instanceof String}function A(e,t){var n=k(e,t),a=[],i=n.reduce(function(e,t){return-1==e?t.valArr.length:e==t.valArr.length?e:NaN},-1);if(-1==i||i!=i)return[];function r(e,t,n,i){C(n)&&(n=[n]),void 0===i&&(i=n[n.length-1]),a.push(i+","),t.forEach(function(e){var t=(0,c.GetObjElement)(e,n);void 0===t&&(t=""),a.push(t+",")}),a.push("\n")}["name","subtype"].forEach(function(e){return r(0,n,e)}),["value","LCL","UCL","LSL","USL"].forEach(function(e){return r(0,n,["measure",e])}),["mean","sigma","CA","CPU","CPL","CP","CPK"].forEach(function(e){return r(0,n,e)}),n.forEach(function(e){a.push(",")}),a.push("\n");for(var o=n[0].valArr.length,s=0;s<o;s++)r(0,n,["valArr",s],t[s].time_ms);return a}var N=function(e){function t(e){b(this,t);var n=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.ec_canvas=null,n.state={defFileSearchName:"",dateRange:[],inspectionRec:[]},n}return y(t,o.default.Component),i(t,[{key:"componentDidMount",value:function(){this.props.edit_info.defModelPath}}]),i(t,[{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"genTarEditUI",value:function(e){var t=this;switch(e.type){case u.SHAPE_TYPE.aux_point:case u.SHAPE_TYPE.search_point:case u.SHAPE_TYPE.measure:return o.default.createElement(s.JsonEditBlock,{object:e,dict:p.default,dictTheme:e.type,key:"BASE_COM.JsonEditBlock",whiteListKey:{type:"div",subtype:"div",name:"input",angleDeg:"input-number",value:"input-number",margin:"input-number",USL:"input-number",LSL:"input-number",UCL:"input-number",LCL:"input-number",quadrant:"div",docheck:"checkbox",width:"input-number",ref:{__OBJ__:"div",0:{__OBJ__:"btn",id:"div",element:"div"},1:{__OBJ__:"btn",id:"div",element:"div"}}},jsonChange:function(e,n,a,i){if("btn"==a)"ref"==n.keyTrace[0]&&t.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(n.keyTrace);else{var r=n.keyTrace[n.keyTrace.length-1];switch(a){case"input-number":var o=parseFloat(i.target.value);if(isNaN(o))return;if(n.obj[r]=o,void 0!==n.obj.value){var s=n.obj.value;"LSL"==r?n.obj.LCL=(0,c.round)(s+(n.obj.LSL-s)/3,.001):"USL"==r&&(n.obj.UCL=(0,c.round)(s+(n.obj.USL-s)/3,.001))}break;case"input":n.obj[r]=i.target.value;break;case"checkbox":n.obj[r]=i.target.checked}t.ec_canvas.SetShape(e,e.id)}}});default:return o.default.createElement(s.JsonEditBlock,{object:e,dict:p.default,dictTheme:e.type,key:"BASE_COM.JsonEditBlock",jsonChange:function(e,n,a,i){var r=n.keyTrace[n.keyTrace.length-1];"input-number"==a?n.obj[r]=parseFloat(i.target.value):"input"==a&&(n.obj[r]=i.target.value),console.log(n.obj);var o=e;t.ec_canvas.SetShape(o,o.id)},whiteListKey:{type:"div",subtype:"div",name:"input",margin:"input-number",direction:"input-number"}})}}},{key:"stateUpdate",value:function(e){return this.setState(a({},this.state,e))}},{key:"render",value:function(){var e=this,t=[o.default.createElement(s.IconButton,{dict:p.default,key:"<",addClass:"layout black vbox",text:"<",onClick:function(){return e.props.ACT_EXIT()}})],n=2==this.state.dateRange.length&&this.state.dateRange.reduce(function(e,t){return e&&void 0!==t._d&&void 0!==t._d.getTime},!0),a=this.state.dateRange.map(function(e){return e._d}),i=this.props.edit_info.DefFileHash,r=this.props.edit_info.DefFileName,u=C(this.props.edit_info.DefFileHash)&&this.props.edit_info.DefFileHash.length>5;return o.default.createElement("div",{className:"HXF"},o.default.createElement("div",{className:"overlayCon s overlayCon width12 HXF"},o.default.createElement("div",{className:"s height12"},o.default.createElement(g,{key:"RP",onChange:function(t){return e.stateUpdate({dateRange:t})}}),o.default.createElement(f.default,{type:"primary",icon:"search",disabled:!n||!u,onClick:function(){_.inspectionQuery(i,a[0],a[1]).then(function(t){console.log(t);var n=t.map(function(e){return e.InspectionData[0]});e.stateUpdate({inspectionRec:n});A(e.props.reportStatisticState.statisticValue.measureList,n)}).catch(function(e){console.log(e)})}}),o.default.createElement(f.default,{type:"primary",icon:"download",disabled:!n||!u||0==this.state.inspectionRec.length,onClick:function(){var t,n,a,i,o,s,l,u,d=A(e.props.reportStatisticState.statisticValue.measureList,e.state.inspectionRec);t=d.join(""),n="text/csv",a=r+"_"+(s=new Date,l=s.getMonth()+1,u=s.getDate(),[s.getFullYear(),(l>9?"":"0")+l,(u>9?"":"0")+u].join(""))+".csv",i=new Blob([t],{type:n}),(o=document.createElement("a")).download=a,o.href=URL.createObjectURL(i),o.dataset.downloadurl=[n,o.download,o.href].join(":"),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(function(){URL.revokeObjectURL(o.href)},1500)}}),o.default.createElement(T,{reportStatisticState:this.props.reportStatisticState,inspectionResults:this.state.inspectionRec})),o.default.createElement(l.default,{transitionName:"fadeIn"},o.default.createElement("div",{key:"k1",className:"s overlay scroll MenuAnim HXA",style:{top:"0px",width:"100px"}},t))))}}]),t}(),w=(0,r.connect)(function(e){return{c_state:e.UIData.c_state,edit_tar_info:e.UIData.edit_info.edit_tar_info,shape_list:e.UIData.edit_info.list,WS_ID:e.UIData.WS_ID,edit_info:e.UIData.edit_info,reportStatisticState:e.UIData.edit_info.reportStatisticState}},function(e,t){return{ACT_SUCCESS:function(t){e(u.EV_UI_ACT(d.EVENT.SUCCESS))},ACT_Fail:function(t){e(u.EV_UI_ACT(d.EVENT.FAIL))},ACT_EXIT:function(t){e(u.EV_UI_ACT(u.UI_SM_EVENT.EXIT))},ACT_WS_SEND:function(t,n,a,i,r){return e(u.EV_WS_SEND(t,n,a,i,r))},ACT_Report_Save:function(t,n,a){e(u.EV_WS_SEND(t,"SV",0,{filename:n},a))},ACT_Cache_Img_Save:function(t,n){e(u.EV_WS_SEND(t,"SV",0,{filename:n,type:"__CACHE_IMG__"}))}}})(N);t.default=w},1052:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inspectionQuery=t.defFileQuery=void 0;var a,i=n(511),r=(a=i)&&a.__esModule?a:{default:a};var o="http://hyv.decade.tw:8080/";t.defFileQuery=function(e,t){var n=o+"query/deffile?";return n+="limit=1000",void 0!==e&&(n+="&name="+e),void 0!==t&&(n+="&featureSet_sha1="+t),new Promise(function(e,t){(0,r.default)(n,function(n,a){null===n?e(a):t(n),console.log(n,a)})})},t.inspectionQuery=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=o+"query/inspection?";return i+="tStart="+t.toString()+"&tEnd="+n.toString()+"&",i+="limit="+a+"&page=1&",i+="subFeatureDefSha1="+e+"&",i+="projection="+JSON.stringify({_id:0,"InspectionData.time_ms":1,"InspectionData.subFeatureDefSha1":1,"InspectionData.judgeReports.id":1,"InspectionData.judgeReports.value":1,"InspectionData.judgeReports.status":1}),i+="",new Promise(function(e,t){(0,r.default)(i,function(n,a){null===n?e(a):t(n),console.log(n,a)})})}},193:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InspectionEditorLogic=t.MEASURERSULTRESION_priority=t.MEASURERSULTRESION=void 0;var a,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.MEASURERSULTRESION_reducer=function(e,t){if(e==S.NA)return e;if(e==S.USNG||e==S.LSNG)return t==S.NA?t:e;if(e==S.UCNG||e==S.LCNG)return t==S.NA||t==S.USNG||t==S.LSNG?t:e;return t};var o,s=n(285),l=n(41),u=n(33),d=n(44),c=n(85),p=(o=c)&&o.__esModule?o:{default:o};function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(45)).getLogger("InspectionEditorLogic"),S=t.MEASURERSULTRESION={NA:"NA",UOK:"UOK",LOK:"LOK",UCNG:"UCNG",LCNG:"LCNG",USNG:"USNG",LSNG:"LSNG"};t.MEASURERSULTRESION_priority=(h(a={},S.NA,0),h(a,S.LSNG,1),h(a,S.USNG,1),h(a,S.UCNG,2),h(a,S.LCNG,2),h(a,S.UOK,3),h(a,S.LOK,3),a);t.InspectionEditorLogic=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reset()}return r(e,[{key:"reset",value:function(){this.shapeCount=0,this.shapeList=[],this.inherentShapeList=[],this.editShape=null,this.editPoint=null,this.state=null,this.sig360info=null,this.inspreport=null,this.img=null}},{key:"Setsig360info",value:function(e){f.info(e),this.sig360info=e}},{key:"SetInspectionReport",value:function(e){var t=this;this.inspreport=e,void 0!==this.inspreport.reports&&0!=this.inspreport.reports.length&&this.inspreport.reports.forEach(function(e){return e.judgeReports.forEach(function(e){var n=t.shapeList.find(function(t){return t.id==e.id});void 0===n||e.status===l.INSPECTION_STATUS.NA?e.detailStatus=S.NA:e.value<n.LSL?e.detailStatus=S.LSNG:e.value<n.LCL?e.detailStatus=S.LCNG:e.value<n.value?e.detailStatus=S.LOK:e.value<n.UCL?e.detailStatus=S.UOK:e.value<n.USL?e.detailStatus=S.UCNG:e.detailStatus=S.USNG})})}},{key:"getsig360info_mmpp",value:function(){try{return this.sig360info.reports[0].mmpp}catch(e){}return 1}},{key:"getsig360infoCenter",value:function(){var e={x:0,y:0};try{e.x=this.sig360info.reports[0].cx,e.y=this.sig360info.reports[0].cy}catch(t){e.x=0,e.y=0}return e}},{key:"SetShapeList",value:function(e){this.shapeList=e;var t=0;this.shapeList.forEach(function(e){t<e.id&&(t=e.id)}),this.shapeCount=t}},{key:"SetDefInfo",value:function(e){this.SetShapeList(e.features),f.info(e);var t=e.inherentfeatures[0];t.signature.magnitude=t.signature.magnitude.map(function(e){return Math.round(1e3*e)/1e3}),t.signature.angle=t.signature.angle.map(function(e){return Math.round(1e3*e)/1e3}),this.Setsig360info({reports:[{cx:t.pt1.x,cy:t.pt1.y,area:t.area,orientation:t.orientation,signature:t.signature,mmpp:e.mmpp,cam_param:e.cam_param}]}),this.UpdateInherentShapeList();var n=this.findLostRefShapes();this.shapeList=this.shapeList.filter(function(e){return!n.includes(e)}),this.UpdateInherentShapeList()}},{key:"SetCameraParamInfo",value:function(e){this.cameraParam=e}},{key:"SetState",value:function(e){this.state!=e&&(this.shapeCount=0,this.editShape=null,this.editPoint=null)}},{key:"FindShape",value:function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shapeList).findIndex(function(n){return n[e]==t});return n<0?void 0:n}},{key:"FindShapeIdx",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;return this.FindShape("id",e,t)}},{key:"FindShapeObject",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shapeList,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.inherentShapeList,i=this.FindShape(e,t,n);return void 0!==i?n[i]:void 0!==(i=this.FindShape(e,t,a))?a[i]:void 0}},{key:"UpdateInherentShapeList",value:function(){var e=this;if(this.inherentShapeList=[],null!==this.sig360info&&void 0!==this.sig360info){var t=this.sig360info.reports[0];f.debug(t);var n=1e5,a=n;return this.inherentShapeList.push({id:a,type:u.SHAPE_TYPE.sign360,name:"@__SIGNATURE__",pt1:{x:t.cx,y:t.cy},pt2:{x:0,y:0},area:t.area,orientation:0,signature:t.signature}),n=a+1,this.inherentShapeList.push({id:n++,type:u.SHAPE_TYPE.aux_point,name:"@__SIGNATURE__.centre",ref:[{id:a,keyTrace:["pt2"]}]}),this.inherentShapeList.push({id:n++,type:u.SHAPE_TYPE.aux_line,name:"@__SIGNATURE__.orientation",ref:[{name:"@__SIGNATURE__",keyTrace:["orientation"]}]}),n=100100,this.shapeList.forEach(function(t){t.type==u.SHAPE_TYPE.arc&&e.inherentShapeList.push({id:n+10*t.id,type:u.SHAPE_TYPE.aux_point,name:t.name+".centre",ref:[{id:t.id,element:"centre"}]})}),this.inherentShapeList}}},{key:"GenerateEditReport",value:function(){return{type:"binary_processing_group",intrusionSizeLimitRatio:.1,featureSet:[{type:"sig360_circle_line",ver:"0.0.1.0",unit:"px",mmpp:this.sig360info.reports[0].mmpp,cam_param:this.sig360info.reports[0].cam_param,features:this.shapeList,inherentfeatures:this.inherentShapeList}]}}},{key:"findLostRefShapes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shapeList,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.inherentShapeList,n=e.concat(t);return n.filter(function(e){if(void 0===e.ref&&void 0===e.ref_baseLine)return!1;var t=e.ref;return void 0!==(0,d.GetObjElement)(e,["ref_baseLine","id"])&&(t=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t),[e.ref_baseLine])),!!t.reduce(function(e,t){return e||null==n.find(function(e){return t.id==e.id})},!1)})}},{key:"FindShapeRefTree",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.inherentShapeList;return n.concat(a).filter(function(t){return(void 0!==t.ref||void 0!==t.ref_baseLine)&&(!(void 0===t.ref.find(function(t){return t.id==e}))||(0,d.GetObjElement)(t,["ref_baseLine","id"])==e)}).map(function(e){var i=t.FindShapeRefTree(e.id,n,a);return 0==i.length?{id:e.id,shape:e}:{id:e.id,shape:e,ref_tree:i}})}},{key:"FlatRefTree",value:function(e){var t=this,n=[];return e.forEach(function(e){n.push(e),void 0!==e.ref_tree&&(n=n.concat(t.FlatRefTree(e.ref_tree)))}),n}},{key:"SetShape",value:function(e,t){var n=null,a=void 0;if(null==e){if(void 0!==t&&(a=this.FindShapeIdx(t),f.debug("SETShape>",a),null!=a)){var r=this.FindShapeRefTree(t);console.log("refTree",r);var o=this.FlatRefTree(r);console.log("flatRefTree",o),this.shapeList=this.shapeList.filter(function(e){return void 0===o.find(function(t){return e.id==t.id})}).filter(function(e){return t!=e.id})}return n}if(f.info("SETShape>",this.shapeList,e,t),null!=this.FindShapeIdx(e.id,this.inherentShapeList))return f.error("Error:Shape id:"+t+" name:"+e.name+" is in inherentShapeList which is not changeable."),null;if(null!=t){var s=this.FindShapeIdx(t),l=this.FindShape("name",e.name);if(void 0!==l&&s!=l)return f.error("Error:Shape id:"+t+" Duplicated shape name:"+e.name+" with idx:"+l+" "),null;if(f.info("SETShape>",s),null==s)return f.error("Error:Shape id:"+t+" doesn't exist in the list...."),null;n=this.shapeList[s],a=s}else this.shapeCount++,t=this.shapeCount;var u=null;return u=i({},e,{id:t}),null==n?(void 0===u.name&&(u.name="@"+u.type+"_"+t),this.shapeList.push(u)):null!=a&&(this.shapeList[a]=u),null!==this.editShape&&this.editShape.id==t&&(this.editShape=u),u}},{key:"FindInspShapeObject",value:function(e,t){if(null!=t){var n=this.FindShapeIdx(e,t.detectedCircles);if(null!=n)return t.detectedCircles[n];var a=this.FindShapeIdx(e,t.detectedLines);if(null!=a)return t.detectedLines[a];var i=this.FindShapeIdx(e,t.auxPoints);if(null!=i)return t.auxPoints[i];var r=this.FindShapeIdx(e,t.searchPoints);if(null!=r)return t.searchPoints[r];var o=this.FindShapeIdx(e,t.judgeReports);return null!=o?t.judgeReports[o]:void 0}}},{key:"ShapeListAdjustsWithInspectionResult",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Math.cos(-t.rotate),r=Math.sin(-t.rotate),o=t.isFlipped?-1:1;e.forEach(function(e){if(null!=e){var l=n.FindInspShapeObject(e.id,t);if(null==t||null!=l){switch(e.inspection_status=l.status,["pt1","pt2","pt3"].forEach(function(n){void 0!==e[n]&&(e[n]=(0,s.PtRotate2d_sc)(e[n],r,i,o),e[n].x+=t.cx,e[n].y+=t.cy)}),e.type){case u.SHAPE_TYPE.line:if(["pt1","pt2"].forEach(function(t){e[t]=(0,s.closestPointOnLine)(l,e[t])}),t.isFlipped){var d=e.pt1;e.pt1=e.pt2,e.pt2=d}break;case u.SHAPE_TYPE.arc:["pt1","pt2","pt3"].forEach(function(t){e[t].x-=l.x,e[t].y-=l.y;var n=Math.hypot(e[t].x,e[t].y);e[t].x=e[t].x*l.r/n+l.x,e[t].y=e[t].y*l.r/n+l.y});break;case u.SHAPE_TYPE.search_point:e.pt1.x=l.x,e.pt1.y=l.y,t.isFlipped&&(e.angleDeg=-e.angleDeg);break;case u.SHAPE_TYPE.measure:e.inspection_value=l.value}a&&["pt1","pt2","pt3"].forEach(function(n){void 0!==e[n]&&(e[n].x-=t.cx,e[n].y-=t.cy,e[n]=o<0?(0,s.PtRotate2d_sc)(e[n],r,i,-1):(0,s.PtRotate2d_sc)(e[n],-r,i,1))})}}})}},{key:"FindClosestCtrlPointInfo",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList,a={pt:null,key:null,shape:null,dist:Number.POSITIVE_INFINITY};return n.forEach(function(n){var i=void 0;switch(n.type){case u.SHAPE_TYPE.line:case u.SHAPE_TYPE.arc:case u.SHAPE_TYPE.search_point:case u.SHAPE_TYPE.measure:["pt1","pt2","pt3"].forEach(function(t){void 0!==n[t]&&(i=(0,s.distance_point_point)(n[t],e),a.dist>i&&(a.shape=n,a.key=t,a.pt=n[t],a.dist=i))});break;case u.SHAPE_TYPE.aux_point:var r=t.auxPointParse(n);i=(0,s.distance_point_point)(r,e),a.dist>i&&(a.shape=n,a.key=void 0,a.pt=r,a.dist=i)}}),a}},{key:"FindClosestInherentPointInfo",value:function(e,t){var n=this,a={pt:null,key:null,shape:null,dist:Number.POSITIVE_INFINITY};return t.forEach(function(t){if(null!=t&&t.type==u.SHAPE_TYPE.aux_point){var i=n.auxPointParse(t),r=(0,s.distance_point_point)(i,e);a.dist>r&&(a.shape=t,a.key=null,a.pt=i,a.dist=r)}}),a}},{key:"auxPointParse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList,n=void 0;if(e.type!=u.SHAPE_TYPE.aux_point)return n;if(1==e.ref.length){var a=this.FindShapeObject("id",e.ref[0].id,t);if(void 0===a)return;if(void 0!==e.ref[0].keyTrace)n=(0,d.GetObjElement)(a,e.ref[0].keyTrace);else switch(a.type){case u.SHAPE_TYPE.arc:var i=a;(n=(0,s.threePointToArc)(i.pt1,i.pt2,i.pt3)).ref=(0,p.default)(e.ref),n.ref[0]._obj=i}}else if(2==e.ref.length){var r=this.FindShapeObject("id",e.ref[0].id,t);if(void 0===r)return;var o=this.FindShapeObject("id",e.ref[1].id,t);if(void 0===o)return;var l=this.shapeVectorParse(r,t),c=this.shapeVectorParse(o,t);if(void 0===l||void 0===c)return;var h=this.shapeMiddlePointParse(r,t),f=this.shapeMiddlePointParse(o,t);if(void 0===h||void 0===f)return;return(0,s.vecXY_addin)(l,h),(0,s.vecXY_addin)(c,f),(0,s.intersectPoint)(h,l,f,c)}return n}},{key:"searchPointParse",value:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;var t=void 0;if(e.type==u.SHAPE_TYPE.search_point){if(1==e.ref.length){var n=this.FindShapeObject("id",e.ref[0].id);if(void 0===n)return;switch(n.type){case u.SHAPE_TYPE.line:t=e.pt1}}return t}}},{key:"shapeMiddlePointParse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;switch(e.type){case u.SHAPE_TYPE.line:return{x:(e.pt1.x+e.pt2.x)/2,y:(e.pt1.y+e.pt2.y)/2};case u.SHAPE_TYPE.arc:return(0,s.threePointToArc)(e.pt1,e.pt2,e.pt3);case u.SHAPE_TYPE.aux_point:return this.auxPointParse(e,t);case u.SHAPE_TYPE.search_point:return this.searchPointParse(e,t)}}},{key:"shapeVectorParse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;switch(e.type){case u.SHAPE_TYPE.line:return{x:e.pt2.x-e.pt1.x,y:e.pt2.y-e.pt1.y};case u.SHAPE_TYPE.search_point:if(void 0===e.ref||1!=e.ref.length)return;var n=this.FindShapeObject("id",e.ref[0].id,t);if(void 0===n||n.type!==u.SHAPE_TYPE.line)return;var a=this.shapeVectorParse(n,t);if(void 0===a)return;var i=Math.atan2(a.y,a.x)+e.angleDeg*Math.PI/180;return{x:Math.cos(i),y:Math.sin(i)}}}}]),e}()},217:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MEASURE_RESULT_VISUAL_INFO=void 0;var a,i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(33),s=n(193),l=S(n(63)),u=n(44),d=n(285),c=n(41),p=S(n(45)),h=n(85),f=(i=h)&&i.__esModule?i:{default:i};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=t.MEASURE_RESULT_VISUAL_INFO=(b(a={},s.MEASURERSULTRESION.NA,{COLOR:"rgba(128,128,128,0.5)",TEXT:s.MEASURERSULTRESION.NA}),b(a,s.MEASURERSULTRESION.UOK,{COLOR:"rgba(128,200,128,0.7)",TEXT:s.MEASURERSULTRESION.UOK}),b(a,s.MEASURERSULTRESION.LOK,{COLOR:"rgba(128,200,128,0.7)",TEXT:s.MEASURERSULTRESION.LOK}),b(a,s.MEASURERSULTRESION.UCNG,{COLOR:"rgba(255,255,0,0.5)",TEXT:s.MEASURERSULTRESION.UCNG}),b(a,s.MEASURERSULTRESION.LCNG,{COLOR:"rgba(255,255,0,0.5)",TEXT:s.MEASURERSULTRESION.LCNG}),b(a,s.MEASURERSULTRESION.USNG,{COLOR:"rgba(255,0,0,0.5)",TEXT:s.MEASURERSULTRESION.USNG}),b(a,s.MEASURERSULTRESION.LSNG,{COLOR:"rgba(255,0,0,0.5)",TEXT:s.MEASURERSULTRESION.LSNG}),a),y=function(){function e(t){E(this,e),this.matrix=new DOMMatrix,this.tmpMatrix=new DOMMatrix,this.identityMat=new DOMMatrix,this.Scale(.1)}return r(e,[{key:"Scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=new DOMMatrix;n.translateSelf(t.x,t.y),n.scaleSelf(e,e),n.translateSelf(-t.x,-t.y),this.matrix.preMultiplySelf(n)}},{key:"StartDrag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.tmpMatrix.setMatrixValue(this.identityMat),this.tmpMatrix.translateSelf(e.x,e.y)}},{key:"EndDrag",value:function(){this.matrix.preMultiplySelf(this.tmpMatrix),this.tmpMatrix.setMatrixValue(this.identityMat)}},{key:"SetOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.matrix.m41=0,this.matrix.m42=0,this.matrix.translateSelf(e.x,e.y)}},{key:"GetCameraScale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.matrix;return Math.sqrt(e.m11*e.m22-e.m12*e.m21)}},{key:"GetCameraOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.matrix;return{x:e.m41,y:e.m42}}},{key:"CameraTransform",value:function(e){e.multiplySelf(this.tmpMatrix),e.multiplySelf(this.matrix)}}]),e}(),g=function(){function e(t){E(this,e),this.setEditor_db_obj(t),this.colorSet={unselected:"rgba(100,0,100,0.5)",inspection_Pass:"rgba(0,255,0,0.1)",inspection_production_Fail:"rgba(128,128,0,0.1)",inspection_Fail:"rgba(255,0,0,0.1)",inspection_NA:"rgba(128,128,128,0.1)",editShape:"rgba(255,0,0,0.7)",measure_info:"rgba(128,128,200,0.7)"},this.renderParam={base_Size:1,size_Multiplier:1,mmpp:.1,font_Base_Size:60,font_Style:"bold "}}return r(e,[{key:"get_mmpp",value:function(){return this.renderParam.mmpp}},{key:"getPrimitiveSize",value:function(){return this.renderParam.base_Size*this.renderParam.size_Multiplier*this.get_mmpp()}},{key:"getPointSize",value:function(){return 8*this.getPrimitiveSize()}},{key:"getIndicationLineSize",value:function(){return 8*this.getPrimitiveSize()}},{key:"getSearchDirectionLineSize",value:function(){return 8*this.getPrimitiveSize()}},{key:"getFontHeightPx",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.renderParam.font_Base_Size)*this.renderParam.size_Multiplier*this.get_mmpp()}},{key:"getFontStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getFontHeightPx();return this.renderParam.font_Style+e+"px Arial"}},{key:"setEditor_db_obj",value:function(e){this.db_obj=e}},{key:"setColorSet",value:function(e){this.colorSet=e}},{key:"drawReportLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};e.beginPath(),e.moveTo(t.x0+n.x,t.y0+n.y),e.lineTo(t.x1+n.x,t.y1+n.y),e.stroke()}},{key:"drawLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};e.beginPath(),e.moveTo(t.pt1.x+n.x,t.pt1.y+n.y),e.lineTo(t.pt2.x+n.x,t.pt2.y+n.y),e.stroke()}},{key:"drawReportArc",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};e.beginPath(),void 0===t.thetaS||void 0===t.thetaE?e.arc(t.x+n.x,t.y+n.y,t.r,0,2*Math.PI,!1):e.arc(t.x+n.x,t.y+n.y,t.r,t.thetaS,t.thetaE,!1),e.stroke()}},{key:"_drawpoint",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;e.beginPath(),"rect"==n?e.rect(t.x-a/2,t.y-a/2,a,a):e.arc(t.x,t.y,a/2,0,2*Math.PI,!1),e.stroke()}},{key:"drawpoint",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.getPointSize(),i=e.strokeStyle;e.lineWidth=2*a,e.strokeStyle="rgba(0,0,100,0.5)",this._drawpoint(e,t,n,2*a),e.lineWidth=a/2,e.strokeStyle=i,this._drawpoint(e,t,n,2*a)}},{key:"drawInherentShapeList",value:function(e,t){var n=this;void 0!==t&&null!=t&&t.forEach(function(t){if(null!=t)switch(t.type){case o.SHAPE_TYPE.aux_point:var a=n.db_obj.auxPointParse(t);null!=a&&(e.strokeStyle="black",n.drawpoint(e,a,"rect"))}})}},{key:"canvas_arrow",value:function(e,t,n,a,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:10,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI/6,s=Math.atan2(i-n,a-t);e.beginPath(),e.moveTo(t,n),e.lineTo(a,i),e.moveTo(a,i),e.lineTo(a-r*Math.cos(s-o),i-r*Math.sin(s-o)),e.moveTo(a,i),e.lineTo(a-r*Math.cos(s+o),i-r*Math.sin(s+o)),e.stroke()}},{key:"drawArcArrow",value:function(e,t,n,a,i,r){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];e.beginPath(),e.arc(t,n,a,i,r,o),e.stroke();var s=Math.cos(r),l=Math.sin(r);t+=a*s,n+=a*l;var u=o?-1:1;u*=this.getPrimitiveSize();var d=50*this.getPrimitiveSize();this.canvas_arrow(e,t+u*l,n-u*s,t,n,d)}},{key:"drawLineArrow",value:function(e,t,n,a,i){}},{key:"drawText",value:function(e,t,n,a){e.fillText(t,n,a),e.strokeStyle="black",e.lineWidth=this.getIndicationLineSize(),e.strokeText(t,n,a)}},{key:"draw_Text",value:function(e,t,n,a,i){e.save(),e.translate(a,i),e.scale(n,n),e.fillText(t,0,0),e.strokeText(t,0,0),e.restore()}},{key:"drawMeasureDistance",value:function(e,t,n,a,i){var r,o,s,l=this.db_obj;o=l.shapeMiddlePointParse(n[0],a),s=l.shapeMiddlePointParse(n[1],a);var u=void 0;void 0!==t.ref_baseLine&&void 0!==t.ref_baseLine.id&&(u=a.find(function(e){return e.id==t.ref_baseLine.id})),void 0===u&&(u=n[0]);var c=l.shapeVectorParse(u,a);if(void 0===c&&(c={x:-(s.y-o.y),y:s.x-o.x}),r={x1:o.x,y1:o.y,x2:o.x+c.x,y2:o.y+c.y},null!=s&&null!=r){var p=(0,d.closestPointOnLine)(r,s),h=(0,d.closestPointOnLine)(r,t.pt1),f={x0:h.x,y0:h.y,x1:h.x+(s.x-p.x),y1:h.y+(s.y-p.y)};e.setLineDash([5*this.getPrimitiveSize(),15*this.getPrimitiveSize()]),this.drawReportLine(e,{x0:f.x0,y0:f.y0,x1:o.x,y1:o.y}),this.drawReportLine(e,{x0:f.x1,y0:f.y1,x1:s.x,y1:s.y}),this.drawReportLine(e,{x0:f.x1,y0:f.y1,x1:t.pt1.x,y1:t.pt1.y}),e.setLineDash([]),this.drawReportLine(e,f),this.drawpoint(e,t.pt1);var S=this.getFontHeightPx();e.font=this.getFontStyle(1),e.strokeStyle="black",e.lineWidth=this.getIndicationLineSize();var _=void 0;if(void 0!==t.inspection_value){var v=0;this.draw_Text(e,t.name,S,t.pt1.x,t.pt1.y),v+=S,_="D"+(t.inspection_value*i.mult).toFixed(4)+i.unit,_+=":"+(100*(t.inspection_value>t.value?(t.inspection_value-t.value)/(t.USL-t.value):-(t.inspection_value-t.value)/(t.LSL-t.value))).toFixed(1)+"%",this.draw_Text(e,_,S,t.pt1.x,t.pt1.y+v)}else{e.save();var E=0;this.draw_Text(e,t.name,S,t.pt1.x,t.pt1.y),E+=S;var b="D"+t.value.toFixed(4)+i.unit;this.draw_Text(e,b,S,t.pt1.x,t.pt1.y+E),E+=S/2,S/=2,b="L:"+t.LSL*i.mult.toFixed(3)+i.unit+" U:"+t.USL*i.mult.toFixed(3)+i.unit,this.draw_Text(e,b,S,t.pt1.x,t.pt1.y+E),E+=S,b="Now:"+(Math.hypot(s.x-p.x,s.y-p.y)*i.mult).toFixed(4)+i.unit,this.draw_Text(e,b,S,t.pt1.x,t.pt1.y+E)}}}},{key:"drawSignature",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36;e.beginPath(),e.moveTo(t.magnitude[0]*Math.cos(t.angle[0]),t.magnitude[0]*Math.sin(t.angle[0]));for(var a=1;a<t.angle.length;a+=n)e.lineTo(t.magnitude[a]*Math.cos(t.angle[a]),t.magnitude[a]*Math.sin(t.angle[a]));e.closePath()}},{key:"drawShapeList",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=this,r=arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{unit:"mm",mult:1};t.forEach(function(t){if(null!=t&&void 0===a.find(function(e){return t.id==e}))switch(n&&(e.strokeStyle=t.color),t.type){case o.SHAPE_TYPE.line:e.lineWidth=2*t.margin,i.drawReportLine(e,{x0:t.pt1.x,y0:t.pt1.y,x1:t.pt2.x,y1:t.pt2.y});var l=(0,d.LineCentralNormal)(t);e.lineWidth=i.getSearchDirectionLineSize(),e.strokeStyle="rgba(100,50,100,0.8)";var u=t.margin+e.lineWidth/2;t.direction<0&&(u=-u),i.drawReportLine(e,{x0:t.pt1.x+l.vx*u,y0:t.pt1.y+l.vy*u,x1:t.pt2.x+l.vx*u,y1:t.pt2.y+l.vy*u}),e.strokeStyle="gray",i.drawpoint(e,t.pt1),i.drawpoint(e,t.pt2);break;case o.SHAPE_TYPE.aux_point:var c=i.db_obj,p=t.ref.map(function(e){return c.FindShape("id",e.id,r)}).map(function(e){return e>=0?r[e]:null});if(i.drawShapeList(e,p,n,a,r),void 0===t.id)break;var h=i.db_obj.auxPointParse(t,r);void 0!==h&&2==p.length&&(e.setLineDash([5*i.getPrimitiveSize(),15*i.getPrimitiveSize()]),e.beginPath(),e.moveTo(h.x,h.y),e.lineTo(p[0].pt1.x,p[0].pt1.y),e.stroke(),e.beginPath(),e.moveTo(h.x,h.y),e.lineTo(p[1].pt1.x,p[1].pt1.y),e.stroke(),e.setLineDash([]),e.strokeStyle="gray",i.drawpoint(e,h));break;case o.SHAPE_TYPE.arc:var f=(0,d.threePointToArc)(t.pt1,t.pt2,t.pt3);e.lineWidth=2*t.margin,i.drawReportArc(e,f),e.lineWidth=i.getSearchDirectionLineSize(),e.strokeStyle="rgba(100,50,100,0.8)";var S=t.margin+e.lineWidth/2;t.direction<0&&(S=-S),f.r+=S,i.drawReportArc(e,f),e.strokeStyle="gray",i.drawpoint(e,t.pt1),i.drawpoint(e,t.pt2),i.drawpoint(e,t.pt3);break;case o.SHAPE_TYPE.search_point:var _=i.db_obj,v=t.ref.map(function(e){return _.FindShape("id",e.id,r)}).map(function(e){return e>=0?r[e]:null});if(null==v[0])break;v[0];var E=_.shapeVectorParse(t,r),b={x:-E.y,y:E.x},m=t.width/2;E.x*=m,E.y*=m,e.lineWidth=2*t.margin,i.drawReportLine(e,{x0:t.pt1.x-E.x,y0:t.pt1.y-E.y,x1:t.pt1.x+E.x,y1:t.pt1.y+E.y}),e.lineWidth=i.getSearchDirectionLineSize(),e.strokeStyle="rgba(100,50,100,0.8)";var y=t.margin+e.lineWidth/2;i.drawReportLine(e,{x0:t.pt1.x-E.x+b.x*y,y0:t.pt1.y-E.y+b.y*y,x1:t.pt1.x+E.x+b.x*y,y1:t.pt1.y+E.y+b.y*y}),i.drawShapeList(e,v,n,a,r),e.strokeStyle="gray",i.drawpoint(e,t.pt1);break;case o.SHAPE_TYPE.measure:var g=i.db_obj;if(void 0===t.ref)break;var k=t.ref.map(function(e){return g.FindShapeObject("id",e.id,r)});if(!k.reduce(function(e,t){return e&&void 0!==t},!0))break;switch(n&&(void 0!==t.color?(e.strokeStyle=t.color,e.fillStyle=t.color):(e.strokeStyle=i.colorSet.measure_info,e.fillStyle=i.colorSet.measure_info)),t.subtype){case o.SHAPE_TYPE.measure_subtype.distance:i.drawMeasureDistance(e,t,k,r,s);break;case o.SHAPE_TYPE.measure_subtype.angle:var T=(0,d.intersectPoint)(k[0].pt1,k[0].pt2,k[1].pt1,k[1].pt2);e.lineWidth=i.getIndicationLineSize();var C=Math.atan2(k[0].pt1.y-T.y,k[0].pt1.x-T.x),A=Math.atan2(k[1].pt1.y-T.y,k[1].pt1.x-T.x),N=(A-C)%(2*Math.PI);N<0&&(N+=2*Math.PI),N>Math.PI&&(N-=Math.PI);var w=0,I=(Math.atan2(t.pt1.y-T.y,t.pt1.x-T.x)-C)%(2*Math.PI);I<0&&(I+=2*Math.PI),w=I<N?1:I<Math.PI?2:I<Math.PI+N?3:4,t.quadrant=w;var P,O=Math.hypot(t.pt1.y-T.y,t.pt1.x-T.x),D=(t.margin,Math.PI,C),x=C,M=A;switch(w%4){case 1:break;case 2:D+=N;break;case 3:D+=Math.PI;break;case 0:D=D+N+Math.PI}w%2==0&&(N=Math.PI-N),P=D+N,w%2==0?(x=P,M=D):(x=D,M=P),i.drawArcArrow(e,T.x,T.y,O,D,P),i.drawpoint(e,t.pt1);var U=180*N/Math.PI;e.setLineDash([5*i.getPrimitiveSize(),15*i.getPrimitiveSize()]),i.drawReportLine(e,{x0:k[0].pt1.x,y0:k[0].pt1.y,x1:T.x+O*Math.cos(x),y1:T.y+O*Math.sin(x)}),i.drawReportLine(e,{x0:k[1].pt1.x,y0:k[1].pt1.y,x1:T.x+O*Math.cos(M),y1:T.y+O*Math.sin(M)}),e.setLineDash([]);var L=t.pt1.x+(t.pt1.x-T.x)/O*4*i.getPrimitiveSize(),F=t.pt1.y+(t.pt1.y-T.y)/O*4*i.getPrimitiveSize(),R=i.getFontHeightPx();e.font=i.getFontStyle(1);var j=void 0;if(void 0!==t.inspection_value){var W=0;e.strokeStyle="black",e.lineWidth=i.getIndicationLineSize(),i.draw_Text(e,t.name,R,L,F),W+=R,j=t.inspection_value.toFixed(2)+"º",j+=":"+(100*(t.inspection_value>t.value?(t.inspection_value-t.value)/(t.USL-t.value):-(t.inspection_value-t.value)/(t.LSL-t.value))).toFixed(1)+"%",i.draw_Text(e,j,R,L,F+W)}else{e.save();var B=0;e.strokeStyle="black",e.lineWidth=i.getIndicationLineSize(),i.draw_Text(e,t.name,R,t.pt1.x,t.pt1.y),B+=R;var H=t.value.toFixed(4)+"º";i.draw_Text(e,H,R,L,F+B),B+=R/2,R/=2,H="L:"+t.LSL.toFixed(3)+"º U:"+t.USL.toFixed(3)+"º",i.draw_Text(e,H,R,L,F+B),B+=R,H="Now:"+U.toFixed(4)+"º",i.draw_Text(e,H,R,t.pt1.x,t.pt1.y+B)}break;case o.SHAPE_TYPE.measure_subtype.radius:e.lineWidth=i.getIndicationLineSize(),e.font=i.getFontStyle();var V=(0,d.threePointToArc)(k[0].pt1,k[0].pt2,k[0].pt3),G={x:t.pt1.x-V.x,y:t.pt1.y-V.y},X=Math.hypot(G.x,G.y),z={x:G.x/X,y:G.y/X};G.x*=V.r/X,G.y*=V.r/X;var Y=50*i.getPrimitiveSize();i.canvas_arrow(e,t.pt1.x,t.pt1.y,V.x+G.x,V.y+G.y,Y),i.drawpoint(e,t.pt1),z.x*=40*i.getPrimitiveSize(),z.y*=40*i.getPrimitiveSize();var K=i.getFontHeightPx();e.font=i.getFontStyle(1);if(void 0!==t.inspection_value){var J="R"+(t.inspection_value*s.mult).toFixed(4)+s.unit;J+=":"+(100*(t.inspection_value>t.value?(t.inspection_value-t.value)/(t.USL-t.value):-(t.inspection_value-t.value)/(t.LSL-t.value))).toFixed(1)+"%",e.strokeStyle="black",e.lineWidth=i.getIndicationLineSize(),i.draw_Text(e,t.name,K,t.pt1.x+z.x,t.pt1.y+z.y);var q=K;i.draw_Text(e,J,K,t.pt1.x+z.x,t.pt1.y+z.y+q)}else{e.save();var Q=0;e.strokeStyle="black",e.lineWidth=i.getIndicationLineSize(),i.draw_Text(e,t.name,K,t.pt1.x,t.pt1.y),Q+=K;var $="R"+t.value.toFixed(4)+s.unit;i.draw_Text(e,$,K,t.pt1.x,t.pt1.y+Q),Q+=K/2,K/=2,$="L:"+t.LSL*s.mult.toFixed(3)+s.unit+" U:"+t.USL*s.mult.toFixed(3)+s.unit,i.draw_Text(e,$,K,t.pt1.x,t.pt1.y+Q),Q+=K,$="Now:"+(V.r*s.mult).toFixed(4)+s.unit,i.draw_Text(e,$,K,t.pt1.x,t.pt1.y+Q)}}}})}},{key:"drawInspectionShapeList",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=this,r=arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{unit:"mm",mult:1},l=[];t.forEach(function(t){if(null!=t&&void 0===a.find(function(e){return t.id==e}))switch(n&&(e.strokeStyle=t.color),t.type){case o.SHAPE_TYPE.line:e.lineWidth=2*i.getPrimitiveSize(),i.drawReportLine(e,{x0:t.pt1.x,y0:t.pt1.y,x1:t.pt2.x,y1:t.pt2.y});break;case o.SHAPE_TYPE.arc:var s=(0,d.threePointToArc)(t.pt1,t.pt2,t.pt3);e.lineWidth=2*i.getPrimitiveSize(),i.drawReportArc(e,s);break;case o.SHAPE_TYPE.search_point:e.strokeStyle="gray",i.drawpoint(e,t.pt1,"rect");break;case o.SHAPE_TYPE.aux_point:var u=i.db_obj,c=t.ref.map(function(e){return u.FindShape("id",e.id,r)}).map(function(e){return e>=0?r[e]:null});if(void 0===t.id)break;var p=i.db_obj.auxPointParse(t,r);void 0!==p&&2==c.length&&(e.setLineDash([5*i.getPrimitiveSize(),15*i.getPrimitiveSize()]),e.beginPath(),e.moveTo(p.x,p.y),e.lineTo(c[0].pt1.x,c[0].pt1.y),e.stroke(),e.beginPath(),e.moveTo(p.x,p.y),e.lineTo(c[1].pt1.x,c[1].pt1.y),e.stroke(),e.setLineDash([]),e.strokeStyle="gray",i.drawpoint(e,p,"rect"));break;case o.SHAPE_TYPE.measure:l.push(t)}}),this.drawShapeList(e,l,n,a,r,s)}}]),e}(),k=function(){function e(t){var n=this;E(this,e),this.canvas=t,this.canvas.onmousemove=this.onmousemove.bind(this),this.canvas.onmousedown=this.onmousedown.bind(this),this.canvas.onmouseup=this.onmouseup.bind(this),this.canvas.onmouseout=this.onmouseout.bind(this),this.canvas.addEventListener("touchstart",function(e){var t=e.touches[0],a=new MouseEvent("mousedown",{clientX:t.clientX,clientY:t.clientY});n.canvas.dispatchEvent(a)},!1),this.canvas.addEventListener("touchmove",function(e){var t=e.touches[0],a=new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY});n.canvas.dispatchEvent(a)},!1),this.canvas.addEventListener("touchend",function(e){var t=new MouseEvent("mouseup",{});n.canvas.dispatchEvent(t)},!1),this.canvas.addEventListener("wheel",this.onmouseswheel.bind(this),!1),this.mouseStatus={x:-1,y:-1,px:-1,py:-1,status:0,pstatus:0},this.secCanvas_rawImg=null,this.secCanvas=document.createElement("canvas"),this.identityMat=new DOMMatrix,this.Mouse2SecCanvas=new DOMMatrix,this.camera=new y,this.camera.Scale(100),this.colorSet={unselected:"rgba(100,0,100,0.5)",inspection_Pass:"rgba(0,255,0,0.1)",inspection_Fail:"rgba(255,0,0,0.1)",editShape:"rgba(255,0,0,0.7)",measure_info:"rgba(128,128,200,0.7)"},this.rUtil=new g(null),this.rUtil.setColorSet(this.colorSet)}return r(e,[{key:"getMousePos",value:function(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}}]),r(e,[{key:"resourceClean",value:function(){this.canvas.removeEventListener("wheel",this.onmouseswheel.bind(this)),p.debug("resourceClean......")}},{key:"SetImg",value:function(e){if(p.debug("SetImg:::"),null!=e&&e!=this.secCanvas_rawImg){this.secCanvas.width=e.width,this.secCanvas.height=e.height,this.secCanvas_rawImg=e;var t=this.secCanvas.getContext("2d");t.putImageData(e,0,0),p.debug("SetImg::: UPDATE",t)}}},{key:"onmouseswheel",value:function(e){var t=e.deltaY/4;t>50&&(t=1),t<-50&&(t=-1);var n=1/1.01;return n=Math.pow(n,t),this.camera.Scale(n,{x:this.mouseStatus.x-this.canvas.width/2,y:this.mouseStatus.y-this.canvas.height/2}),this.draw(),!1}},{key:"onmousemove",value:function(e){var t=this.getMousePos(this.canvas,e);switch(this.mouseStatus.x=t.x,this.mouseStatus.y=t.y,this.state.substate){case o.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(null!=this.EditPoint)break;case o.UI_SM_STATES.DEFCONF_MODE_NEUTRAL:case o.UI_SM_STATES.INSP_MODE_NEUTRAL:1==this.mouseStatus.status&&this.camera.StartDrag({x:t.x-this.mouseStatus.px,y:t.y-this.mouseStatus.py})}this.ctrlLogic(),this.draw()}},{key:"onmousedown",value:function(e){var t=this.getMousePos(this.canvas,e);this.mouseStatus.px=t.x,this.mouseStatus.py=t.y,this.mouseStatus.x=t.x,this.mouseStatus.y=t.y,this.mouseStatus.status=1,this.ctrlLogic(),this.draw()}},{key:"onmouseup",value:function(e){var t=this.getMousePos(this.canvas,e);this.mouseStatus.x=t.x,this.mouseStatus.y=t.y,this.mouseStatus.status=0,this.camera.EndDrag(),this.ctrlLogic(),this.draw()}},{key:"onmouseout",value:function(e){1==this.mouseStatus.status&&this.onmouseup(e)}},{key:"resize",value:function(e,t){this.canvas.width=e,this.canvas.height=t,this.draw()}},{key:"worldTransform",value:function(){var e=new DOMMatrix;return e.translateSelf(this.canvas.width/2,this.canvas.height/2),this.camera.CameraTransform(e),e}},{key:"VecX2DMat",value:function(e,t){return{x:e.x*t.a+e.y*t.c+t.e,y:e.x*t.b+e.y*t.d+t.f}}}]),e}(),T=function(e){function t(e){E(this,t);var n=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.edit_DB_info=null,n.db_obj=null,n.mouse_close_dist=10,n.state=void 0,n.EditShape=null,n.CandEditPointInfo=null,n.EditPoint=null,n.EmitEvent=function(e){p.debug(e)},n}return v(t,k),r(t,[{key:"SetState",value:function(e){p.debug(e);var t=(0,u.xstate_GetCurrentMainState)(e),n=JSON.stringify(t);JSON.stringify(this.state)!==n&&(this.state=JSON.parse(n),this.state.state==o.UI_SM_STATES.DEFCONF_MODE&&this.state.substate==o.UI_SM_STATES.DEFCONF_MODE_NEUTRAL&&(this.EmitEvent(l.Edit_Tar_Update(null)),this.EditShape=null,this.EditPoint=null))}},{key:"EditDBInfoSync",value:function(e){if(this.edit_DB_info=e,this.db_obj=e._obj,void 0!==this.db_obj&&null!=this.db_obj&&void 0!==this.db_obj.cameraParam){this.rUtil.setEditor_db_obj(this.db_obj),this.SetImg(e.img);var t=this.db_obj.getsig360info_mmpp();this.rUtil.renderParam.mmpp=t}}},{key:"fitCameraToShape",value:function(e){if(null!=e&&void 0!==e){var t={x:0,y:0};switch(e.type){case o.SHAPE_TYPE.line:t.x=(e.pt1.x+e.pt2.x)/2,t.y=(e.pt1.y+e.pt2.y)/2;break;case o.SHAPE_TYPE.arc:var n=(0,d.threePointToArc)(e.pt1,e.pt2,e.pt3);n.r>500?(t.x=(e.pt1.x+e.pt3.x)/2,t.y=(e.pt1.y+e.pt3.y)/2):(t.x=n.x,t.y=n.y);break;case o.SHAPE_TYPE.aux_point:var a=this.db_obj.auxPointParse(e);if(null==a)return;t=a;break;case o.SHAPE_TYPE.search_point:t=e.pt1;break;default:return}this.camera.SetOffset({x:-t.x,y:-t.y})}}},{key:"ctrlLogic",value:function(){}},{key:"setMatrix",value:function(e,t){e.setTransform(t.a,t.b,t.c,t.d,t.e,t.f)}},{key:"draw",value:function(){if(void 0!==this.db_obj&&null!=this.db_obj&&void 0!==this.db_obj.cameraParam){var e=this.rUtil.get_mmpp(),t=this.canvas.getContext("2d");this.secCanvas.getContext("2d");t.lineWidth=this.rUtil.getIndicationLineSize(),this.setMatrix(t,this.identityMat),t.clearRect(0,0,this.canvas.width,this.canvas.height);var n=this.worldTransform();this.setMatrix(t,n);var a=this.db_obj.getsig360infoCenter();t.save(),t.translate(-a.x,-a.y),t.scale(4*e,4*e),t.drawImage(this.secCanvas,0,0),t.restore();this.Mouse2SecCanvas=n.invertSelf();var i=this.Mouse2SecCanvas,r=this.mouseStatus;this.VecX2DMat(r,i);t.closePath(),t.save();this.rUtil.drawShapeList(t,this.edit_DB_info.list,!0,[],this.edit_DB_info.list,{unit:"mm",mult:1}),this.rUtil.drawInherentShapeList(t,this.edit_DB_info.inherentShapeList)}}}]),t}(),C=function(e){function t(e){E(this,t);var n=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.ERROR_LOCK=!1,n.edit_DB_info=null,n.db_obj=null,n.mouse_close_dist=10,n.colorSet=Object.assign(n.colorSet,{inspection_Pass:"rgba(0,255,0,0.1)",inspection_production_Fail:"rgba(128,128,0,0.3)",inspection_Fail:"rgba(255,0,0,0.1)",inspection_NA:"rgba(64,64,64,0.1)",color_NA:"rgba(128,128,128,0.5)",color_SUCCESS:n.colorSet.measure_info,color_FAILURE_opt:{submargin1:"rgba(255,255,0,0.5)"},color_FAILURE:"rgba(255,0,0,0.5)"}),n.state=void 0,n.EditShape=null,n.CandEditPointInfo=null,n.EditPoint=null,n.EmitEvent=function(e){p.info(e)},n}return v(t,k),r(t,[{key:"SetState",value:function(e){p.debug(e);var t=(0,u.xstate_GetCurrentMainState)(e),n=JSON.stringify(t);JSON.stringify(this.state)!==n&&(this.state=JSON.parse(n))}},{key:"EditDBInfoSync",value:function(e){this.edit_DB_info=e,this.db_obj=e._obj,this.rUtil.setEditor_db_obj(this.db_obj),this.SetImg(e.img);var t=this.db_obj.cameraParam.mmpb2b/this.db_obj.cameraParam.ppb2b;this.rUtil.renderParam.mmpp=t}},{key:"SetShape",value:function(e,t){this.tmp_EditShape_id=t,this.EmitEvent(l.Shape_Set({shape:e,id:t}))}},{key:"inspectionResult",value:function(e){var t=e.judgeReports.reduce(function(e,t){return e==c.INSPECTION_STATUS.NA?e:e==c.INSPECTION_STATUS.FAILURE?t.status==c.INSPECTION_STATUS.NA?c.INSPECTION_STATUS.NA:e:t.status},c.INSPECTION_STATUS.SUCCESS);return null==t?c.INSPECTION_STATUS.NA:t}},{key:"draw",value:function(){this.draw_INSP()}},{key:"draw_INSP",value:function(){var e=this;if(!this.ERROR_LOCK&&null!=this.edit_DB_info&&null!=this.edit_DB_info.inspReport&&null!=this.edit_DB_info.inspReport){var t,n=this.edit_DB_info.reportStatisticState.trackingWindow.filter(function(e){return e.isCurObj});t={unit:"mm",mult:1};var a=this.canvas.getContext("2d");this.secCanvas.getContext("2d");a.lineWidth=this.rUtil.getIndicationLineSize(),a.resetTransform(),a.clearRect(0,0,this.canvas.width,this.canvas.height);var i=this.worldTransform();a.setTransform(i.a,i.b,i.c,i.d,i.e,i.f);var r=4*this.rUtil.get_mmpp();a.translate(-this.secCanvas.width*r/2,-this.secCanvas.height*r/2),a.save(),a.scale(r,r),a.drawImage(this.secCanvas,0,0),a.restore();void 0!==this.edit_DB_info.list&&this.edit_DB_info.list.reduce(function(e,t){return t.type==o.SHAPE_TYPE.measure&&e.push(t),e},[]),n.forEach(function(t,n){switch(a.save(),a.translate(t.cx,t.cy),a.rotate(-t.rotate),t.isFlipped&&a.scale(1,-1),a.scale(1,1),e.rUtil.drawSignature(a,e.edit_DB_info.inherentShapeList[0].signature,5),e.inspectionResult(t)){case c.INSPECTION_STATUS.NA:a.fillStyle=e.colorSet.inspection_NA;break;case c.INSPECTION_STATUS.SUCCESS:a.fillStyle=e.colorSet.inspection_Pass;Number.MAX_VALUE;e.edit_DB_info.list.forEach(function(e){if(e.type===o.SHAPE_TYPE.measure){var n=e.id,i=t.judgeReports.find(function(e){return e.id===n});if(void 0===i)return;a.fillStyle=m[i.detailStatus].COLOR}});break;case c.INSPECTION_STATUS.FAILURE:a.fillStyle=e.colorSet.inspection_Fail}a.fill(),a.restore(),a.strokeStyle="black"}),n.forEach(function(n,i){var r=(0,f.default)(e.edit_DB_info.list);e.db_obj.ShapeListAdjustsWithInspectionResult(r,n),r.forEach(function(t){switch(t.inspection_status){case c.INSPECTION_STATUS.NA:t.color=e.colorSet.color_NA;break;case c.INSPECTION_STATUS.SUCCESS:if(t.color=e.colorSet.color_SUCCESS,t.type===o.SHAPE_TYPE.measure){var a=t.id,i=n.judgeReports.find(function(e){return e.id===a});if(void 0===i)break;t.color=m[i.detailStatus].COLOR}break;case c.INSPECTION_STATUS.FAILURE:t.color=e.colorSet.color_FAILURE}}),e.rUtil.drawInspectionShapeList(a,r,!0,[],r,t)})}}},{key:"ctrlLogic",value:function(){if(null===this.edit_DB_info.inherentShapeList||void 0===this.edit_DB_info.inherentShapeList||0==this.edit_DB_info.inherentShapeList.length)return this.ERROR_LOCK=!0,void this.EmitEvent({type:"ERROR",data:"Define Config is not valid or the corrupted..."});var e=this.worldTransform(),t=(new DOMMatrix).setMatrixValue(e).invertSelf(),n=this.mouseStatus,a=this.VecX2DMat(n,t),i={x:this.mouseStatus.px,y:this.mouseStatus.py};this.VecX2DMat(i,t),this.mouseStatus.status,this.mouseStatus.pstatus;this.EmitEvent((0,o.EV_UI_Canvas_Mouse_Location)(a))}}]),t}(),A=function(e){function t(e){E(this,t);var n=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.edit_DB_info=null,n.db_obj=null,n.mouse_close_dist=10,n.state=void 0,n.EditShape=null,n.CandEditPointInfo=null,n.EditPoint=null,n.EmitEvent=function(e){p.debug(e)},n}return v(t,k),r(t,[{key:"SetState",value:function(e){p.debug(e);var t=(0,u.xstate_GetCurrentMainState)(e),n=JSON.stringify(t);JSON.stringify(this.state)!==n&&(this.state=JSON.parse(n),this.state.state==o.UI_SM_STATES.DEFCONF_MODE&&this.state.substate==o.UI_SM_STATES.DEFCONF_MODE_NEUTRAL&&(this.EmitEvent(l.Edit_Tar_Update(null)),this.EditShape=null,this.EditPoint=null))}},{key:"EditDBInfoSync",value:function(e){this.edit_DB_info=e,this.db_obj=e._obj,this.rUtil.setEditor_db_obj(this.db_obj),this.SetImg(e.img),this.SetEditShape(e.edit_tar_info);var t=this.db_obj.getsig360info_mmpp();this.rUtil.renderParam.mmpp=t}},{key:"SetShape",value:function(e,t){this.tmp_EditShape_id=t,this.EmitEvent(l.Shape_Set({shape:e,id:t}))}},{key:"SetEditShape",value:function(e){this.EditShape=e,p.debug(this.tmp_EditShape_id),null!=this.EditShape&&null!=this.EditShape.id&&this.tmp_EditShape_id!=this.EditShape.id&&(null!=this.tmp_EditShape_id&&this.fitCameraToShape(this.EditShape),this.tmp_EditShape_id=this.EditShape.id)}},{key:"AvailableShapeFilter",value:function(e){var t=void 0,n=void 0;switch(this.state.substate){case o.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:t=o.SHAPE_TYPE.aux_point;break;case o.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:t=o.SHAPE_TYPE.search_point;break;case o.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:t=o.SHAPE_TYPE.measure,void 0!==this.EditShape&&null!==this.EditShape&&(n=this.EditShape.subtype);break;case o.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:var a=this.edit_DB_info.edit_tar_ele_trace,i=this.edit_DB_info.edit_tar_info;void 0!==i&&null!==a&&(n=i.subtype,t=i.type)}switch(t){case o.SHAPE_TYPE.aux_point:case o.SHAPE_TYPE.search_point:return e.filter(function(e){return e.type===o.SHAPE_TYPE.line});case o.SHAPE_TYPE.measure:switch(n){case o.SHAPE_TYPE.measure_subtype.distance:return e;case o.SHAPE_TYPE.measure_subtype.angle:return e.filter(function(e){return e.type===o.SHAPE_TYPE.line});case o.SHAPE_TYPE.measure_subtype.radius:return e.filter(function(e){return e.type===o.SHAPE_TYPE.arc})}}return e}},{key:"fitCameraToShape",value:function(e){if(null!=e&&void 0!==e){var t={x:0,y:0};switch(e.type){case o.SHAPE_TYPE.line:t.x=(e.pt1.x+e.pt2.x)/2,t.y=(e.pt1.y+e.pt2.y)/2;break;case o.SHAPE_TYPE.arc:var n=(0,d.threePointToArc)(e.pt1,e.pt2,e.pt3);n.r>500?(t.x=(e.pt1.x+e.pt3.x)/2,t.y=(e.pt1.y+e.pt3.y)/2):(t.x=n.x,t.y=n.y);break;case o.SHAPE_TYPE.aux_point:var a=this.db_obj.auxPointParse(e);if(null==a)return;t=a;break;case o.SHAPE_TYPE.search_point:t=e.pt1;break;default:return}this.camera.SetOffset({x:-t.x,y:-t.y})}}},{key:"draw",value:function(){this.draw_DEFCONF()}},{key:"ctrlLogic",value:function(){this.ctrlLogic_DEFCONF()}},{key:"setMatrix",value:function(e,t){e.setTransform(t.a,t.b,t.c,t.d,t.e,t.f)}},{key:"draw_DEFCONF",value:function(){var e=this.rUtil.get_mmpp(),t=this.canvas.getContext("2d");this.secCanvas.getContext("2d");t.lineWidth=this.rUtil.getIndicationLineSize(),this.setMatrix(t,this.identityMat),t.clearRect(0,0,this.canvas.width,this.canvas.height);var n=this.worldTransform();this.setMatrix(t,n);var a=this.db_obj.getsig360infoCenter();t.save(),t.translate(-a.x,-a.y),t.scale(4*e,4*e),t.drawImage(this.secCanvas,0,0),t.restore();var i={unit:"mm",mult:1};this.Mouse2SecCanvas=n.invertSelf();var r=this.Mouse2SecCanvas,o=this.mouseStatus;this.VecX2DMat(o,r);t.closePath(),t.save();var s=[];if(null!=this.EditShape&&(s.push(this.EditShape.id),t.strokeStyle=this.colorSet.editShape,this.rUtil.drawShapeList(t,[this.EditShape],!1,[],this.edit_DB_info.list,i)),null!=this.CandEditPointInfo){var l=this.CandEditPointInfo;void 0===s.find(function(e){return l.shape.id==e}.bind(this))&&(s.push(l.shape.id),t.strokeStyle="rgba(255,0,255,0.5)",this.rUtil.drawShapeList(t,[l.shape],!1,[],this.edit_DB_info.list,i))}var u=this.AvailableShapeFilter(this.edit_DB_info.list);this.rUtil.drawShapeList(t,u,!0,s,u,i),this.rUtil.drawInherentShapeList(t,this.edit_DB_info.inherentShapeList),null!=this.EditPoint&&(t.strokeStyle="green",this.rUtil.drawpoint(t,this.EditPoint,2*this.rUtil.getPointSize())),null!=this.CandEditPointInfo&&(t.strokeStyle="rgba(0,255,0,0.3)",this.rUtil.drawpoint(t,this.CandEditPointInfo.pt,2*this.rUtil.getPointSize()))}},{key:"ctrlLogic_DEFCONF",value:function(){this.rUtil.get_mmpp();var e=this.worldTransform(),t=(new DOMMatrix).setMatrixValue(e).invertSelf(),n=this.mouseStatus,a=this.VecX2DMat(n,t),i={x:this.mouseStatus.px,y:this.mouseStatus.py},r=this.VecX2DMat(i,t),s=this.mouseStatus.status!=this.mouseStatus.pstatus;switch(this.state.substate){case o.UI_SM_STATES.DEFCONF_MODE_LINE_CREATE:1==this.mouseStatus.status?this.EditShape={type:o.SHAPE_TYPE.line,pt1:a,pt2:r,margin:.3,color:this.colorSet.unselected,direction:1}:null!=this.EditShape&&s&&(this.SetShape(this.EditShape),this.EmitEvent(l.SUCCESS()));break;case o.UI_SM_STATES.DEFCONF_MODE_ARC_CREATE:if(1==this.mouseStatus.status){var u=(0,d.LineCentralNormal)({pt1:a,pt2:r});this.EditShape={type:o.SHAPE_TYPE.arc,pt1:a,pt2:{x:u.x+u.vx,y:u.y+u.vy},pt3:r,margin:.3,color:this.colorSet.unselected,direction:1}}else null!=this.EditShape&&s&&(this.SetShape(this.EditShape),this.EmitEvent(l.SUCCESS()));break;case o.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:case o.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:case o.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:if(1==this.mouseStatus.status)s&&null!=this.CandEditPointInfo&&(this.state.substate==o.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE?(this.EditShape={type:o.SHAPE_TYPE.search_point,pt1:{x:0,y:0},angleDeg:90,margin:.15,width:.5,ref:[{id:this.CandEditPointInfo.shape.id,element:this.CandEditPointInfo.shape.type}],color:this.colorSet.unselected},this.SetShape(this.EditShape),this.EmitEvent(l.SUCCESS())):(p.debug(s,this.CandEditPointInfo),this.EmitEvent(l.Edit_Tar_Ele_Cand_Update(this.CandEditPointInfo))));else{var c=this.AvailableShapeFilter(this.edit_DB_info.list),h=this.db_obj.FindClosestCtrlPointInfo(a,c),S=this.AvailableShapeFilter(this.edit_DB_info.inherentShapeList),_=this.db_obj.FindClosestInherentPointInfo(a,S);h.dist>_.dist&&(h=_),null!=h.pt&&h.dist<this.mouse_close_dist/this.camera.GetCameraScale()?this.CandEditPointInfo=h:this.CandEditPointInfo=null}break;case o.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(1==this.mouseStatus.status)if(s){var v=this.edit_DB_info.edit_tar_ele_trace;if(null==v||void 0===v){if(null!=this.CandEditPointInfo){var E=this.CandEditPointInfo;this.CandEditPointInfo=null,this.EditShape=(0,f.default)(E.shape),this.EditPoint=this.EditShape[E.key],this.tmp_EditShape_id=this.EditShape.id}else this.EditPoint=null,this.EditShape=null;this.EmitEvent(l.Edit_Tar_Update(this.EditShape))}else null!=this.CandEditPointInfo?this.EmitEvent(l.Edit_Tar_Ele_Cand_Update(this.CandEditPointInfo)):this.EmitEvent(l.Edit_Tar_Ele_Trace_Update(null))}else null!=this.EditPoint&&(this.EditPoint.x=a.x,this.EditPoint.y=a.y,this.EmitEvent(l.Edit_Tar_Update(this.EditShape)));else{null!=this.EditShape&&s&&this.SetShape(this.EditShape,this.EditShape.id);var b=this.AvailableShapeFilter(this.edit_DB_info.list),m=this.db_obj.FindClosestCtrlPointInfo(a,b),y=this.AvailableShapeFilter(this.edit_DB_info.inherentShapeList),g=this.db_obj.FindClosestInherentPointInfo(a,y);m.dist>g.dist&&(m=g),null!=m.pt&&m.dist<this.mouse_close_dist/this.camera.GetCameraScale()?this.CandEditPointInfo=m:this.CandEditPointInfo=null}}this.mouseStatus.pstatus=this.mouseStatus.status}}]),t}();t.default={Preview_CanvasComponent:T,INSP_CanvasComponent:C,DEFCONF_CanvasComponent:A}},284:function(e,t,n){"use strict";var a,i,r,o,s,l,u,d,c,p,h,f,S;Object.defineProperty(t,"__esModule",{value:!0}),t.ReduxStoreSetUp=function(e){var t=(0,_.combineReducers)({UIData:v.default}),n=(0,_.applyMiddleware)(y.default,new m.MWWebSocket({}),new b.ECStateMachine({ev_state_update:"ev_state_update",state_config:O}),new E.ActionThrottle({time:100,posEdge:!0}));return(0,_.createStore)(t,e,n)};var _=n(230),v=T(n(716)),E=n(805),b=n(806),m=n(321),y=T(n(807)),g=n(33),k=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(63));function T(e){return e&&e.__esModule?e:{default:e}}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=g.UI_SM_STATES,N=g.UI_SM_EVENT,w={initial:A.DEFCONF_MODE_NEUTRAL,states:(d={},C(d,A.DEFCONF_MODE_NEUTRAL,{on:(a={},C(a,N.Line_Create,A.DEFCONF_MODE_LINE_CREATE),C(a,N.Arc_Create,A.DEFCONF_MODE_ARC_CREATE),C(a,N.Search_Point_Create,A.DEFCONF_MODE_SEARCH_POINT_CREATE),C(a,N.Aux_Point_Create,A.DEFCONF_MODE_AUX_POINT_CREATE),C(a,N.Shape_Edit,A.DEFCONF_MODE_SHAPE_EDIT),C(a,N.Measure_Create,A.DEFCONF_MODE_MEASURE_CREATE),a)}),C(d,A.DEFCONF_MODE_SEARCH_POINT_CREATE,{on:(i={},C(i,k.EVENT.SUCCESS,A.DEFCONF_MODE_SHAPE_EDIT),C(i,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),i)}),C(d,A.DEFCONF_MODE_AUX_POINT_CREATE,{on:(r={},C(r,k.EVENT.SUCCESS,A.DEFCONF_MODE_SHAPE_EDIT),C(r,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),r)}),C(d,A.DEFCONF_MODE_LINE_CREATE,{on:(o={},C(o,k.EVENT.SUCCESS,A.DEFCONF_MODE_SHAPE_EDIT),C(o,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),o)}),C(d,A.DEFCONF_MODE_ARC_CREATE,{on:(s={},C(s,k.EVENT.SUCCESS,A.DEFCONF_MODE_SHAPE_EDIT),C(s,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),s)}),C(d,A.DEFCONF_MODE_SHAPE_EDIT,{on:(l={},C(l,k.EVENT.SUCCESS,A.DEFCONF_MODE_NEUTRAL),C(l,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),l)}),C(d,A.DEFCONF_MODE_MEASURE_CREATE,{on:(u={},C(u,k.EVENT.SUCCESS,A.DEFCONF_MODE_SHAPE_EDIT),C(u,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),u)}),d)},I={initial:A.INSP_MODE_NEUTRAL,states:C({},A.INSP_MODE_NEUTRAL,{on:{}})},P={initial:A.ANALYSIS_MODE_NEUTRAL,states:C({},A.ANALYSIS_MODE_NEUTRAL,{on:{}})},O={initial:A.SPLASH,states:(S={},C(S,A.SPLASH,{on:C({},N.Connected,A.MAIN)}),C(S,A.MAIN,{on:(c={},C(c,N.Edit_Mode,A.DEFCONF_MODE),C(c,N.Insp_Mode,A.INSP_MODE),C(c,N.Analysis_Mode,A.ANALYSIS_MODE),C(c,N.Disonnected,A.SPLASH),C(c,N.EXIT,A.SPLASH),c)}),C(S,A.DEFCONF_MODE,Object.assign({on:(p={},C(p,N.Disonnected,A.SPLASH),C(p,N.EXIT,A.MAIN),p)},w)),C(S,A.INSP_MODE,Object.assign({on:(h={},C(h,N.Disonnected,A.SPLASH),C(h,N.ERROR,A.MAIN),C(h,N.EXIT,A.MAIN),h)},I)),C(S,A.ANALYSIS_MODE,Object.assign({on:(f={},C(f,N.Disonnected,A.SPLASH),C(f,N.ERROR,A.MAIN),C(f,N.EXIT,A.MAIN),f)},P)),S)}},285:function(e,t,n){"use strict";function a(e,t){var n=void 0;n=void 0===e.vx?{x:(e.x1+e.x2)/2,y:(e.y1+e.y2)/2,vx:e.x2-e.x1,vy:e.y2-e.y1}:{x:e.cx,y:e.cy,vx:e.vx,vy:e.vy};var a=Math.hypot(n.vx,n.vy);n.vx/=a,n.vy/=a;var i={x:t.x,y:t.y};i.x-=n.x,i.y-=n.y;var r=n.vx*i.x+n.vy*i.y;return n.x+=r*n.vx,n.y+=r*n.vy,n.dist=r,n}function i(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return a=a>=0?1:-1,{x:e.x*n-a*e.y*t,y:e.x*t+a*e.y*n}}Object.defineProperty(t,"__esModule",{value:!0}),t.distance_point_point=function(e,t){return Math.hypot(e.x-t.x,e.y-t.y)},t.distance_arc_point=function(e,t){var n=Math.atan2(t.y-e.y,t.x-e.x),a=n,i=e.angleFrom,r=e.angleTo;n-=i,r-=i,n%=2*Math.PI,r%=2*Math.PI,n<0&&(n+=2*Math.PI);r<0&&(r+=2*Math.PI);if(i=0,n<r)return n=a,{x:e.r*Math.cos(n)+e.x,y:e.r*Math.sin(n)+e.y,dist:Math.abs(Math.hypot(t.x-e.x,t.y-e.y)-e.r)};i=e.angleFrom,r=e.angleTo;var o={x:e.r*Math.cos(r)+e.x,y:e.r*Math.sin(r)+e.y},s={x:e.r*Math.cos(i)+e.x,y:e.r*Math.sin(i)+e.y},l=Math.hypot(t.x-o.x,t.y-o.y),u=Math.hypot(t.x-s.x,t.y-s.y);if(l<u)return o.dist=l,o;return s.dist=u,s},t.closestPointOnLine=a,t.intersectPoint=function(e,t,n,a){var i={x:0,y:0},r=void 0,o=e.x-t.x,s=n.x-a.x,l=e.y-t.y,u=n.y-a.y;r=o*u-l*s;var d=e.x*t.y-e.y*t.x,c=n.x*a.y-n.y*a.x;return i.x=(d*s-o*c)/r,i.y=(d*u-l*c)/r,i},t.vecXY_addin=function(e,t){return e.x+=t.x,e.y+=t.y,e},t.vecXY_mulin=function(e,t){return e.x*=t,e.y*=t,e},t.distance_line_point=function(e,t){var n=a(e,t),i=void 0;i=Math.abs(e.x2-e.x1)>Math.abs(e.y2-e.y1)?(n.x-e.x1)/(e.x2-e.x1):(n.y-e.y1)/(e.y2-e.y1);if(i>1){var r=Math.hypot(t.x-e.x2,t.y-e.y2);return{x:e.x2,y:e.y2,dist:r}}if(i>0){var o=Math.hypot(t.x-n.x,t.y-n.y);return n.dist=o,n}var s=Math.hypot(t.x-e.x1,t.y-e.y1);return{x:e.x1,y:e.y1,dist:s}},t.threePointToArc=function(e,t,n){var a=t.x*t.x+t.y*t.y,i=(e.x*e.x+e.y*e.y-a)/2,r=(a-n.x*n.x-n.y*n.y)/2,o=(e.x-t.x)*(t.y-n.y)-(t.x-n.x)*(e.y-t.y),s=(i*(t.y-n.y)-r*(e.y-t.y))/o,l=(r*(e.x-t.x)-i*(t.x-n.x))/o,u=Math.sqrt(Math.pow(t.x-s,2)+Math.pow(t.y-l,2)),d=Math.atan2(e.y-l,e.x-s),c=Math.atan2(t.y-l,t.x-s),p=Math.atan2(n.y-l,n.x-s),h=(d-c+4*Math.PI)%(2*Math.PI);(d-p+4*Math.PI)%(2*Math.PI)>h&&(h=d,d=p,p=h);return{x:s,y:l,r:u,thetaS:d,thetaE:p}},t.LineCentralNormal=function(e){var t=e.pt2.y-e.pt1.y,n=e.pt2.x-e.pt1.x,a=Math.hypot(t,n);return{x:(e.pt1.x+e.pt2.x)/2,y:(e.pt1.y+e.pt2.y)/2,vx:t/a,vy:-n/a}},t.PtRotate2d_sc=i,t.PtRotate2d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=Math.sin(t),r=Math.cos(t);return i(e,a,r,n)}},321:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=t.MWWS_EVENT={ERROR:"MWWS_ERROR",CONNECT:"MWWS_CONNECT",DISCONNECT:"MWWS_DISCONNECT",SEND:"MWWS_SEND"};t.MWWebSocket=function(e){return function(t){return function(n){return function(i){if(null==i.type||!i.type.startsWith("MWWS_"))return n(i);var r=i.data,o=r.id;if(void 0===o&&(o=r.url),void 0===o)return n({type:a.ERROR,data:{str:"no id/url is found",info:r}});switch(i.type){case a.CONNECT:void 0!==e[o]&&t.dispatch({type:a.DISCONNECT,data:e[o]}),e[o]=void 0,r.websocket=new WebSocket(r.url),void 0!==r.binaryType&&(r.websocket.binaryType=r.binaryType),r.websocket.onopen=function(e){this.onopen(e,this)}.bind(r),r.websocket.onmessage=function(e){this.onmessage(e,this)}.bind(r),r.websocket.onclose=function(t){this.onclose(t,this),e[this.id]=void 0}.bind(r),r.websocket.onerror=function(t){this.onerror(t,this),e[this.id]=void 0}.bind(r),e[o]=r;break;case a.SEND:if(void 0===e[o])return n({type:a.MWWS_ERROR});void 0===e[o].send?e[o].websocket.send(r.data):e[o].send(r.data,e[o],r.promiseCBs);break;case a.DISCONNECT:e[o].websocket.close()}return n(i)}}}}},33:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.UI_SM_EVENT=t.DEFAULT_UNIT=t.SHAPE_TYPE=t.SAK=t.SHAPE_ATTR_KEY=t.UI_SM_STATES=void 0,t.EV_WS_ChannelUpdate=function(e){return{type:s.WS_channel,data:e}},t.EV_UI_EC_Save_Def_Config=function(e){return{type:s.EC_Save_Def_Config,data:e}},t.EV_UI_EC_Load_Def_Config=function(e){return{type:s.EC_Load_Def_Config,data:e}},t.EV_UI_Version_Map_Update=function(e){return{type:s.Version_Map_Update,data:e}},t.EV_WS_Connected=function(e){return{type:s.Connected,data:e}},t.EV_WS_Disconnected=function(e){return{type:s.Disonnected,data:e}},t.EV_UI_Edit_Mode=function(){return{type:s.Edit_Mode}},t.EV_UI_Insp_Mode=function(){return{type:s.Insp_Mode}},t.EV_UI_Analysis_Mode=function(){return{type:s.Analysis_Mode}},t.EV_UI_ACT=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:e,data:t,misc:n}},t.Def_Model_Path_Update=function(e){return{type:s.Def_Model_Path_Update,data:e}},t.EV_UI_Canvas_Mouse_Location=function(e){return{type:s.Canvas_Mouse_Location,data:e}},t.EV_WS_Inspection_Report=function(e){return{type:s.Inspection_Report,data:e}},t.EV_WS_Image_Update=function(e){return{type:s.Image_Update,data:e}},t.EV_WS_MinRepeatInspReport_Update=function(e){return{type:s.MinRepeatInspReport_Update,data:e}},t.EV_WS_Define_File_Update=function(e){return{type:s.Define_File_Update,data:e}},t.EV_WS_SIG360_Extraction=function(e){return{type:s.SIG360_Extraction,data:e}},t.EV_WS_SIG360_Report_Update=function(e){return{type:s.SIG360_Report_Update,data:e}},t.EV_WS_SEND=function(e,t,n,a,i,r){return{type:"MWWS_SEND",data:{id:e,data:{tl:t,prop:n,data:a,uintArr:i},promiseCBs:r}}};n(41);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.UI_SM_STATES={SPLASH:"SPLASH",MAIN:"MAIN",DEFCONF_MODE:"DEFCONF_MODE",DEFCONF_MODE_NEUTRAL:"DEFCONF_MODE_NEUTRAL",DEFCONF_MODE_LINE_CREATE:"LINE_CREATE",DEFCONF_MODE_AUX_LINE_CREATE:"AUX_LINE_CREATE",DEFCONF_MODE_AUX_POINT_CREATE:"AUX_POINT_CREATE",DEFCONF_MODE_SEARCH_POINT_CREATE:"SEARCH_POINT_CREATE",DEFCONF_MODE_MEASURE_CREATE:"MEASURE_CREATE",DEFCONF_MODE_ARC_CREATE:"ARC_CREATE",DEFCONF_MODE_SHAPE_EDIT:"SHAPE_EDIT",INSP_MODE:"INSP_MODE",INSP_MODE_NEUTRAL:"INSP_MODE_NEUTRAL",ANALYSIS_MODE:"ANALYSIS_MODE",ANALYSIS_MODE_NEUTRAL:"ANALYSIS_MODE_NEUTRAL"};var r=t.SHAPE_ATTR_KEY={id:"id",name:"name",color:"color",type:"type",ref:"ref",element:"element"},o=(t.SAK=r,t.SHAPE_TYPE={sign360:"sign360",point:"point",line:"line",arc:"arc",aux_point:"aux_point",aux_line:"aux_line",search_point:"search_point",measure:"measure",measure_subtype:{NA:"NA",sigma:"sigma",distance:"distance",angle:"angle",radius:"radius"}}),s=(t.DEFAULT_UNIT=(i(a={},o.measure_subtype.sigma,""),i(a,o.measure_subtype.distance,"mm"),i(a,o.measure_subtype.angle,"º"),i(a,o.measure_subtype.radius,"mm"),a),t.UI_SM_EVENT={Connected:"Connected",Disonnected:"Disonnected",_SUCCESS:"_SUCCESS",_FAIL:"_FAIL",EXIT:"EXIT",ERROR:"ERROR",Version_Map_Update:"Version_Map_Update",Def_Model_Path_Update:"Def_Model_Path_Update",WS_channel:"WS_channel",Edit_Mode:"Edit_Mode",Insp_Mode:"Insp_Mode",Analysis_Mode:"Analysis_Mode",Inspection_Report:"Inspection_Report",Image_Update:"Image_Update",MinRepeatInspReport_Update:"MinRepeatInspReport_Update",Define_File_Update:"Define_File_Update",SIG360_Report_Update:"SIG360_Report_Update",SIG360_Extraction:"SIG360_Extraction",Line_Create:"Line_Create",Arc_Create:"Arc_Create",Aux_Line_Create:"Aux_Line_Create",Search_Point_Create:"Search_Point_Create",Aux_Point_Create:"Aux_Point_Create",Shape_Edit:"Shape_Edit",Measure_Create:"Measure_Create",EC_Save_Def_Config:"EC_Save_Def_Config",EC_Load_Def_Config:"EC_Load_Def_Config",Control_SM_Panel:"Control_SM_Panel",Canvas_Mouse_Location:"Canvas_Mouse_Location"})},41:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEF_EXTENSION=t.INSPECTION_STATUS=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(33));var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e.data instanceof ArrayBuffer&&e.data.byteLength>=9){var n=new Uint8ClampedArray(e.data,t,9),a={};return a.type=String.fromCharCode(n[0],n[1]),a.prop=n[2],a.pgID=(n[3]<<8)+n[4],a.length=n[5]<<24|n[6]<<16|n[7]<<8|n[8],a}return null},r=new TextEncoder,o=t.INSPECTION_STATUS={NA:-128,SUCCESS:0,FAILURE:-1};t.DEF_EXTENSION="hydef";t.default={raw2header:i,raw2obj_rawdata:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=i(e,t);return null==n?null:(n.rawdata=new Uint8ClampedArray(e.data,t+9,n.length),n)},raw2obj:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=i(e,t);if(null==n)return null;n.rawdata=new Uint8ClampedArray(e.data,t+9,n.length);var a=new TextDecoder("utf-8").decode(n.rawdata);return n.data=JSON.parse(a),n},raw2Obj_IM:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=i(e,t);if(null==n)return null;var a=new Uint8ClampedArray(e.data,t+9,6);n.camera_id=a[0],n.session_id=a[1],n.width=a[2]<<8|a[3],n.height=a[4]<<8|a[5];n.width,n.height;return n.image=new Uint8ClampedArray(e.data,t+9+6,4*n.width*n.height),n},objbarr2raw:function(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=null==a?"":JSON.stringify(a),s=r.encode(o),l=s.length,u=i instanceof Uint8Array?i.length:0,d=new Uint8Array(9+l+1+u);d[0]=e.charCodeAt(0),d[1]=e.charCodeAt(1),d[2]=t,d[3]=n>>1,d[4]=255&n;var c=d.length-9;return d[5]=c>>24,d[6]=c>>16,d[7]=c>>8,d[8]=c,0!=l&&d.set(s,9),d[9+l]=0,0!=u&&d.set(i,9+l+1),d},INSPECTION_STATUS:o,map_BPG_Packet2Act:function(e){var t=[];switch(e.type){case"HR":case"SS":break;case"IM":var n=e,i=new ImageData(n.image,n.width);t.push(a.EV_WS_Image_Update(i));break;case"IR":case"RP":var r=e;t.push(a.EV_WS_Inspection_Report(r.data));break;case"DF":var o=e;t.push(a.EV_WS_Define_File_Update(o.data));break;case"FL":var s=e;"binary_processing_group"===s.data.type&&t.push(a.EV_WS_Inspection_Report(s.data));break;case"SG":var l=e;t.push(a.EV_WS_SIG360_Report_Update(l.data));break;default:act=e}return t[0]}}},44:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){var n=e,a=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length-1)+1;if(void 0!==e){for(var i=0;i<a;i++){if(void 0===(n=n[t[i]]))return}return n}}t.Num2Str_padding=function(e,t){return("0000000000000000"+t).substr(-e)},t.round=function(e){var t=1/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),n=Math.round(t);0==n&&(n=t);return Math.round(e*n)/n},t.xstate_GetCurrentMainState=function(e){if("string"==typeof e.value)return{state:e.value,substate:null};var t=e.value,n=Object.keys(t)[0];return{state:n,substate:t[n]}},t.xstate_GetMainState=function(e){if("string"==typeof e.value)return e.value;var t=e.value;return Object.keys(t)[0]},t.xstate_GetSubState=function(e){if("string"==typeof e.value)return;var t=e.value,n=Object.keys(t)[0];return t[n]},t.GetObjElement=r,t.isString=function(e){return"string"==typeof e||e instanceof String},t.DictConv=function(e,t,n){var a=void 0===n?void 0:r(t,[n,e]);void 0===a&&(a=r(t,["fallback",e]));return a},t.undefFallback=o,t.dictLookUp=function(e,t,n){if(Array.isArray(e))return o(r(t,e),e[e.length-1]);var a=o(n,"fallback");return o(r(t,[a,e]),e)};t.websocket_autoReconnect=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;i(this,e),this.url=void 0,this.wsclose=!1,this.reconnectionCounter=0,this.reconnectGap_ms=1e3,this.connectionTimeout_ms=n,this.connectionTimer=null,this.readyState=void 0,this._connect(t)}return a(e,[{key:"onopen",value:function(e){}},{key:"onmessage",value:function(e){}},{key:"onerror",value:function(e){}},{key:"onclose",value:function(e){}},{key:"onreconnection",value:function(e){}},{key:"onconnectiontimeout",value:function(){}},{key:"setWebsocketCallbackUndefined",value:function(e){e.onopen=e.onmessage=e.onerror=e.onclose=void 0}},{key:"_connect",value:function(e){var t=this;if(!this.wsclose){if(console.log("_connect"),this.url=e,void 0!==this.websocket){this.reconnectionCounter++;var n=this.onreconnection(this.reconnectionCounter);if(void 0!==n&&1!=n)return void(this.websocket=void 0)}void 0!==this.connectionTimer&&clearTimeout(this.connectionTimer),this.connectionTimer=void 0,this.websocket=new WebSocket(e),this.OPEN=this.websocket.OPEN,this.CONNECTING=this.websocket.CONNECTING,this.CLOSED=this.websocket.CLOSED,this.CLOSING=this.websocket.CLOSING,this.connectionTimer=setTimeout(function(){t.close(),t.onconnectiontimeout()},this.connectionTimeout_ms),this.websocket.onopen=function(e){return t.readyState=t.websocket.readyState,clearTimeout(t.connectionTimer),t.connectionTimer=void 0,t.onopen(e)},this.websocket.onmessage=function(e){return t.onmessage(e)},this.websocket.onerror=function(e){return t.readyState=t.websocket.readyState,t.onerror(e)},this.websocket.onclose=function(n){return t.readyState=t.websocket.readyState,setTimeout(function(){return t._connect(e)},t.reconnectGap_ms),t.onclose(n)}}}},{key:"reconnect",value:function(){console.log(this.wsclose,this.websocket),this.wsclose=!1,void 0!==this.websocket?this.websocket.readyState!=this.websocket.OPEN?(setWebsocketCallbackUndefined(this.websocket),this.websocket=void 0,this._connect(this.url)):this.websocket.close():this._connect(this.url)}},{key:"close",value:function(){this.wsclose=!0,void 0!==this.connectionTimer&&clearTimeout(this.connectionTimer),this.connectionTimer=void 0,void 0!==this.websocket&&this.websocket.close()}},{key:"send",value:function(e){return this.websocket.send(e)}}]),e}(),t.websocket_reqTrack=function(){function e(t){var n=this;i(this,e);t.onopen,t.onmessage,t.onerror,t.onclose;this.trackWindow={},t.onopen=function(e){n.readyState=n.websocket.readyState,n.onopen(e)},t.onclose=function(e){n.readyState=n.websocket.readyState,n.onclose(e)},t.onmessage=function(e){n.readyState=n.websocket.readyState;var t=JSON.parse(e.data),a=t.type;if("ACK"==a||"NAK"==a){var i=t.req_id;if(void 0!==i){var r=n.trackWindow[i];void 0!==r?(delete n.trackWindow[i],"ACK"==a?r.resolve(t):r.reject(t)):i=void 0}void 0===i&&n.onTrackError({type:"ACK_TRACK_ERR",data:t})}n.onmessage(e,t)},t.onerror=function(e){n.readyState=n.websocket.readyState,n.onerror(e)},this.websocket=t}return a(e,[{key:"onTrackError",value:function(e){}},{key:"onopen",value:function(e){}},{key:"onmessage",value:function(e){}},{key:"onerror",value:function(e){}},{key:"onclose",value:function(e){}},{key:"close",value:function(){return this.websocket.close()}},{key:"send_obj",value:function(e,t){for(var n=e.req_id;void 0===n||Object.keys(this.trackWindow).reduce(function(e,t){return e||t===n},!1);)n=Math.floor(16777215*Math.random()).toString(16);e.req_id=n,this.websocket.send(JSON.stringify(e,t));var a={time:Date.now(),resolve:void 0,reject:void 0,data:e,rsp:void 0};return this.trackWindow[n]=a,new Promise(function(e,t){a.resolve=e,a.reject=t})}}]),e}();function o(e,t){return void 0!==e?e:t}},540:function(e,t,n){"use strict";var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=(E(n(541)),E(n(544)),n(104)),r=E(n(1)),o=E(n(8)),s=(v(n(84)),E(n(41))),l=(n(41),n(284)),u=v(n(33)),d=(n(44),n(321)),c=E(n(808)),p=E(n(810)),h=E(n(1099)),f=E(n(86)),S=v(n(45)),_=E(n(511));E(n(46)),E(n(527)),E(n(53));function v(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function E(e){return e&&e.__esModule?e:{default:e}}S.setLevel("info"),S.getLogger("InspectionEditorLogic").setLevel("INFO"),S.getLogger("UICtrlReducer").setLevel("INFO");var b=Object.assign({},h.default,f.default),m=(0,l.ReduxStoreSetUp)({}),y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.BPG_WS={reqWindow:[],pgIDCounter:0,onopen:function(e,t){m.dispatch(u.EV_WS_Connected(t))},onmessage:function(e,t){if(S.debug("onMessage:::"),S.debug(e),e.data instanceof ArrayBuffer){var a=s.default.raw2header(e);S.debug("onMessage:["+a.type+"]");var i=a.pgID,r=void 0,o=!1;switch(a.type){case"HR":var l=s.default.raw2obj(e),u=l.data.webUI_resource;void 0===u&&(u="http://hyv.idcircle.me"),u+="/version.jsonp?rand="+function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e6;return Math.floor(Math.random()*(t-e+1))+e}(),(0,_.default)(u,{name:"hyv_version_map"},function(e,t){t.core_info=l.data,n.props.ACT_Version_Map_Update(t)}),n.props.ACT_WS_SEND(n.props.WS_ID,"HR",0,{a:["d"]}),setTimeout(function(){n.props.ACT_WS_SEND(n.props.WS_ID,"LD",0,{filename:"data/default_camera_param.json"})},100);break;case"SS":var d=s.default.raw2obj(e);d.data.start&&(o=!0),r=d;break;case"IM":r=s.default.raw2Obj_IM(e);break;case"IR":case"RP":case"DF":case"FL":case"SG":default:r=s.default.raw2obj(e)}if(-1===i){if(void 0!==r){var c=s.default.map_BPG_Packet2Act(r);void 0!==c&&n.props.DISPATCH(c)}}else{var p=n.BPG_WS.reqWindow[i];void 0!==p?(void 0!==r&&p.pkts.push(r),o||"SS"!=a.type||(delete n.BPG_WS.reqWindow[i],void 0!==p.promiseCBs?p.promiseCBs.resolve(p.pkts):n.props.DISPATCH({type:"ATBundle",ActionThrottle_type:"express",data:p.pkts.map(function(e){return s.default.map_BPG_Packet2Act(e)}).filter(function(e){return void 0!==e}),rawData:p}))):o&&(n.BPG_WS.reqWindow[i]={time:(new Date).getTime(),pkts:[r]})}}},onclose:function(e,t){n.props.DISPATCH(u.EV_WS_Disconnected(e)),setTimeout(function(){n.props.ACT_WS_CONNECT(n.props.WS_ID,"ws://localhost:4090",n.BPG_WS)},3e3)},onerror:function(e,t){},send:function(e,t,a){var i=void 0;e.data instanceof Object&&(i=e.data._PGID_,delete e.data._PGID_),void 0===i&&(i=n.BPG_WS.pgIDCounter,n.BPG_WS.pgIDCounter++,n.BPG_WS.pgIDCounter>1e4&&(n.BPG_WS.pgIDCounter=0)),e.data instanceof Uint8Array?t.websocket.send(s.default.objbarr2raw(e.tl,e.prop,i,null,e.data)):(n.BPG_WS.reqWindow[i]={time:(new Date).getTime(),pkts:[],promiseCBs:a},t.websocket.send(s.default.objbarr2raw(e.tl,e.prop,i,e.data,e.uintArr)))}},setTimeout(function(){return n.props.ACT_WS_CONNECT(n.props.WS_ID,"ws://localhost:4090",n.BPG_WS)},3e3),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),a(t,null,[{key:"mapDispatchToProps",value:function(e,t){return{ACT_Ctrl_SM_Panel:function(t){return e({type:u.UI_SM_EVENT.Control_SM_Panel,data:t})},ACT_WS_CONNECT:function(t,n,a){return e({type:d.MWWS_EVENT.CONNECT,data:Object.assign({id:t,url:n,binaryType:"arraybuffer"},a)})},ACT_WS_DISCONNECT:function(t){return e({type:d.MWWS_EVENT.DISCONNECT,data:{id:t}})},DISPATCH:function(t){e(t)},DISPATCH_flush:function(t){t.ActionThrottle_type="flush",e(t)},ACT_WS_SEND:function(t,n,a,i,r){return e(u.EV_WS_SEND(t,n,a,i,r))},ACT_Version_Map_Update:function(t){return e(u.EV_UI_Version_Map_Update(t))}}}},{key:"mapStateToProps",value:function(e){return{showSplash:e.UIData.showSplash,showSM_graph:e.UIData.showSM_graph,stateMachine:e.UIData.sm,WS_CH:e.UIData.WS_CH,WS_ID:e.UIData.WS_ID}}},{key:"connect",value:function(){return(0,i.connect)(t.mapStateToProps,t.mapDispatchToProps)(t)}}]),a(t,[{key:"render",value:function(){S.debug("APPMasterX render",this.props);var e=void 0;return e=null,r.default.createElement("div",{className:"HXF"},r.default.createElement(p.default,{key:"APP"}),e,this.props.showSplash?r.default.createElement("div",{key:"LOGO",className:"s HXF WXF overlay veleXY logoFrame white"},r.default.createElement("div",{className:"veleXY width6 height6"},r.default.createElement("img",{className:"height8 LOGOImg ",src:"resource/image/NotiMon.svg"}),r.default.createElement("div",{className:"HX0_5"}),r.default.createElement("div",{className:"s"},r.default.createElement("div",{className:"TitleTextCon showOverFlow HX4"},r.default.createElement("h1",{className:"Title"},"HY"),r.default.createElement("h1",{className:"Title"},"Vision"))))):[])}}]),t}().connect();S.info(b),o.default.render(r.default.createElement(i.Provider,{store:m},r.default.createElement(c.default,{locale:b},r.default.createElement(y,null))),document.getElementById("container"))},541:function(e,t,n){var a=n(542);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(154)(a,i);a.locals&&(e.exports=a.locals)},542:function(e,t,n){(e.exports=n(153)(!1)).push([e.i,"html, body {\r\n\theight: 100%;\r\n\twidth: 100%;\r\n\tmargin: 0;\r\n  padding: 0;\r\n\tbackground: none;\r\n}\r\n\r\n* {\r\n\tmargin: 0;\r\n\tpadding: 0;\r\n\tbox-sizing: border-box;\r\n}\r\n.body {\r\n\toverflow: scroll;\r\n\tposition: absolute;\r\n\t-webkit-overflow-scrolling: touch;\r\n}\r\n\r\n\r\n.vbox:before {/*invisible trick*/\r\n\tcontent: '';\r\n\tdisplay: inline-block;\r\n\tvertical-align: middle;\r\n\twidth: 0;\r\n\theight: 100%;\r\n}\r\n.vbox > * {\r\n\tvertical-align: middle;\r\n\tdisplay: inline-block;\r\n}\r\n\r\n.vboxImg > * {\r\n\tvertical-align: middle;\r\n\tdisplay: inline-block;\r\n}\r\n\r\n\r\n.veleY {\r\n\tposition: relative;\r\n\ttop: 50%;\r\n\ttransform: translateY(-50%);\r\n}\r\n\r\n\r\n.veleX {\r\n\tposition: relative;\r\n\tleft: 50%;\r\n\ttransform: translateX(-50%);\r\n}\r\n\r\n.veleXY {\r\n\tposition: relative;\r\n\ttop: 50%;\r\n\tleft: 50%;\r\n\ttransform: translate(-50%,-50%);\r\n}\r\n\r\n.vbox:before {/*invisible trick*/\r\n\tcontent: '';\r\n\tdisplay: inline-block;\r\n\tvertical-align: middle;\r\n\twidth: 0px;\r\n\theight: 100%;\r\n\tbackground: red;\r\n}\r\n.vbox  * {\r\n\tvertical-align: middle;\r\n\tdisplay: inline-block;\r\n}\r\n.cardblock{\r\n\tmargin:10px;\r\n\tbox-shadow:0 0px 10px #000;\r\n}\r\n\r\n.border{\r\n\tborder: 7px solid #FFF;\r\n}\r\n\r\n\r\n\r\n.blockS{\r\n}\r\n\r\n\r\n.blockS .layout {\r\n\tfloat: left;\r\n\tborder-style: none;\r\n\tbox-sizing: border-box;\r\n}\r\n.blockS .layoutRight {\r\n\tfloat: right;\r\n\tborder-style: none;\r\n\tbox-sizing: border-box;\r\n}\r\n.blockS .s {\r\n\tfloat: left;\r\n\tborder-style: none;\r\n\ttransition: background ease-in 0.2s, color ease-in 0.2s;\r\n\twidth: 100%;\r\n\theight: 50px;\r\n\tfont-family: 'Open Sans', sans-serif;\r\n\ttext-align: center;\r\n\tfont-size: 0.4cm;\r\n\tfont-weight:bold;\r\n\tbox-sizing: border-box;\r\n\tcolor:#FFF;\r\n\toverflow:hidden;\r\n}\r\n\r\n\r\n.blockS .scroll {\r\n\toverflow: auto;\r\n\t-webkit-overflow-scrolling: touch;\r\n}\r\n\r\n\r\n.blockS .textAlignLeft {\r\n  text-align: left;\r\n}\r\n\r\n\r\n\r\n.blockS .floatRight {\r\n  float: right;\r\n}\r\n\r\n\r\n.smallFontSize{\r\n\tfont-size: 0.3cm;\r\n}\r\n\r\n.blockS .noAnim {\r\n\ttransition: none;\r\n}\r\n\r\n\r\n.blockS .showOverFlow,.blockS .dropDown{\r\n  overflow: visible;\r\n}\r\n.blockS .dropdownBox,.blockS .dropDownContent{\r\n  position: relative;\r\n}\r\n\r\n.blockS .HCenter{\r\nmargin:auto; float: none;\r\n}\r\n\r\n\r\n.blockS .overlayCon {\r\n\tposition: relative;\r\n\toverflow:hidden;\r\n}\r\n.blockS .overlay {\r\n\tposition: absolute;\r\n\tbackground: none;\r\n}\r\n.blockS .overlaybtm {\r\n\r\n\tposition: absolute;\r\n\tbackground: none;\r\n\tbottom:0;\r\n}\r\n\r\n.blockS .overlayright {\r\n\r\n\tposition: absolute;\r\n\tbackground: none;\r\n\tright:0;\r\n}\r\n\r\n.blockS .HXA {\r\n\r\n  height: auto;\r\n  max-height: 100%;\r\n}\r\n.blockS .WXA {\r\n\r\n  width: auto;\r\n}\r\n.blockS .HX0 {\r\n\r\n\theight: 0px;\r\n}\r\n.blockS .HX0_1 {\r\n\r\n\theight: 5px;\r\n}\r\n.blockS .HX0_5 {\r\n\r\n\theight: 25px;\r\n}\r\n.blockS .HX1_5 {\r\n\r\n\theight: 75px;\r\n}\r\n.blockS .HX1 {\r\n\theight: 50px;\r\n}\r\n.blockS .HX2 {\r\n\r\n\theight: 100px;\r\n}\r\n.blockS .HX3 {\r\n\r\n\theight: 150px;\r\n}\r\n\r\n.blockS .HX4 {\r\n\r\n\theight:200px;\r\n}\r\n.blockS .HX5 {\r\n\r\n\theight:250px;\r\n}\r\n.blockS .HX6 {\r\n\r\n\theight:300px;\r\n}\r\n.blockS .HX7 {\r\n\r\n\theight:350px;\r\n}\r\n.blockS .HXF{\r\n\r\n\theight:100%;\r\n}\r\n.cl {\r\n\r\n\theight: 10px;\r\n}\r\n.blockS .input{\r\n\tbox-shadow: inset 0 -5px 0 black, inset 2px 0px 0 black;\r\n\r\n\tpadding-left: 5px;\r\n\ttext-align: left;\r\n\tbackground: #FAFAFA;\r\n\tcolor:#333;\r\n\tborder-radius: 0px;\r\n\tappearance: none;\r\n}\r\n\r\n.blockS .padding\r\n{\r\n    padding:0.3em;\r\n}\r\n\r\n.textarea {\r\n\toverflow: auto;\r\n\tborder: solid 5px #222;\r\n\tbackground: #FFF;\r\n\ttext-align: left;\r\n\tcolor:#333;\r\n}\r\n\r\n.blockS .width0 {\r\n\twidth: 0%;\r\n}\r\n.blockS .width1 {\r\n\twidth: 8.333%;\r\n}\r\n.blockS .width2 {\r\n\twidth: 16.666%;\r\n}\r\n.blockS .width3 {\r\n\twidth: 25%;\r\n}\r\n.blockS .width4 {\r\n\twidth: 33.333%;\r\n}\r\n.blockS .width5 {\r\n\twidth: 41.666%;\r\n}\r\n.blockS .width6 {\r\n\twidth: 50%;\r\n}\r\n.blockS .width7 {\r\n\twidth: 58.333%;\r\n}\r\n.blockS .width8 {\r\n\twidth: 66.666%;\r\n}\r\n.blockS .width9 {\r\n\twidth: 75%;\r\n}\r\n.blockS .width10 {\r\n\twidth: 83.333%;\r\n}\r\n.blockS .width11 {\r\n\twidth: 91.6666%;\r\n}\r\n\r\n.blockS .width005 {\r\n\twidth: 4.1666%;\r\n}\r\n.blockS .width12 {\r\n\twidth: 100%;\r\n}\r\n.blockS .WXF {\r\n\twidth: 100%;\r\n}\r\n\r\n.blockS .widthR{\r\n\r\n\twidth: unset;\r\n\tfloat:unset;\r\n}\r\n.blockS .height0 {\r\n\theight: 0%;\r\n\tdisplay: none;\r\n}\r\n.blockS .height1 {\r\n\theight: 8.333%;\r\n}\r\n.blockS .height2 {\r\n\theight: 16.666%;\r\n}\r\n.blockS .height3 {\r\n\theight: 25%;\r\n}\r\n.blockS .height4 {\r\n\theight: 33.333%;\r\n}\r\n.blockS .height5 {\r\n\theight: 41.666%;\r\n}\r\n.blockS .height6 {\r\n\theight: 50%;\r\n}\r\n.blockS .height7 {\r\n\theight: 58.333%;\r\n}\r\n.blockS .height8 {\r\n\theight: 66.666%;\r\n}\r\n.blockS .height9 {\r\n\theight: 75%;\r\n}\r\n.blockS .height10 {\r\n\theight: 83.333%;\r\n}\r\n.blockS .height11 {\r\n\theight: 91.6666%;\r\n}\r\n\r\n.blockS .height115 {\r\n\theight: 95.8333%;\r\n}\r\n.blockS .height005 {\r\n\theight: 4.1666%;\r\n}\r\n.blockS .height12 {\r\n\theight: 100%;\r\n}\r\n\r\n\r\n@media screen and (max-width: 800px) {\r\n\t.blockS .widthF800 {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.blockS .widthN800 {\r\n\t\tdisplay: none;\r\n\t}\r\n}\r\n\r\n@media screen and (max-width: 500px) {\r\n\t.blockS .widthF500 {\r\n\t\twidth: 100%;\r\n\t}\r\n\t.blockS .widthN500 {\r\n\t\tdisplay: none;\r\n\t}\r\n}\r\n.blockS .button {\r\n    outline:none;\r\n\tborder-bottom : 5px solid #111;\r\n\tborder-right : 3px solid #111;\r\n\r\n\tbackground: #333;\r\n}\r\n\r\n\r\n\r\n.blockS .button:active {\r\n\tborder-top: 5px solid #111;\r\n\tborder-bottom : 0;\r\n\tborder-right :0;\r\n\r\n\tbackground: #333;\r\n\tcolor:#eee;\r\n}\r\n\r\n\r\n.blockS *:disabled {\r\n\tbackground: #888;\r\n}\r\n\r\n.blockS .lgray {\r\n\r\n\tbackground: #999;\r\n}\r\n.blockS .lred {\r\n\r\n\tbackground: #ECC;\r\n}\r\n.blockS .lgreen {\r\n\r\n\tbackground: #CEC;\r\n}\r\n.blockS .lblue{\r\n\r\n\tbackground: #CCE;\r\n}\r\n.blockS .deepred {\r\n\r\n\tbackground: #F00;\r\n}\r\n\r\n.blockS .deepgreen{\r\n\r\n\tbackground: #0F0;\r\n}\r\n.blockS .red {\r\n\r\n\tbackground: #422;\r\n}\r\n\r\n.blockS .green {\r\n\tbackground: #242;\r\n}\r\n\r\n.blockS .blue {\r\n\r\n\tbackground: #224;\r\n}\r\n\r\n.blockS .black {\r\n\r\n  background: #000;\r\n}\r\n.blockS .white {\r\n  background: #FFF;\r\n}\r\n.blockS .blackText {\r\n\tcolor: #444;\r\n}\r\n.blockS .nocolor {\r\n\r\n\tbackground: none;\r\n}\r\n",""])},544:function(e,t,n){var a=n(545);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(154)(a,i);a.locals&&(e.exports=a.locals)},545:function(e,t,n){var a=n(546);(e.exports=n(153)(!1)).push([e.i,"\r\n.blockS .deepblue{\r\n\r\n  background: #0081ee;\r\n}\r\n\r\n/*Start of ANT COlor*/\r\n.iconButtonSize > svg{ padding-left: 2px; width: 30px;height: 100%;}\r\n.iconTextPadding {padding-left: 5px;}\r\n.blockS .palatte-blue-1{background:#e6f7ff}\r\n.blockS .palatte-blue-2{background:#bae7ff}\r\n.blockS .palatte-blue-3{background:#91d5ff}.blockS .palatte-blue-4{background:#69c0ff}.blockS .palatte-blue-5{background:#40a9ff}.blockS .palatte-blue-6{background:#1890ff}.blockS .palatte-blue-7{background:#096dd9}.blockS .palatte-blue-8{background:#0050b3}.blockS .palatte-blue-9{background:#003a8c}.blockS .palatte-blue-10{background:#002766}.blockS .palatte-purple-1{background:#f9f0ff}.blockS .palatte-purple-2{background:#efdbff}.blockS .palatte-purple-3{background:#d3adf7}.blockS .palatte-purple-4{background:#b37feb}.blockS .palatte-purple-5{background:#9254de}.blockS .palatte-purple-6{background:#722ed1}.blockS .palatte-purple-7{background:#531dab}.blockS .palatte-purple-8{background:#391085}.blockS .palatte-purple-9{background:#22075e}.blockS .palatte-purple-10{background:#120338}.blockS .palatte-cyan-1{background:#e6fffb}.blockS .palatte-cyan-2{background:#b5f5ec}.blockS .palatte-cyan-3{background:#87e8de}.blockS .palatte-cyan-4{background:#5cdbd3}.blockS .palatte-cyan-5{background:#36cfc9}.blockS .palatte-cyan-6{background:#13c2c2}.blockS .palatte-cyan-7{background:#08979c}.blockS .palatte-cyan-8{background:#006d75}.blockS .palatte-cyan-9{background:#00474f}.blockS .palatte-cyan-10{background:#002329}.blockS .palatte-green-1{background:#f6ffed}.blockS .palatte-green-2{background:#d9f7be}.blockS .palatte-green-3{background:#b7eb8f}.blockS .palatte-green-4{background:#95de64}.blockS .palatte-green-5{background:#73d13d}.blockS .palatte-green-6{background:#52c41a}.blockS .palatte-green-7{background:#389e0d}.blockS .palatte-green-8{background:#237804}.blockS .palatte-green-9{background:#135200}.blockS .palatte-green-10{background:#092b00}.blockS .palatte-magenta-1{background:#fff0f6}.blockS .palatte-magenta-2{background:#ffd6e7}.blockS .palatte-magenta-3{background:#ffadd2}.blockS .palatte-magenta-4{background:#ff85c0}.blockS .palatte-magenta-5{background:#f759ab}.blockS .palatte-magenta-6{background:#eb2f96}.blockS .palatte-magenta-7{background:#c41d7f}.blockS .palatte-magenta-8{background:#9e1068}.blockS .palatte-magenta-9{background:#780650}.blockS .palatte-magenta-10{background:#520339}.blockS .palatte-red-1{background:#fff1f0}.blockS .palatte-red-2{background:#ffccc7}.blockS .palatte-red-3{background:#ffa39e}.blockS .palatte-red-4{background:#ff7875}.blockS .palatte-red-5{background:#ff4d4f}.blockS .palatte-red-6{background:#f5222d}.blockS .palatte-red-7{background:#cf1322}.blockS .palatte-red-8{background:#a8071a}.blockS .palatte-red-9{background:#820014}.blockS .palatte-red-10{background:#5c0011}.blockS .palatte-volcano-1{background:#fff2e8}.blockS .palatte-volcano-2{background:#ffd8bf}.blockS .palatte-volcano-3{background:#ffbb96}.blockS .palatte-volcano-4{background:#ff9c6e}.blockS .palatte-volcano-5{background:#ff7a45}.blockS .palatte-volcano-6{background:#fa541c}.blockS .palatte-volcano-7{background:#d4380d}.blockS .palatte-volcano-8{background:#ad2102}.blockS .palatte-volcano-9{background:#871400}.blockS .palatte-volcano-10{background:#610b00}.blockS .palatte-orange-1{background:#fff7e6}.blockS .palatte-orange-2{background:#ffe7ba}.blockS .palatte-orange-3{background:#ffd591}.blockS .palatte-orange-4{background:#ffc069}.blockS .palatte-orange-5{background:#ffa940}.blockS .palatte-orange-6{background:#fa8c16}.blockS .palatte-orange-7{background:#d46b08}.blockS .palatte-orange-8{background:#ad4e00}.blockS .palatte-orange-9{background:#873800}.blockS .palatte-orange-10{background:#612500}.blockS .palatte-gold-1{background:#fffbe6}.blockS .palatte-gold-2{background:#fff1b8}.blockS .palatte-gold-3{background:#ffe58f}.blockS .palatte-gold-4{background:#ffd666}.blockS .palatte-gold-5{background:#ffc53d}.blockS .palatte-gold-6{background:#faad14}.blockS .palatte-gold-7{background:#d48806}.blockS .palatte-gold-8{background:#ad6800}.blockS .palatte-gold-9{background:#874d00}.blockS .palatte-gold-10{background:#613400}.blockS .palatte-yellow-1{background:#feffe6}.blockS .palatte-yellow-2{background:#ffffb8}.blockS .palatte-yellow-3{background:#fffb8f}.blockS .palatte-yellow-4{background:#fff566}.blockS .palatte-yellow-5{background:#ffec3d}.blockS .palatte-yellow-6{background:#fadb14}.blockS .palatte-yellow-7{background:#d4b106}.blockS .palatte-yellow-8{background:#ad8b00}.blockS .palatte-yellow-9{background:#876800}.blockS .palatte-yellow-10{background:#614700}.blockS .palatte-lime-1{background:#fcffe6}.blockS .palatte-lime-2{background:#f4ffb8}.blockS .palatte-lime-3{background:#eaff8f}.blockS .palatte-lime-4{background:#d3f261}.blockS .palatte-lime-5{background:#bae637}.blockS .palatte-lime-6{background:#a0d911}.blockS .palatte-lime-7{background:#7cb305}.blockS .palatte-lime-8{background:#5b8c00}.blockS .palatte-lime-9{background:#3f6600}.blockS .palatte-lime-10{background:#254000}.blockS .palatte-geekblue-1{background:#f0f5ff}.blockS .palatte-geekblue-2{background:#d6e4ff}.blockS .palatte-geekblue-3{background:#adc6ff}.blockS .palatte-geekblue-4{background:#85a5ff}.blockS .palatte-geekblue-5{background:#597ef7}.blockS .palatte-geekblue-6{background:#2f54eb}.blockS .palatte-geekblue-7{background:#1d39c4}.blockS .palatte-geekblue-8{background:#10239e}.blockS .palatte-geekblue-9{background:#061178}.blockS .palatte-geekblue-10{background:#030852}.blockS .palatte-grey-1{background:#fff}.blockS .palatte-grey-2{background:#fafafa}.blockS .palatte-grey-3{background:#f5f5f5}.blockS .palatte-grey-4{background:#e8e8e8}.blockS .palatte-grey-5{background:#d9d9d9}.blockS .palatte-grey-6{background:#bfbfbf}.blockS .palatte-grey-7{background:#8c8c8c}.blockS .palatte-grey-8{background:#595959}.blockS .palatte-grey-9{background:#262626}.blockS .palatte-grey-10{background:#000}\r\n/*End of ANT COlor*/\r\n\r\nbody.sp_Style.blockS  {\r\n  overflow: hidden;\r\n  padding: 15px;\r\n  background: #EAEBEE;\r\n}\r\n.sp_Style.blockS *.shadow1 {\r\n  box-shadow:5px 10px 13px rgba(10,10,10,0.3);\r\n}\r\n\r\n.sp_Style.blockS .radarScanPanel {\r\n  box-shadow: inset 0px 0px 8px rgba(0,0,0,0.8);\r\n  border-radius: 50%;\r\n}\r\n.sp_Style.blockS .radarScanWave {\r\n  border-radius: 50%;\r\n  border: 5px solid gray;\r\n  animation: scanWave 5s infinite;\r\n}\r\n\r\n@keyframes scanWave{\r\n  0%,40%{\r\n    transform: translate3d(-50%,-50%,0) scale(0.05);\r\n    opacity: 0.4;\r\n  }\r\n  100%{\r\n    transform: translate3d(-50%,-50%,0) scale(0.8);\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\n\r\n\r\n.sp_Style.blockS .SMGraph{\r\n  top: 50%;\r\n  left: 0px;\r\n  opacity: 1;\r\n  transition:opacity 0.5s, transform ease-out 0.3s;\r\n  transform: translate(-0%,-50%);\r\n}\r\n.sp_Style.blockS .SMGraph.hide{\r\n  opacity: 0.1;\r\n  transform: translate(-90%,-50%);\r\n}\r\n\r\n.sp_Style .ant-input-affix-wrapper.error input{\r\n  background-color: #f99;\r\n} \r\n\r\n.sp_Style .ant-tag.large{\r\n  font-size:20px;margin-bottom: 8px;\r\n} \r\n\r\n.sp_Style .ant-tag.InspTag.fixed{\r\n  color: #ffffff;\r\n  background:#f50;\r\n  border-color: #f50;\r\n}\r\n\r\n.sp_Style .ant-tag.InspTag.optional{\r\n  color: #ffffff;\r\n  background: #108ee9;\r\n  border-color: #108ee9;\r\n} \r\n\r\n\r\n.sp_Style.blockS .MenuAnim{\r\n  transition:opacity 0.2s, transform 0.3s;\r\n  background-color: rgba(0,0,0,0.1);\r\n  width:200px;\r\n  transition-timing-function: cubic-bezier(.05,.88,.6,.87);\r\n  transform-origin: -20% 50%;\r\n  perspective: 200px;\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-enter{\r\n  transform: rotateY(-10deg);\r\n  opacity: 0;\r\n\r\n  z-index: 2;\r\n\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-enter.fadeIn-enter-active{\r\n  opacity: 1;\r\n  transform: rotateY(00deg);\r\n  z-index: 2;\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-leave{\r\n  opacity: 1;\r\n  z-index: 1;\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-leave.fadeIn-leave-active{\r\n  opacity: 0;\r\n  z-index: 1;\r\n}\r\n\r\n.sp_Style.blockS{\r\n  perspective:300px;\r\n  -webkit-perspective: 300px;\r\n}\r\n\r\n@font-face {\r\n    font-family: 'roboto_med';\r\n    src: url("+a(n(547))+");\r\n}\r\n\r\n\r\n.sp_Style.blockS .robotoFont  {\r\n  font-family: 'roboto_med';\r\n  color: #000;\r\n}\r\n\r\n.sp_Style.blockS .logoFrame .Title{\r\n  font-family: 'roboto_med';\r\n  color: #000;\r\n  font-size: 30pt;\r\n}\r\n\r\n.sp_Style.blockS .logoFrame .TitleTextCon{\r\n  transform: translate(0%,-50%);\r\n}\r\n.sp_Style.blockS .logoFrame-leave-active .TitleTextCon{\r\n  animation-delay: 0.2s;\r\n  animation-duration: 0.2s;\r\n  animation-name: LOGOTitleAnimation;\r\n  animation-fill-mode: forwards;\r\n  animation-timing-function: ease-in-out;\r\n}\r\n@keyframes LOGOTitleAnimation {\r\n  100% {\r\n      transform: none;\r\n  }\r\n}\r\n\r\n.sp_Style.blockS .logoFrame .LOGOImg{\r\n  transform-origin: 50% 50%;\r\n  animation-duration: 0.4s;\r\n  animation-timing-function: ease-in-out;\r\n  -webkit-filter: grayscale(100%);\r\n  transform: rotateZ(-360deg);\r\n}\r\n\r\n.sp_Style.blockS .logoFrame-leave-active .LOGOImg{\r\n  animation-delay: 0s;\r\n  animation-name: LOGOImgRotateAnimation;\r\n  animation-fill-mode: forwards;\r\n}\r\n\r\n@keyframes LOGOImgRotateAnimation {\r\n\r\n  50%  {\r\n  }\r\n\r\n  100% {\r\n      transform: none;\r\n      -webkit-filter: none;\r\n  }\r\n}\r\n\r\n\r\n\r\n.sp_Style.blockS .logoFrame{\r\n  transform-origin: 50% -120%;\r\n}\r\n.sp_Style.blockS .logoFrame-leave-active{\r\n  animation-delay: 0.7s;\r\n  animation-name: logoFrameAnimation;\r\n  animation-duration: 1.0s;\r\n  animation-timing-function: ease-in-out;\r\n}\r\n@keyframes logoFrameAnimation {\r\n\r\n  15%  {\r\n    transform: translate(-50%,-50%);\r\n  }\r\n  40%  {\r\n    transform: rotateX(2deg) translate(-50%,-50%) ;\r\n  }\r\n  100% {\r\n    transform: rotateX(0deg) translate(-50%,-100%) ;\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n.sp_Style.blockS .scroll::-webkit-scrollbar {\r\n\twidth: 5px;\r\n\theight: 0;\r\n\tbackground-color: #cccccc;\r\n}\r\n.sp_Style.blockS .scroll::-webkit-scrollbar-thumb {\r\n\tbackground-color: #555;\r\n}\r\n.sp_Style.blockS .scroll::-webkit-scrollbar-thumb:hover {\r\n\tborder: 1px solid #333333;\r\n}\r\n.sp_Style.blockS .scroll::-webkit-scrollbar-thumb:active {\r\n\tborder: 1px solid #333333;\r\n}\r\n\r\n.sp_Style.blockS *:not(.nblockS *){\r\n\tfont-size: 0.6cm;\r\n}\r\n\r\n.sp_Style.blockS .sFontSize{\r\n\tfont-size: 0.4cm;\r\n}\r\n.sp_Style.blockS .mFontSize{\r\n\tfont-size: 0.6cm;\r\n}\r\n.sp_Style.blockS .lFontSize{\r\n\tfont-size: 0.7cm;\r\n}\r\n\r\n\r\n.sp_Style.blockS button.sidebar{\r\n  border-bottom : 2px solid #EEE;\r\n  border-right : 4px solid #111;\r\n  background: white;\r\n  color: white;\r\n}\r\n\r\n.sp_Style.blockS button.sidebar:hover {\r\n  background: #222;\r\n}\r\n\r\n.sp_Style.blockS button.sidebar >p {\r\n  padding: 15px;\r\n  text-align: left;\r\n  color: #333;\r\n}\r\n\r\n\r\n.sp_Style.blockS button.sidebar >img {\r\n  width:20px;\r\n  margin-left: 8px;\r\n}\r\n\r\n.sp_Style.blockS button.sidebar:hover>p {\r\n  text-align: center;\r\n  color: white;\r\n\r\n}\r\n\r\n.sp_Style.blockS .pokemonSpriteCon>* {\r\n\r\n\ttransition: transform ease-out 0.5s;\r\n}\r\n\r\n.sp_Style.blockS .sysAPPBtn{\r\n\r\n\ttransition: transform ease-out 0.5s;\r\n}\r\n",""])},547:function(e,t,n){e.exports=n.p+"fe13e4170719c2fc586501e777bde143.ttf"},63:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Edit_Tar_Update=function(e){return{type:a.Edit_Tar_Update,data:e}},t.Edit_Tar_Ele_Trace_Update=function(e){return{type:a.Edit_Tar_Ele_Trace_Update,data:e}},t.Edit_Tar_Ele_Cand_Update=function(e){return{type:a.Edit_Tar_Ele_Cand_Update,data:e}},t.Shape_List_Update=function(e){return{type:a.Shape_List_Update,data:e}},t.Shape_Decoration_ID_Order_Update=function(e){return{type:a.Shape_Decoration_ID_Order_Update,data:e}},t.Matching_Face_Update=function(e){return{type:a.Matching_Face_Update,data:e}},t.Matching_Angle_Margin_Deg_Update=function(e){return{type:a.Matching_Angle_Margin_Deg_Update,data:e}},t.Shape_Set=function(e){return{type:a.Shape_Set,data:{shape:e.shape,id:e.id}}},t.DefFileName_Update=function(e){return{type:a.DefFileName_Update,data:e}},t.DefFileTag_Update=function(e){return{type:a.DefFileTag_Update,data:e}},t.InspOptionalTag_Update=function(e){return{type:a.InspOptionalTag_Update,data:e}},t.SUCCESS=function(){return{type:a.SUCCESS}},t.FAIL=function(){return{type:a.FAIL}},t.ERROR=function(){return{type:a.ERROR}};var a=t.EVENT={Edit_Tar_Update:"Edit_Tar_Update",Edit_Tar_Ele_Trace_Update:"Edit_Tar_Ele_Trace_Update",Edit_Tar_Ele_Cand_Update:"Edit_Tar_Ele_Cand_Update",Shape_List_Update:"Shape_List_Update",Shape_Set:"Shape_Set",Shape_Decoration_ID_Order_Update:"Shape_Decoration_ID_Order_Update",DefFileName_Update:"DefFileName_Update",DefFileTag_Update:"DefFileTag_Update",Matching_Face_Update:"Matching_Face_Update",Matching_Angle_Margin_Deg_Update:"Matching_Angle_Margin_Deg_Update",InspOptionalTag_Update:"InspOptionalTag_Update",SUCCESS:"DEFCONF_MODE_SUCCESS",FAIL:"DEFCONF_MODE_FAIL",ERROR:"ERROR"}},716:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=n(33),r=_(n(63)),o=n(44),s=n(193),l=n(41),u=S(n(717)),d=_(n(45)),c=S(n(85)),p=(n(718),S(n(719))),h=S(n(286)),f=S(n(804));function S(e){return e&&e.__esModule?e:{default:e}}function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function v(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var E=d.getLogger("UICtrlReducer"),b=i.UI_SM_STATES,m=i.UI_SM_EVENT,y=3;function g(e){var t={inspReport:void 0,reportStatisticState:{trackingWindow:[],historyReport:[],newAddedReport:[],statisticValue:void 0},MinRepeatInspReport:y,sig360info:[],matching_angle_margin_deg:180,matching_angle_offset_deg:0,matching_face:0,img:null,DefFileName:"",DefFileTag:[],DefFileHash:"",list:[],__decorator:{list_id_order:[]},inherentShapeList:[],edit_tar_info:null,edit_tar_ele_trace:null,edit_tar_ele_cand:null,mouseLocation:void 0};e.edit_info=Object.assign({},e.edit_info,t),e.edit_info._obj.reset(),e.edit_info.edit_tar_info=null,e.edit_info.list=e.edit_info._obj.shapeList,e.edit_info.inherentShapeList=e.edit_info._obj.UpdateInherentShapeList()}function k(e,t){var n=e.filter(function(e){return t.find(function(t){return t.id==e})}),a=t.filter(function(e){return void 0===n.find(function(t){return t==e.id})}).map(function(e){return e.id});return n=[].concat(v(n),v(a))}function T(e,t){if(e.state_count++,"ev_state_update"==t.type&&(e.c_state=t.data.c_state,e.p_state=t.data.p_state,e.sm=t.data.sm,e.state_count=0,E.info(e.p_state.value," + ",t.data.action," > ",e.c_state.value)),t.type===m.Control_SM_Panel)return e.showSM_graph=t.data,e;switch(t.type){case m.Connected:return e.WS_CH=t.data,E.info("Connected",e.WS_CH),e;case m.Version_Map_Update:E.info("Version_Map_Update",t.data);var n=t.data;n.webUI_info=u.default;var s=n.core_info;n.recommend_ver={};var d=s.version;void 0===d&&(d="0.0.0");var S=n.core2wui[d];if(void 0!==S&&void 0!==S.ver){var _=S.ver,v="http://hyv.idcircle.me";void 0!==s.webUI_resource&&(v=s.webUI_resource);var T=f.default.clean(u.default.version),C=_.map(function(e){return f.default.clean(e)}).reduce(function(e,t){return f.default.gt(e,t)?e:t});f.default.gt(C,T)&&(n.recommend_info={versions:_,url:v+"/"+_[_.length-1]})}return e=a({},e,{version_map_info:n});case m.Disonnected:return e.WS_CH=void 0,e;case m.Control_SM_Panel:return e.showSM_graph=t.data,e}switch(e.c_state.value){case b.SPLASH:return e.showSplash=!0,e}var A=(0,o.xstate_GetCurrentMainState)(e.c_state),N=A.substate;function w(e,t){return e.measureList.forEach(function(e){var n=t.judgeReports.find(function(t){return t.id==e.id}),a=e.statistic;if(void 0===n)return a.count_stat.NA++,void E.error("The incoming inspection report doesn't match the defFile");if(n.status==l.INSPECTION_STATUS.NA)return a.count_stat.NA++,void E.error("The measure["+n.name+"] is NA");var i=n.value;void 0===a.count_stat[n.detailStatus]?a.count_stat[n.detailStatus]=0:a.count_stat[n.detailStatus]++,a.count++,a.sum+=i,a.mean=a.sum/a.count,a.sqSum+=i*i,a.variance=a.sqSum/a.count-a.mean*a.mean,a.sigma=Math.sqrt(a.variance),a.CPU=(e.USL-a.mean)/(3*a.sigma),a.CPL=(a.mean-e.LSL)/(3*a.sigma),a.CP=Math.min(a.CPU,a.CPL),a.CK=(a.mean-e.value)/((e.USL-e.LSL)/2),a.CPK=a.CP*(1-Math.abs(a.CK)),a.histogram=function(e,t){if(t<e.xmin)return e.histo[0]++,e;if(t>e.xmax)return e.histo[e.histo.length-1]++,e;var n=e.histo.length-2,a=Math.floor(n*(t-e.xmin)/(e.xmax-e.xmin));return a>=n&&(a=n-1),e.histo[a+1]++,e}(a.histogram,i)}),e}switch(A.state){case b.SPLASH:return e.showSplash=!0,e;case b.MAIN:case b.DEFCONF_MODE:case b.INSP_MODE:switch(e.showSplash=!1,t.type){case m.MinRepeatInspReport_Update:var I=void 0===t.data?t.data:y;e.edit_info=a({},e.edit_info,{MinRepeatInspReport:I});break;case m.Image_Update:e.edit_info=a({},e.edit_info,{img:t.data});break;case m.Def_Model_Path_Update:e.edit_info=a({},e.edit_info,{defModelPath:t.data});break;case i.UI_SM_EVENT.Canvas_Mouse_Location:e.edit_info.mouseLocation=t.data;break;case m.Inspection_Report:!function(e,t){var n=e.edit_info.MinRepeatInspReport,r=e.edit_info.DefFileTag+","+e.edit_info.inspOptionalTag,o=t.date.getTime(),s=e.edit_info._obj.cameraParam,u=void 0;u=void 0===s?void 0:s.mmpb2b/s.ppb2b;var d=t.data.subFeatureDefSha1,p=t.data.machine_hash;"binary_processing_group"===t.data.type&&t.data.reports.forEach(function(s){switch(s.type){case"sig360_extractor":case"sig360_circle_line":e.edit_info=a({},e.edit_info),e.edit_info._obj.SetInspectionReport(s);var h=e.edit_info._obj.inspreport;if(e.edit_info.inspReport=h,h.time_ms=o,void 0===u)break;var f=e.edit_info.reportStatisticState;if(f.newAddedReport=[],f.trackingWindow.forEach(function(e){e.isCurObj=!1}),f.trackingWindow=f.trackingWindow.filter(function(e){return o-e.time_ms<3e3||(f.statisticValue=w(f.statisticValue,e),f.historyReport.push(e),f.newAddedReport.push(e),!1)}),void 0===h.reports)break;h.reports.forEach(function(t){var n=f.trackingWindow.reduce(function(e,n){if(void 0!==e)return e;if(t.isFlipped!=n.isFlipped)return e;var a=t.area/n.area;if(a>1.2||a<1/1.2)return e;var i=t.rotate-n.rotate;return i>180&&(i-=360),i>5||i<-5?e:Math.hypot(t.cx-n.cx,t.cy-n.cy)>u/2?e:n},void 0);function a(e,t,n){return e+=1/(n+1)*(t-e)}if(void 0!==n)n.area=a(n.area,t.area,n.repeatTime),n.cx=a(n.cx,t.cx,n.repeatTime),n.cy=a(n.cy,t.cy,n.repeatTime),n.judgeReports.forEach(function(a){var r=a.id,o=t.judgeReports.find(function(e){return e.id==r});if(void 0!==o){if(o.status==l.INSPECTION_STATUS.NA||a==l.INSPECTION_STATUS.NA)return a.status=l.INSPECTION_STATUS.NA,void(a.value=NaN);var s=o.value-a.value;a.subtype===i.SHAPE_TYPE.measure_subtype.angle&&s>180&&(s-=360),a.value+=1/(n.repeatTime+1)*s;var u=e.edit_info.list.find(function(e){return e.id==r});void 0!==u&&(a.value!=a.value?a.status=l.INSPECTION_STATUS.NA:a.value<u.USL&&a.value>u.LSL?a.status=l.INSPECTION_STATUS.SUCCESS:a.status=l.INSPECTION_STATUS.FAILURE)}}),n.detectedLines.forEach(function(e){var i=e.id,r=t.detectedLines.find(function(e){return e.id==i});void 0!==r&&(e.cx=a(e.cx,r.cx,n.repeatTime),e.cy=a(e.cy,r.cy,n.repeatTime),e.vx=a(e.vx,r.vx,n.repeatTime),e.vy=a(e.vy,r.vy,n.repeatTime))}),n.detectedCircles.forEach(function(e){var i=e.id,r=t.detectedCircles.find(function(e){return e.id==i});void 0!==r&&(e.x=a(e.x,r.x,n.repeatTime),e.y=a(e.y,r.y,n.repeatTime),e.r=a(e.r,r.r,n.repeatTime),e.s=a(e.s,r.s,n.repeatTime))}),n.searchPoints.forEach(function(e){var i=e.id,r=t.searchPoints.find(function(e){return e.id==i});void 0!==r&&(e.x=a(e.x,r.x,n.repeatTime),e.y=a(e.y,r.y,n.repeatTime))}),n.time_ms=o,n.repeatTime+=1,n.isCurObj=!0;else{var s=(0,c.default)(t);s.time_ms=o,s.add_time_ms=o,s.subFeatureDefSha1=d,s.tag=r,s.machine_hash=p,s.repeatTime=0,s.isCurObj=!0,f.trackingWindow.push(s)}}),f.trackingWindow=f.trackingWindow.filter(function(e){return e.isCurObj||e.repeatTime>=n});break;case"camera_calibration":void 0!==s.error&&0==s.error?(e.edit_info._obj.SetCameraParamInfo(s),e.edit_info.camera_calibration_report=t.data):(e.edit_info._obj.SetCameraParamInfo(void 0),e.edit_info.camera_calibration_report=void 0)}})}(e,t);break;case m.Define_File_Update:var P=t.data;if("binary_processing_group"===P.type){var O=!1,D=(0,c.default)(P.featureSet);D.forEach(function(e){Object.keys(e).filter(function(e){return e.startsWith("__")}).forEach(function(t){return delete e[t]})});var x=h.default.digest(D,"sha1","hex");if(void 0!==P.featureSet_sha1)P.featureSet_sha1!==x&&(O=!0);if(g(e),O){e.edit_info.DefFileHash=void 0;break}if(console.log((0,c.default)(e.edit_info)),e.edit_info.DefFileHash=x,void 0===P.name){var M=new Date,U=(0,p.default)(M,"yyyymmdd_HHMMss");e.edit_info.DefFileName="Sample_"+U}else e.edit_info.DefFileName=P.name;if(void 0!==P.tag){var L=P.tag;(0,o.isString)(L)&&(L=P.tag.split(",")),Array.isArray(L)&&(e.edit_info.DefFileTag=L)}P.featureSet.forEach(function(n){switch(n.type){case"sig360_extractor":case"sig360_circle_line":void 0!==n.matching_angle_margin_deg&&(e.edit_info.matching_angle_margin_deg=n.matching_angle_margin_deg),void 0!==n.matching_angle_offset_deg&&(e.edit_info.matching_angle_offset_deg=n.matching_angle_offset_deg),void 0!==n.matching_face&&(e.edit_info.matching_face=n.matching_face),e.edit_info=Object.assign({},e.edit_info),e.edit_info._obj.SetDefInfo(n);var r=e.edit_info.reportStatisticState;e.edit_info.edit_tar_info=null,e.edit_info.list=e.edit_info._obj.shapeList,e.edit_info.__decorator=a({},e.edit_info.__decorator,n.__decorator),e.edit_info.__decorator.list_id_order=k(e.edit_info.__decorator.list_id_order,e.edit_info.list),e.edit_info.inherentShapeList=e.edit_info._obj.UpdateInherentShapeList(),E.info(e.edit_info.inherentShapeList);var o=(0,c.default)(e.edit_info.list.filter(function(e){return e.type==i.SHAPE_TYPE.measure})).map(function(e){return console.log(e),e.statistic={count_stat:{NA:0,UOK:0,LOK:0,UCNG:0,LCNG:0,USNG:0,LSNG:0},histogram:{xmin:1.2*(e.LSL-e.value)+e.value,xmax:1.2*(e.USL-e.value)+e.value,histo:new Array(502).fill(0)},count:0,sum:0,sqSum:0,mean:0,variance:0,sigma:0,CP:0,CK:0,CPU:0,CPL:0,CPK:0},e});r.statisticValue={measureList:o},E.info(r.statisticValue);break;case"camera_calibration":E.error(t)}})}break;case m.SIG360_Report_Update:case m.SIG360_Extraction:e.edit_info=Object.assign({},e.edit_info),console.log(t.data),e.edit_info._obj.Setsig360info(t.data),e.edit_info.sig360info=e.edit_info._obj.sig360info;break;case r.EVENT.Shape_List_Update:e.edit_info._obj.SetShapeList(t.data),e.edit_info.edit_tar_info=null,e.edit_info.list=e.edit_info._obj.shapeList,e.edit_info.__decorator.list_id_order=k(e.edit_info.__decorator.list_id_order,e.edit_info.list),e.edit_info.inherentShapeList=e.edit_info._obj.UpdateInherentShapeList();break;case r.EVENT.Edit_Tar_Update:e.edit_info.edit_tar_info=null==t.data?null:Object.assign({},t.data),e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null;break;case r.EVENT.Edit_Tar_Ele_Trace_Update:e.edit_info.edit_tar_ele_trace=null==t.data?null:t.data.slice();break;case m.EC_Save_Def_Config:if(null==e.WS_CH)break;break;case r.EVENT.Edit_Tar_Ele_Cand_Update:e.edit_info.edit_tar_ele_cand=null==t.data?null:t.data instanceof Object?Object.assign({},t.data):t.data,E.info("DEFCONF_MODE_Edit_Tar_Ele_Cand_Update",e.edit_info.edit_tar_ele_cand);break;case r.EVENT.DefFileName_Update:e.edit_info=Object.assign({},e.edit_info,{DefFileName:t.data});break;case r.EVENT.DefFileTag_Update:e.edit_info=a({},e.edit_info,{DefFileTag:t.data});break;case r.EVENT.Matching_Angle_Margin_Deg_Update:e.edit_info=a({},e.edit_info,{matching_angle_margin_deg:t.data});break;case r.EVENT.Matching_Face_Update:e.edit_info=a({},e.edit_info,{matching_face:t.data});break;case r.EVENT.InspOptionalTag_Update:var F=t.data,R=F;F=R=R.filter(function(e,t){if(0==e.length)return!1;for(var n=0;n<t;n++)if(R[n]==e)return!1;return!0}),e.edit_info=a({},e.edit_info,{inspOptionalTag:F});break;case r.EVENT.Shape_Decoration_ID_Order_Update:E.info("action.data:",t.data),e.edit_info.__decorator.list_id_order=k(t.data,e.edit_info.list);case r.EVENT.Shape_Set:var j=t.data.id;E.info("newID:",j);var W=e.edit_info._obj.SetShape(t.data.shape,j);if(e.edit_info.list=e.edit_info._obj.shapeList,e.edit_info.__decorator.list_id_order=k(e.edit_info.__decorator.list_id_order,e.edit_info.list),e.edit_info.inherentShapeList=e.edit_info._obj.UpdateInherentShapeList(),void 0!==j){var B=e.edit_info._obj.FindShapeIdx(j);E.info(B),e.edit_info.edit_tar_info=void 0===B?null:(0,c.default)(e.edit_info.list[B])}else e.edit_info.edit_tar_info=(0,c.default)(W);e.edit_info=Object.assign({},e.edit_info)}switch(N){case i.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:if(null==e.edit_info.edit_tar_info){e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null;break}if(null!=e.edit_info.edit_tar_ele_trace&&null!=e.edit_info.edit_tar_ele_cand){var H=e.edit_info.edit_tar_ele_trace,V=(0,o.GetObjElement)(e.edit_info.edit_tar_info,H,H.length-2),G=e.edit_info.edit_tar_ele_cand;E.info("GetObjElement",V,H[H.length-1]),V[H[H.length-1]]={id:G.shape.id,type:G.shape.type},E.info(V,e.edit_info.edit_tar_info),e.edit_info.edit_tar_info=Object.assign({},e.edit_info.edit_tar_info),e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null}break;case i.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:if(null==e.edit_info.edit_tar_info){e.edit_info.edit_tar_info={type:i.SHAPE_TYPE.aux_point,ref:[{},{}]},e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null;break}if(E.info(e.edit_info.edit_tar_ele_trace,e.edit_info.edit_tar_ele_cand),null!=e.edit_info.edit_tar_ele_trace&&null!=e.edit_info.edit_tar_ele_cand){var X=e.edit_info.edit_tar_ele_trace,z=(0,o.GetObjElement)(e.edit_info.edit_tar_info,X,X.length-2),Y=e.edit_info.edit_tar_ele_cand;E.info("GetObjElement",z,X[X.length-1]),z[X[X.length-1]]={id:Y.shape.id,type:Y.shape.type},E.info(z,e.edit_info.edit_tar_info),e.edit_info.edit_tar_info=Object.assign({},e.edit_info.edit_tar_info),e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null}break;case i.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:if(null==e.edit_info.edit_tar_info&&(e.edit_info.edit_tar_info={type:i.SHAPE_TYPE.measure,subtype:i.SHAPE_TYPE.measure_subtype.NA,docheck:!0},e.edit_info.edit_tar_ele_trace=["subtype"],e.edit_info.edit_tar_ele_cand=null),E.info(e.edit_info.edit_tar_ele_trace,e.edit_info.edit_tar_ele_cand),null!=e.edit_info.edit_tar_ele_trace&&null!=e.edit_info.edit_tar_ele_cand){var K=e.edit_info.edit_tar_ele_trace,J=(0,o.GetObjElement)(e.edit_info.edit_tar_info,K,K.length-2),q=e.edit_info.edit_tar_ele_cand;if("ref"==K[0]&&void 0!==q.shape){var Q=!0,$=e.edit_info.edit_tar_info.subtype;switch($){case i.SHAPE_TYPE.measure_subtype.sigma:break;case i.SHAPE_TYPE.measure_subtype.distance:q.shape.type==i.SHAPE_TYPE.search_point||q.shape.type==i.SHAPE_TYPE.aux_point||q.shape.type==i.SHAPE_TYPE.arc||q.shape.type==i.SHAPE_TYPE.line||(E.info("Error: "+$+" doesn't accept "+q.shape.type),Q=!1);break;case i.SHAPE_TYPE.measure_subtype.radius:q.shape.type!=i.SHAPE_TYPE.arc&&(E.info("Error: "+$+" Only accepts arc"),Q=!1);break;case i.SHAPE_TYPE.measure_subtype.angle:q.shape.type!=i.SHAPE_TYPE.line&&(E.info("Error: "+$+" Only accepts line"),Q=!1);break;default:E.info("Error: "+$+" is not in the measure_subtype list"),Q=!1}Q&&(E.info("GetObjElement",J,K[K.length-1]),J[K[K.length-1]]={id:q.shape.id,type:q.shape.type})}else if("subtype"==K[0]){var Z=!0;switch(q){case i.SHAPE_TYPE.measure_subtype.sigma:case i.SHAPE_TYPE.measure_subtype.radius:e.edit_info.edit_tar_info.ref=[{}];break;case i.SHAPE_TYPE.measure_subtype.distance:e.edit_info.edit_tar_info.ref=[{},{}],e.edit_info.edit_tar_info.ref_baseLine={};break;case i.SHAPE_TYPE.measure_subtype.angle:e.edit_info.edit_tar_info.ref=[{},{}];break;default:E.info("Error: "+q+" is not in the measure_subtype list"),Z=!1}e.edit_info.edit_tar_info=Object.assign(e.edit_info.edit_tar_info,{pt1:{x:0,y:0},value:0,USL:0,LSL:0,UCL:0,LCL:0}),Z&&(J[K[K.length-1]]=q)}else"ref_baseLine"==K[0]&&(J[K[K.length-1]]={id:q.shape.id,type:q.shape.type});E.info(J,e.edit_info.edit_tar_info),e.edit_info.edit_tar_info=Object.assign({},e.edit_info.edit_tar_info),e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null}break;case i.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(null!=e.edit_info.edit_tar_ele_trace&&null!=e.edit_info.edit_tar_ele_cand){var ee=e.edit_info.edit_tar_ele_trace,te=(0,o.GetObjElement)(e.edit_info.edit_tar_info,ee,ee.length-2),ne=e.edit_info.edit_tar_ele_cand;E.info("GetObjElement",te,ee[ee.length-1]),te[ee[ee.length-1]]={id:ne.shape.id,type:ne.shape.type},e.edit_info.edit_tar_info=Object.assign({},e.edit_info.edit_tar_info),e.edit_info.edit_tar_ele_trace=null,e.edit_info.edit_tar_ele_cand=null}}return e}return e}t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(g(e={MENU_EXPEND:!1,showSplash:!0,showSM_graph:!1,WS_CH:void 0,edit_info:{defModelPath:"data/cache_def",_obj:new s.InspectionEditorLogic,inspReport:void 0,reportStatisticState:{trackingWindow:[],historyReport:[],newAddedReport:[],statisticValue:void 0},sig360info:[],matching_angle_margin_deg:180,matching_angle_offset_deg:0,matching_face:0,img:null,DefFileName:"",DefFileTag:[],inspOptionalTag:[],list:[],__decorator:{listIDOrder:[]},inherentShapeList:[],edit_tar_info:null,edit_tar_ele_trace:null,edit_tar_ele_cand:null,camera_calibration_report:void 0,mouseLocation:void 0},version_map_info:void 0,WebUI_info:u.default,sm:null,c_state:null,p_state:null,state_count:0,WS_ID:"EverCheckWS",InspectionMonitor_URL:"http://gitexp.idcircle.me/hyvision_monitor/0.0.0/"}),e),n=arguments[1];if(void 0===n.type||n.type.includes("@@redux/"))return t;var a=Object.assign({},t),i=new Date;return"ATBundle"===n.type?(a=n.data.reduce(function(e,t){return t.date=i,T(e,t)},a),E.info(a),a):(n.date=i,a=T(a,n),E.debug(a),a)}},717:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={version:"1.0.4"}},721:function(e,t){},723:function(e,t){},757:function(e,t){},758:function(e,t){},805:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionThrottle=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n(33);(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t})(n(45)).getLogger("ActionThrottle"),t.ActionThrottle=function(e){return function(t){return function(n){return function(i){if(e.ATID!=i.ATID)return n(i);switch(void 0===e.initted&&(a(e.time)!=a(0)&&(e.time=30),a(e.posEdge)!=a(!0)&&(e.posEdge=!0),e.actions=[],e.initted=!0,e.timeout_obj=null),i.ActionThrottle_type){case"express":return i.ATID=e.ExATID,n(i);case"flush":if(clearTimeout(e.timeout_obj),e.timeout_obj=null,0==e.actions.length)return;e.actions.push(i);var r=e.actions;return e.actions=[],r.forEach(function(e){void 0!==e.type&&n(e)}),null;default:return null==e.timeout_obj?(e.timeout_obj=setTimeout(function(){t.dispatch({ActionThrottle_type:"flush"})},e.time),e.posEdge?(i.ATID=e.ExATID,n(i)):void e.actions.push(i)):void e.actions.push(i)}return i.ATID=e.ExATID,n(i)}}}}},806:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ECStateMachine=void 0;n(33);var a=n(1104);t.ECStateMachine=function(e){return function(t){return function(t){return function(n){if(void 0!==e.initted&&e.initted||(e.sm=(0,a.Machine)(e.state_config),e.c_state=e.sm.initialState,t({type:e.ev_state_update,data:{p_state:e.c_state,c_state:e.c_state,sm:e.sm,action:{type:e.ev_state_update}}}),e.initted=!0),null==n.type)return t(n);var i=e.sm.transition(e.c_state,n.type);if(JSON.stringify(e.c_state.value)!==JSON.stringify(i.value)){var r=e.c_state;e.c_state=i,t({type:e.ev_state_update,data:{p_state:r,c_state:i,sm:e.sm,action:n}})}return t(n)}}}}},809:function(e,t,n){var a={"./af":322,"./af.js":322,"./ar":323,"./ar-dz":324,"./ar-dz.js":324,"./ar-kw":325,"./ar-kw.js":325,"./ar-ly":326,"./ar-ly.js":326,"./ar-ma":327,"./ar-ma.js":327,"./ar-sa":328,"./ar-sa.js":328,"./ar-tn":329,"./ar-tn.js":329,"./ar.js":323,"./az":330,"./az.js":330,"./be":331,"./be.js":331,"./bg":332,"./bg.js":332,"./bm":333,"./bm.js":333,"./bn":334,"./bn.js":334,"./bo":335,"./bo.js":335,"./br":336,"./br.js":336,"./bs":337,"./bs.js":337,"./ca":338,"./ca.js":338,"./cs":339,"./cs.js":339,"./cv":340,"./cv.js":340,"./cy":341,"./cy.js":341,"./da":342,"./da.js":342,"./de":343,"./de-at":344,"./de-at.js":344,"./de-ch":345,"./de-ch.js":345,"./de.js":343,"./dv":346,"./dv.js":346,"./el":347,"./el.js":347,"./en-SG":348,"./en-SG.js":348,"./en-au":349,"./en-au.js":349,"./en-ca":350,"./en-ca.js":350,"./en-gb":351,"./en-gb.js":351,"./en-ie":352,"./en-ie.js":352,"./en-il":353,"./en-il.js":353,"./en-nz":354,"./en-nz.js":354,"./eo":355,"./eo.js":355,"./es":356,"./es-do":357,"./es-do.js":357,"./es-us":358,"./es-us.js":358,"./es.js":356,"./et":359,"./et.js":359,"./eu":360,"./eu.js":360,"./fa":361,"./fa.js":361,"./fi":362,"./fi.js":362,"./fo":363,"./fo.js":363,"./fr":364,"./fr-ca":365,"./fr-ca.js":365,"./fr-ch":366,"./fr-ch.js":366,"./fr.js":364,"./fy":367,"./fy.js":367,"./ga":368,"./ga.js":368,"./gd":369,"./gd.js":369,"./gl":370,"./gl.js":370,"./gom-latn":371,"./gom-latn.js":371,"./gu":372,"./gu.js":372,"./he":373,"./he.js":373,"./hi":374,"./hi.js":374,"./hr":375,"./hr.js":375,"./hu":376,"./hu.js":376,"./hy-am":377,"./hy-am.js":377,"./id":378,"./id.js":378,"./is":379,"./is.js":379,"./it":380,"./it-ch":381,"./it-ch.js":381,"./it.js":380,"./ja":382,"./ja.js":382,"./jv":383,"./jv.js":383,"./ka":384,"./ka.js":384,"./kk":385,"./kk.js":385,"./km":386,"./km.js":386,"./kn":387,"./kn.js":387,"./ko":388,"./ko.js":388,"./ku":389,"./ku.js":389,"./ky":390,"./ky.js":390,"./lb":391,"./lb.js":391,"./lo":392,"./lo.js":392,"./lt":393,"./lt.js":393,"./lv":394,"./lv.js":394,"./me":395,"./me.js":395,"./mi":396,"./mi.js":396,"./mk":397,"./mk.js":397,"./ml":398,"./ml.js":398,"./mn":399,"./mn.js":399,"./mr":400,"./mr.js":400,"./ms":401,"./ms-my":402,"./ms-my.js":402,"./ms.js":401,"./mt":403,"./mt.js":403,"./my":404,"./my.js":404,"./nb":405,"./nb.js":405,"./ne":406,"./ne.js":406,"./nl":407,"./nl-be":408,"./nl-be.js":408,"./nl.js":407,"./nn":409,"./nn.js":409,"./pa-in":410,"./pa-in.js":410,"./pl":411,"./pl.js":411,"./pt":412,"./pt-br":413,"./pt-br.js":413,"./pt.js":412,"./ro":414,"./ro.js":414,"./ru":415,"./ru.js":415,"./sd":416,"./sd.js":416,"./se":417,"./se.js":417,"./si":418,"./si.js":418,"./sk":419,"./sk.js":419,"./sl":420,"./sl.js":420,"./sq":421,"./sq.js":421,"./sr":422,"./sr-cyrl":423,"./sr-cyrl.js":423,"./sr.js":422,"./ss":424,"./ss.js":424,"./sv":425,"./sv.js":425,"./sw":426,"./sw.js":426,"./ta":427,"./ta.js":427,"./te":428,"./te.js":428,"./tet":429,"./tet.js":429,"./tg":430,"./tg.js":430,"./th":431,"./th.js":431,"./tl-ph":432,"./tl-ph.js":432,"./tlh":433,"./tlh.js":433,"./tr":434,"./tr.js":434,"./tzl":435,"./tzl.js":435,"./tzm":436,"./tzm-latn":437,"./tzm-latn.js":437,"./tzm.js":436,"./ug-cn":438,"./ug-cn.js":438,"./uk":439,"./uk.js":439,"./ur":440,"./ur.js":440,"./uz":441,"./uz-latn":442,"./uz-latn.js":442,"./uz.js":441,"./vi":443,"./vi.js":443,"./x-pseudo":444,"./x-pseudo.js":444,"./yo":445,"./yo.js":445,"./zh-cn":446,"./zh-cn.js":446,"./zh-hk":447,"./zh-hk.js":447,"./zh-tw":448,"./zh-tw.js":448};function i(e){var t=r(e);return n(t)}function r(e){var t=a[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id=809},810:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(811);var r=n(104),o=I(n(1)),s=n(84),l=w(s),u=n(41),d=I(n(813)),c=w(n(33)),p=w(n(63)),h=I(n(834)),f=I(n(924)),S=I(n(1051)),_=n(44),v=I(n(217)),E=I(n(229)),b=I(n(46)),m=I(n(1083)),y=I(n(1087)),g=I(n(527)),k=I(n(15)),T=I(n(53)),C=I(n(1098)),A=I(n(133)),N=I(n(220));function w(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function I(e){return e&&e.__esModule?e:{default:e}}function P(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}C.default.Header;var M=C.default.Content,U=(C.default.Footer,C.default.Sider),L=(T.default.SubMenu,y.default.Paragraph),F=y.default.Title,R=(g.default.Panel,function(e){function t(e){return O(this,t),D(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return x(t,o.default.Component),i(t,[{key:"ec_canvas_EmitEvent",value:function(e){}},{key:"componentDidMount",value:function(){this.ec_canvas=new v.default.Preview_CanvasComponent(this.refs.canvas),this.ec_canvas.EmitEvent=this.ec_canvas_EmitEvent.bind(this),void 0!==this.props.onCanvasInit&&this.props.onCanvasInit(this.ec_canvas),this.updateCanvas(this.props.c_state)}},{key:"componentWillUnmount",value:function(){this.ec_canvas.resourceClean()}},{key:"updateCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;void 0!==this.ec_canvas&&(this.ec_canvas.EditDBInfoSync(t.edit_info),this.ec_canvas.SetState(e),this.ec_canvas.draw())}},{key:"onResize",value:function(e,t){void 0!==this.ec_canvas&&this.ec_canvas.resize(e,t)}},{key:"componentDidUpdate",value:function(e,t){console.log("CanvasComponent render",this.props.c_state),console.log(this.props.edit_info.inherentShapeList),this.updateCanvas(this.props.c_state,this.props)}},{key:"render",value:function(){return o.default.createElement("div",{className:this.props.className},o.default.createElement("canvas",{ref:"canvas",className:"width12 HXF"}),o.default.createElement(E.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),t}()),j=function(e){function t(e){O(this,t);var n=D(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.QR_Content="",n.state={canvas:void 0,fUpdateC:0},n}return x(t,o.default.Component),i(t,[{key:"componentDidMount",value:function(){this.setState(a({},this.state,{canvas:this.refs.canvas}))}},{key:"onResize",value:function(e,t){this.refs.canvas.width=e,this.refs.canvas.height=t,this.setState(a({},this.state,{fUpdateC:this.state.fUpdateC++}))}},{key:"componentDidUpdate",value:function(e,t){this.QR_Content=this.props.QR_Content}},{key:"render",value:function(){return void 0!==this.refs.canvas&&d.default.toCanvas(this.refs.canvas,this.props.QR_Content,{errorCorrectionLevel:"L"},function(e){e&&console.error(e),console.log("success!")}),o.default.createElement("div",{className:this.props.className},o.default.createElement("canvas",{ref:"canvas",className:"width12 HXF",onClick:this.props.onClick}),o.default.createElement(E.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),t}(),W=(0,r.connect)(function(e){return{c_state:e.UIData.c_state,edit_info:e.UIData.edit_info}},function(e,t){return{}})(R);function B(e){return"string"==typeof e||e instanceof String}var H=function(e){function t(e){O(this,t);var n=D(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fileSelectedCallBack:void 0,menuSelect:"Overview",menuCollapsed:!0},n}return x(t,o.default.Component),i(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){var t=e.props.defModelPath;e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{deffile:t+"."+u.DEF_EXTENSION,imgsrc:t})},1e3)}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"FrontDoor",value:function(){var e=o.default.createElement("div",{className:"content"},o.default.createElement(L,null,"HYVision 2019 is the most famous vision-check system in the world."),o.default.createElement(L,null,o.default.createElement("p",null,"HYVision 2019 - v1 (http://hyv.idcircle.me)"),o.default.createElement("p",null,"HYVision 2019 - v2 (http://hyv.idcircle.me)"),o.default.createElement("p",null,"HYVision 2019 - v3 (http://hyv.idcircle.me)")),o.default.createElement("p",{className:"contentLink"},o.default.createElement("a",null,o.default.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/MjEImQtenlyueSmVEfUD.svg",alt:"start"})," Quick Start"),o.default.createElement("a",null,o.default.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/NbuDUAuBlIApFuDvWiND.svg",alt:"info"}),"Product Info"),o.default.createElement("a",null,o.default.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/ohOEPSYdDTNnyMbGuyLb.svg",alt:"doc"}),"Product Doc"))),t=o.default.createElement("img",{src:"https://gw.alipayobjects.com/mdn/mpaas_user/afts/img/A*KsfVQbuLRlYAAAAAAAAAAABjAQAAAQ/original",alt:"content"});return o.default.createElement(m.default,{title:"HYVision 2019",breadcrumb:{routes:[{path:"index",breadcrumbName:"HYV"},{path:"first",breadcrumbName:"HOME"},{path:"second",breadcrumbName:"Manual"}]}},o.default.createElement("div",{className:"wrap"},o.default.createElement("div",{className:"content"},e),o.default.createElement("div",{className:"extraContent"},t)))}},{key:"render",value:function(){var e=this,t=[];if(null==this.props.c_state)return null;var n=(0,_.xstate_GetCurrentMainState)(this.props.c_state);if(n.state===c.UI_SM_STATES.MAIN){var i=this.props.defModelPath.substr(0,this.props.defModelPath.lastIndexOf("/")+1),r=function(t){e.setState(a({},e.state,{menuSelect:t.key}))},d=void 0;if(void 0!==this.props.camera_calibration_report){var p=this.props.isp_db.cameraParam;d=p.mmpb2b/p.ppb2b}var v=void 0;B(this.props.defModelHash)&&this.props.defModelHash.length>5&&(v=this.props.InspectionMonitor_URL+"?v=0&name="+this.props.defModelName+"&hash="+this.props.defModelHash,v=encodeURI(v));var E={HOME:{icon:"home",content:this.FrontDoor(),onSelected:r},Overview:{icon:"info-circle",content:o.default.createElement("div",{style:{padding:24,background:"#fff",height:"100%"}},o.default.createElement("div",{className:"s black"},this.props.WebUI_info.version),o.default.createElement("div",{className:"s width7",style:{height:"500px"}},o.default.createElement(b.default,{size:"large",onClick:function(){e.setState(a({},e.state,{fileSelectedCallBack:function(t,n){t=t.replace("."+u.DEF_EXTENSION,""),e.setState(a({},e.state,{fileSelectedCallBack:void 0})),e.props.ACT_Def_Model_Path_Update(t),e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{deffile:t+"."+u.DEF_EXTENSION,imgsrc:t})}}))}},o.default.createElement(k.default,{type:"file-add"}),this.props.defModelPath),o.default.createElement(F,{level:2},this.props.defModelName),this.props.defFileTag.map(function(e){return o.default.createElement(N.default,{className:"large InspTag fixed"},e)}),this.props.inspOptionalTag.map(function(t){return o.default.createElement(N.default,{closable:!0,className:"large InspTag optional",onClose:function(n){n.preventDefault();var a=t,i=e.props.inspOptionalTag.filter(function(e){return e!=a});console.log(n.target,i),e.props.ACT_InspOptionalTag_Update(i)}},t)}),o.default.createElement(A.default,{placeholder:"新標籤",onChange:function(t){var n=t.target.value;e.setState(a({},e.state,{newTagStr:n}))},onPressEnter:function(t){var n=t.target.value.split(","),i=[].concat(P(e.props.inspOptionalTag),P(n));e.props.ACT_InspOptionalTag_Update(i),e.setState(a({},e.state,{newTagStr:""}))},className:this.props.inspOptionalTag.find(function(t){return t==e.state.newTagStr})?"error":"",allowClear:!0,value:this.state.newTagStr,prefix:o.default.createElement(k.default,{type:"tags"})}),o.default.createElement(W,{className:"height11"})),B(v)?o.default.createElement(j,{className:"s width5 HX6",onClick:function(){return window.open(v)},QR_Content:v}):null,void 0===d?null:o.default.createElement(b.default,{key:"mmpp",size:"large",onClick:function(){e.props.ACT_WS_SEND(e.props.WS_ID,"ST",0,{LoadCameraCalibration:"data/default_camera_param.json"}),e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{filename:"data/default_camera_param.json"})}},o.default.createElement(k.default,{type:"camera"})," ","mmpp:"+d),o.default.createElement(s.BPG_FileBrowser,{key:"BPG_FileBrowser",path:i,visible:void 0!==this.state.fileSelectedCallBack,BPG_Channel:function(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.props).ACT_WS_SEND.apply(t,[e.props.WS_ID].concat(a))},onFileSelected:function(t,n){e.setState(a({},e.state,{fileSelectedCallBack:void 0})),e.state.fileSelectedCallBack(t,n)},onCancel:function(){e.setState(a({},e.state,{fileSelectedCallBack:void 0}))},fileFilter:function(e){return"DIR"==e.type||e.name.includes("."+u.DEF_EXTENSION)}})),onSelected:r},EDIT:{icon:"edit",content:null,onSelected:this.props.EV_UI_Edit_Mode},Inspect:{icon:"scan",content:null,onSelected:this.props.EV_UI_Insp_Mode},STA:{icon:"bar-chart",content:null,onSelected:this.props.EV_UI_Analysis_Mode},Setting:{icon:"setting",content:o.default.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},o.default.createElement(b.default,{key:"Reconnect CAM",onClick:function(){e.props.ACT_WS_SEND(e.props.WS_ID,"RC",0,{target:"camera_ez_reconnect"})}},"Reconnect CAM"),o.default.createElement(b.default,{key:"camera Calib",onClick:function(){e.setState(a({},e.state,{fileSelectedCallBack:function(t,n){console.log(t,n),e.props.ACT_WS_SEND(e.props.WS_ID,"II",0,{deffile:"data/cameraCalibration.json",imgsrc:t})}}))}},"camera Calib"),o.default.createElement(s.BPG_FileBrowser,{key:"BPG_FileBrowser",path:i,visible:void 0!==this.state.fileSelectedCallBack,BPG_Channel:function(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.props).ACT_WS_SEND.apply(t,[e.props.WS_ID].concat(a))},onFileSelected:function(t,n){e.setState(a({},e.state,{fileSelectedCallBack:void 0})),e.state.fileSelectedCallBack(t,n)},onCancel:function(){e.setState(a({},e.state,{fileSelectedCallBack:void 0}))},fileFilter:function(e){return"DIR"==e.type||e.name.includes(".bmp")||e.name.includes(".png")}})),onSelected:r},Collapse:{icon:this.state.menuCollapsed?"right":"left",content:null,onSelected:function(){return e.setState(a({},e.state,{menuCollapsed:!e.state.menuCollapsed}))}}},m=this.props.version_map_info,y=(0,_.GetObjElement)(m,["recommend_info","url"]);void 0!==y&&-1==y.indexOf()&&(E.UPDATE={icon:"cloud-download",content:null,onSelected:function(){window.location.href=y}}),t.push(o.default.createElement(C.default,{className:"HXF"},o.default.createElement(U,{trigger:null,collapsible:!0,collapsed:this.state.menuCollapsed},o.default.createElement(T.default,{theme:"dark",mode:"inline",defaultSelectedKeys:[this.state.menuSelect],onClick:function(e){return E[e.key].onSelected(e)}},Object.keys(E).map(function(e){return o.default.createElement(T.default.Item,{key:e},o.default.createElement(k.default,{type:E[e].icon}),o.default.createElement("span",null,e))}))),o.default.createElement(C.default,null,o.default.createElement(M,null,E[this.state.menuSelect].content))))}else n.state===c.UI_SM_STATES.DEFCONF_MODE?t=o.default.createElement(h.default,null):n.state===c.UI_SM_STATES.INSP_MODE?t=o.default.createElement(f.default,null):n.state===c.UI_SM_STATES.ANALYSIS_MODE&&(t=o.default.createElement(S.default,null));return o.default.createElement(l.CardFrameWarp,{addClass:"width12 height12",fixedFrame:!0},t)}}]),t}(),V=(0,r.connect)(function(e){return{defModelName:e.UIData.edit_info.DefFileName,defFileTag:e.UIData.edit_info.DefFileTag,inspOptionalTag:e.UIData.edit_info.inspOptionalTag,defModelPath:e.UIData.edit_info.defModelPath,defModelHash:e.UIData.edit_info.DefFileHash,c_state:e.UIData.c_state,camera_calibration_report:e.UIData.edit_info.camera_calibration_report,isp_db:e.UIData.edit_info._obj,WS_CH:e.UIData.WS_CH,WS_ID:e.UIData.WS_ID,version_map_info:e.UIData.version_map_info,WebUI_info:e.UIData.WebUI_info,InspectionMonitor_URL:e.UIData.InspectionMonitor_URL}},function(e,t){return{EV_UI_Edit_Mode:function(t){e(c.EV_UI_Edit_Mode())},EV_UI_Insp_Mode:function(){e(c.EV_UI_Insp_Mode())},EV_UI_Analysis_Mode:function(){e(c.EV_UI_Analysis_Mode())},ACT_Def_Model_Path_Update:function(t){e(c.Def_Model_Path_Update(t))},ACT_InspOptionalTag_Update:function(t){e(p.InspOptionalTag_Update(t))},ACT_WS_SEND:function(t,n,a,i,r,o){return e(c.EV_WS_SEND(t,n,a,i,r,o))}}})(H);t.default=V},834:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(104),o=T(n(1)),s=T(n(209)),l=k(n(84)),u=T(n(845)),d=T(n(229)),c=n(41),p=T(n(41)),h=T(n(217)),f=(n(284),k(n(33))),S=k(n(63)),_=n(44),v=T(n(286)),E=k(n(45)),b=T(n(85)),m=T(n(173)),y=T(n(129)),g=T(n(86));function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function T(e){return e&&e.__esModule?e:{default:e}}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function N(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var w=l.BPG_FileBrowser,I=l.BPG_FileSavingBrowser,P=function(e){function t(e){return C(this,t),A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return N(t,o.default.Component),i(t,[{key:"ec_canvas_EmitEvent",value:function(e){switch(e.type){case S.EVENT.SUCCESS:this.props.ACT_SUCCESS();break;case S.EVENT.FAIL:this.props.ACT_Fail();break;case S.EVENT.Edit_Tar_Update:this.props.ACT_EDIT_TAR_UPDATE(e.data);break;case S.EVENT.Edit_Tar_Ele_Cand_Update:this.props.ACT_EDIT_TAR_ELE_CAND_UPDATE(e.data);break;case S.EVENT.Shape_List_Update:console.log(e),this.props.ACT_EDIT_SHAPELIST_UPDATE(e.data);break;case S.EVENT.Shape_Set:console.log(e),this.props.ACT_EDIT_SHAPE_SET(e.data);break;case S.EVENT.Edit_Tar_Ele_Trace_Update:this.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(e.data)}}},{key:"componentDidMount",value:function(){this.ec_canvas=new h.default.DEFCONF_CanvasComponent(this.refs.canvas),this.ec_canvas.EmitEvent=this.ec_canvas_EmitEvent.bind(this),this.props.onCanvasInit(this.ec_canvas),this.updateCanvas(this.props.c_state)}},{key:"componentWillUnmount",value:function(){this.ec_canvas.resourceClean()}},{key:"updateCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;void 0!==this.ec_canvas&&(this.ec_canvas.EditDBInfoSync(t.edit_info),this.ec_canvas.SetState(e),this.ec_canvas.draw())}},{key:"onResize",value:function(e,t){void 0!==this.ec_canvas&&(this.ec_canvas.resize(e,t),this.updateCanvas(this.props.c_state),this.ec_canvas.ctrlLogic(),this.ec_canvas.draw())}},{key:"componentWillUpdate",value:function(e,t){console.log("CanvasComponent render",e.c_state),console.log(e.edit_info.inherentShapeList),this.updateCanvas(e.c_state,e)}},{key:"render",value:function(){return o.default.createElement("div",{className:this.props.addClass+" HXF"},o.default.createElement("canvas",{ref:"canvas",className:"width12 HXF"}),o.default.createElement(d.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),t}(),O=(0,r.connect)(function(e){return{c_state:e.UIData.c_state,edit_info:e.UIData.edit_info}},function(e,t){return{ACT_SUCCESS:function(t){e(f.EV_UI_ACT(S.EVENT.SUCCESS))},ACT_Fail:function(t){e(f.EV_UI_ACT(S.EVENT.FAIL))},ACT_EXIT:function(t){e(f.EV_UI_ACT(f.UI_SM_EVENT.EXIT))},ACT_EDIT_TAR_UPDATE:function(t){e(S.Edit_Tar_Update(t))},ACT_EDIT_TAR_ELE_CAND_UPDATE:function(t){e(S.Edit_Tar_Ele_Cand_Update(t))},ACT_EDIT_SHAPELIST_UPDATE:function(t){e(S.Shape_List_Update(t))},ACT_EDIT_SHAPE_SET:function(t){e(S.Shape_Set(t))},ACT_EDIT_TAR_ELE_TRACE_UPDATE:function(t){e(S.Edit_Tar_Ele_Trace_Update(t))}}})(P),D=(function(e){function t(e){C(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}N(t,o.default.Component),i(t,[{key:"dragStart",value:function(e){this.dragged=e.currentTarget,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.dragged)}},{key:"dragEnd",value:function(e){}},{key:"dragOver",value:function(e){e.preventDefault(),this.dragged.style.display="none","placeholder"!==e.target.className&&(this.over=e.target,e.target.parentNode.insertBefore(placeholder,e.target))}},{key:"render",value:function(){var e=this,t=this.props.items.map(function(t,n){var a=e.props.itemRenderer(t,n,"true",e.dragEnd.bind(e),e.dragStart.bind(e));return console.log(a),a});return o.default.createElement("ul",{onDragOver:this.dragOver.bind(this)},t)}}])}(),function(e){function t(e){C(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.ec_canvas=null,n.state={fileSelectedCallBack:void 0,fileSavingCallBack:void 0,showSetup:!1},n}return N(t,o.default.Component),i(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.edit_info.defModelPath;new Promise(function(n,a){e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{deffile:t+"."+c.DEF_EXTENSION,imgsrc:t},void 0,{resolve:n,reject:a}),setTimeout(function(){return a("Timeout")},1e3)}).then(function(t){e.props.DISPATCH({type:"ATBundle",ActionThrottle_type:"express",data:t.map(function(e){return p.default.map_BPG_Packet2Act(e)}).filter(function(e){return void 0!==e})})}).catch(function(e){E.info(e)});var n=new _.websocket_autoReconnect("ws://hyv.decade.tw:8080/insert/def",1e4);this.WS_DEF_DB_Insert=new _.websocket_reqTrack(n),this.WS_DEF_DB_Insert.onreconnection=function(e){return E.info("onreconnection"+e),!(e>10)},this.WS_DEF_DB_Insert.onopen=function(){return E.info("WS_DEF_DB_Insert:onopen")},this.WS_DEF_DB_Insert.onmessage=function(e){return E.info("WS_DEF_DB_Insert:onmessage::",e)},this.WS_DEF_DB_Insert.onconnectiontimeout=function(){return E.info("WS_DEF_DB_Insert:onconnectiontimeout")},this.WS_DEF_DB_Insert.onclose=function(){return E.info("WS_DEF_DB_Insert:onclose")},this.WS_DEF_DB_Insert.onerror=function(){return E.info("WS_DEF_DB_Insert:onerror")}}},{key:"componentWillUnmount",value:function(){this.WS_DEF_DB_Insert.close(),this.props.ACT_ClearImage()}}]),i(t,[{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"genTarEditUI",value:function(e){var t=this;switch(e.type){case f.SHAPE_TYPE.aux_point:case f.SHAPE_TYPE.search_point:case f.SHAPE_TYPE.measure:return o.default.createElement(l.JsonEditBlock,{object:e,dict:g.default,dictTheme:e.type,key:"BASE_COM.JsonEditBlock",whiteListKey:{type:"div",subtype:"div",name:"input",angleDeg:"input-number",value:"input-number",margin:"input-number",USL:"input-number",LSL:"input-number",UCL:"input-number",LCL:"input-number",quadrant:"div",docheck:"checkbox",width:"input-number",ref:{__OBJ__:"div",0:{__OBJ__:"btn",id:"div",element:"div"},1:{__OBJ__:"btn",id:"div",element:"div"}},ref_baseLine:{__OBJ__:"btn",id:"div",element:"div"}},jsonChange:function(e,n,a,i){if("btn"==a)"ref"!=n.keyTrace[0]&&"ref_baseLine"!=n.keyTrace[0]||t.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(n.keyTrace);else{var r=n.keyTrace[n.keyTrace.length-1];switch(a){case"input-number":var o=parseFloat(i.target.value);if(isNaN(o))return;if(n.obj[r]=o,void 0!==n.obj.value){var s=n.obj.value;"LSL"==r?n.obj.LCL=(0,_.round)(s+2*(n.obj.LSL-s)/3,.001):"USL"==r&&(n.obj.UCL=(0,_.round)(s+2*(n.obj.USL-s)/3,.001))}break;case"input":n.obj[r]=i.target.value;break;case"checkbox":n.obj[r]=i.target.checked}t.ec_canvas.SetShape(e,e.id)}}});default:return o.default.createElement(l.JsonEditBlock,{object:e,dict:g.default,dictTheme:e.type,key:"BASE_COM.JsonEditBlock",jsonChange:function(e,n,a,i){var r=n.keyTrace[n.keyTrace.length-1];"input-number"==a?n.obj[r]=parseFloat(i.target.value):"input"==a&&(n.obj[r]=i.target.value),console.log(n.obj);var o=e;t.ec_canvas.SetShape(o,o.id)},whiteListKey:{type:"div",subtype:"div",name:"input",margin:"input-number",direction:"input-number"}})}}},{key:"render",value:function(){var e=this,t=[],n="HXA";console.log("CanvasComponent render");var i=this.props.c_state.value[f.UI_SM_STATES.DEFCONF_MODE];console.log(this.props.edit_info.DefFileTag);var r=this.props.edit_info.defModelPath;switch(i){case f.UI_SM_STATES.DEFCONF_MODE_NEUTRAL:n="HXA",t=[o.default.createElement(l.IconButton,{dict:g.default,key:"<",addClass:"layout black vbox",text:"<",onClick:function(){return e.props.ACT_EXIT()}}),o.default.createElement(l.JsonEditBlock,{object:{DefFileName:this.props.edit_info.DefFileName},dict:g.default,key:"this.props.edit_info.DefFileName",jsonChange:function(t,n,a,i){e.props.ACT_DefFileName_Update(i.target.value)},whiteListKey:{DefFileName:"input"}}),o.default.createElement(l.JsonEditBlock,{object:{DefFileTag:this.props.edit_info.DefFileTag.join(",")},dict:g.default,key:"this.props.edit_info.DefFileTag",jsonChange:function(t,n,a,i){e.props.ACT_DefFileTag_Update(i.target.value.split(","))},whiteListKey:{DefFileTag:"input"}}),o.default.createElement(l.IconButton,{dict:g.default,addClass:"layout palatte-blue-8 vbox",key:"LINE",text:"line",onClick:function(){return e.props.ACT_Line_Add_Mode()}}),o.default.createElement(l.IconButton,{dict:g.default,addClass:"layout palatte-blue-8 vbox",key:"ARC",text:"arc",onClick:function(){return e.props.ACT_Arc_Add_Mode()}}),o.default.createElement(l.IconButton,{dict:g.default,addClass:"layout palatte-blue-8 vbox",key:"APOINT",text:"apoint",onClick:function(){return e.props.ACT_Aux_Point_Add_Mode()}}),o.default.createElement(l.IconButton,{dict:g.default,addClass:"layout palatte-blue-8 vbox",key:"SPOINT",text:"spoint",onClick:function(){return e.props.ACT_Search_Point_Add_Mode()}}),o.default.createElement(l.IconButton,{iconType:"form",addClass:"layout palatte-blue-8",key:"MEASURE",dict:g.default,text:"measure",onClick:function(){return e.props.ACT_Measure_Add_Mode()}}),o.default.createElement(l.IconButton,{iconType:"edit",dict:g.default,addClass:"layout palatte-blue-5 vbox",key:"EDIT",text:"edit",onClick:function(){return e.props.ACT_Shape_Edit_Mode()}}),o.default.createElement(l.IconButton,{iconType:"save",dict:g.default,addClass:"layout palatte-gold-7 vbox",key:"SAVE",text:"save",onClick:function(){e.setState(a({},e.state,{fileSavingCallBack:function(t,n,i){var r=t.path+"/"+n.replace("."+c.DEF_EXTENSION,"");console.log(r);var o=new TextEncoder,s=e.props.edit_info._obj.GenerateEditReport();s.name=e.props.edit_info.DefFileName,s.tag=e.props.edit_info.DefFileTag,s.featureSet[0].matching_angle_margin_deg=e.props.edit_info.matching_angle_margin_deg,s.featureSet[0].matching_angle_offset_deg=e.props.edit_info.matching_angle_offset_deg,s.featureSet[0].matching_face=e.props.edit_info.matching_face;var l=v.default.digest(s.featureSet,"sha1","hex");s.featureSet[0].__decorator=e.props.Info_decorator,s.featureSet_sha1=l,console.log("ACT_Report_Save"),e.props.ACT_Report_Save(e.props.WS_ID,r+"."+c.DEF_EXTENSION,o.encode(JSON.stringify(s,null,2))),console.log("ACT_Cache_Img_Save"),e.props.ACT_Cache_Img_Save(e.props.WS_ID,r),e.props.ACT_Def_Model_Path_Update(r),e.setState(a({},e.state,{fileSavingCallBack:void 0}));var u={dbcmd:{db_action:"insert"},data:s};e.WS_DEF_DB_Insert.send_obj(u).then(function(e){return console.log("then",e)}).catch(function(e){return console.log("catch",e)})},fileSelectFooter:o.default.createElement("div",null,"ddd")}))}}),o.default.createElement(l.IconButton,{iconType:"export",dict:g.default,addClass:"layout palatte-gold-7 vbox",key:"LOAD",text:"load",onClick:function(){e.setState(a({},e.state,{fileSelectedCallBack:function(t){var n=t.replace("."+c.DEF_EXTENSION,"");console.log(n),e.props.ACT_Def_Model_Path_Update(n),e.props.ACT_WS_SEND(e.props.WS_ID,"LD",0,{deffile:n+"."+c.DEF_EXTENSION,imgsrc:n}),e.setState(a({},e.state,{fileSelectedCallBack:void 0}))}}))}}),o.default.createElement(l.IconButton,{dict:g.default,iconType:"setting",addClass:"layout palatte-gray-8 vbox",key:"setting",text:"setting",onClick:function(){return e.setState(a({},e.state,{showSetup:!0}))}}),o.default.createElement(l.IconButton,{iconType:"camera",dict:g.default,addClass:"layout palatte-purple-8 vbox",key:"TAKE",text:"take",onClick:function(){e.setState(a({},e.state,{warningInfo:{onOk:function(){new Promise(function(t,n){e.props.ACT_WS_SEND(e.props.WS_ID,"EX",0,{},void 0,{resolve:t,reject:n}),setTimeout(function(){return n("Timeout")},1e3)}).then(function(t){e.props.DISPATCH({type:"ATBundle",ActionThrottle_type:"express",data:t.map(function(e){return p.default.map_BPG_Packet2Act(e)}).filter(function(e){return void 0!==e})})}).catch(function(e){E.info(e)}),e.props.ACT_Shape_List_Reset()},onCancel:function(){console.log("onCancel")},content:"確定要重新設定嗎？"}}))}})];var d=r.substr(0,r.lastIndexOf("/")+1);if(void 0!==this.state.fileSelectedCallBack&&t.push(o.default.createElement(w,{key:"BPG_FileBrowser",path:d,visible:void 0!==this.state.fileSelectedCallBack,BPG_Channel:function(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.props).ACT_WS_SEND.apply(t,[e.props.WS_ID].concat(a))},onFileSelected:function(t,n){e.state.fileSelectedCallBack(t,n)},onOk:function(e){console.log(e)},onCancel:function(){e.setState(a({},e.state,{fileSelectedCallBack:void 0}))},fileFilter:function(e){return"DIR"==e.type||e.name.includes("."+c.DEF_EXTENSION)}})),void 0!==this.state.fileSavingCallBack){var h=r.substr(r.lastIndexOf("/")+1);t.push(o.default.createElement(I,{key:"BPG_FileSavingBrowser",path:d,visible:void 0!==this.state.fileSavingCallBack,defaultName:h,BPG_Channel:function(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.props).ACT_WS_SEND.apply(t,[e.props.WS_ID].concat(a))},onOk:function(t,n,a){e.state.fileSavingCallBack(t,n,a)},onCancel:function(){e.setState(a({},e.state,{fileSavingCallBack:void 0}))},fileFilter:function(e){return"DIR"==e.type||e.name.includes("."+c.DEF_EXTENSION)}}))}break;case f.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:if(t=[o.default.createElement(l.Button,{addClass:"layout black vbox width4",key:"<",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"MEASURE",className:"s width8 lblue vbox"},"MEASURE")],null!=this.props.edit_tar_info){if(console.log("BASE_COM.JsonEditBlock:",this.props.edit_tar_info),t.push(o.default.createElement(l.JsonEditBlock,{object:this.props.edit_tar_info,dict:g.default,key:"BASE_COM.JsonEditBlock",whiteListKey:{name:"input",subtype:"div",ref:{__OBJ__:"div",0:{__OBJ__:"btn",id:"div",element:"div"},1:{__OBJ__:"btn",id:"div",element:"div"}},ref_baseLine:{__OBJ__:"btn",id:"div",element:"div"}},jsonChange:function(t,n,a,i){if(console.log(n),"btn"==a)"ref"!=n.keyTrace[0]&&"ref_baseLine"!=n.keyTrace[0]||e.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(n.keyTrace);else{var r=n.keyTrace[n.keyTrace.length-1];"input-number"==a?n.obj[r]=parseFloat(i.target.value):"input"==a&&(n.obj[r]=i.target.value),e.ec_canvas.SetShape(t,t.id)}}})),this.props.edit_tar_info.subtype==f.SHAPE_TYPE.measure_subtype.NA)for(var S in f.SHAPE_TYPE.measure_subtype)"NA"!=S&&t.push(o.default.createElement(l.IconButton,{dict:g.default,key:"MSUB__"+S,addClass:"layout red vbox",text:S,onClick:function(t,n){console.log(n.props.text),e.props.ACT_EDIT_TAR_ELE_CAND_UPDATE(n.props.text)}}));var k=this.props.edit_tar_info;if(console.log(k.ref),void 0!==k.ref){var T=!1;k.ref.forEach(function(e){void 0===e.id&&(T=!0)}),T||t.push(o.default.createElement(l.Button,{key:"ADD_BTN",addClass:"layout red vbox",text:"ADD",onClick:function(){e.ec_canvas.SetShape(e.props.edit_tar_info),e.props.ACT_SUCCESS()}}))}}break;case f.UI_SM_STATES.DEFCONF_MODE_LINE_CREATE:t=[o.default.createElement(l.IconButton,{dict:g.default,addClass:"layout black vbox width4",key:"<",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"LINE",className:"s width8 lred vbox"},"LINE")];break;case f.UI_SM_STATES.DEFCONF_MODE_ARC_CREATE:t=[o.default.createElement(l.IconButton,{dict:g.default,addClass:"layout black vbox width4",key:"<",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"ARC",className:"s width8 lred vbox"},"ARC")];break;case f.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:if(t=[o.default.createElement(l.IconButton,{dict:g.default,addClass:"layout black vbox",key:"<",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"SEARCH_POINT",className:"s lred vbox"},"SPOINT")],null!=this.props.edit_tar_info)console.log("BASE_COM.JsonEditBlock:",this.props.edit_tar_info),t.push(this.genTarEditUI(this.props.edit_tar_info)),void 0!==this.props.edit_tar_info.ref[0].id&&t.push(o.default.createElement(l.Button,{key:"ADD_BTN",addClass:"layout red vbox",text:"ADD",onClick:function(){e.ec_canvas.SetShape(e.props.edit_tar_info),e.props.ACT_SUCCESS()}}));break;case f.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:if(t=[o.default.createElement(l.Button,{addClass:"layout black vbox",key:"<",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"AUX_POINT",className:"s lred vbox"},"APOINT")],null!=this.props.edit_tar_info){console.log("BASE_COM.JsonEditBlock:",this.props.edit_tar_info),t.push(this.genTarEditUI(this.props.edit_tar_info));var C=this.props.edit_tar_info;console.log(C.ref),void 0!==C.ref[0].id&&void 0!==C.ref[1].id&&C.ref[0].id!=C.ref[1].id&&t.push(o.default.createElement(l.Button,{key:"ADD_BTN",addClass:"layout red vbox",text:"ADD",onClick:function(){e.ec_canvas.SetShape(e.props.edit_tar_info),e.props.ACT_SUCCESS()}}))}break;case f.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(t=[o.default.createElement(l.Button,{key:"<",addClass:"layout black vbox width4",text:"<",onClick:function(){return e.props.ACT_Fail()}}),o.default.createElement("div",{key:"EDIT_Text",className:"s width8 lblue vbox"},"EDIT"),o.default.createElement("div",{key:"HLINE",className:"s HX0_1"})],null!=this.props.edit_tar_info){t.push(this.genTarEditUI(this.props.edit_tar_info));void 0!==this.props.edit_tar_info.id&&(t.push(o.default.createElement(l.Button,{key:"COPY_BTN",addClass:"layout blue vbox",text:"COPY",onClick:function(){return t=e.props.edit_tar_info,(n=(0,b.default)(t)).id=void 0,console.log(n),["pt1","pt2","pt3"].forEach(function(e){void 0!==n[e]&&(n[e].x+=1,n[e].y+=1)}),n.name+="_copy",void e.ec_canvas.SetShape(n,void 0);var t,n}})),t.push(o.default.createElement(l.Button,{key:"DEL_BTN",addClass:"layout red vbox",text:"DEL",onClick:function(){var t=e.props.edit_tar_info,n="確定要刪除:"+t.name+" ?",i=e.props.edit_info._obj.FindShapeRefTree(t.id),r=e.props.edit_info._obj.FlatRefTree(i);0!==(r=r.filter(function(t){return e.props.shape_list.find(function(e){return e.id==t.id})})).length&&(n=o.default.createElement("div",null,n,o.default.createElement("br",null),"相關連之物件如下",r.map(function(e){return[o.default.createElement("br",null),e.shape.name]}))),console.log(i,r),e.setState(a({},e.state,{warningInfo:{onOk:function(){var n;n=t.id,e.ec_canvas.SetShape(null,n),console.log("onOK")},onCancel:function(){console.log("onCancel")},content:n}}))}})))}else{console.log(this.props.shape_list);var A=this.props.shape_list;console.log(this.props.Info_decorator.list_id_order),this.props.Info_decorator.list_id_order.length==A.length&&(A=this.props.Info_decorator.list_id_order.map(function(t){return e.props.shape_list.find(function(e){return e.id==t})})),t.push(o.default.createElement("div",{className:"s HXA"},o.default.createElement(u.default,{items:A.map(function(t,n){return{content:o.default.createElement("div",{key:"shape_listing_"+t.id,className:"button lred",style:{height:"40px"},onClick:function(){return e.props.ACT_EDIT_TAR_UPDATE(t)}},t.name),shape_id:t.id}}),onSort:function(t){var n=t.map(function(e){return e.shape_id});e.props.ACT_Shape_Decoration_ID_Order_Update(n),console.log("onSort",t,n)},dropBackTransitionDuration:.3,type:"vertical"})))}}return console.log("APP_DEFCONF_MODE render"),o.default.createElement("div",{className:"overlayCon HXF"},o.default.createElement(m.default,{title:null,visible:void 0!==this.state.warningInfo,okText:"Yes",okType:"danger",onCancel:function(t){e.state.warningInfo.onCancel(t),e.setState(a({},e.state,{warningInfo:void 0}))},onOk:function(t){e.state.warningInfo.onOk(t),e.setState(a({},e.state,{warningInfo:void 0}))}},void 0!==this.state.warningInfo?this.state.warningInfo.content:null),o.default.createElement(m.default,{title:"Setup",visible:this.state.showSetup,onCancel:function(t){e.setState(a({},e.state,{showSetup:!1}))},footer:"  "},o.default.createElement(y.default,{checked:90==this.props.edit_info.matching_angle_margin_deg,onChange:function(t){90==e.props.edit_info.matching_angle_margin_deg?e.props.ACT_Matching_Angle_Margin_Deg_Update(180):e.props.ACT_Matching_Angle_Margin_Deg_Update(90)}},(0,_.dictLookUp)("matchingAngleLimit180",g.default)),o.default.createElement("br",null),o.default.createElement(y.default,{checked:1==this.props.edit_info.matching_face,onChange:function(t){1==e.props.edit_info.matching_face?e.props.ACT_Matching_Face_Update(0):e.props.ACT_Matching_Face_Update(1),console.log(t.target.checked)}},(0,_.dictLookUp)("matchingFaceFrontOnly",g.default))),o.default.createElement(O,{addClass:"layout width12",onCanvasInit:function(t){e.ec_canvas=t}}),o.default.createElement(s.default,{transitionName:"fadeIn"},o.default.createElement("div",{key:i,className:"s overlay scroll shadow1 MenuAnim "+n},t)))}}]),t}()),x=(0,r.connect)(function(e){return{c_state:e.UIData.c_state,edit_tar_info:e.UIData.edit_info.edit_tar_info,shape_list:e.UIData.edit_info.list,Info_decorator:e.UIData.edit_info.__decorator,WS_ID:e.UIData.WS_ID,edit_info:e.UIData.edit_info}},function(e,t){return{ACT_Line_Add_Mode:function(t){e(f.EV_UI_ACT(f.UI_SM_EVENT.Line_Create))},ACT_Arc_Add_Mode:function(t){e(f.EV_UI_ACT(f.UI_SM_EVENT.Arc_Create))},ACT_Search_Point_Add_Mode:function(t){e(f.EV_UI_ACT(f.UI_SM_EVENT.Search_Point_Create))},ACT_Aux_Point_Add_Mode:function(t){e(f.EV_UI_ACT(f.UI_SM_EVENT.Aux_Point_Create))},ACT_Shape_Edit_Mode:function(t){e(f.EV_UI_ACT(f.UI_SM_EVENT.Shape_Edit))},ACT_Measure_Add_Mode:function(t){e(f.EV_UI_ACT(f.UI_SM_EVENT.Measure_Create))},ACT_DefFileName_Update:function(t){e(S.DefFileName_Update(t))},ACT_DefFileTag_Update:function(t){e(S.DefFileTag_Update(t))},ACT_EDIT_TAR_ELE_TRACE_UPDATE:function(t){e(S.Edit_Tar_Ele_Trace_Update(t))},ACT_EDIT_TAR_ELE_CAND_UPDATE:function(t){e(S.Edit_Tar_Ele_Cand_Update(t))},ACT_EDIT_TAR_UPDATE:function(t){e(S.Edit_Tar_Update(t))},ACT_Shape_List_Reset:function(){e(S.Shape_List_Update([]))},ACT_Save_Def_Config:function(t){e(f.EV_UI_EC_Save_Def_Config(t))},ACT_Load_Def_Config:function(t){e(f.EV_UI_EC_Load_Def_Config(t))},ACT_SUCCESS:function(t){e(f.EV_UI_ACT(S.EVENT.SUCCESS))},ACT_Fail:function(t){e(f.EV_UI_ACT(S.EVENT.FAIL))},ACT_EXIT:function(t){e(f.EV_UI_ACT(f.UI_SM_EVENT.EXIT))},ACT_Def_Model_Path_Update:function(t){e(f.Def_Model_Path_Update(t))},ACT_WS_SEND:function(){return e(f.EV_WS_SEND.apply(f,arguments))},ACT_ClearImage:function(){e(f.EV_WS_Image_Update(null))},ACT_Shape_Decoration_ID_Order_Update:function(t){e(S.Shape_Decoration_ID_Order_Update(t))},ACT_Matching_Angle_Margin_Deg_Update:function(t){e(S.Matching_Angle_Margin_Deg_Update(t))},ACT_Matching_Face_Update:function(t){e(S.Matching_Face_Update(t))},ACT_Report_Save:function(t,n,a){var i=f.EV_WS_SEND(t,"SV",0,{filename:n},a);console.log(i),e(i)},ACT_Cache_Img_Save:function(t,n){e(f.EV_WS_SEND(t,"SV",0,{filename:n,type:"__CACHE_IMG__"}))},ACT_SIG360_Extraction:function(t){return e(f.EV_WS_SIG360_Extraction(t))},DISPATCH:function(t){e(t)}}})(D);t.default=x},84:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SwitchButton=t.ImgSprite=t.Button=t.IconButton=t.AButton=t.DropDown=t.BPG_FileBrowser_proto=t.BPG_FolderBrowser=t.BPG_FileSavingBrowser=t.BPG_FileBrowser=t.DropDownWarp=t.CardFrameWarp=t.JsonEditBlock=t.JsonElement=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=E(n(1)),s=E(n(556)),l=n(44),u=E(n(85)),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(45)),c=E(n(86)),p=E(n(46)),h=E(n(173)),f=E(n(176)),S=E(n(15)),_=E(n(53)),v=E(n(133));function E(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=p.default.Group,k=d.getLogger("baseComponent"),T=t.JsonElement=function(e){function t(){return b(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,o.default.Component),r(t,[{key:"render",value:function(){return void 0!==this.props.type.type?this.renderComplex():this.renderSimple()}},{key:"renderComplex",value:function(){switch(this.props.type.type){case"droplist":return o.default.createElement("div",{key:this.props.id,className:this.props.className},this.props.children)}}},{key:"renderSimple",value:function(){var e=this,t=this.props.children,n=void 0;switch("div"==this.props.type&&void 0===(n=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,t]))&&(n=(0,l.GetObjElement)(this.props.dict,["fallback",t])),void 0===n&&(n=t),this.props.type){case"input-number":return n+="",o.default.createElement("input",{key:this.props.id,className:this.props.className,type:"number",step:"0.1",pattern:"^[-+]?[0-9]*(\\.[0-9]*)?",value:n,onChange:function(t){return e.props.onChange(e.props.target,e.props.type,t)}});case"input":return o.default.createElement("input",{key:this.props.id,className:this.props.className,value:n,onChange:function(t){return e.props.onChange(e.props.target,e.props.type,t)}});case"checkbox":return o.default.createElement("input",{key:this.props.id,className:this.props.className,type:"checkbox",checked:n,onChange:function(t){return e.props.onChange(e.props.target,e.props.type,t)}});case"btn":return o.default.createElement("button",{key:this.props.id,className:this.props.className,onClick:function(t){return e.props.onChange(e.props.target,e.props.type,t)}},n);case"div":default:return o.default.createElement("div",{key:this.props.id,className:this.props.className},n," ")}}}]),t}(),C=(t.JsonEditBlock=function(e){function t(e){b(this,t);var n=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.tmp={object:{}},n}return y(t,o.default.Component),r(t,[{key:"onChangeX",value:function(e,t,n){return this.props.jsonChange(this.tmp.object,e,t,n),!0}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"composeObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=[],s=null==t?e:t;for(var u in s){var d=e[u],c=null==t?null:t[u];if(void 0!==d&&void 0!==c){var p=a.slice();p.push(u);var h=void 0;switch(void 0===(h=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,u]))&&(h=(0,l.GetObjElement)(this.props.dict,["fallback",u])),void 0===h&&(h=u),void 0===d?"undefined":i(d)){case"string":case"boolean":case"number":null==c&&(c="div"),r.push(o.default.createElement("div",{key:n+"_"+u+"_txt",className:"s HX1 width4 vbox black"},h)),r.push(o.default.createElement(T,{key:n+"_"+u+"_ele",className:"s HX1 width8 vbox blackText",type:c,target:{obj:e,keyTrace:p},dict:this.props.dict,onChange:this.onChangeX.bind(this)},d));break;case"object":r.push(o.default.createElement("div",{key:n+"_"+u+"_HL",className:"s HX0_1 WXF  vbox"}));var f=null==c?"div":c.__OBJ__;null==f&&(f="div"),r.push(o.default.createElement(T,{key:n+"_"+u+"_ele",dict:this.props.dict,className:"s HX1 WXF vbox black",type:f,onChange:this.onChangeX.bind(this),target:{obj:e,keyTrace:p}},h)),r.push(o.default.createElement("div",{key:n+"_"+u+"__",className:"s HX1 width1"})),r.push(o.default.createElement("div",{key:n+"_"+u+"_C",className:"s HXA width11"},this.composeObject(d,c,n+"_"+u,p))),r.push(o.default.createElement("div",{key:n+"_"+u+"_HL2",className:"s HX0_1 WXF  vbox"}));break;default:r.push(o.default.createElement("div",{key:n+"_"+u+"_txt",className:"s HX1 width3 vbox black"},u)),r.push(o.default.createElement("div",{key:n+"_"+u+"_XXX",className:"s HX1 width9 vbox lblue"},"Not supported"))}}}return r}},{key:"render",value:function(){this.tmp.object=(0,u.default)(this.props.object);var e=this.composeObject(this.tmp.object,this.props.whiteListKey);return o.default.createElement("div",{className:"WXF HXA"},e)}}]),t}(),t.CardFrameWarp=(0,s.default)({getDefaultProps:function(){return{boxShadow:"1px 2px 10px #000",addClass:""}},render:function(){var e=this.props.fixedFrame?"HXF":"HXA",t=this.props.addClass+(this.props.fixedFrame?"":" HXA");return o.default.createElement("div",{className:"padding "+t},o.default.createElement("div",{className:e+" white padding ",style:{boxShadow:this.props.boxShadow}},this.props.children))}})),A=t.DropDownWarp=(0,s.default)({render:function(){var e="HXA dropDownContent "+(this.props.ifShowDropDown?"":"hide ")+this.props.dropdownClass;return o.default.createElement("div",{className:"dropDown "+this.props.containerClass},this.props.children[0],o.default.createElement("div",{className:e,style:this.props.dropdownStyle},this.props.children.slice(1,this.props.children.length)))}}),N=(t.BPG_FileBrowser=function(e){function t(){return b(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,o.default.Component),r(t,[{key:"render",value:function(){return o.default.createElement(N,a({},this.props,{footer:null}))}}]),t}(),t.BPG_FileSavingBrowser=function(e){function t(e){b(this,t);var n=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={fileName:void 0===e.defaultName?"":e.defaultName,folderInfo:void 0},n}return y(t,o.default.Component),r(t,[{key:"isASCII",value:function(e){return(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(e)}},{key:"render",value:function(){var e=this,t=null!=this.state.folderInfo&&void 0!==this.state.folderInfo.files.find(function(t){return t.name==e.state.fileName});return console.log(t),o.default.createElement(N,a({},this.props,{onFileSelected:function(t){var n=t.substr(t.lastIndexOf("/")+1);e.setState(a({},e.state,{fileName:n}))},footer:o.default.createElement("div",null,o.default.createElement(v.default,{className:"width9",placeholder:"File Name",value:this.state.fileName,onChange:function(t){var n=t.target.value;e.isASCII(n)&&e.setState(a({},e.state,{fileName:n}))}}),o.default.createElement(g,{className:"width2"},o.default.createElement(p.default,{onClick:this.props.onCancel},"Cancel"),o.default.createElement(p.default,{onClick:function(){return e.props.onOk(e.state.folderInfo,e.state.fileName,t)},type:t?"danger":"primary",disabled:0==this.state.fileName.length||void 0===this.state.folderInfo},"OK"))),onFolderLoaded:function(t){e.setState(a({},e.state,{folderInfo:t}))}}))}}]),t}(),t.BPG_FolderBrowser=function(e){function t(){return b(this,t),m(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return y(t,o.default.Component),r(t,[{key:"render",value:function(){return o.default.createElement(N,a({},this.props,{footer:null}))}}]),t}(),t.BPG_FileBrowser_proto=function(e){function t(e){b(this,t);var n=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={folderStruct:{},history:["./"]},n}return y(t,o.default.Component),r(t,[{key:"goDir",value:function(e){var t=this;if(void 0===e){if(this.state.history.length<=1)return;this.state.history.pop(),e=this.state.history[this.state.history.length-1]}else{if(e==this.state.history[this.state.history.length-1])return;this.state.history.push(e)}new Promise(function(n,a){t.props.BPG_Channel("FB",0,{path:e,depth:0},void 0,{resolve:n,reject:a}),setTimeout(function(){return a("Timeout")},1e3)}).then(function(e){if(e[1].data.ACK){var n=e[0].data;t.setState(Object.assign(t.state,{folderStruct:n})),void 0!==t.props.onFolderLoaded&&t.props.onFolderLoaded(n)}else setTimeout(function(){return t.goDir()},1e3)}).catch(function(e){console.log(e)})}},{key:"componentWillMount",value:function(){this.goDir(this.props.path)}},{key:"componentDidUpdate",value:function(e){1==this.props.visible&&0==e.visible&&this.goDir(this.props.path)}},{key:"bytesToSize",value:function(e){if(0==e)return"0 Byte";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t]}},{key:"render",value:function(){var e=this,t=["type","name","size"].map(function(e){return{title:e,dataIndex:e,key:e}});t[0].render=function(e,t){var n="DIR"==e?"folder":"file";return o.default.createElement(S.default,{type:n})},t[0].width=64;var n=void 0===this.state.folderStruct.files?[]:this.state.folderStruct.files;(n=n.filter(function(t){return"."!=t.name&&".."!=t.name&&(void 0===e.props.fileFilter||e.props.fileFilter(t))})).forEach(function(t){t.size=e.bytesToSize(t.size_bytes),t.key=t.name});var a="string"==typeof this.state.folderStruct.path?this.state.folderStruct.path.replace(/\\+/g,"/").split("/"):[];(a=a.map(function(e){return{name:e}})).reduce(function(e,t){return e=e+t.name+"/",t.path=e,e},"");var i=o.default.createElement("div",null,o.default.createElement(g,null,o.default.createElement(p.default,{type:"primary",onClick:function(){return e.goDir()}},o.default.createElement(S.default,{type:"left"}))),"   ",o.default.createElement(g,null,a.map(function(t,n){return o.default.createElement(p.default,{key:t.name+"_"+n,onClick:function(){return e.goDir(t.path)}},t.name)})));return o.default.createElement(h.default,{title:i,visible:this.props.visible,width:void 0===this.props.width?900:this.props.width,onCancel:this.props.onCancel,onOk:this.props.onOk,footer:this.props.footer},o.default.createElement("div",{style:{height:void 0===this.props.height?400:this.props.height}},o.default.createElement("div",{className:"s height12 width2 scroll",key:"sideMenu"},o.default.createElement(_.default,{onClick:function(t){e.goDir(t.item.props.path)},mode:"inline"},[{name:"origin",path:"./"}].map(function(e){return o.default.createElement(_.default.Item,{key:e.name,path:e.path},e.name)}))),o.default.createElement("div",{className:"height12 width10 scroll",key:"folderView"},o.default.createElement(f.default,{onRow:function(t){return{onClick:function(n){"DIR"!=t.type?e.props.onFileSelected(e.state.folderStruct.path+"/"+t.name,t):e.goDir(e.state.folderStruct.path+"/"+t.name)}}},pagination:!1,columns:t,dataSource:n}))))}}]),t}()),w=(t.DropDown=(0,s.default)({handleClick:function(e,t){this.props.onClick(e,t)},shouldComponentUpdate:function(e,t){return e!=this.props},render:function(){var e=[],t=!0,n=!1,a=void 0;try{for(var i,r=this.props.dropMenu[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value,l=[],u=!0,d=!1,c=void 0;try{for(var p,h=s.ele[Symbol.iterator]();!(u=(p=h.next()).done);u=!0){var f=p.value;l.push(o.default.createElement(w,{addClass:" textAlignLeft dropDownBtn",key:f.id,id:f.id,text:f.text,onClick:s.callBack}))}}catch(e){d=!0,c=e}finally{try{!u&&h.return&&h.return()}finally{if(d)throw c}}var S="black HX"+s.ele.length+" ";e.push(o.default.createElement("div",{key:s.id+"_div"},o.default.createElement("div",{key:s.text,className:S+"width1 rotateContent"},o.default.createElement("p",null,s.text)),o.default.createElement("div",{key:s.id+"_block",className:S+"width11"},l))),e.push(o.default.createElement("div",{key:s.id+"_",className:"black HX0_1 "}))}}catch(e){n=!0,a=e}finally{try{!t&&r.return&&r.return()}finally{if(n)throw a}}return o.default.createElement(A,{containerClass:this.props.className,ifShowDropDown:this.props.ifShowDropDown,dropdownClass:"aniFlipin",dropdownStyle:{width:"300px"}},o.default.createElement(w,{addClass:"HXF lgreen",text:"...",onClick:this.handleClick}),o.default.createElement(C,{boxShadow:"1px 2px 20px #333"},e))}}),t.AButton=(0,s.default)({handleClick:function(e){this.props.onClick(e,this)},render:function(){var e=void 0;return void 0===(e=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,this.props.text]))&&(e=(0,l.GetObjElement)(this.props.dict,["fallback",this.props.text])),void 0===e&&(e=this.props.text),o.default.createElement(p.default,{block:!0,type:this.props.type,shape:"round",icon:this.props.icon,size:this.props.size,dict:c.default,onClick:this.handleClick},e)}}),t.IconButton=(0,s.default)({handleClick:function(e){this.props.onClick(e,this)},render:function(){k.debug(this.props),k.debug(this.context);var e="button s "+this.props.addClass,t=void 0;return void 0!==this.props.dict&&void 0===(t=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,this.props.text]))&&(t=(0,l.GetObjElement)(this.props.dict,["fallback",this.props.text])),void 0===t&&(t=this.props.text),o.default.createElement("div",{onClick:this.handleClick,className:e},void 0===this.props.iconType?null:o.default.createElement(S.default,{className:"layout iconButtonSize veleY",type:this.props.iconType}),o.default.createElement("p",{className:"layout veleY iconTextPadding"},t))}}),t.Button=(0,s.default)({handleClick:function(e){this.props.onClick(e,this)},render:function(){var e="button s vbox "+this.props.addClass;return o.default.createElement("div",{onClick:this.handleClick,className:e},o.default.createElement("p",null,this.props.text))}}));t.ImgSprite=(0,s.default)({shouldComponentUpdate:function(e,t){return e.position!=this.props.position||e.id!=this.props.id||e.style!=this.props.style||e.offset!=this.props.offset},render:function(){var e=this.props.spriteInfo,t=null!=this.props.spriteScale?this.props.spriteScale:1,n=null!=this.props.offset?this.props.offset:{x:0,y:0},a=-this.props.id%e.xLimit,i=-Math.floor(this.props.id/e.xLimit),r=Object.assign({},this.props.style,{width:e.sWidth*t+"px",height:e.sHeight*t+"px",background:"url("+e.url+") "+(n.x+e.sWidth*a)*t+"px "+(n.y+e.sHeight*i)*t+"px",backgroundSize:e.width*t+"px "+e.height*t+"px"});return o.default.createElement("div",{style:r,className:this.props.className})}}),t.SwitchButton=(0,s.default)({handleClick:function(e){this.props.onClick(e,this)},render:function(){var e="lgray vbox "+this.props.addClass;return o.default.createElement("button",{onClick:this.handleClick,className:e},o.default.createElement("p",null,this.props.text))}})},86:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={fallback:{ReconnectAirDevice:"重新連接噴氣裝置",line:"量測線段/Line",arc:"量測弧/Arc",spoint:"搜尋點/SPOINT",search_point:"搜尋點",apoint:"交點/APOINT",aux_point:"交點","<":"< 返回",measure:"測量定義/MEASURE",edit:"編輯測量定義/Edit",save:"儲存定義/SAVE",load:"讀取定義/LOAD",take:"重新設定/TAKE",type:"類型",subtype:"次類型",value:"出貨目標",margin:"範圍",submargin1:"生產目標",margin2:"次範圍",direction:"方向",angleDeg:"角度°",width:"寬",ref:"參考物件",ref_baseLine:"參考線",id:"編號",sigma:"標準差",distance:"距離/D",angle:"角度/A",radius:"半徑/R",name:"名稱",docheck:"必要判定",DefFileName:"設定檔名",DefFileTag:"標籤","Info Graphs":"資料圖表",matchingAngleLimit180:"角度限制180",matchingFaceFrontOnly:"僅正面",setting:"設定"},measure:{value:"目標",USL:"規格上限",LSL:"規格下限",UCL:"管制上限",LCL:"管制下限",docheck:"必要判定",quadrant:"量測象限"}}},924:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InspectionResultDisplay_FullScren=t.OK_NG_BOX_COLOR_TEXT=void 0;var a,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(104),s=x(n(1)),l=x(n(209)),u=D(n(84)),d=x(n(229)),c=x(n(217)),p=n(33),h=D(p),f=n(44),S=x(n(86)),_=n(193),v=n(41),E=D(n(45)),b=D(n(63)),m=x(n(925)),y=x(n(933)),g=(x(n(934)),x(n(176))),k=x(n(946)),T=x(n(220)),C=(x(n(133)),x(n(191))),A=x(n(951)),N=x(n(46)),w=x(n(53)),I=x(n(15)),P=x(n(510));n(1044);var O=x(n(173));function D(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function x(e){return e&&e.__esModule?e:{default:e}}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function F(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var R=n(1050),j=E.getLogger("InspectionUI"),W=N.default.Group,B={name:"file",onChange:function(e){console.log(e)}},H=C.default.Option,V=(s.default.createElement(C.default,{defaultValue:"Http://",style:{width:90}},s.default.createElement(H,{value:"Http://"},"Http://"),s.default.createElement(H,{value:"Https://"},"Https://")),s.default.createElement(C.default,{defaultValue:".com",style:{width:80}},s.default.createElement(H,{value:".com"},".com"),s.default.createElement(H,{value:".jp"},".jp"),s.default.createElement(H,{value:".cn"},".cn"),s.default.createElement(H,{value:".org"},".org")),w.default.SubMenu),G=(w.default.ItemGroup,function(e){function t(e){U(this,t);var n=L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n.WS_DB_Inser=void 0,n.WS_DB_Query=void 0,n}return F(t,s.default.Component),r(t,[{key:"componentWillUnmount",value:function(){this.websocketClose()}},{key:"componentWillMount",value:function(){this.websocketConnect(this.props.url)}},{key:"componentDidUpdate",value:function(e,t,n){if(this.props.reportStatisticState.newAddedReport.length>0){var a=this.props.reportStatisticState.newAddedReport;this.send2WS_Insert(a)}}},{key:"handleLocalStorage",value:function(e){return R?(console.log("Local Storage: Supported"),R.setItem("HYVision",JSON.stringify(e)),R.length):(console.log("Local Storage: Unsupported"),0)}},{key:"send2WS_Query",value:function(e){}},{key:"send2WS_Insert",value:function(e){if(console.log("send2WS_Insert"),void 0!==this.WS_DB_Insert)if(console.log("readyState:"+this.WS_DB_Insert.readyState),this.WS_DB_Insert.readyState===WebSocket.OPEN){var t={dbcmd:{db_action:"insert",checked:!0},data:e};this.WS_DB_Insert.send_obj(t,function(e,t){return t.toFixed?Number(t.toFixed(5)):t}).then(function(e){return console.log("then",e)}).catch(function(e){return console.log("catch",e)})}else console.log("[X][WS]StatusCode="+this.WS_DB_Insert.readyState)}},{key:"websocketClose",value:function(){this.WS_DB_Insert.close(),this.WS_DB_Query.close()}},{key:"websocketConnect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ws://hyv.decade.tw:8080/";if(void 0===this.WS_DB_Insert){console.log("[init][WS]"+t+"insert/insp");var n=new f.websocket_autoReconnect(t+"insert/insp",1e4);this.WS_DB_Insert=new f.websocket_reqTrack(n),this.WS_DB_Insert.onreconnection=function(e){return j.info("onreconnection"+e),!0},this.WS_DB_Insert.onconnectiontimeout=function(){return j.info("onconnectiontimeout")},this.WS_DB_Insert.onopen=this.onOpen.bind(this),this.WS_DB_Insert.onmessage=this.onMessage.bind(this),this.WS_DB_Insert.onclose=function(){return j.info("WS_DB_Insert:onclose")},this.WS_DB_Insert.onerror=function(){return e.onError.bind(e)}}if(void 0===this.WS_DB_Query){console.log("[init][WS]"+t+"query/insp");var a=new f.websocket_autoReconnect(t+"query/insp",1e4);this.WS_DB_Query=new f.websocket_reqTrack(a),this.WS_DB_Query.onreconnection=function(e){return j.info("onreconnection"+e),!0},this.WS_DB_Query.onconnectiontimeout=function(){return j.info("onconnectiontimeout")},this.WS_DB_Query.onopen=this.onOpen.bind(this),this.WS_DB_Query.onmessage=this.onMessage.bind(this),this.WS_DB_Query.onclose=function(){return j.info("WS_DB_Query:onclose")},this.WS_DB_Query.onerror=function(){return e.onError.bind(e)}}}},{key:"onError",value:function(e){console.log("onError RAW_InspectionReportPull")}},{key:"onOpen",value:function(e){console.log("onOpen RAW_InspectionReportPull")}},{key:"onMessage",value:function(e){console.log(e)}},{key:"render",value:function(){return null}}]),t}()),X=(function(e){function t(e){U(this,t);var n=L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.resultDB=void 0,n.state={db_open:!1,resultX:void 0},n}F(t,s.default.Component),r(t,[{key:"componentDidMount",value:function(){}},{key:"echoTime",value:function(){return""+(new Date).getSeconds()}},{key:"query",value:function(){var e=this;return this.resultDB="[!]",fetch("http://127.0.0.1:4000/gui",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:"{ hello }"})}).then(function(e){return e.json()}).then(function(t){console.log("[O]DB data returned:",JSON.stringify(t)),e.resultDB=JSON.stringify(t)}),this.resultDB}},{key:"render",value:function(){return s.default.createElement("div",{style:{display:"inline-block"}},s.default.createElement("p",null))}}])}(),t.OK_NG_BOX_COLOR_TEXT=(M(a={},_.MEASURERSULTRESION.NA,{COLOR:"#aaa",TEXT:_.MEASURERSULTRESION.NA}),M(a,_.MEASURERSULTRESION.UOK,{COLOR:"#87d068",TEXT:_.MEASURERSULTRESION.UOK}),M(a,_.MEASURERSULTRESION.LOK,{COLOR:"#87d068",TEXT:_.MEASURERSULTRESION.LOK}),M(a,_.MEASURERSULTRESION.UCNG,{COLOR:"#d0d068",TEXT:_.MEASURERSULTRESION.UCNG}),M(a,_.MEASURERSULTRESION.LCNG,{COLOR:"#d0d068",TEXT:_.MEASURERSULTRESION.LCNG}),M(a,_.MEASURERSULTRESION.USNG,{COLOR:"#f50",TEXT:_.MEASURERSULTRESION.USNG}),M(a,_.MEASURERSULTRESION.LSNG,{COLOR:"#f50",TEXT:_.MEASURERSULTRESION.LSNG}),a)),z=t.InspectionResultDisplay_FullScren=function(e){function t(e){U(this,t);var n=L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={folderStruct:{},history:["./"]},n}return F(t,s.default.Component),r(t,[{key:"render",value:function(){var e=this.props.IR;if(!Array.isArray(e))return null;var t=this.props.resultMenuCopy,n=s.default.createElement("div",null,"Object List Window"),a=t.map(function(e,t,n){return"sub1"+t}),i=t.map(function(e){return s.default.createElement(y.default,{span:8},s.default.createElement(w.default,{selectable:!0,defaultSelectedKeys:["functionMenu"],defaultOpenKeys:a,mode:"inline"},e))});return s.default.createElement(O.default,{title:n,visible:this.props.visible,width:void 0===this.props.width?900:this.props.width,onCancel:this.props.onCancel,onOk:this.props.onOk,footer:null},s.default.createElement("div",{style:{height:void 0===this.props.height?400:this.props.height}},s.default.createElement(m.default,{type:"flex",justify:"start",align:"top"},i)))}}]),t}(),Y=function(e){function t(e){U(this,t);var n=L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return F(t,s.default.Component),r(t,[{key:"clickFullScreen",value:function(){this.props.fullScreenToggleCallback()}},{key:"showResultValueCheck",value:function(e){return e.status==_.MEASURERSULTRESION.NA?"NaN ":e.value===+e.value?e.value.toFixed(3):"NaN "}},{key:"render",value:function(){var e=this.props.singleInspection;return s.default.createElement("div",{className:"s black",style:{borderBottom:"6px solid #A9A9A9",height:70}},s.default.createElement("div",{className:"s width8  HXF"},s.default.createElement("div",{className:"s vbox height4"},s.default.createElement(I.default,{type:"fullscreen",onClick:this.clickFullScreen.bind(this)}),e.name),s.default.createElement("div",{className:"s vbox  height8",style:{fontSize:25}},this.showResultValueCheck(e)+p.DEFAULT_UNIT[e.subtype])),s.default.createElement("div",{className:"s vbox width4 HXF"},s.default.createElement(T.default,{style:{fontSize:18},color:X[e.detailStatus].COLOR},X[e.detailStatus].TEXT)))}}]),t}(),K=function(e){function t(e){U(this,t);var n=L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return F(t,s.default.Component),r(t,[{key:"render",value:function(){return s.default.createElement("div",{style:{display:"inline-block"}},s.default.createElement(T.default,{style:{fontSize:20},color:X[this.props.detailStatus].COLOR},X[this.props.detailStatus].TEXT),this.props.children)}}]),t}(),J=function(){function e(t){U(this,e),this.data={DoImageTransfer:!0,emptyResultCount:0,cameraSpeedMode:-1,speedSwitchingCount:100},this.ws_ch=t.ws_ch,this.ev_speedModeChange=t.ev_speedModeChange,void 0===this.ev_speedModeChange&&(this.ev_speedModeChange=function(){}),this.ev_emptyResultCountChange=t.ev_emptyResultCountChange,void 0===this.ev_emptyResultCountChange&&(this.ev_emptyResultCountChange=function(){}),this.setSpeedSwitchingCount(1e3),this.setCameraSpeed_HIGH()}return r(e,[{key:"setCameraImageTransfer",value:function(e){void 0===e&&(e=!this.data.DoImageTransfer),this.data.DoImageTransfer=e,this.ws_ch({DoImageTransfer:e})}},{key:"setCameraSpeedMode",value:function(e){this.data.cameraSpeedMode!=e&&(j.info("setCameraSpeedMode:"+e),this.data.cameraSpeedMode=e,this.ev_speedModeChange(e),this.ws_ch({CameraSetting:{framerate_mode:e}}))}},{key:"setSpeedSwitchingCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;this.data.speedSwitchingCount=e}},{key:"setCameraSpeed_HIGH",value:function(){this.setCameraSpeedMode(2)}},{key:"setCameraSpeed_LOW",value:function(){this.setCameraSpeedMode(0)}},{key:"updateInspectionReport",value:function(e){if(void 0===e||0==e.reports.length)return this.data.emptyResultCount++,this.data.emptyResultCount>this.data.speedSwitchingCount&&this.setCameraSpeed_LOW(),void this.ev_emptyResultCountChange(this.data.emptyResultCount);0!=this.data.emptyResultCount&&(this.ev_emptyResultCountChange(this.data.emptyResultCount),this.data.emptyResultCount=0,this.setCameraSpeed_HIGH())}}]),e}(),q=function(e){function t(e){U(this,t);var n=L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={collapsed:!1,fullScreen:!1},n}return F(t,s.default.Component),r(t,[{key:"toggleCollapsed",value:function(){this.setState(i({},this.state,{collapsed:!this.state.collapsed}))}},{key:"toggleFullscreen",value:function(){console.log("[XLINX2]fullScreen="+this.state.fullScreen),this.setState(i({},this.state,{fullScreen:!this.state.fullScreen}))}},{key:"render",value:function(){var e,t=this,n=this.props.IR,a=this.props.IR_decotrator;if(!Array.isArray(n))return null;var r=n.filter(function(e){return e.isCurObj}),o=void 0;void 0!==a&&(o=a.list_id_order),e=r.map(function(e,n){var a,i=e.judgeReports;void 0!==o&&(i=o.map(function(e){return i.find(function(t){return t.id==e})}).filter(function(e){return void 0!==e})),a=i.map(function(e,a){var i;return s.default.createElement(Y,(M(i={key:"i"+n+e.name},"key",a),M(i,"singleInspection",e),M(i,"fullScreenToggleCallback",t.toggleFullscreen.bind(t)),i))});var r=i.reduce(function(e,t){return(0,_.MEASURERSULTRESION_reducer)(e,t.detailStatus)},void 0);return s.default.createElement(V,{style:{textAlign:"left"},key:"sub1"+n,title:s.default.createElement("span",null,s.default.createElement(I.default,{type:"paper-clip"}),s.default.createElement("span",null,n," ",s.default.createElement(K,{detailStatus:r})))},a)});var l=s.default.createElement(z,i({},this.state,{resultMenuCopy:e,IR:n,visible:this.state.fullScreen,onCancel:this.toggleFullscreen.bind(this),width:"90%"}));return s.default.createElement("div",null,s.default.createElement(w.default,{onClick:this.handleClick,selectable:!0,defaultSelectedKeys:["functionMenu"],mode:"inline"},s.default.createElement(V,{style:{textAlign:"left"},key:"functionMenu",title:s.default.createElement("span",null,s.default.createElement(I.default,{type:"setting"}),s.default.createElement("span",null,"平台功能操作"))},s.default.createElement($,{url:"ws://192.168.2.2:5213",checkResult2AirAction:this.props.checkResult2AirAction,WSCMD_CB:this.props.WSCMD_CB})),e),l)}}]),t}(),Q=function(e){function t(e){U(this,t);var n=L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={loading:!1,iconLoading:!1,websocketAirTime:10,STOP:!0},n.websocketAir=void 0,n.heartBeat={timer:void 0,PINGcount:0,PONGcount:0,PONGPace:0},n}return F(t,s.default.Component),r(t,[{key:"keyEventX",value:function(e){var t=e.keyCode||e.which,n=String.fromCharCode(t);switch(j.info("keyEvent>>",t,n),n){case"R":this.blowAir_RIGHTa();break;case"L":this.blowAir_LEFTa();break;case"B":this.blowAir_StartStop();break;case"1":this.blowAir_TIMEADD(10);break;case"2":this.blowAir_TIMESUB(10);break;case"T":this.blowAir_TEST();break;case"I":this.getCameraImage_StartStop()}}},{key:"blowAir_TEST",value:function(){console.log("[WS]/cue/TEST"),1===this.websocketAir.readyState?(console.log("[O][WS]/cue/TEST"),this.websocketAir.send("/cue/TEST")):console.log("[X][WS]/cue/TEST")}},{key:"blowAir_LEFTa",value:function(){this.websocketAir.readyState===this.websocketAir.OPEN?this.websocketAir.send("/cue/LEFT"):console.log("[X][WS]/cue/LEFT")}},{key:"blowAir_RIGHTa",value:function(){this.websocketAir.readyState===this.websocketAir.OPEN?this.websocketAir.send("/cue/RIGHT"):console.log("[X][WS]/cue/RIGHT")}},{key:"blowAir_TIMEUpdate",value:function(){this.setState(Object.assign({},this.state)),this.websocketAir.readyState===this.websocketAir.OPEN&&this.websocketAir.send("/cue/TIME/"+this.state.websocketAirTime)}},{key:"blowAir_StartStop",value:function(){this.state.STOP=!this.state.STOP,this.setState(Object.assign({},this.state))}},{key:"blowAir_TIMEADD",value:function(e){this.state.websocketAirTime+=e,this.blowAir_TIMEUpdate()}},{key:"blowAir_TIMESUB",value:function(e){this.state.websocketAirTime-=e,this.state.websocketAirTime<10&&(this.state.websocketAirTime=10),this.blowAir_TIMEUpdate()}},{key:"enterLoading",value:function(){this.setState(i({},this.state,{loading:!0}))}},{key:"sendHeartBeat",value:function(){if(void 0!==this.websocketAir&&this.websocketAir.readyState==this.websocketAir.OPEN){if(j.info("sendHeartBeat: PING:"+this.heartBeat.PINGcount," PONG:"+this.heartBeat.PONGPace+"/"+this.heartBeat.PONGcount),this.heartBeat.PINGcount>this.heartBeat.PONGPace+2)return j.error("Heart beat ERROR: PINGcount > PONGPace+2"),this.websocketAir.reconnect(),void(this.heartBeat.PINGcount=this.heartBeat.PONGPace=0);this.websocketAir.send("/cue/PING"),this.heartBeat.PINGcount++}}},{key:"componentWillMount",value:function(){var e=this;this._keyEventX=this.keyEventX.bind(this),console.log("[init][componentWillMount]"),this.websocketConnect(this.props.url),this.websocketAir=new f.websocket_autoReconnect(this.props.url,1e4),this.websocketAir.onreconnection=function(e){return console.log(e)},this.websocketAir.onmessage=this.onMessage.bind(this),this.websocketAir.onerror=this.onError.bind(this),this.websocketAir.onopen=function(t){e.setState(i({},e.state,{loading:!1})),console.log("onopen:",t),e.props.ACT_MinRepeatInspReport_Update(1),e.heartBeat.PINGcount=0,e.heartBeat.PONGcount=0},this.websocketAir.onclose=function(t){e.props.ACT_MinRepeatInspReport_Update(),e.setState(i({},e.state,{loading:!0})),3001==t.code?console.log("ws closed",t):console.log("ws connection error",t)},document.addEventListener("keydown",this._keyEventX),this.heartBeat.timer=setInterval(this.sendHeartBeat.bind(this),3e3)}},{key:"componentWillUnmount",value:function(){void 0!==this.websocketAir&&(this.websocketAir.close(),this.websocketAir=void 0),document.removeEventListener("keydown",this._keyEventX),clearInterval(this.heartBeat.timer),this.heartBeat.timer=void 0}},{key:"websocketConnect",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.log("[init][WS][OK]"),console.log(this.websocketAir)}},{key:"onError",value:function(e){this.setState(i({},this.state,{loading:!1})),console.log("onError")}},{key:"onMessage",value:function(e){console.log(e);e.timeStamp;"/rsp/PONG"===e.data&&(this.heartBeat.PONGcount++,this.heartBeat.PONGPace=this.heartBeat.PINGcount)}},{key:"enterIconLoading",value:function(){}},{key:"componentWillReceiveProps",value:function(e){this.state.STOP||e.checkResult2AirAction.ver!=this.props.checkResult2AirAction.ver&&("left"===e.checkResult2AirAction.direction?this.blowAir_LEFTa():"right"===e.checkResult2AirAction.direction&&this.blowAir_RIGHTa())}},{key:"render",value:function(){var e=this;return void 0===this.websocketAir||this.websocketAir.readyState!=this.websocketAir.OPEN?s.default.createElement(u.AButton,{block:!0,text:"ReconnectAirDevice",type:"primary",shape:"round",icon:"loading",size:"large",dict:S.default,onClick:function(){e.websocketConnect(e.props.url)}}):s.default.createElement("div",null,s.default.createElement(N.default,{block:!0,style:{marginTop:2,marginBottom:2},type:"primary",size:"small",onClick:function(){return e.blowAir_StartStop()}},"噴氣功能(B): ",this.state.STOP?" 暫停=":" 啟動=",this.state.websocketAirTime,"ms"),s.default.createElement(W,null,s.default.createElement(N.default,{style:{backgroundColor:"#c41d7f",marginBottom:2},type:"primary",size:"large",onClick:this.blowAir_LEFTa.bind(this)},s.default.createElement(I.default,{type:"double-left"}),"NG左"),s.default.createElement(N.default,{style:{backgroundColor:"#7cb305",marginBottom:2},type:"primary",size:"large",onClick:function(){return e.blowAir_RIGHTa()}},"右OK",s.default.createElement(I.default,{type:"double-right"}))),s.default.createElement(N.default,{block:!0,style:{marginBottom:2},type:"primary",size:"small",onClick:function(){return e.blowAir_TIMEADD(10)}},s.default.createElement(I.default,{type:"up-circle"}),"增加噴氣時間(1)"),s.default.createElement(N.default,{block:!0,style:{marginBottom:2},type:"primary",size:"small",onClick:function(){return e.blowAir_TIMESUB(10)}},s.default.createElement(I.default,{type:"down-circle"}),"漸少噴氣時間(2)"),s.default.createElement(N.default,{block:!0,style:{marginBottom:2},type:"primary",size:"small",onClick:function(){return e.blowAir_TEST()}},s.default.createElement(I.default,{type:"swap"}),"測試左右噴氣(T)",s.default.createElement(I.default,{type:"swap"})),s.default.createElement("br",null),s.default.createElement(A.default,B,s.default.createElement(N.default,{block:!0,style:{marginBottom:3},type:"primary",size:"small"},s.default.createElement(I.default,{type:"thunderbolt"}),"快速切換特徵檔案",s.default.createElement(I.default,{type:"thunderbolt"}))),s.default.createElement("div",null))}}]),t}(),$=(0,o.connect)(function(e){return{}},function(e,t){return{ACT_MinRepeatInspReport_Update:function(t){e(h.EV_WS_MinRepeatInspReport_Update(t))}}})(Q),Z=function(e){function t(e){U(this,t);var n=L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.windowSize={},n}return F(t,s.default.Component),r(t,[{key:"ec_canvas_EmitEvent",value:function(e){switch(e.type){case b.EVENT.ERROR:j.error(e),this.props.ACT_ERROR()}}},{key:"componentDidMount",value:function(){this.ec_canvas=new c.default.INSP_CanvasComponent(this.refs.canvas),this.ec_canvas.EmitEvent=this.ec_canvas_EmitEvent.bind(this),this.props.onCanvasInit(this.ec_canvas),this.updateCanvas(this.props.c_state)}},{key:"componentWillUnmount",value:function(){this.ec_canvas.resourceClean()}},{key:"updateCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;void 0!==this.ec_canvas&&(j.debug("updateCanvas>>",t.edit_info),this.ec_canvas.EditDBInfoSync(t.edit_info),this.ec_canvas.SetState(e),this.ec_canvas.draw())}},{key:"onResize",value:function(e,t){Math.hypot(this.windowSize.width-e,this.windowSize.height-t)<5||void 0!==this.ec_canvas&&(this.ec_canvas.resize(e,t),this.windowSize={width:e,height:t},this.updateCanvas(this.props.c_state))}},{key:"componentWillUpdate",value:function(e,t){this.updateCanvas(e.c_state,e)}},{key:"render",value:function(){return s.default.createElement("div",{className:this.props.addClass},s.default.createElement("canvas",{ref:"canvas",className:"width12 HXF"}),s.default.createElement(d.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),t}(),ee=(0,o.connect)(function(e){return{c_state:e.UIData.c_state,edit_info:e.UIData.edit_info}},function(e,t){return{ACT_EXIT:function(t){e(h.EV_UI_ACT(h.UI_SM_EVENT.EXIT))},ACT_ERROR:function(t){e(h.EV_UI_ACT(h.UI_SM_EVENT.ERROR))}}})(Z),te=function(e){function t(e){U(this,t);var n=L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.divID="ControlChart_ID_"+Math.round(1e4*Math.random()),n.charObj=void 0,n.state={chartOpt:{type:"line",data:{labels:[],datasets:[{type:"line",borderColor:"rgb(100, 255, 100)",lineTension:.2,data:[],pointBackgroundColor:[]}]},bezierCurve:!1,options:{scales:{xAxes:[{ticks:{callback:function(e,t,n){return e}}}]},elements:{line:{fill:!1},point:{radius:6}},bezierCurve:!1,animation:{duration:0},maintainAspectRatio:!1,responsive:!0,title:{display:!0,text:""},annotation:{annotations:[]},legend:{display:!1},tooltips:{enabled:!0}}}},n.default_annotationTargets=[{type:"USL",color:"rgba(200, 0, 0,0.2)"},{type:"LSL",color:"rgba(200, 0, 0,0.2)"},{type:"UCL",color:"rgba(100, 100, 0,0.2)"},{type:"LCL",color:"rgba(100, 100, 0,0.2)"},{type:"value",color:"rgba(0, 0, 0,0.2)"}],n}return F(t,s.default.Component),r(t,[{key:"componentWillUpdate",value:function(e,t){this.state.chartOpt.data.labels=[],this.state.chartOpt.data.datasets.forEach(function(e){e.data=[],e.pointBackgroundColor=[]});var n=e.reportArray.length;if(0!=n){var a=e.reportArray[n-1].time_ms;this.state.chartOpt.options.title.text=e.reportArray[0].judgeReports.find(function(t){return t.id==e.targetMeasure.id}).name,e.reportArray.reduce(function(t,n,i){t.labels.push((a-n.time_ms)/1e3);var r=n.judgeReports.find(function(t){return t.id==e.targetMeasure.id}),o=void 0,s=r.value;return void 0===(o=X[r.detailStatus].COLOR)&&(o="#AA0000"),r.detailStatus===_.MEASURERSULTRESION.NA&&(s=void 0),t.datasets[0].pointBackgroundColor.push(o),t.datasets[0].data.push(s),t},this.state.chartOpt.data);var i=this.props.nnotationTargets;void 0===i&&(i=this.default_annotationTargets),this.state.chartOpt.options.annotation.annotations=i.map(function(t){return{type:"line",mode:"horizontal",scaleID:"y-axis-0",value:e.targetMeasure[t.type],borderColor:t.color,borderWidth:4,borderDash:[12,12],label:{position:"right",enabled:!0,content:t.type}}}),this.charObj.update()}}},{key:"componentDidMount",value:function(){var e=document.getElementById(this.divID).getContext("2d");this.charObj=new P.default(e,this.state.chartOpt)}},{key:"onResize",value:function(e,t){}},{key:"render",value:function(){return s.default.createElement("div",{className:this.props.className},s.default.createElement("canvas",{id:this.divID,style:{height:"400px"}}),s.default.createElement(d.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),t}(),ne=function(e){function t(e){U(this,t);var n=L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={drawList:[]},n}return F(t,s.default.Component),r(t,[{key:"render",value:function(){var e=this,t=this.props.reportStatisticState;if(void 0===t.statisticValue)return null;var n=t.statisticValue.measureList,a=n.map(function(e){return{id:e.id,name:e.name,subtype:e.subtype,count:e.statistic.count,mean:(0,f.round)(e.statistic.mean,.001),sigma:(0,f.round)(e.statistic.sigma,.001),CK:(0,f.round)(e.statistic.CK,.001),CPU:(0,f.round)(e.statistic.CPU,.001),CPL:(0,f.round)(e.statistic.CPL,.001),CP:(0,f.round)(e.statistic.CP,.001),CPK:(0,f.round)(e.statistic.CPK,.001)}});if(0==a.length)return null;var i=a,r=["name","subtype","count","mean","sigma","CK","CP","CPU","CPL","CPK"].map(function(e){return{title:e,dataIndex:e,key:e}}).map(function(e){return"number"==typeof a[0][e.title]?Object.assign(e,{sorter:function(t,n){return t[e.title]-n[e.title]}}):e});r.push({title:"Draw Toggle",key:"draw",fixed:"right",render:function(t,n){return s.default.createElement(k.default,{onChange:function(t){e.state.drawList[n.id]=t}})}});var o=Object.keys(this.state.drawList).map(function(a,i){if(1==e.state.drawList[a]){var r=n.find(function(e){return e.id==a}),o=t.historyReport.slice(Math.max(t.historyReport.length-500,1));return s.default.createElement(te,{reportArray:o,targetMeasure:r})}return null});return s.default.createElement("div",{className:this.props.className},s.default.createElement(g.default,{key:"dat_table",dataSource:i,columns:r,scroll:{x:1e3},pagination:!1}),o)}}]),t}(),ae=(function(e){function t(e){return U(this,t),L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}F(t,s.default.Component),r(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}}]),r(t,[{key:"render",value:function(){var e=this.props.inspection_Info.statisticValue;if(void 0===e)return null;var t=e.measureList.map(function(e){return s.default.createElement("div",null,e.statistic.mean)});return s.default.createElement("div",{className:this.props.addClass},t)}}])}(),function(e){function t(e){U(this,t);var n=L(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.ec_canvas=null,n.checkResult2AirAction={direction:"none",ver:0},n.state={GraphUIDisplayMode:0,CanvasWindowRatio:9},n.CameraCtrl=new J({ws_ch:function(e,t){n.props.ACT_WS_SEND(n.props.WS_ID,"ST",0,e,void 0,t)},ev_speedModeChange:function(e){console.log(e)}}),n}return F(t,s.default.Component),r(t,[{key:"componentDidMount",value:function(){this.props.ACT_WS_SEND(this.props.WS_ID,"CI",0,{deffile:this.props.defModelPath+"."+v.DEF_EXTENSION}),this.CameraCtrl.setCameraImageTransfer(!1)}},{key:"componentWillUnmount",value:function(){this.props.ACT_WS_SEND(this.props.WS_ID,"CI",0,{})}}]),r(t,[{key:"componentDidUpdate",value:function(){this.CameraCtrl.updateInspectionReport(this.props.inspectionReport)}},{key:"render",value:function(){var e=this,t=void 0;if(void 0!==this.props.inspectionReport&&(t=this.props.inspectionReport).reports.length>0){var n=t.reports.map(function(e){return e.judgeReports.reduce(function(e,t){return e==v.INSPECTION_STATUS.NA?e:e==v.INSPECTION_STATUS.FAILURE?t.status==v.INSPECTION_STATUS.NA?v.INSPECTION_STATUS.NA:e:t.status},v.INSPECTION_STATUS.SUCCESS)}).reduce(function(e,t){return void 0===e?t:e==v.INSPECTION_STATUS.NA||t==v.INSPECTION_STATUS.NA?v.INSPECTION_STATUS.NA:e!=t?v.INSPECTION_STATUS.NA:t},void 0);n==v.INSPECTION_STATUS.SUCCESS?this.checkResult2AirAction={direction:"right",ver:this.checkResult2AirAction.ver+1}:n==v.INSPECTION_STATUS.FAILURE?this.checkResult2AirAction={direction:"left",ver:this.checkResult2AirAction.ver+1}:j.error("result NA...")}var a=[];j.debug("CanvasComponent render");var i=12,r=1;switch(a=[s.default.createElement(u.IconButton,{dict:S.default,key:"<",addClass:"layout black vbox",text:"<",onClick:this.props.ACT_EXIT}),s.default.createElement(u.IconButton,{iconType:"file",key:"LOADDef",addClass:"layout gray-1 vbox",text:this.props.defModelName,onClick:function(){}}),s.default.createElement("div",{className:"s black width12 HXA"},this.props.defModelTag.map(function(e){return s.default.createElement(T.default,{color:"red"},e)}),this.props.inspOptionalTag.map(function(e){return s.default.createElement(T.default,{color:"green"},e)})),s.default.createElement(u.IconButton,{dict:S.default,iconType:"bar-chart",key:"Info Graphs",addClass:"layout black vbox",text:"Info Graphs",onClick:function(){e.state.GraphUIDisplayMode=(e.state.GraphUIDisplayMode+1)%3,e.setState(Object.assign({},e.state))}})],this.state.GraphUIDisplayMode){case 0:i=12,r=1;break;case 1:i=3,r=.3;break;case 2:i=0,r=.3;break;case 3:i=3,r=.3}a.push(s.default.createElement(u.IconButton,{dict:S.default,iconType:"up-square",key:"DoImageTransfer",addClass:"layout palatte-blue-8 vbox",text:"傳輸相機影像(I): "+(this.state.DoImageTransfer?"暫停":"啟動"),onClick:function(){return e.CameraCtrl.setCameraImageTransfer()}}));var o=this.props.reportStatisticState.trackingWindow;return a.push(s.default.createElement(q,{IR:o,IR_decotrator:this.props.info_decorator,checkResult2AirAction:this.checkResult2AirAction,key:"ObjInfoList",WSCMD_CB:function(t,n,a,i){e.props.ACT_WS_SEND(e.props.WS_ID,t,n,a,i)}})),s.default.createElement("div",{className:"overlayCon HXF"},i<=0?null:s.default.createElement(ee,{addClass:"layout WXF height"+i,onCanvasInit:function(t){e.ec_canvas=t}}),i>=12?null:s.default.createElement(ne,{className:"s scroll WXF height"+(12-i),reportStatisticState:this.props.reportStatisticState}),s.default.createElement(G,{reportStatisticState:this.props.reportStatisticState,url:"ws://hyv.decade.tw:8080/"}),s.default.createElement(l.default,{transitionName:"fadeIn"},s.default.createElement("div",{key:"MENU",className:"s overlay shadow1 scroll MenuAnim HXA",style:{opacity:r,width:"250px"}},a)))}}]),t}()),ie=(0,o.connect)(function(e){return{c_state:e.UIData.c_state,shape_list:e.UIData.edit_info.list,info_decorator:e.UIData.edit_info.__decorator,defModelName:e.UIData.edit_info.DefFileName,defModelTag:e.UIData.edit_info.DefFileTag,inspOptionalTag:e.UIData.edit_info.inspOptionalTag,defModelPath:e.UIData.edit_info.defModelPath,WS_ID:e.UIData.WS_ID,inspectionReport:e.UIData.edit_info.inspReport,reportStatisticState:e.UIData.edit_info.reportStatisticState}},function(e,t){return{ACT_EXIT:function(t){e(h.EV_UI_ACT(h.UI_SM_EVENT.EXIT))},ACT_WS_SEND:function(t,n,a,i,r,o){return e(h.EV_WS_SEND(t,n,a,i,r,o))}}})(ae);t.default=ie}});