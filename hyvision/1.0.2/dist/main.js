!function(t){function e(e){for(var a,o,s=e[0],l=e[1],u=e[2],c=0,h=[];c<s.length;c++)o=s[c],i[o]&&h.push(i[o][0]),i[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);for(d&&d(e);h.length;)h.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(a=!1)}a&&(r.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},i={0:0},r=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/dist/";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var d=l;r.push([474,1]),n()}({174:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InspectionEditorLogic=e.MEASURERSULTRESION_priority=e.MEASURERSULTRESION=void 0;var a,i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();e.MEASURERSULTRESION_reducer=function(t,e){if(t==S.NA)return t;if(t==S.USNG||t==S.LSNG)return e==S.NA?e:t;if(t==S.UCNG||t==S.LCNG)return e==S.NA||e==S.USNG||e==S.LSNG?e:t;return e};var o,s=n(246),l=n(39),u=n(32),d=n(43),c=n(82),h=(o=c)&&o.__esModule?o:{default:o};function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(44)).getLogger("InspectionEditorLogic"),S=e.MEASURERSULTRESION={NA:"NA",UOK:"UOK",LOK:"LOK",UCNG:"UCNG",LCNG:"LCNG",USNG:"USNG",LSNG:"LSNG"};e.MEASURERSULTRESION_priority=(p(a={},S.NA,0),p(a,S.LSNG,1),p(a,S.USNG,1),p(a,S.UCNG,2),p(a,S.LCNG,2),p(a,S.UOK,3),p(a,S.LOK,3),a);e.InspectionEditorLogic=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}return r(t,[{key:"reset",value:function(){this.shapeCount=0,this.shapeList=[],this.inherentShapeList=[],this.editShape=null,this.editPoint=null,this.state=null,this.sig360info=null,this.inspreport=null,this.img=null}},{key:"Setsig360info",value:function(t){f.info(t),this.sig360info=t}},{key:"SetInspectionReport",value:function(t){var e=this;this.inspreport=t,void 0!==this.inspreport.reports&&0!=this.inspreport.reports.length&&this.inspreport.reports.forEach(function(t){return t.judgeReports.forEach(function(t){var n=e.shapeList.find(function(e){return e.id==t.id});void 0===n||t.status===l.INSPECTION_STATUS.NA?t.detailStatus=S.NA:t.value<n.LSL?t.detailStatus=S.LSNG:t.value<n.LCL?t.detailStatus=S.LCNG:t.value<n.value?t.detailStatus=S.LOK:t.value<n.UCL?t.detailStatus=S.UOK:t.value<n.USL?t.detailStatus=S.UCNG:t.detailStatus=S.USNG})})}},{key:"getsig360info_mmpp",value:function(){try{return this.sig360info.reports[0].mmpp}catch(t){}return 1}},{key:"getsig360infoCenter",value:function(){var t={x:0,y:0};try{t.x=this.sig360info.reports[0].cx,t.y=this.sig360info.reports[0].cy}catch(e){t.x=0,t.y=0}return t}},{key:"SetShapeList",value:function(t){this.shapeList=t;var e=0;this.shapeList.forEach(function(t){e<t.id&&(e=t.id)}),this.shapeCount=e}},{key:"SetDefInfo",value:function(t){this.SetShapeList(t.features),f.info(t);var e=t.inherentfeatures[0];e.signature.magnitude=e.signature.magnitude.map(function(t){return Math.round(1e3*t)/1e3}),e.signature.angle=e.signature.angle.map(function(t){return Math.round(1e3*t)/1e3}),this.Setsig360info({reports:[{cx:e.pt1.x,cy:e.pt1.y,area:e.area,orientation:e.orientation,signature:e.signature,mmpp:t.mmpp,cam_param:t.cam_param}]}),this.UpdateInherentShapeList();var n=this.findLostRefShapes();this.shapeList=this.shapeList.filter(function(t){return!n.includes(t)}),this.UpdateInherentShapeList()}},{key:"SetCameraParamInfo",value:function(t){this.cameraParam=t}},{key:"SetState",value:function(t){this.state!=t&&(this.shapeCount=0,this.editShape=null,this.editPoint=null)}},{key:"FindShape",value:function(t,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shapeList).findIndex(function(n){return n[t]==e});return n<0?void 0:n}},{key:"FindShapeIdx",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;return this.FindShape("id",t,e)}},{key:"FindShapeObject",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shapeList,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.inherentShapeList,i=this.FindShape(t,e,n);return void 0!==i?n[i]:void 0!==(i=this.FindShape(t,e,a))?a[i]:void 0}},{key:"UpdateInherentShapeList",value:function(){var t=this;if(this.inherentShapeList=[],null!==this.sig360info&&void 0!==this.sig360info){var e=this.sig360info.reports[0];f.debug(e);var n=1e5,a=n;return this.inherentShapeList.push({id:a,type:u.SHAPE_TYPE.sign360,name:"@__SIGNATURE__",pt1:{x:e.cx,y:e.cy},pt2:{x:0,y:0},area:e.area,orientation:0,signature:e.signature}),n=a+1,this.inherentShapeList.push({id:n++,type:u.SHAPE_TYPE.aux_point,name:"@__SIGNATURE__.centre",ref:[{id:a,keyTrace:["pt2"]}]}),this.inherentShapeList.push({id:n++,type:u.SHAPE_TYPE.aux_line,name:"@__SIGNATURE__.orientation",ref:[{name:"@__SIGNATURE__",keyTrace:["orientation"]}]}),n=100100,this.shapeList.forEach(function(e){e.type==u.SHAPE_TYPE.arc&&t.inherentShapeList.push({id:n+10*e.id,type:u.SHAPE_TYPE.aux_point,name:e.name+".centre",ref:[{id:e.id,element:"centre"}]})}),this.inherentShapeList}}},{key:"GenerateEditReport",value:function(){return{type:"binary_processing_group",intrusionSizeLimitRatio:.1,featureSet:[{type:"sig360_circle_line",ver:"0.0.1.0",unit:"px",mmpp:this.sig360info.reports[0].mmpp,cam_param:this.sig360info.reports[0].cam_param,features:this.shapeList,inherentfeatures:this.inherentShapeList}]}}},{key:"findLostRefShapes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shapeList,e=this.inherentShapeList;return t.filter(function(n){return n.ref instanceof Array&&void 0!==n.ref.find(function(n){var a=t.find(function(t){return t.id==n.id});return void 0===a&&(a=e.find(function(t){return t.id==n.id})),void 0===a})})}},{key:"SetShape",value:function(t,e){var n=null,a=void 0;if(null==t){if(void 0!==e&&(a=this.FindShapeIdx(e),f.debug("SETShape>",a),null!=a)){n=this.shapeList[a],this.shapeList.splice(a,1),null!=this.editShape&&this.editShape.id==e&&(this.editShape=null);var r=this.findLostRefShapes();this.shapeList=this.shapeList.filter(function(t){return!r.includes(t)})}return n}if(f.info("SETShape>",this.shapeList,t,e),null!=this.FindShapeIdx(t.id,this.inherentShapeList))return f.error("Error:Shape id:"+e+" name:"+t.name+" is in inherentShapeList which is not changeable."),null;if(null!=e){var o=this.FindShapeIdx(e),s=this.FindShape("name",t.name);if(void 0!==s&&o!=s)return f.error("Error:Shape id:"+e+" Duplicated shape name:"+t.name+" with idx:"+s+" "),null;if(f.info("SETShape>",o),null==o)return f.error("Error:Shape id:"+e+" doesn't exist in the list...."),null;n=this.shapeList[o],a=o}else this.shapeCount++,e=this.shapeCount;var l=null;return l=i({},t,{id:e}),null==n?(void 0===l.name&&(l.name="@"+l.type+"_"+e),this.shapeList.push(l)):null!=a&&(this.shapeList[a]=l),null!==this.editShape&&this.editShape.id==e&&(this.editShape=l),l}},{key:"FindInspShapeObject",value:function(t,e){if(null!=e){var n=this.FindShapeIdx(t,e.detectedCircles);if(null!=n)return e.detectedCircles[n];var a=this.FindShapeIdx(t,e.detectedLines);if(null!=a)return e.detectedLines[a];var i=this.FindShapeIdx(t,e.auxPoints);if(null!=i)return e.auxPoints[i];var r=this.FindShapeIdx(t,e.searchPoints);if(null!=r)return e.searchPoints[r];var o=this.FindShapeIdx(t,e.judgeReports);return null!=o?e.judgeReports[o]:void 0}}},{key:"ShapeListAdjustsWithInspectionResult",value:function(t,e){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Math.cos(-e.rotate),r=Math.sin(-e.rotate),o=e.isFlipped?-1:1;t.forEach(function(t){if(null!=t){var l=n.FindInspShapeObject(t.id,e);if(null==e||null!=l){switch(t.inspection_status=l.status,["pt1","pt2","pt3"].forEach(function(n){void 0!==t[n]&&(t[n]=(0,s.PtRotate2d_sc)(t[n],r,i,o),t[n].x+=e.cx,t[n].y+=e.cy)}),t.type){case u.SHAPE_TYPE.line:if(["pt1","pt2"].forEach(function(e){t[e]=(0,s.closestPointOnLine)(l,t[e])}),e.isFlipped){var d=t.pt1;t.pt1=t.pt2,t.pt2=d}break;case u.SHAPE_TYPE.arc:["pt1","pt2","pt3"].forEach(function(e){t[e].x-=l.x,t[e].y-=l.y;var n=Math.hypot(t[e].x,t[e].y);t[e].x=t[e].x*l.r/n+l.x,t[e].y=t[e].y*l.r/n+l.y});break;case u.SHAPE_TYPE.search_point:t.pt1.x=l.x,t.pt1.y=l.y,e.isFlipped&&(t.angleDeg=-t.angleDeg);break;case u.SHAPE_TYPE.measure:t.inspection_value=l.value}a&&["pt1","pt2","pt3"].forEach(function(n){void 0!==t[n]&&(t[n].x-=e.cx,t[n].y-=e.cy,t[n]=o<0?(0,s.PtRotate2d_sc)(t[n],r,i,-1):(0,s.PtRotate2d_sc)(t[n],-r,i,1))})}}})}},{key:"FindClosestCtrlPointInfo",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList,a={pt:null,key:null,shape:null,dist:Number.POSITIVE_INFINITY};return n.forEach(function(n){var i=void 0;switch(n.type){case u.SHAPE_TYPE.line:case u.SHAPE_TYPE.arc:case u.SHAPE_TYPE.search_point:case u.SHAPE_TYPE.measure:["pt1","pt2","pt3"].forEach(function(e){void 0!==n[e]&&(i=(0,s.distance_point_point)(n[e],t),a.dist>i&&(a.shape=n,a.key=e,a.pt=n[e],a.dist=i))});break;case u.SHAPE_TYPE.aux_point:var r=e.auxPointParse(n);i=(0,s.distance_point_point)(r,t),a.dist>i&&(a.shape=n,a.key=void 0,a.pt=r,a.dist=i)}}),a}},{key:"FindClosestInherentPointInfo",value:function(t,e){var n=this,a={pt:null,key:null,shape:null,dist:Number.POSITIVE_INFINITY};return e.forEach(function(e){if(null!=e&&e.type==u.SHAPE_TYPE.aux_point){var i=n.auxPointParse(e),r=(0,s.distance_point_point)(i,t);a.dist>r&&(a.shape=e,a.key=null,a.pt=i,a.dist=r)}}),a}},{key:"auxPointParse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList,n=void 0;if(t.type!=u.SHAPE_TYPE.aux_point)return n;if(1==t.ref.length){var a=this.FindShapeObject("id",t.ref[0].id,e);if(void 0===a)return;if(void 0!==t.ref[0].keyTrace)n=(0,d.GetObjElement)(a,t.ref[0].keyTrace);else switch(a.type){case u.SHAPE_TYPE.arc:var i=a;(n=(0,s.threePointToArc)(i.pt1,i.pt2,i.pt3)).ref=(0,h.default)(t.ref),n.ref[0]._obj=i}}else if(2==t.ref.length){var r=this.FindShapeObject("id",t.ref[0].id,e);if(void 0===r)return;var o=this.FindShapeObject("id",t.ref[1].id,e);if(void 0===o)return;var l=this.shapeVectorParse(r,e),c=this.shapeVectorParse(o,e);if(void 0===l||void 0===c)return;var p=this.shapeMiddlePointParse(r,e),f=this.shapeMiddlePointParse(o,e);if(void 0===p||void 0===f)return;return(0,s.vecXY_addin)(l,p),(0,s.vecXY_addin)(c,f),(0,s.intersectPoint)(p,l,f,c)}return n}},{key:"searchPointParse",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;var e=void 0;if(t.type==u.SHAPE_TYPE.search_point){if(1==t.ref.length){var n=this.FindShapeObject("id",t.ref[0].id);if(void 0===n)return;switch(n.type){case u.SHAPE_TYPE.line:e=t.pt1}}return e}}},{key:"shapeMiddlePointParse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;switch(t.type){case u.SHAPE_TYPE.line:return{x:(t.pt1.x+t.pt2.x)/2,y:(t.pt1.y+t.pt2.y)/2};case u.SHAPE_TYPE.arc:return(0,s.threePointToArc)(t.pt1,t.pt2,t.pt3);case u.SHAPE_TYPE.aux_point:return this.auxPointParse(t,e);case u.SHAPE_TYPE.search_point:return this.searchPointParse(t,e)}}},{key:"shapeVectorParse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shapeList;switch(t.type){case u.SHAPE_TYPE.line:return{x:t.pt2.x-t.pt1.x,y:t.pt2.y-t.pt1.y};case u.SHAPE_TYPE.search_point:if(void 0===t.ref||1!=t.ref.length)return;var n=this.FindShapeObject("id",t.ref[0].id,e);if(void 0===n||n.type!==u.SHAPE_TYPE.line)return;var a=this.shapeVectorParse(n,e);if(void 0===a)return;var i=Math.atan2(a.y,a.x)+t.angleDeg*Math.PI/180;return{x:Math.cos(i),y:Math.sin(i)}}}}]),t}()},192:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MEASURE_RESULT_VISUAL_INFO=void 0;var a,i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(32),s=n(174),l=S(n(74)),u=n(43),d=n(246),c=n(39),h=S(n(44)),p=n(82),f=(i=p)&&i.__esModule?i:{default:i};function S(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function E(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function v(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y=e.MEASURE_RESULT_VISUAL_INFO=(b(a={},s.MEASURERSULTRESION.NA,{COLOR:"rgba(128,128,128,0.5)",TEXT:s.MEASURERSULTRESION.NA}),b(a,s.MEASURERSULTRESION.UOK,{COLOR:"rgba(128,200,128,0.7)",TEXT:s.MEASURERSULTRESION.UOK}),b(a,s.MEASURERSULTRESION.LOK,{COLOR:"rgba(128,200,128,0.7)",TEXT:s.MEASURERSULTRESION.LOK}),b(a,s.MEASURERSULTRESION.UCNG,{COLOR:"rgba(255,255,0,0.5)",TEXT:s.MEASURERSULTRESION.UCNG}),b(a,s.MEASURERSULTRESION.LCNG,{COLOR:"rgba(255,255,0,0.5)",TEXT:s.MEASURERSULTRESION.LCNG}),b(a,s.MEASURERSULTRESION.USNG,{COLOR:"rgba(255,0,0,0.5)",TEXT:s.MEASURERSULTRESION.USNG}),b(a,s.MEASURERSULTRESION.LSNG,{COLOR:"rgba(255,0,0,0.5)",TEXT:s.MEASURERSULTRESION.LSNG}),a),m=function(){function t(e){_(this,t),this.matrix=new DOMMatrix,this.tmpMatrix=new DOMMatrix,this.identityMat=new DOMMatrix,this.Scale(.1)}return r(t,[{key:"Scale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=new DOMMatrix;n.translateSelf(e.x,e.y),n.scaleSelf(t,t),n.translateSelf(-e.x,-e.y),this.matrix.preMultiplySelf(n)}},{key:"StartDrag",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.tmpMatrix.setMatrixValue(this.identityMat),this.tmpMatrix.translateSelf(t.x,t.y)}},{key:"EndDrag",value:function(){this.matrix.preMultiplySelf(this.tmpMatrix),this.tmpMatrix.setMatrixValue(this.identityMat)}},{key:"SetOffset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.matrix.m41=0,this.matrix.m42=0,this.matrix.translateSelf(t.x,t.y)}},{key:"GetCameraScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.matrix;return Math.sqrt(t.m11*t.m22-t.m12*t.m21)}},{key:"GetCameraOffset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.matrix;return{x:t.m41,y:t.m42}}},{key:"CameraTransform",value:function(t){t.multiplySelf(this.tmpMatrix),t.multiplySelf(this.matrix)}}]),t}(),g=function(){function t(e){_(this,t),this.setEditor_db_obj(e),this.colorSet={unselected:"rgba(100,0,100,0.5)",inspection_Pass:"rgba(0,255,0,0.1)",inspection_production_Fail:"rgba(128,128,0,0.1)",inspection_Fail:"rgba(255,0,0,0.1)",inspection_NA:"rgba(128,128,128,0.1)",editShape:"rgba(255,0,0,0.7)",measure_info:"rgba(128,128,200,0.7)"},this.renderParam={base_Size:1,size_Multiplier:1,mmpp:.1,font_Base_Size:60,font_Style:"bold "}}return r(t,[{key:"get_mmpp",value:function(){return this.renderParam.mmpp}},{key:"getPrimitiveSize",value:function(){return this.renderParam.base_Size*this.renderParam.size_Multiplier*this.get_mmpp()}},{key:"getPointSize",value:function(){return 8*this.getPrimitiveSize()}},{key:"getIndicationLineSize",value:function(){return 8*this.getPrimitiveSize()}},{key:"getSearchDirectionLineSize",value:function(){return 8*this.getPrimitiveSize()}},{key:"getFontHeightPx",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.renderParam.font_Base_Size)*this.renderParam.size_Multiplier*this.get_mmpp()}},{key:"getFontStyle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getFontHeightPx();return this.renderParam.font_Style+t+"px Arial"}},{key:"setEditor_db_obj",value:function(t){this.db_obj=t}},{key:"setColorSet",value:function(t){this.colorSet=t}},{key:"drawReportLine",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};t.beginPath(),t.moveTo(e.x0+n.x,e.y0+n.y),t.lineTo(e.x1+n.x,e.y1+n.y),t.stroke()}},{key:"drawLine",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};t.beginPath(),t.moveTo(e.pt1.x+n.x,e.pt1.y+n.y),t.lineTo(e.pt2.x+n.x,e.pt2.y+n.y),t.stroke()}},{key:"drawReportArc",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};t.beginPath(),void 0===e.thetaS||void 0===e.thetaE?t.arc(e.x+n.x,e.y+n.y,e.r,0,2*Math.PI,!1):t.arc(e.x+n.x,e.y+n.y,e.r,e.thetaS,e.thetaE,!1),t.stroke()}},{key:"_drawpoint",value:function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;t.beginPath(),"rect"==n?t.rect(e.x-a/2,e.y-a/2,a,a):t.arc(e.x,e.y,a/2,0,2*Math.PI,!1),t.stroke()}},{key:"drawpoint",value:function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.getPointSize(),i=t.strokeStyle;t.lineWidth=2*a,t.strokeStyle="rgba(0,0,100,0.5)",this._drawpoint(t,e,n,2*a),t.lineWidth=a/2,t.strokeStyle=i,this._drawpoint(t,e,n,2*a)}},{key:"drawInherentShapeList",value:function(t,e){var n=this;void 0!==e&&null!=e&&e.forEach(function(e){if(null!=e)switch(e.type){case o.SHAPE_TYPE.aux_point:var a=n.db_obj.auxPointParse(e);null!=a&&(t.strokeStyle="black",n.drawpoint(t,a,"rect"))}})}},{key:"canvas_arrow",value:function(t,e,n,a,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:10,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI/6,s=Math.atan2(i-n,a-e);t.beginPath(),t.moveTo(e,n),t.lineTo(a,i),t.moveTo(a,i),t.lineTo(a-r*Math.cos(s-o),i-r*Math.sin(s-o)),t.moveTo(a,i),t.lineTo(a-r*Math.cos(s+o),i-r*Math.sin(s+o)),t.stroke()}},{key:"drawArcArrow",value:function(t,e,n,a,i,r){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];t.beginPath(),t.arc(e,n,a,i,r,o),t.stroke();var s=Math.cos(r),l=Math.sin(r);e+=a*s,n+=a*l;var u=o?-1:1;u*=this.getPrimitiveSize();var d=50*this.getPrimitiveSize();this.canvas_arrow(t,e+u*l,n-u*s,e,n,d)}},{key:"drawLineArrow",value:function(t,e,n,a,i){}},{key:"drawText",value:function(t,e,n,a){t.fillText(e,n,a),t.strokeStyle="black",t.lineWidth=this.getIndicationLineSize(),t.strokeText(e,n,a)}},{key:"draw_Text",value:function(t,e,n,a,i){t.save(),t.translate(a,i),t.scale(n,n),t.fillText(e,0,0),t.strokeText(e,0,0),t.restore()}},{key:"drawMeasureDistance",value:function(t,e,n,a,i){var r,o,s,l=this.db_obj;o=l.shapeMiddlePointParse(n[0],a),s=l.shapeMiddlePointParse(n[1],a);var u=void 0;void 0!==e.ref_baseLine&&void 0!==e.ref_baseLine.id&&(u=a.find(function(t){return t.id==e.ref_baseLine.id})),void 0===u&&(u=n[0]);var c=l.shapeVectorParse(u,a);if(void 0===c&&(c={x:-(s.y-o.y),y:s.x-o.x}),r={x1:o.x,y1:o.y,x2:o.x+c.x,y2:o.y+c.y},null!=s&&null!=r){var h=(0,d.closestPointOnLine)(r,s),p=(0,d.closestPointOnLine)(r,e.pt1),f={x0:p.x,y0:p.y,x1:p.x+(s.x-h.x),y1:p.y+(s.y-h.y)};t.setLineDash([5*this.getPrimitiveSize(),15*this.getPrimitiveSize()]),this.drawReportLine(t,{x0:f.x0,y0:f.y0,x1:o.x,y1:o.y}),this.drawReportLine(t,{x0:f.x1,y0:f.y1,x1:s.x,y1:s.y}),this.drawReportLine(t,{x0:f.x1,y0:f.y1,x1:e.pt1.x,y1:e.pt1.y}),t.setLineDash([]),this.drawReportLine(t,f),this.drawpoint(t,e.pt1);var S=this.getFontHeightPx();t.font=this.getFontStyle(1),t.strokeStyle="black",t.lineWidth=this.getIndicationLineSize();var E=void 0;if(void 0!==e.inspection_value){var v=0;this.draw_Text(t,e.name,S,e.pt1.x,e.pt1.y),v+=S,E="D"+(e.inspection_value*i.mult).toFixed(4)+i.unit,E+=":"+(100*(e.inspection_value>e.value?(e.inspection_value-e.value)/(e.USL-e.value):-(e.inspection_value-e.value)/(e.LSL-e.value))).toFixed(1)+"%",this.draw_Text(t,E,S,e.pt1.x,e.pt1.y+v)}else{t.save();var _=0;this.draw_Text(t,e.name,S,e.pt1.x,e.pt1.y),_+=S;var b="D"+e.value.toFixed(4)+i.unit;this.draw_Text(t,b,S,e.pt1.x,e.pt1.y+_),_+=S/2,S/=2,b="L:"+e.LSL*i.mult.toFixed(3)+i.unit+" U:"+e.USL*i.mult.toFixed(3)+i.unit,this.draw_Text(t,b,S,e.pt1.x,e.pt1.y+_),_+=S,b="Now:"+(Math.hypot(s.x-h.x,s.y-h.y)*i.mult).toFixed(4)+i.unit,this.draw_Text(t,b,S,e.pt1.x,e.pt1.y+_)}}}},{key:"drawSignature",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36;t.beginPath(),t.moveTo(e.magnitude[0]*Math.cos(e.angle[0]),e.magnitude[0]*Math.sin(e.angle[0]));for(var a=1;a<e.angle.length;a+=n)t.lineTo(e.magnitude[a]*Math.cos(e.angle[a]),e.magnitude[a]*Math.sin(e.angle[a]));t.closePath()}},{key:"drawShapeList",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=this,r=arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{unit:"mm",mult:1};e.forEach(function(e){if(null!=e&&void 0===a.find(function(t){return e.id==t}))switch(n&&(t.strokeStyle=e.color),e.type){case o.SHAPE_TYPE.line:t.lineWidth=2*e.margin,i.drawReportLine(t,{x0:e.pt1.x,y0:e.pt1.y,x1:e.pt2.x,y1:e.pt2.y});var l=(0,d.LineCentralNormal)(e);t.lineWidth=i.getSearchDirectionLineSize(),t.strokeStyle="rgba(100,50,100,0.8)";var u=e.margin+t.lineWidth/2;e.direction<0&&(u=-u),i.drawReportLine(t,{x0:e.pt1.x+l.vx*u,y0:e.pt1.y+l.vy*u,x1:e.pt2.x+l.vx*u,y1:e.pt2.y+l.vy*u}),t.strokeStyle="gray",i.drawpoint(t,e.pt1),i.drawpoint(t,e.pt2);break;case o.SHAPE_TYPE.aux_point:var c=i.db_obj,h=e.ref.map(function(t){return c.FindShape("id",t.id,r)}).map(function(t){return t>=0?r[t]:null});if(i.drawShapeList(t,h,n,a,r),void 0===e.id)break;var p=i.db_obj.auxPointParse(e,r);void 0!==p&&2==h.length&&(t.setLineDash([5*i.getPrimitiveSize(),15*i.getPrimitiveSize()]),t.beginPath(),t.moveTo(p.x,p.y),t.lineTo(h[0].pt1.x,h[0].pt1.y),t.stroke(),t.beginPath(),t.moveTo(p.x,p.y),t.lineTo(h[1].pt1.x,h[1].pt1.y),t.stroke(),t.setLineDash([]),t.strokeStyle="gray",i.drawpoint(t,p));break;case o.SHAPE_TYPE.arc:var f=(0,d.threePointToArc)(e.pt1,e.pt2,e.pt3);t.lineWidth=2*e.margin,i.drawReportArc(t,f),t.lineWidth=i.getSearchDirectionLineSize(),t.strokeStyle="rgba(100,50,100,0.8)";var S=e.margin+t.lineWidth/2;e.direction<0&&(S=-S),f.r+=S,i.drawReportArc(t,f),t.strokeStyle="gray",i.drawpoint(t,e.pt1),i.drawpoint(t,e.pt2),i.drawpoint(t,e.pt3);break;case o.SHAPE_TYPE.search_point:var E=i.db_obj,v=e.ref.map(function(t){return E.FindShape("id",t.id,r)}).map(function(t){return t>=0?r[t]:null});if(null==v[0])break;v[0];var _=E.shapeVectorParse(e,r),b={x:-_.y,y:_.x},y=e.width/2;_.x*=y,_.y*=y,t.lineWidth=2*e.margin,i.drawReportLine(t,{x0:e.pt1.x-_.x,y0:e.pt1.y-_.y,x1:e.pt1.x+_.x,y1:e.pt1.y+_.y}),t.lineWidth=i.getSearchDirectionLineSize(),t.strokeStyle="rgba(100,50,100,0.8)";var m=e.margin+t.lineWidth/2;i.drawReportLine(t,{x0:e.pt1.x-_.x+b.x*m,y0:e.pt1.y-_.y+b.y*m,x1:e.pt1.x+_.x+b.x*m,y1:e.pt1.y+_.y+b.y*m}),i.drawShapeList(t,v,n,a,r),t.strokeStyle="gray",i.drawpoint(t,e.pt1);break;case o.SHAPE_TYPE.measure:var g=i.db_obj;if(void 0===e.ref)break;var k=e.ref.map(function(t){return g.FindShapeObject("id",t.id,r)});if(!k.reduce(function(t,e){return t&&void 0!==e},!0))break;switch(n&&(void 0!==e.color?(t.strokeStyle=e.color,t.fillStyle=e.color):(t.strokeStyle=i.colorSet.measure_info,t.fillStyle=i.colorSet.measure_info)),e.subtype){case o.SHAPE_TYPE.measure_subtype.distance:i.drawMeasureDistance(t,e,k,r,s);break;case o.SHAPE_TYPE.measure_subtype.angle:var T=(0,d.intersectPoint)(k[0].pt1,k[0].pt2,k[1].pt1,k[1].pt2);t.lineWidth=i.getIndicationLineSize();var C=Math.atan2(k[0].pt1.y-T.y,k[0].pt1.x-T.x),A=Math.atan2(k[1].pt1.y-T.y,k[1].pt1.x-T.x),N=(A-C)%(2*Math.PI);N<0&&(N+=2*Math.PI),N>Math.PI&&(N-=Math.PI);var w=0,P=(Math.atan2(e.pt1.y-T.y,e.pt1.x-T.x)-C)%(2*Math.PI);P<0&&(P+=2*Math.PI),w=P<N?1:P<Math.PI?2:P<Math.PI+N?3:4,e.quadrant=w;var I,O=Math.hypot(e.pt1.y-T.y,e.pt1.x-T.x),x=(e.margin,Math.PI,C),D=C,M=A;switch(w%4){case 1:break;case 2:x+=N;break;case 3:x+=Math.PI;break;case 0:x=x+N+Math.PI}w%2==0&&(N=Math.PI-N),I=x+N,w%2==0?(D=I,M=x):(D=x,M=I),i.drawArcArrow(t,T.x,T.y,O,x,I),i.drawpoint(t,e.pt1);var U=180*N/Math.PI;t.setLineDash([5*i.getPrimitiveSize(),15*i.getPrimitiveSize()]),i.drawReportLine(t,{x0:k[0].pt1.x,y0:k[0].pt1.y,x1:T.x+O*Math.cos(D),y1:T.y+O*Math.sin(D)}),i.drawReportLine(t,{x0:k[1].pt1.x,y0:k[1].pt1.y,x1:T.x+O*Math.cos(M),y1:T.y+O*Math.sin(M)}),t.setLineDash([]);var L=e.pt1.x+(e.pt1.x-T.x)/O*4*i.getPrimitiveSize(),F=e.pt1.y+(e.pt1.y-T.y)/O*4*i.getPrimitiveSize(),R=i.getFontHeightPx();t.font=i.getFontStyle(1);var j=void 0;if(void 0!==e.inspection_value){var W=0;t.strokeStyle="black",t.lineWidth=i.getIndicationLineSize(),i.draw_Text(t,e.name,R,L,F),W+=R,j=e.inspection_value.toFixed(2)+"º",j+=":"+(100*(e.inspection_value>e.value?(e.inspection_value-e.value)/(e.USL-e.value):-(e.inspection_value-e.value)/(e.LSL-e.value))).toFixed(1)+"%",i.draw_Text(t,j,R,L,F+W)}else{t.save();var B=0;t.strokeStyle="black",t.lineWidth=i.getIndicationLineSize(),i.draw_Text(t,e.name,R,e.pt1.x,e.pt1.y),B+=R;var H=e.value.toFixed(4)+"º";i.draw_Text(t,H,R,L,F+B),B+=R/2,R/=2,H="L:"+e.LSL.toFixed(3)+"º U:"+e.USL.toFixed(3)+"º",i.draw_Text(t,H,R,L,F+B),B+=R,H="Now:"+U.toFixed(4)+"º",i.draw_Text(t,H,R,e.pt1.x,e.pt1.y+B)}break;case o.SHAPE_TYPE.measure_subtype.radius:t.lineWidth=i.getIndicationLineSize(),t.font=i.getFontStyle();var G=(0,d.threePointToArc)(k[0].pt1,k[0].pt2,k[0].pt3),V={x:e.pt1.x-G.x,y:e.pt1.y-G.y},X=Math.hypot(V.x,V.y),z={x:V.x/X,y:V.y/X};V.x*=G.r/X,V.y*=G.r/X;var Y=50*i.getPrimitiveSize();i.canvas_arrow(t,e.pt1.x,e.pt1.y,G.x+V.x,G.y+V.y,Y),i.drawpoint(t,e.pt1),z.x*=40*i.getPrimitiveSize(),z.y*=40*i.getPrimitiveSize();var K=i.getFontHeightPx();t.font=i.getFontStyle(1);if(void 0!==e.inspection_value){var J="R"+(e.inspection_value*s.mult).toFixed(4)+s.unit;J+=":"+(100*(e.inspection_value>e.value?(e.inspection_value-e.value)/(e.USL-e.value):-(e.inspection_value-e.value)/(e.LSL-e.value))).toFixed(1)+"%",t.strokeStyle="black",t.lineWidth=i.getIndicationLineSize(),i.draw_Text(t,e.name,K,e.pt1.x+z.x,e.pt1.y+z.y);var q=K;i.draw_Text(t,J,K,e.pt1.x+z.x,e.pt1.y+z.y+q)}else{t.save();var Q=0;t.strokeStyle="black",t.lineWidth=i.getIndicationLineSize(),i.draw_Text(t,e.name,K,e.pt1.x,e.pt1.y),Q+=K;var $="R"+e.value.toFixed(4)+s.unit;i.draw_Text(t,$,K,e.pt1.x,e.pt1.y+Q),Q+=K/2,K/=2,$="L:"+e.LSL*s.mult.toFixed(3)+s.unit+" U:"+e.USL*s.mult.toFixed(3)+s.unit,i.draw_Text(t,$,K,e.pt1.x,e.pt1.y+Q),Q+=K,$="Now:"+(G.r*s.mult).toFixed(4)+s.unit,i.draw_Text(t,$,K,e.pt1.x,e.pt1.y+Q)}}}})}},{key:"drawInspectionShapeList",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=this,r=arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{unit:"mm",mult:1},l=[];e.forEach(function(e){if(null!=e&&void 0===a.find(function(t){return e.id==t}))switch(n&&(t.strokeStyle=e.color),e.type){case o.SHAPE_TYPE.line:t.lineWidth=2*i.getPrimitiveSize(),i.drawReportLine(t,{x0:e.pt1.x,y0:e.pt1.y,x1:e.pt2.x,y1:e.pt2.y});break;case o.SHAPE_TYPE.arc:var s=(0,d.threePointToArc)(e.pt1,e.pt2,e.pt3);t.lineWidth=2*i.getPrimitiveSize(),i.drawReportArc(t,s);break;case o.SHAPE_TYPE.search_point:t.strokeStyle="gray",i.drawpoint(t,e.pt1,"rect");break;case o.SHAPE_TYPE.aux_point:var u=i.db_obj,c=e.ref.map(function(t){return u.FindShape("id",t.id,r)}).map(function(t){return t>=0?r[t]:null});if(void 0===e.id)break;var h=i.db_obj.auxPointParse(e,r);void 0!==h&&2==c.length&&(t.setLineDash([5*i.getPrimitiveSize(),15*i.getPrimitiveSize()]),t.beginPath(),t.moveTo(h.x,h.y),t.lineTo(c[0].pt1.x,c[0].pt1.y),t.stroke(),t.beginPath(),t.moveTo(h.x,h.y),t.lineTo(c[1].pt1.x,c[1].pt1.y),t.stroke(),t.setLineDash([]),t.strokeStyle="gray",i.drawpoint(t,h,"rect"));break;case o.SHAPE_TYPE.measure:l.push(e)}}),this.drawShapeList(t,l,n,a,r,s)}}]),t}(),k=function(){function t(e){var n=this;_(this,t),this.canvas=e,this.canvas.onmousemove=this.onmousemove.bind(this),this.canvas.onmousedown=this.onmousedown.bind(this),this.canvas.onmouseup=this.onmouseup.bind(this),this.canvas.onmouseout=this.onmouseout.bind(this),this.canvas.addEventListener("touchstart",function(t){var e=t.touches[0],a=new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY});n.canvas.dispatchEvent(a)},!1),this.canvas.addEventListener("touchmove",function(t){var e=t.touches[0],a=new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY});n.canvas.dispatchEvent(a)},!1),this.canvas.addEventListener("touchend",function(t){var e=new MouseEvent("mouseup",{});n.canvas.dispatchEvent(e)},!1),this.canvas.addEventListener("wheel",this.onmouseswheel.bind(this),!1),this.mouseStatus={x:-1,y:-1,px:-1,py:-1,status:0,pstatus:0},this.secCanvas_rawImg=null,this.secCanvas=document.createElement("canvas"),this.identityMat=new DOMMatrix,this.Mouse2SecCanvas=new DOMMatrix,this.camera=new m,this.camera.Scale(100),this.colorSet={unselected:"rgba(100,0,100,0.5)",inspection_Pass:"rgba(0,255,0,0.1)",inspection_Fail:"rgba(255,0,0,0.1)",editShape:"rgba(255,0,0,0.7)",measure_info:"rgba(128,128,200,0.7)"},this.rUtil=new g(null),this.rUtil.setColorSet(this.colorSet)}return r(t,[{key:"getMousePos",value:function(t,e){var n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}}}]),r(t,[{key:"resourceClean",value:function(){this.canvas.removeEventListener("wheel",this.onmouseswheel.bind(this)),h.debug("resourceClean......")}},{key:"SetImg",value:function(t){if(h.debug("SetImg:::"),null!=t&&t!=this.secCanvas_rawImg){this.secCanvas.width=t.width,this.secCanvas.height=t.height,this.secCanvas_rawImg=t;var e=this.secCanvas.getContext("2d");e.putImageData(t,0,0),h.debug("SetImg::: UPDATE",e)}}},{key:"onmouseswheel",value:function(t){var e=t.deltaY/4;e>50&&(e=1),e<-50&&(e=-1);var n=1/1.01;return n=Math.pow(n,e),this.camera.Scale(n,{x:this.mouseStatus.x-this.canvas.width/2,y:this.mouseStatus.y-this.canvas.height/2}),this.draw(),!1}},{key:"onmousemove",value:function(t){var e=this.getMousePos(this.canvas,t);switch(this.mouseStatus.x=e.x,this.mouseStatus.y=e.y,this.state.substate){case o.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(null!=this.EditPoint)break;case o.UI_SM_STATES.DEFCONF_MODE_NEUTRAL:case o.UI_SM_STATES.INSP_MODE_NEUTRAL:1==this.mouseStatus.status&&this.camera.StartDrag({x:e.x-this.mouseStatus.px,y:e.y-this.mouseStatus.py})}this.ctrlLogic(),this.draw()}},{key:"onmousedown",value:function(t){var e=this.getMousePos(this.canvas,t);this.mouseStatus.px=e.x,this.mouseStatus.py=e.y,this.mouseStatus.x=e.x,this.mouseStatus.y=e.y,this.mouseStatus.status=1,this.ctrlLogic(),this.draw()}},{key:"onmouseup",value:function(t){var e=this.getMousePos(this.canvas,t);this.mouseStatus.x=e.x,this.mouseStatus.y=e.y,this.mouseStatus.status=0,this.camera.EndDrag(),this.ctrlLogic(),this.draw()}},{key:"onmouseout",value:function(t){1==this.mouseStatus.status&&this.onmouseup(t)}},{key:"resize",value:function(t,e){this.canvas.width=t,this.canvas.height=e,this.draw()}},{key:"worldTransform",value:function(){var t=new DOMMatrix;return t.translateSelf(this.canvas.width/2,this.canvas.height/2),this.camera.CameraTransform(t),t}},{key:"VecX2DMat",value:function(t,e){return{x:t.x*e.a+t.y*e.c+e.e,y:t.x*e.b+t.y*e.d+e.f}}}]),t}(),T=function(t){function e(t){_(this,e);var n=E(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.edit_DB_info=null,n.db_obj=null,n.mouse_close_dist=10,n.state=void 0,n.EditShape=null,n.CandEditPointInfo=null,n.EditPoint=null,n.EmitEvent=function(t){h.debug(t)},n}return v(e,k),r(e,[{key:"SetState",value:function(t){h.debug(t);var e=(0,u.xstate_GetCurrentMainState)(t),n=JSON.stringify(e);JSON.stringify(this.state)!==n&&(this.state=JSON.parse(n),this.state.state==o.UI_SM_STATES.DEFCONF_MODE&&this.state.substate==o.UI_SM_STATES.DEFCONF_MODE_NEUTRAL&&(this.EmitEvent(l.Edit_Tar_Update(null)),this.EditShape=null,this.EditPoint=null))}},{key:"EditDBInfoSync",value:function(t){if(this.edit_DB_info=t,this.db_obj=t._obj,void 0!==this.db_obj&&null!=this.db_obj&&void 0!==this.db_obj.cameraParam){this.rUtil.setEditor_db_obj(this.db_obj),this.SetImg(t.img);var e=this.db_obj.getsig360info_mmpp();this.rUtil.renderParam.mmpp=e}}},{key:"fitCameraToShape",value:function(t){if(null!=t&&void 0!==t){var e={x:0,y:0};switch(t.type){case o.SHAPE_TYPE.line:e.x=(t.pt1.x+t.pt2.x)/2,e.y=(t.pt1.y+t.pt2.y)/2;break;case o.SHAPE_TYPE.arc:var n=(0,d.threePointToArc)(t.pt1,t.pt2,t.pt3);n.r>500?(e.x=(t.pt1.x+t.pt3.x)/2,e.y=(t.pt1.y+t.pt3.y)/2):(e.x=n.x,e.y=n.y);break;case o.SHAPE_TYPE.aux_point:var a=this.db_obj.auxPointParse(t);if(null==a)return;e=a;break;case o.SHAPE_TYPE.search_point:e=t.pt1;break;default:return}this.camera.SetOffset({x:-e.x,y:-e.y})}}},{key:"ctrlLogic",value:function(){}},{key:"setMatrix",value:function(t,e){t.setTransform(e.a,e.b,e.c,e.d,e.e,e.f)}},{key:"draw",value:function(){if(void 0!==this.db_obj&&null!=this.db_obj&&void 0!==this.db_obj.cameraParam){var t=this.rUtil.get_mmpp(),e=this.canvas.getContext("2d");this.secCanvas.getContext("2d");e.lineWidth=this.rUtil.getIndicationLineSize(),this.setMatrix(e,this.identityMat),e.clearRect(0,0,this.canvas.width,this.canvas.height);var n=this.worldTransform();this.setMatrix(e,n);var a=this.db_obj.getsig360infoCenter();e.save(),e.translate(-a.x,-a.y),e.scale(4*t,4*t),e.drawImage(this.secCanvas,0,0),e.restore();this.Mouse2SecCanvas=n.invertSelf();var i=this.Mouse2SecCanvas,r=this.mouseStatus;this.VecX2DMat(r,i);e.closePath(),e.save();this.rUtil.drawShapeList(e,this.edit_DB_info.list,!0,[],this.edit_DB_info.list,{unit:"mm",mult:1}),this.rUtil.drawInherentShapeList(e,this.edit_DB_info.inherentShapeList)}}}]),e}(),C=function(t){function e(t){_(this,e);var n=E(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.ERROR_LOCK=!1,n.edit_DB_info=null,n.db_obj=null,n.mouse_close_dist=10,n.colorSet=Object.assign(n.colorSet,{inspection_Pass:"rgba(0,255,0,0.1)",inspection_production_Fail:"rgba(128,128,0,0.3)",inspection_Fail:"rgba(255,0,0,0.1)",inspection_NA:"rgba(64,64,64,0.1)",color_NA:"rgba(128,128,128,0.5)",color_SUCCESS:n.colorSet.measure_info,color_FAILURE_opt:{submargin1:"rgba(255,255,0,0.5)"},color_FAILURE:"rgba(255,0,0,0.5)"}),n.state=void 0,n.EditShape=null,n.CandEditPointInfo=null,n.EditPoint=null,n.EmitEvent=function(t){h.info(t)},n}return v(e,k),r(e,[{key:"SetState",value:function(t){h.debug(t);var e=(0,u.xstate_GetCurrentMainState)(t),n=JSON.stringify(e);JSON.stringify(this.state)!==n&&(this.state=JSON.parse(n))}},{key:"EditDBInfoSync",value:function(t){this.edit_DB_info=t,this.db_obj=t._obj,this.rUtil.setEditor_db_obj(this.db_obj),this.SetImg(t.img);var e=this.db_obj.cameraParam.mmpb2b/this.db_obj.cameraParam.ppb2b;this.rUtil.renderParam.mmpp=e}},{key:"SetShape",value:function(t,e){this.tmp_EditShape_id=e,this.EmitEvent(l.Shape_Set({shape:t,id:e}))}},{key:"inspectionResult",value:function(t){var e=t.judgeReports.reduce(function(t,e){return t==c.INSPECTION_STATUS.NA?t:t==c.INSPECTION_STATUS.FAILURE?e.status==c.INSPECTION_STATUS.NA?c.INSPECTION_STATUS.NA:t:e.status},c.INSPECTION_STATUS.SUCCESS);return null==e?c.INSPECTION_STATUS.NA:e}},{key:"draw",value:function(){this.draw_INSP()}},{key:"draw_INSP",value:function(){var t=this;if(!this.ERROR_LOCK&&null!=this.edit_DB_info&&null!=this.edit_DB_info.inspReport&&null!=this.edit_DB_info.inspReport){var e,n=this.edit_DB_info.reportStatisticState.trackingWindow.filter(function(t){return t.isCurObj});e={unit:"mm",mult:1};var a=this.canvas.getContext("2d");this.secCanvas.getContext("2d");a.lineWidth=this.rUtil.getIndicationLineSize(),a.resetTransform(),a.clearRect(0,0,this.canvas.width,this.canvas.height);var i=this.worldTransform();a.setTransform(i.a,i.b,i.c,i.d,i.e,i.f);var r=4*this.rUtil.get_mmpp();a.translate(-this.secCanvas.width*r/2,-this.secCanvas.height*r/2),a.save(),a.scale(r,r),a.drawImage(this.secCanvas,0,0),a.restore();void 0!==this.edit_DB_info.list&&this.edit_DB_info.list.reduce(function(t,e){return e.type==o.SHAPE_TYPE.measure&&t.push(e),t},[]),n.forEach(function(e,n){switch(a.save(),a.translate(e.cx,e.cy),a.rotate(-e.rotate),e.isFlipped&&a.scale(1,-1),a.scale(1,1),t.rUtil.drawSignature(a,t.edit_DB_info.inherentShapeList[0].signature,5),t.inspectionResult(e)){case c.INSPECTION_STATUS.NA:a.fillStyle=t.colorSet.inspection_NA;break;case c.INSPECTION_STATUS.SUCCESS:a.fillStyle=t.colorSet.inspection_Pass;Number.MAX_VALUE;t.edit_DB_info.list.forEach(function(t){if(t.type===o.SHAPE_TYPE.measure){var n=t.id,i=e.judgeReports.find(function(t){return t.id===n});if(void 0===i)return;a.fillStyle=y[i.detailStatus].COLOR}});break;case c.INSPECTION_STATUS.FAILURE:a.fillStyle=t.colorSet.inspection_Fail}a.fill(),a.restore(),a.strokeStyle="black"}),n.forEach(function(n,i){var r=(0,f.default)(t.edit_DB_info.list);t.db_obj.ShapeListAdjustsWithInspectionResult(r,n),r.forEach(function(e){switch(e.inspection_status){case c.INSPECTION_STATUS.NA:e.color=t.colorSet.color_NA;break;case c.INSPECTION_STATUS.SUCCESS:if(e.color=t.colorSet.color_SUCCESS,e.type===o.SHAPE_TYPE.measure){var a=e.id,i=n.judgeReports.find(function(t){return t.id===a});if(void 0===i)break;e.color=y[i.detailStatus].COLOR}break;case c.INSPECTION_STATUS.FAILURE:e.color=t.colorSet.color_FAILURE}}),t.rUtil.drawInspectionShapeList(a,r,!0,[],r,e)})}}},{key:"ctrlLogic",value:function(){if(null===this.edit_DB_info.inherentShapeList||void 0===this.edit_DB_info.inherentShapeList||0==this.edit_DB_info.inherentShapeList.length)return this.ERROR_LOCK=!0,void this.EmitEvent({type:"ERROR",data:"Define Config is not valid or the corrupted..."});var t=this.worldTransform(),e=(new DOMMatrix).setMatrixValue(t).invertSelf(),n=this.mouseStatus,a=this.VecX2DMat(n,e),i={x:this.mouseStatus.px,y:this.mouseStatus.py};this.VecX2DMat(i,e),this.mouseStatus.status,this.mouseStatus.pstatus;this.EmitEvent((0,o.EV_UI_Canvas_Mouse_Location)(a))}}]),e}(),A=function(t){function e(t){_(this,e);var n=E(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.edit_DB_info=null,n.db_obj=null,n.mouse_close_dist=10,n.state=void 0,n.EditShape=null,n.CandEditPointInfo=null,n.EditPoint=null,n.EmitEvent=function(t){h.debug(t)},n}return v(e,k),r(e,[{key:"SetState",value:function(t){h.debug(t);var e=(0,u.xstate_GetCurrentMainState)(t),n=JSON.stringify(e);JSON.stringify(this.state)!==n&&(this.state=JSON.parse(n),this.state.state==o.UI_SM_STATES.DEFCONF_MODE&&this.state.substate==o.UI_SM_STATES.DEFCONF_MODE_NEUTRAL&&(this.EmitEvent(l.Edit_Tar_Update(null)),this.EditShape=null,this.EditPoint=null))}},{key:"EditDBInfoSync",value:function(t){this.edit_DB_info=t,this.db_obj=t._obj,this.rUtil.setEditor_db_obj(this.db_obj),this.SetImg(t.img),this.SetEditShape(t.edit_tar_info);var e=this.db_obj.getsig360info_mmpp();this.rUtil.renderParam.mmpp=e}},{key:"SetShape",value:function(t,e){this.tmp_EditShape_id=e,this.EmitEvent(l.Shape_Set({shape:t,id:e}))}},{key:"SetEditShape",value:function(t){this.EditShape=t,h.debug(this.tmp_EditShape_id),null!=this.EditShape&&null!=this.EditShape.id&&this.tmp_EditShape_id!=this.EditShape.id&&(null!=this.tmp_EditShape_id&&this.fitCameraToShape(this.EditShape),this.tmp_EditShape_id=this.EditShape.id)}},{key:"AvailableShapeFilter",value:function(t){var e=void 0,n=void 0;switch(this.state.substate){case o.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:e=o.SHAPE_TYPE.aux_point;break;case o.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:e=o.SHAPE_TYPE.search_point;break;case o.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:e=o.SHAPE_TYPE.measure,void 0!==this.EditShape&&null!==this.EditShape&&(n=this.EditShape.subtype);break;case o.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:var a=this.edit_DB_info.edit_tar_ele_trace,i=this.edit_DB_info.edit_tar_info;void 0!==i&&null!==a&&(n=i.subtype,e=i.type)}switch(e){case o.SHAPE_TYPE.aux_point:case o.SHAPE_TYPE.search_point:return t.filter(function(t){return t.type===o.SHAPE_TYPE.line});case o.SHAPE_TYPE.measure:switch(n){case o.SHAPE_TYPE.measure_subtype.distance:return t;case o.SHAPE_TYPE.measure_subtype.angle:return t.filter(function(t){return t.type===o.SHAPE_TYPE.line});case o.SHAPE_TYPE.measure_subtype.radius:return t.filter(function(t){return t.type===o.SHAPE_TYPE.arc})}}return t}},{key:"fitCameraToShape",value:function(t){if(null!=t&&void 0!==t){var e={x:0,y:0};switch(t.type){case o.SHAPE_TYPE.line:e.x=(t.pt1.x+t.pt2.x)/2,e.y=(t.pt1.y+t.pt2.y)/2;break;case o.SHAPE_TYPE.arc:var n=(0,d.threePointToArc)(t.pt1,t.pt2,t.pt3);n.r>500?(e.x=(t.pt1.x+t.pt3.x)/2,e.y=(t.pt1.y+t.pt3.y)/2):(e.x=n.x,e.y=n.y);break;case o.SHAPE_TYPE.aux_point:var a=this.db_obj.auxPointParse(t);if(null==a)return;e=a;break;case o.SHAPE_TYPE.search_point:e=t.pt1;break;default:return}this.camera.SetOffset({x:-e.x,y:-e.y})}}},{key:"draw",value:function(){this.draw_DEFCONF()}},{key:"ctrlLogic",value:function(){this.ctrlLogic_DEFCONF()}},{key:"setMatrix",value:function(t,e){t.setTransform(e.a,e.b,e.c,e.d,e.e,e.f)}},{key:"draw_DEFCONF",value:function(){var t=this.rUtil.get_mmpp(),e=this.canvas.getContext("2d");this.secCanvas.getContext("2d");e.lineWidth=this.rUtil.getIndicationLineSize(),this.setMatrix(e,this.identityMat),e.clearRect(0,0,this.canvas.width,this.canvas.height);var n=this.worldTransform();this.setMatrix(e,n);var a=this.db_obj.getsig360infoCenter();e.save(),e.translate(-a.x,-a.y),e.scale(4*t,4*t),e.drawImage(this.secCanvas,0,0),e.restore();var i={unit:"mm",mult:1};this.Mouse2SecCanvas=n.invertSelf();var r=this.Mouse2SecCanvas,o=this.mouseStatus;this.VecX2DMat(o,r);e.closePath(),e.save();var s=[];if(null!=this.EditShape&&(s.push(this.EditShape.id),e.strokeStyle=this.colorSet.editShape,this.rUtil.drawShapeList(e,[this.EditShape],!1,[],this.edit_DB_info.list,i)),null!=this.CandEditPointInfo){var l=this.CandEditPointInfo;void 0===s.find(function(t){return l.shape.id==t}.bind(this))&&(s.push(l.shape.id),e.strokeStyle="rgba(255,0,255,0.5)",this.rUtil.drawShapeList(e,[l.shape],!1,[],this.edit_DB_info.list,i))}var u=this.AvailableShapeFilter(this.edit_DB_info.list);this.rUtil.drawShapeList(e,u,!0,s,u,i),this.rUtil.drawInherentShapeList(e,this.edit_DB_info.inherentShapeList),null!=this.EditPoint&&(e.strokeStyle="green",this.rUtil.drawpoint(e,this.EditPoint,2*this.rUtil.getPointSize())),null!=this.CandEditPointInfo&&(e.strokeStyle="rgba(0,255,0,0.3)",this.rUtil.drawpoint(e,this.CandEditPointInfo.pt,2*this.rUtil.getPointSize()))}},{key:"ctrlLogic_DEFCONF",value:function(){this.rUtil.get_mmpp();var t=this.worldTransform(),e=(new DOMMatrix).setMatrixValue(t).invertSelf(),n=this.mouseStatus,a=this.VecX2DMat(n,e),i={x:this.mouseStatus.px,y:this.mouseStatus.py},r=this.VecX2DMat(i,e),s=this.mouseStatus.status!=this.mouseStatus.pstatus;switch(this.state.substate){case o.UI_SM_STATES.DEFCONF_MODE_LINE_CREATE:1==this.mouseStatus.status?this.EditShape={type:o.SHAPE_TYPE.line,pt1:a,pt2:r,margin:.3,color:this.colorSet.unselected,direction:1}:null!=this.EditShape&&s&&(this.SetShape(this.EditShape),this.EmitEvent(l.SUCCESS()));break;case o.UI_SM_STATES.DEFCONF_MODE_ARC_CREATE:if(1==this.mouseStatus.status){var u=(0,d.LineCentralNormal)({pt1:a,pt2:r});this.EditShape={type:o.SHAPE_TYPE.arc,pt1:a,pt2:{x:u.x+u.vx,y:u.y+u.vy},pt3:r,margin:.3,color:this.colorSet.unselected,direction:1}}else null!=this.EditShape&&s&&(this.SetShape(this.EditShape),this.EmitEvent(l.SUCCESS()));break;case o.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:case o.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:case o.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:if(1==this.mouseStatus.status)s&&null!=this.CandEditPointInfo&&(this.state.substate==o.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE?(this.EditShape={type:o.SHAPE_TYPE.search_point,pt1:{x:0,y:0},angleDeg:90,margin:.15,width:.5,ref:[{id:this.CandEditPointInfo.shape.id,element:this.CandEditPointInfo.shape.type}],color:this.colorSet.unselected},this.SetShape(this.EditShape),this.EmitEvent(l.SUCCESS())):(h.debug(s,this.CandEditPointInfo),this.EmitEvent(l.Edit_Tar_Ele_Cand_Update(this.CandEditPointInfo))));else{var c=this.AvailableShapeFilter(this.edit_DB_info.list),p=this.db_obj.FindClosestCtrlPointInfo(a,c),S=this.AvailableShapeFilter(this.edit_DB_info.inherentShapeList),E=this.db_obj.FindClosestInherentPointInfo(a,S);p.dist>E.dist&&(p=E),null!=p.pt&&p.dist<this.mouse_close_dist/this.camera.GetCameraScale()?this.CandEditPointInfo=p:this.CandEditPointInfo=null}break;case o.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(1==this.mouseStatus.status)if(s){var v=this.edit_DB_info.edit_tar_ele_trace;if(null==v||void 0===v){if(null!=this.CandEditPointInfo){var _=this.CandEditPointInfo;this.CandEditPointInfo=null,this.EditShape=(0,f.default)(_.shape),this.EditPoint=this.EditShape[_.key],this.tmp_EditShape_id=this.EditShape.id}else this.EditPoint=null,this.EditShape=null;this.EmitEvent(l.Edit_Tar_Update(this.EditShape))}else null!=this.CandEditPointInfo?this.EmitEvent(l.Edit_Tar_Ele_Cand_Update(this.CandEditPointInfo)):this.EmitEvent(l.Edit_Tar_Ele_Trace_Update(null))}else null!=this.EditPoint&&(this.EditPoint.x=a.x,this.EditPoint.y=a.y,this.EmitEvent(l.Edit_Tar_Update(this.EditShape)));else{null!=this.EditShape&&s&&this.SetShape(this.EditShape,this.EditShape.id);var b=this.AvailableShapeFilter(this.edit_DB_info.list),y=this.db_obj.FindClosestCtrlPointInfo(a,b),m=this.AvailableShapeFilter(this.edit_DB_info.inherentShapeList),g=this.db_obj.FindClosestInherentPointInfo(a,m);y.dist>g.dist&&(y=g),null!=y.pt&&y.dist<this.mouse_close_dist/this.camera.GetCameraScale()?this.CandEditPointInfo=y:this.CandEditPointInfo=null}}this.mouseStatus.pstatus=this.mouseStatus.status}}]),e}();e.default={Preview_CanvasComponent:T,INSP_CanvasComponent:C,DEFCONF_CanvasComponent:A}},245:function(t,e,n){"use strict";var a,i,r,o,s,l,u,d,c,h,p,f,S;Object.defineProperty(e,"__esModule",{value:!0}),e.ReduxStoreSetUp=function(t){var e=(0,E.combineReducers)({UIData:v.default}),n=(0,E.applyMiddleware)(m.default,new y.MWWebSocket({}),new b.ECStateMachine({ev_state_update:"ev_state_update",state_config:O}),new _.ActionThrottle({time:100,posEdge:!0}));return(0,E.createStore)(e,t,n)};var E=n(200),v=T(n(671)),_=n(760),b=n(761),y=n(282),m=T(n(762)),g=n(32),k=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(74));function T(t){return t&&t.__esModule?t:{default:t}}function C(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var A=g.UI_SM_STATES,N=g.UI_SM_EVENT,w={initial:A.DEFCONF_MODE_NEUTRAL,states:(d={},C(d,A.DEFCONF_MODE_NEUTRAL,{on:(a={},C(a,N.Line_Create,A.DEFCONF_MODE_LINE_CREATE),C(a,N.Arc_Create,A.DEFCONF_MODE_ARC_CREATE),C(a,N.Search_Point_Create,A.DEFCONF_MODE_SEARCH_POINT_CREATE),C(a,N.Aux_Point_Create,A.DEFCONF_MODE_AUX_POINT_CREATE),C(a,N.Shape_Edit,A.DEFCONF_MODE_SHAPE_EDIT),C(a,N.Measure_Create,A.DEFCONF_MODE_MEASURE_CREATE),a)}),C(d,A.DEFCONF_MODE_SEARCH_POINT_CREATE,{on:(i={},C(i,k.EVENT.SUCCESS,A.DEFCONF_MODE_SHAPE_EDIT),C(i,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),i)}),C(d,A.DEFCONF_MODE_AUX_POINT_CREATE,{on:(r={},C(r,k.EVENT.SUCCESS,A.DEFCONF_MODE_SHAPE_EDIT),C(r,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),r)}),C(d,A.DEFCONF_MODE_LINE_CREATE,{on:(o={},C(o,k.EVENT.SUCCESS,A.DEFCONF_MODE_SHAPE_EDIT),C(o,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),o)}),C(d,A.DEFCONF_MODE_ARC_CREATE,{on:(s={},C(s,k.EVENT.SUCCESS,A.DEFCONF_MODE_SHAPE_EDIT),C(s,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),s)}),C(d,A.DEFCONF_MODE_SHAPE_EDIT,{on:(l={},C(l,k.EVENT.SUCCESS,A.DEFCONF_MODE_NEUTRAL),C(l,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),l)}),C(d,A.DEFCONF_MODE_MEASURE_CREATE,{on:(u={},C(u,k.EVENT.SUCCESS,A.DEFCONF_MODE_SHAPE_EDIT),C(u,k.EVENT.FAIL,A.DEFCONF_MODE_NEUTRAL),u)}),d)},P={initial:A.INSP_MODE_NEUTRAL,states:C({},A.INSP_MODE_NEUTRAL,{on:{}})},I={initial:A.ANALYSIS_MODE_NEUTRAL,states:C({},A.ANALYSIS_MODE_NEUTRAL,{on:{}})},O={initial:A.SPLASH,states:(S={},C(S,A.SPLASH,{on:C({},N.Connected,A.MAIN)}),C(S,A.MAIN,{on:(c={},C(c,N.Edit_Mode,A.DEFCONF_MODE),C(c,N.Insp_Mode,A.INSP_MODE),C(c,N.Analysis_Mode,A.ANALYSIS_MODE),C(c,N.Disonnected,A.SPLASH),C(c,N.EXIT,A.SPLASH),c)}),C(S,A.DEFCONF_MODE,Object.assign({on:(h={},C(h,N.Disonnected,A.SPLASH),C(h,N.EXIT,A.MAIN),h)},w)),C(S,A.INSP_MODE,Object.assign({on:(p={},C(p,N.Disonnected,A.SPLASH),C(p,N.ERROR,A.MAIN),C(p,N.EXIT,A.MAIN),p)},P)),C(S,A.ANALYSIS_MODE,Object.assign({on:(f={},C(f,N.Disonnected,A.SPLASH),C(f,N.ERROR,A.MAIN),C(f,N.EXIT,A.MAIN),f)},I)),S)}},246:function(t,e,n){"use strict";function a(t,e){var n=void 0;n=void 0===t.vx?{x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2,vx:t.x2-t.x1,vy:t.y2-t.y1}:{x:t.cx,y:t.cy,vx:t.vx,vy:t.vy};var a=Math.hypot(n.vx,n.vy);n.vx/=a,n.vy/=a;var i={x:e.x,y:e.y};i.x-=n.x,i.y-=n.y;var r=n.vx*i.x+n.vy*i.y;return n.x+=r*n.vx,n.y+=r*n.vy,n.dist=r,n}function i(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return a=a>=0?1:-1,{x:t.x*n-a*t.y*e,y:t.x*e+a*t.y*n}}Object.defineProperty(e,"__esModule",{value:!0}),e.distance_point_point=function(t,e){return Math.hypot(t.x-e.x,t.y-e.y)},e.distance_arc_point=function(t,e){var n=Math.atan2(e.y-t.y,e.x-t.x),a=n,i=t.angleFrom,r=t.angleTo;n-=i,r-=i,n%=2*Math.PI,r%=2*Math.PI,n<0&&(n+=2*Math.PI);r<0&&(r+=2*Math.PI);if(i=0,n<r)return n=a,{x:t.r*Math.cos(n)+t.x,y:t.r*Math.sin(n)+t.y,dist:Math.abs(Math.hypot(e.x-t.x,e.y-t.y)-t.r)};i=t.angleFrom,r=t.angleTo;var o={x:t.r*Math.cos(r)+t.x,y:t.r*Math.sin(r)+t.y},s={x:t.r*Math.cos(i)+t.x,y:t.r*Math.sin(i)+t.y},l=Math.hypot(e.x-o.x,e.y-o.y),u=Math.hypot(e.x-s.x,e.y-s.y);if(l<u)return o.dist=l,o;return s.dist=u,s},e.closestPointOnLine=a,e.intersectPoint=function(t,e,n,a){var i={x:0,y:0},r=void 0,o=t.x-e.x,s=n.x-a.x,l=t.y-e.y,u=n.y-a.y;r=o*u-l*s;var d=t.x*e.y-t.y*e.x,c=n.x*a.y-n.y*a.x;return i.x=(d*s-o*c)/r,i.y=(d*u-l*c)/r,i},e.vecXY_addin=function(t,e){return t.x+=e.x,t.y+=e.y,t},e.vecXY_mulin=function(t,e){return t.x*=e,t.y*=e,t},e.distance_line_point=function(t,e){var n=a(t,e),i=void 0;i=Math.abs(t.x2-t.x1)>Math.abs(t.y2-t.y1)?(n.x-t.x1)/(t.x2-t.x1):(n.y-t.y1)/(t.y2-t.y1);if(i>1){var r=Math.hypot(e.x-t.x2,e.y-t.y2);return{x:t.x2,y:t.y2,dist:r}}if(i>0){var o=Math.hypot(e.x-n.x,e.y-n.y);return n.dist=o,n}var s=Math.hypot(e.x-t.x1,e.y-t.y1);return{x:t.x1,y:t.y1,dist:s}},e.threePointToArc=function(t,e,n){var a=e.x*e.x+e.y*e.y,i=(t.x*t.x+t.y*t.y-a)/2,r=(a-n.x*n.x-n.y*n.y)/2,o=(t.x-e.x)*(e.y-n.y)-(e.x-n.x)*(t.y-e.y),s=(i*(e.y-n.y)-r*(t.y-e.y))/o,l=(r*(t.x-e.x)-i*(e.x-n.x))/o,u=Math.sqrt(Math.pow(e.x-s,2)+Math.pow(e.y-l,2)),d=Math.atan2(t.y-l,t.x-s),c=Math.atan2(e.y-l,e.x-s),h=Math.atan2(n.y-l,n.x-s),p=(d-c+4*Math.PI)%(2*Math.PI);(d-h+4*Math.PI)%(2*Math.PI)>p&&(p=d,d=h,h=p);return{x:s,y:l,r:u,thetaS:d,thetaE:h}},e.LineCentralNormal=function(t){var e=t.pt2.y-t.pt1.y,n=t.pt2.x-t.pt1.x,a=Math.hypot(e,n);return{x:(t.pt1.x+t.pt2.x)/2,y:(t.pt1.y+t.pt2.y)/2,vx:e/a,vy:-n/a}},e.PtRotate2d_sc=i,e.PtRotate2d=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=Math.sin(e),r=Math.cos(e);return i(t,a,r,n)}},282:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=e.MWWS_EVENT={ERROR:"MWWS_ERROR",CONNECT:"MWWS_CONNECT",DISCONNECT:"MWWS_DISCONNECT",SEND:"MWWS_SEND"};e.MWWebSocket=function(t){return function(e){return function(n){return function(i){if(null==i.type||!i.type.startsWith("MWWS_"))return n(i);var r=i.data,o=r.id;if(void 0===o&&(o=r.url),void 0===o)return n({type:a.ERROR,data:{str:"no id/url is found",info:r}});switch(i.type){case a.CONNECT:void 0!==t[o]&&e.dispatch({type:a.DISCONNECT,data:t[o]}),t[o]=void 0,r.websocket=new WebSocket(r.url),void 0!==r.binaryType&&(r.websocket.binaryType=r.binaryType),r.websocket.onopen=function(t){this.onopen(t,this)}.bind(r),r.websocket.onmessage=function(t){this.onmessage(t,this)}.bind(r),r.websocket.onclose=function(e){this.onclose(e,this),t[this.id]=void 0}.bind(r),r.websocket.onerror=function(e){this.onerror(e,this),t[this.id]=void 0}.bind(r),t[o]=r;break;case a.SEND:if(void 0===t[o])return n({type:a.MWWS_ERROR});void 0===t[o].send?t[o].websocket.send(r.data):t[o].send(r.data,t[o],r.promiseCBs);break;case a.DISCONNECT:t[o].websocket.close()}return n(i)}}}}},32:function(t,e,n){"use strict";var a;Object.defineProperty(e,"__esModule",{value:!0}),e.UI_SM_EVENT=e.DEFAULT_UNIT=e.SHAPE_TYPE=e.SAK=e.SHAPE_ATTR_KEY=e.UI_SM_STATES=void 0,e.EV_WS_ChannelUpdate=function(t){return{type:s.WS_channel,data:t}},e.EV_UI_EC_Save_Def_Config=function(t){return{type:s.EC_Save_Def_Config,data:t}},e.EV_UI_EC_Load_Def_Config=function(t){return{type:s.EC_Load_Def_Config,data:t}},e.EV_UI_Version_Map_Update=function(t){return{type:s.Version_Map_Update,data:t}},e.EV_WS_Connected=function(t){return{type:s.Connected,data:t}},e.EV_WS_Disconnected=function(t){return{type:s.Disonnected,data:t}},e.EV_UI_Edit_Mode=function(){return{type:s.Edit_Mode}},e.EV_UI_Insp_Mode=function(){return{type:s.Insp_Mode}},e.EV_UI_Analysis_Mode=function(){return{type:s.Analysis_Mode}},e.EV_UI_ACT=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:t,data:e,misc:n}},e.Def_Model_Path_Update=function(t){return{type:s.Def_Model_Path_Update,data:t}},e.EV_UI_Canvas_Mouse_Location=function(t){return{type:s.Canvas_Mouse_Location,data:t}},e.EV_WS_Inspection_Report=function(t){return{type:s.Inspection_Report,data:t}},e.EV_WS_Image_Update=function(t){return{type:s.Image_Update,data:t}},e.EV_WS_Define_File_Update=function(t){return{type:s.Define_File_Update,data:t}},e.EV_WS_SIG360_Extraction=function(t){return{type:s.SIG360_Extraction,data:t}},e.EV_WS_SIG360_Report_Update=function(t){return{type:s.SIG360_Report_Update,data:t}},e.EV_WS_SEND=function(t,e,n,a,i,r){return{type:"MWWS_SEND",data:{id:t,data:{tl:e,prop:n,data:a,uintArr:i},promiseCBs:r}}};n(39);function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}e.UI_SM_STATES={SPLASH:"SPLASH",MAIN:"MAIN",DEFCONF_MODE:"DEFCONF_MODE",DEFCONF_MODE_NEUTRAL:"DEFCONF_MODE_NEUTRAL",DEFCONF_MODE_LINE_CREATE:"LINE_CREATE",DEFCONF_MODE_AUX_LINE_CREATE:"AUX_LINE_CREATE",DEFCONF_MODE_AUX_POINT_CREATE:"AUX_POINT_CREATE",DEFCONF_MODE_SEARCH_POINT_CREATE:"SEARCH_POINT_CREATE",DEFCONF_MODE_MEASURE_CREATE:"MEASURE_CREATE",DEFCONF_MODE_ARC_CREATE:"ARC_CREATE",DEFCONF_MODE_SHAPE_EDIT:"SHAPE_EDIT",INSP_MODE:"INSP_MODE",INSP_MODE_NEUTRAL:"INSP_MODE_NEUTRAL",ANALYSIS_MODE:"ANALYSIS_MODE",ANALYSIS_MODE_NEUTRAL:"ANALYSIS_MODE_NEUTRAL"};var r=e.SHAPE_ATTR_KEY={id:"id",name:"name",color:"color",type:"type",ref:"ref",element:"element"},o=(e.SAK=r,e.SHAPE_TYPE={sign360:"sign360",point:"point",line:"line",arc:"arc",aux_point:"aux_point",aux_line:"aux_line",search_point:"search_point",measure:"measure",measure_subtype:{NA:"NA",sigma:"sigma",distance:"distance",angle:"angle",radius:"radius"}}),s=(e.DEFAULT_UNIT=(i(a={},o.measure_subtype.sigma,""),i(a,o.measure_subtype.distance,"mm"),i(a,o.measure_subtype.angle,"º"),i(a,o.measure_subtype.radius,"mm"),a),e.UI_SM_EVENT={Connected:"Connected",Disonnected:"Disonnected",_SUCCESS:"_SUCCESS",_FAIL:"_FAIL",EXIT:"EXIT",ERROR:"ERROR",Version_Map_Update:"Version_Map_Update",Def_Model_Path_Update:"Def_Model_Path_Update",WS_channel:"WS_channel",Edit_Mode:"Edit_Mode",Insp_Mode:"Insp_Mode",Analysis_Mode:"Analysis_Mode",Inspection_Report:"Inspection_Report",Image_Update:"Image_Update",Define_File_Update:"Define_File_Update",SIG360_Report_Update:"SIG360_Report_Update",SIG360_Extraction:"SIG360_Extraction",Line_Create:"Line_Create",Arc_Create:"Arc_Create",Aux_Line_Create:"Aux_Line_Create",Search_Point_Create:"Search_Point_Create",Aux_Point_Create:"Aux_Point_Create",Shape_Edit:"Shape_Edit",Measure_Create:"Measure_Create",EC_Save_Def_Config:"EC_Save_Def_Config",EC_Load_Def_Config:"EC_Load_Def_Config",Control_SM_Panel:"Control_SM_Panel",Canvas_Mouse_Location:"Canvas_Mouse_Location"})},39:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEF_EXTENSION=e.INSPECTION_STATUS=void 0;var a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(32));var i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t.data instanceof ArrayBuffer&&t.data.byteLength>=9){var n=new Uint8ClampedArray(t.data,e,9),a={};return a.type=String.fromCharCode(n[0],n[1]),a.prop=n[2],a.pgID=(n[3]<<8)+n[4],a.length=n[5]<<24|n[6]<<16|n[7]<<8|n[8],a}return null},r=new TextEncoder,o=e.INSPECTION_STATUS={NA:-128,SUCCESS:0,FAILURE:-1};e.DEF_EXTENSION="hydef";e.default={raw2header:i,raw2obj_rawdata:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=i(t,e);return null==n?null:(n.rawdata=new Uint8ClampedArray(t.data,e+9,n.length),n)},raw2obj:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=i(t,e);if(null==n)return null;n.rawdata=new Uint8ClampedArray(t.data,e+9,n.length);var a=new TextDecoder("utf-8").decode(n.rawdata);return n.data=JSON.parse(a),n},raw2Obj_IM:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=i(t,e);if(null==n)return null;var a=new Uint8ClampedArray(t.data,e+9,6);n.camera_id=a[0],n.session_id=a[1],n.width=a[2]<<8|a[3],n.height=a[4]<<8|a[5];n.width,n.height;return n.image=new Uint8ClampedArray(t.data,e+9+6,4*n.width*n.height),n},objbarr2raw:function(t,e,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=null==a?"":JSON.stringify(a),s=r.encode(o),l=s.length,u=i instanceof Uint8Array?i.length:0,d=new Uint8Array(9+l+1+u);d[0]=t.charCodeAt(0),d[1]=t.charCodeAt(1),d[2]=e,d[3]=n>>1,d[4]=255&n;var c=d.length-9;return d[5]=c>>24,d[6]=c>>16,d[7]=c>>8,d[8]=c,0!=l&&d.set(s,9),d[9+l]=0,0!=u&&d.set(i,9+l+1),d},INSPECTION_STATUS:o,map_BPG_Packet2Act:function(t){var e=[];switch(t.type){case"HR":case"SS":break;case"IM":var n=t,i=new ImageData(n.image,n.width);e.push(a.EV_WS_Image_Update(i));break;case"IR":case"RP":var r=t;e.push(a.EV_WS_Inspection_Report(r.data));break;case"DF":var o=t;e.push(a.EV_WS_Define_File_Update(o.data));break;case"FL":var s=t;"binary_processing_group"===s.data.type&&e.push(a.EV_WS_Inspection_Report(s.data));break;case"SG":var l=t;e.push(a.EV_WS_SIG360_Report_Update(l.data));break;default:act=t}return e[0]}}},43:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){var n=t,a=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length-1)+1;if(void 0!==t){for(var i=0;i<a;i++){if(void 0===(n=n[e[i]]))return}return n}}e.Num2Str_padding=function(t,e){return("0000000000000000"+e).substr(-t)},e.round=function(t){var e=1/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),n=Math.round(e);0==n&&(n=e);return Math.round(t*n)/n},e.xstate_GetCurrentMainState=function(t){if("string"==typeof t.value)return{state:t.value,substate:null};var e=t.value,n=Object.keys(e)[0];return{state:n,substate:e[n]}},e.xstate_GetMainState=function(t){if("string"==typeof t.value)return t.value;var e=t.value;return Object.keys(e)[0]},e.xstate_GetSubState=function(t){if("string"==typeof t.value)return;var e=t.value,n=Object.keys(e)[0];return e[n]},e.GetObjElement=r,e.DictConv=function(t,e,n){var a=void 0===n?void 0:r(e,[n,t]);void 0===a&&(a=r(e,["fallback",t]));return a};e.websocket_autoReconnect=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;i(this,t),this.url=void 0,this.wsclose=!1,this.reconnectionCounter=0,this.reconnectGap_ms=1e3,this.connectionTimeout_ms=n,this.connectionTimer=null,this.readyState=void 0,this._connect(e)}return a(t,[{key:"onopen",value:function(t){}},{key:"onmessage",value:function(t){}},{key:"onerror",value:function(t){}},{key:"onclose",value:function(t){}},{key:"onreconnection",value:function(t){}},{key:"onconnectiontimeout",value:function(){}},{key:"setWebsocketCallbackUndefined",value:function(t){t.onopen=t.onmessage=t.onerror=t.onclose=void 0}},{key:"_connect",value:function(t){var e=this;if(!this.wsclose){if(console.log("_connect"),this.url=t,void 0!==this.websocket){this.reconnectionCounter++;var n=this.onreconnection(this.reconnectionCounter);if(void 0!==n&&1!=n)return void(this.websocket=void 0)}void 0!==this.connectionTimer&&clearTimeout(this.connectionTimer),this.connectionTimer=void 0,this.websocket=new WebSocket(t),this.OPEN=this.websocket.OPEN,this.CONNECTING=this.websocket.CONNECTING,this.CLOSED=this.websocket.CLOSED,this.CLOSING=this.websocket.CLOSING,this.connectionTimer=setTimeout(function(){e.close(),e.onconnectiontimeout()},this.connectionTimeout_ms),this.websocket.onopen=function(t){return e.readyState=e.websocket.readyState,clearTimeout(e.connectionTimer),e.connectionTimer=void 0,e.onopen(t)},this.websocket.onmessage=function(t){return e.onmessage(t)},this.websocket.onerror=function(t){return e.readyState=e.websocket.readyState,e.onerror(t)},this.websocket.onclose=function(n){return e.readyState=e.websocket.readyState,setTimeout(function(){return e._connect(t)},e.reconnectGap_ms),e.onclose(n)}}}},{key:"reconnect",value:function(){console.log(this.wsclose,this.websocket),this.wsclose=!1,void 0!==this.websocket?this.websocket.readyState!=this.websocket.OPEN?(setWebsocketCallbackUndefined(this.websocket),this.websocket=void 0,this._connect(this.url)):this.websocket.close():this._connect(this.url)}},{key:"close",value:function(){this.wsclose=!0,void 0!==this.connectionTimer&&clearTimeout(this.connectionTimer),this.connectionTimer=void 0,void 0!==this.websocket&&this.websocket.close()}},{key:"send",value:function(t){return this.websocket.send(t)}}]),t}(),e.websocket_reqTrack=function(){function t(e){var n=this;i(this,t);e.onopen,e.onmessage,e.onerror,e.onclose;this.trackWindow={},e.onopen=function(t){n.readyState=n.websocket.readyState,n.onopen(t)},e.onclose=function(t){n.readyState=n.websocket.readyState,n.onclose(t)},e.onmessage=function(t){n.readyState=n.websocket.readyState;var e=JSON.parse(t.data),a=e.type;if("ACK"==a||"NAK"==a){var i=e.req_id;if(void 0!==i){var r=n.trackWindow[i];void 0!==r?(delete n.trackWindow[i],"ACK"==a?r.resolve(e):r.reject(e)):i=void 0}void 0===i&&n.onTrackError({type:"ACK_TRACK_ERR",data:e})}n.onmessage(t,e)},e.onerror=function(t){n.readyState=n.websocket.readyState,n.onerror(t)},this.websocket=e}return a(t,[{key:"onTrackError",value:function(t){}},{key:"onopen",value:function(t){}},{key:"onmessage",value:function(t){}},{key:"onerror",value:function(t){}},{key:"onclose",value:function(t){}},{key:"close",value:function(){return this.websocket.close()}},{key:"send_obj",value:function(t,e){for(var n=t.req_id;void 0===n||Object.keys(this.trackWindow).reduce(function(t,e){return t||e===n},!1);)n=Math.floor(16777215*Math.random()).toString(16);t.req_id=n,this.websocket.send(JSON.stringify(t,e));var a={time:Date.now(),resolve:void 0,reject:void 0,data:t,rsp:void 0};return this.trackWindow[n]=a,new Promise(function(t,e){a.resolve=t,a.reject=e})}}]),t}()},474:function(t,e,n){"use strict";var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();n(101);_(n(477)),_(n(479));var i=n(98),r=_(n(1)),o=_(n(8)),s=(v(n(81)),_(n(39))),l=(n(39),n(245)),u=v(n(32)),d=(n(43),n(282)),c=_(n(763)),h=_(n(765)),p=_(n(969)),f=_(n(83)),S=v(n(44)),E=_(n(444));_(n(45)),_(n(460)),_(n(52));function v(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function _(t){return t&&t.__esModule?t:{default:t}}S.setLevel("info"),S.getLogger("InspectionEditorLogic").setLevel("INFO"),S.getLogger("UICtrlReducer").setLevel("INFO");var b=Object.assign({},p.default,f.default),y=(0,l.ReduxStoreSetUp)({}),m=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.BPG_WS={reqWindow:[],pgIDCounter:0,onopen:function(t,e){y.dispatch(u.EV_WS_Connected(e))},onmessage:function(t,e){if(S.debug("onMessage:::"),S.debug(t),t.data instanceof ArrayBuffer){var a=s.default.raw2header(t);S.debug("onMessage:["+a.type+"]");var i=a.pgID,r=void 0,o=!1;switch(a.type){case"HR":var l=s.default.raw2obj(t),u=l.data.webUI_resource;void 0===u&&(u="http://hyv.idcircle.me"),u+="/version.jsonp?rand="+function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e6;return Math.floor(Math.random()*(e-t+1))+t}(),(0,E.default)(u,{name:"hyv_version_map"},function(t,e){e.core_info=l.data,n.props.ACT_Version_Map_Update(e)}),n.props.ACT_WS_SEND(n.props.WS_ID,"HR",0,{a:["d"]}),setTimeout(function(){n.props.ACT_WS_SEND(n.props.WS_ID,"LD",0,{filename:"data/default_camera_param.json"})},100);break;case"SS":var d=s.default.raw2obj(t);d.data.start&&(o=!0),r=d;break;case"IM":r=s.default.raw2Obj_IM(t);break;case"IR":case"RP":case"DF":case"FL":case"SG":default:r=s.default.raw2obj(t)}if(-1===i){if(void 0!==r){var c=s.default.map_BPG_Packet2Act(r);void 0!==c&&n.props.DISPATCH(c)}}else{var h=n.BPG_WS.reqWindow[i];void 0!==h?(void 0!==r&&h.pkts.push(r),o||"SS"!=a.type||(delete n.BPG_WS.reqWindow[i],void 0!==h.promiseCBs?h.promiseCBs.resolve(h.pkts):n.props.DISPATCH({type:"ATBundle",ActionThrottle_type:"express",data:h.pkts.map(function(t){return s.default.map_BPG_Packet2Act(t)}).filter(function(t){return void 0!==t}),rawData:h}))):o&&(n.BPG_WS.reqWindow[i]={time:(new Date).getTime(),pkts:[r]})}}},onclose:function(t,e){n.props.DISPATCH(u.EV_WS_Disconnected(t)),setTimeout(function(){n.props.ACT_WS_CONNECT(n.props.WS_ID,"ws://localhost:4090",n.BPG_WS)},3e3)},onerror:function(t,e){},send:function(t,e,a){var i=void 0;t.data instanceof Object&&(i=t.data._PGID_,delete t.data._PGID_),void 0===i&&(i=n.BPG_WS.pgIDCounter,n.BPG_WS.pgIDCounter++,n.BPG_WS.pgIDCounter>1e4&&(n.BPG_WS.pgIDCounter=0)),t.data instanceof Uint8Array?e.websocket.send(s.default.objbarr2raw(t.tl,t.prop,i,null,t.data)):(n.BPG_WS.reqWindow[i]={time:(new Date).getTime(),pkts:[],promiseCBs:a},e.websocket.send(s.default.objbarr2raw(t.tl,t.prop,i,t.data,t.uintArr)))}},setTimeout(function(){return n.props.ACT_WS_CONNECT(n.props.WS_ID,"ws://localhost:4090",n.BPG_WS)},3e3),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default.Component),a(e,null,[{key:"mapDispatchToProps",value:function(t,e){return{ACT_Ctrl_SM_Panel:function(e){return t({type:u.UI_SM_EVENT.Control_SM_Panel,data:e})},ACT_WS_CONNECT:function(e,n,a){return t({type:d.MWWS_EVENT.CONNECT,data:Object.assign({id:e,url:n,binaryType:"arraybuffer"},a)})},ACT_WS_DISCONNECT:function(e){return t({type:d.MWWS_EVENT.DISCONNECT,data:{id:e}})},DISPATCH:function(e){t(e)},DISPATCH_flush:function(e){e.ActionThrottle_type="flush",t(e)},ACT_WS_SEND:function(e,n,a,i,r){return t(u.EV_WS_SEND(e,n,a,i,r))},ACT_Version_Map_Update:function(e){return t(u.EV_UI_Version_Map_Update(e))}}}},{key:"mapStateToProps",value:function(t){return{showSplash:t.UIData.showSplash,showSM_graph:t.UIData.showSM_graph,stateMachine:t.UIData.sm,WS_CH:t.UIData.WS_CH,WS_ID:t.UIData.WS_ID}}},{key:"connect",value:function(){return(0,i.connect)(e.mapStateToProps,e.mapDispatchToProps)(e)}}]),a(e,[{key:"render",value:function(){S.debug("APPMasterX render",this.props);var t=void 0;return t=null,r.default.createElement("div",{className:"HXF"},r.default.createElement(h.default,{key:"APP"}),t,this.props.showSplash?r.default.createElement("div",{key:"LOGO",className:"s HXF WXF overlay veleXY logoFrame white"},r.default.createElement("div",{className:"veleXY width6 height6"},r.default.createElement("img",{className:"height8 LOGOImg ",src:"resource/image/NotiMon.svg"}),r.default.createElement("div",{className:"HX0_5"}),r.default.createElement("div",{className:"s"},r.default.createElement("div",{className:"TitleTextCon showOverFlow HX4"},r.default.createElement("h1",{className:"Title"},"HY"),r.default.createElement("h1",{className:"Title"},"Vision"))))):[])}}]),e}().connect();S.info(b),o.default.render(r.default.createElement(i.Provider,{store:y},r.default.createElement(c.default,{locale:b},r.default.createElement(m,null))),document.getElementById("container"))},477:function(t,e,n){var a=n(478);"string"==typeof a&&(a=[[t.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(132)(a,i);a.locals&&(t.exports=a.locals)},478:function(t,e,n){(t.exports=n(131)(!1)).push([t.i,"html, body {\r\n\theight: 100%;\r\n\twidth: 100%;\r\n\tmargin: 0;\r\n  padding: 0;\r\n\tbackground: none;\r\n}\r\n\r\n* {\r\n\tmargin: 0;\r\n\tpadding: 0;\r\n\tbox-sizing: border-box;\r\n}\r\n.body {\r\n\toverflow: scroll;\r\n\tposition: absolute;\r\n\t-webkit-overflow-scrolling: touch;\r\n}\r\n\r\n\r\n.vbox:before {/*invisible trick*/\r\n\tcontent: '';\r\n\tdisplay: inline-block;\r\n\tvertical-align: middle;\r\n\twidth: 0;\r\n\theight: 100%;\r\n}\r\n.vbox > * {\r\n\tvertical-align: middle;\r\n\tdisplay: inline-block;\r\n}\r\n\r\n.vboxImg > * {\r\n\tvertical-align: middle;\r\n\tdisplay: inline-block;\r\n}\r\n\r\n\r\n.veleY {\r\n\tposition: relative;\r\n\ttop: 50%;\r\n\ttransform: translateY(-50%);\r\n}\r\n\r\n\r\n.veleX {\r\n\tposition: relative;\r\n\tleft: 50%;\r\n\ttransform: translateX(-50%);\r\n}\r\n\r\n.veleXY {\r\n\tposition: relative;\r\n\ttop: 50%;\r\n\tleft: 50%;\r\n\ttransform: translate(-50%,-50%);\r\n}\r\n\r\n.vbox:before {/*invisible trick*/\r\n\tcontent: '';\r\n\tdisplay: inline-block;\r\n\tvertical-align: middle;\r\n\twidth: 0px;\r\n\theight: 100%;\r\n\tbackground: red;\r\n}\r\n.vbox  * {\r\n\tvertical-align: middle;\r\n\tdisplay: inline-block;\r\n}\r\n.cardblock{\r\n\tmargin:10px;\r\n\tbox-shadow:0 0px 10px #000;\r\n}\r\n\r\n.border{\r\n\tborder: 7px solid #FFF;\r\n}\r\n\r\n\r\n\r\n.blockS{\r\n}\r\n\r\n\r\n.blockS .layout {\r\n\tfloat: left;\r\n\tborder-style: none;\r\n\tbox-sizing: border-box;\r\n}\r\n.blockS .layoutRight {\r\n\tfloat: right;\r\n\tborder-style: none;\r\n\tbox-sizing: border-box;\r\n}\r\n.blockS .s {\r\n\tfloat: left;\r\n\tborder-style: none;\r\n\ttransition: background ease-in 0.2s, color ease-in 0.2s;\r\n\twidth: 100%;\r\n\theight: 50px;\r\n\tfont-family: 'Open Sans', sans-serif;\r\n\ttext-align: center;\r\n\tfont-size: 0.4cm;\r\n\tfont-weight:bold;\r\n\tbox-sizing: border-box;\r\n\tcolor:#FFF;\r\n\toverflow:hidden;\r\n}\r\n\r\n\r\n.blockS .scroll {\r\n\toverflow: auto;\r\n\t-webkit-overflow-scrolling: touch;\r\n}\r\n\r\n\r\n.blockS .textAlignLeft {\r\n  text-align: left;\r\n}\r\n\r\n\r\n\r\n.blockS .floatRight {\r\n  float: right;\r\n}\r\n\r\n\r\n.smallFontSize{\r\n\tfont-size: 0.3cm;\r\n}\r\n\r\n.blockS .noAnim {\r\n\ttransition: none;\r\n}\r\n\r\n\r\n.blockS .showOverFlow,.blockS .dropDown{\r\n  overflow: visible;\r\n}\r\n.blockS .dropdownBox,.blockS .dropDownContent{\r\n  position: relative;\r\n}\r\n\r\n.blockS .HCenter{\r\nmargin:auto; float: none;\r\n}\r\n\r\n\r\n.blockS .overlayCon {\r\n\tposition: relative;\r\n\toverflow:hidden;\r\n}\r\n.blockS .overlay {\r\n\tposition: absolute;\r\n\tbackground: none;\r\n}\r\n.blockS .overlaybtm {\r\n\r\n\tposition: absolute;\r\n\tbackground: none;\r\n\tbottom:0;\r\n}\r\n\r\n.blockS .overlayright {\r\n\r\n\tposition: absolute;\r\n\tbackground: none;\r\n\tright:0;\r\n}\r\n\r\n.blockS .HXA {\r\n\r\n  height: auto;\r\n  max-height: 100%;\r\n}\r\n.blockS .WXA {\r\n\r\n  width: auto;\r\n}\r\n.blockS .HX0 {\r\n\r\n\theight: 0px;\r\n}\r\n.blockS .HX0_1 {\r\n\r\n\theight: 5px;\r\n}\r\n.blockS .HX0_5 {\r\n\r\n\theight: 25px;\r\n}\r\n.blockS .HX1_5 {\r\n\r\n\theight: 75px;\r\n}\r\n.blockS .HX2 {\r\n\r\n\theight: 100px;\r\n}\r\n.blockS .HX3 {\r\n\r\n\theight: 150px;\r\n}\r\n\r\n.blockS .HX4 {\r\n\r\n\theight:200px;\r\n}\r\n.blockS .HX5 {\r\n\r\n\theight:250px;\r\n}\r\n.blockS .HX6 {\r\n\r\n\theight:300px;\r\n}\r\n.blockS .HX7 {\r\n\r\n\theight:350px;\r\n}\r\n.blockS .HXF{\r\n\r\n\theight:100%;\r\n}\r\n.cl {\r\n\r\n\theight: 10px;\r\n}\r\n.blockS .input{\r\n\tbox-shadow: inset 0 -5px 0 black, inset 2px 0px 0 black;\r\n\r\n\tpadding-left: 5px;\r\n\ttext-align: left;\r\n\tbackground: #FAFAFA;\r\n\tcolor:#333;\r\n\tborder-radius: 0px;\r\n\tappearance: none;\r\n}\r\n\r\n.blockS .padding\r\n{\r\n    padding:0.3em;\r\n}\r\n\r\n.textarea {\r\n\toverflow: auto;\r\n\tborder: solid 5px #222;\r\n\tbackground: #FFF;\r\n\ttext-align: left;\r\n\tcolor:#333;\r\n}\r\n\r\n.blockS .width0 {\r\n\twidth: 0%;\r\n}\r\n.blockS .width1 {\r\n\twidth: 8.333%;\r\n}\r\n.blockS .width2 {\r\n\twidth: 16.666%;\r\n}\r\n.blockS .width3 {\r\n\twidth: 25%;\r\n}\r\n.blockS .width4 {\r\n\twidth: 33.333%;\r\n}\r\n.blockS .width5 {\r\n\twidth: 41.666%;\r\n}\r\n.blockS .width6 {\r\n\twidth: 50%;\r\n}\r\n.blockS .width7 {\r\n\twidth: 58.333%;\r\n}\r\n.blockS .width8 {\r\n\twidth: 66.666%;\r\n}\r\n.blockS .width9 {\r\n\twidth: 75%;\r\n}\r\n.blockS .width10 {\r\n\twidth: 83.333%;\r\n}\r\n.blockS .width11 {\r\n\twidth: 91.6666%;\r\n}\r\n\r\n.blockS .width005 {\r\n\twidth: 4.1666%;\r\n}\r\n.blockS .width12 {\r\n\twidth: 100%;\r\n}\r\n.blockS .WXF {\r\n\twidth: 100%;\r\n}\r\n\r\n.blockS .widthR{\r\n\r\n\twidth: unset;\r\n\tfloat:unset;\r\n}\r\n.blockS .height0 {\r\n\theight: 0%;\r\n\tdisplay: none;\r\n}\r\n.blockS .height1 {\r\n\theight: 8.333%;\r\n}\r\n.blockS .height2 {\r\n\theight: 16.666%;\r\n}\r\n.blockS .height3 {\r\n\theight: 25%;\r\n}\r\n.blockS .height4 {\r\n\theight: 33.333%;\r\n}\r\n.blockS .height5 {\r\n\theight: 41.666%;\r\n}\r\n.blockS .height6 {\r\n\theight: 50%;\r\n}\r\n.blockS .height7 {\r\n\theight: 58.333%;\r\n}\r\n.blockS .height8 {\r\n\theight: 66.666%;\r\n}\r\n.blockS .height9 {\r\n\theight: 75%;\r\n}\r\n.blockS .height10 {\r\n\theight: 83.333%;\r\n}\r\n.blockS .height11 {\r\n\theight: 91.6666%;\r\n}\r\n\r\n.blockS .height115 {\r\n\theight: 95.8333%;\r\n}\r\n.blockS .height005 {\r\n\theight: 4.1666%;\r\n}\r\n.blockS .height12 {\r\n\theight: 100%;\r\n}\r\n\r\n\r\n@media screen and (max-width: 800px) {\r\n\t.blockS .widthF800 {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.blockS .widthN800 {\r\n\t\tdisplay: none;\r\n\t}\r\n}\r\n\r\n@media screen and (max-width: 500px) {\r\n\t.blockS .widthF500 {\r\n\t\twidth: 100%;\r\n\t}\r\n\t.blockS .widthN500 {\r\n\t\tdisplay: none;\r\n\t}\r\n}\r\n.blockS .button {\r\n    outline:none;\r\n\tborder-bottom : 5px solid #111;\r\n\tborder-right : 3px solid #111;\r\n\r\n\tbackground: #333;\r\n}\r\n\r\n\r\n\r\n.blockS .button:active {\r\n\tborder-top: 5px solid #111;\r\n\tborder-bottom : 0;\r\n\tborder-right :0;\r\n\r\n\tbackground: #333;\r\n\tcolor:#eee;\r\n}\r\n\r\n\r\n.blockS *:disabled {\r\n\tbackground: #888;\r\n}\r\n\r\n.blockS .lgray {\r\n\r\n\tbackground: #999;\r\n}\r\n.blockS .lred {\r\n\r\n\tbackground: #ECC;\r\n}\r\n.blockS .lgreen {\r\n\r\n\tbackground: #CEC;\r\n}\r\n.blockS .lblue{\r\n\r\n\tbackground: #CCE;\r\n}\r\n.blockS .deepred {\r\n\r\n\tbackground: #F00;\r\n}\r\n\r\n.blockS .deepgreen{\r\n\r\n\tbackground: #0F0;\r\n}\r\n.blockS .red {\r\n\r\n\tbackground: #422;\r\n}\r\n\r\n.blockS .green {\r\n\tbackground: #242;\r\n}\r\n\r\n.blockS .blue {\r\n\r\n\tbackground: #224;\r\n}\r\n\r\n.blockS .black {\r\n\r\n  background: #000;\r\n}\r\n.blockS .white {\r\n  background: #FFF;\r\n}\r\n.blockS .blackText {\r\n\tcolor: #444;\r\n}\r\n.blockS .nocolor {\r\n\r\n\tbackground: none;\r\n}\r\n",""])},479:function(t,e,n){var a=n(480);"string"==typeof a&&(a=[[t.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(132)(a,i);a.locals&&(t.exports=a.locals)},480:function(t,e,n){var a=n(481);(t.exports=n(131)(!1)).push([t.i,"\r\n.blockS .deepblue{\r\n\r\n  background: #0081ee;\r\n}\r\n\r\n/*Start of ANT COlor*/\r\n.iconButtonSize > svg{ padding-left: 2px; width: 30px;height: 100%;}\r\n.iconTextPadding {padding-left: 5px;}\r\n.blockS .palatte-blue-1{background:#e6f7ff}\r\n.blockS .palatte-blue-2{background:#bae7ff}\r\n.blockS .palatte-blue-3{background:#91d5ff}.blockS .palatte-blue-4{background:#69c0ff}.blockS .palatte-blue-5{background:#40a9ff}.blockS .palatte-blue-6{background:#1890ff}.blockS .palatte-blue-7{background:#096dd9}.blockS .palatte-blue-8{background:#0050b3}.blockS .palatte-blue-9{background:#003a8c}.blockS .palatte-blue-10{background:#002766}.blockS .palatte-purple-1{background:#f9f0ff}.blockS .palatte-purple-2{background:#efdbff}.blockS .palatte-purple-3{background:#d3adf7}.blockS .palatte-purple-4{background:#b37feb}.blockS .palatte-purple-5{background:#9254de}.blockS .palatte-purple-6{background:#722ed1}.blockS .palatte-purple-7{background:#531dab}.blockS .palatte-purple-8{background:#391085}.blockS .palatte-purple-9{background:#22075e}.blockS .palatte-purple-10{background:#120338}.blockS .palatte-cyan-1{background:#e6fffb}.blockS .palatte-cyan-2{background:#b5f5ec}.blockS .palatte-cyan-3{background:#87e8de}.blockS .palatte-cyan-4{background:#5cdbd3}.blockS .palatte-cyan-5{background:#36cfc9}.blockS .palatte-cyan-6{background:#13c2c2}.blockS .palatte-cyan-7{background:#08979c}.blockS .palatte-cyan-8{background:#006d75}.blockS .palatte-cyan-9{background:#00474f}.blockS .palatte-cyan-10{background:#002329}.blockS .palatte-green-1{background:#f6ffed}.blockS .palatte-green-2{background:#d9f7be}.blockS .palatte-green-3{background:#b7eb8f}.blockS .palatte-green-4{background:#95de64}.blockS .palatte-green-5{background:#73d13d}.blockS .palatte-green-6{background:#52c41a}.blockS .palatte-green-7{background:#389e0d}.blockS .palatte-green-8{background:#237804}.blockS .palatte-green-9{background:#135200}.blockS .palatte-green-10{background:#092b00}.blockS .palatte-magenta-1{background:#fff0f6}.blockS .palatte-magenta-2{background:#ffd6e7}.blockS .palatte-magenta-3{background:#ffadd2}.blockS .palatte-magenta-4{background:#ff85c0}.blockS .palatte-magenta-5{background:#f759ab}.blockS .palatte-magenta-6{background:#eb2f96}.blockS .palatte-magenta-7{background:#c41d7f}.blockS .palatte-magenta-8{background:#9e1068}.blockS .palatte-magenta-9{background:#780650}.blockS .palatte-magenta-10{background:#520339}.blockS .palatte-red-1{background:#fff1f0}.blockS .palatte-red-2{background:#ffccc7}.blockS .palatte-red-3{background:#ffa39e}.blockS .palatte-red-4{background:#ff7875}.blockS .palatte-red-5{background:#ff4d4f}.blockS .palatte-red-6{background:#f5222d}.blockS .palatte-red-7{background:#cf1322}.blockS .palatte-red-8{background:#a8071a}.blockS .palatte-red-9{background:#820014}.blockS .palatte-red-10{background:#5c0011}.blockS .palatte-volcano-1{background:#fff2e8}.blockS .palatte-volcano-2{background:#ffd8bf}.blockS .palatte-volcano-3{background:#ffbb96}.blockS .palatte-volcano-4{background:#ff9c6e}.blockS .palatte-volcano-5{background:#ff7a45}.blockS .palatte-volcano-6{background:#fa541c}.blockS .palatte-volcano-7{background:#d4380d}.blockS .palatte-volcano-8{background:#ad2102}.blockS .palatte-volcano-9{background:#871400}.blockS .palatte-volcano-10{background:#610b00}.blockS .palatte-orange-1{background:#fff7e6}.blockS .palatte-orange-2{background:#ffe7ba}.blockS .palatte-orange-3{background:#ffd591}.blockS .palatte-orange-4{background:#ffc069}.blockS .palatte-orange-5{background:#ffa940}.blockS .palatte-orange-6{background:#fa8c16}.blockS .palatte-orange-7{background:#d46b08}.blockS .palatte-orange-8{background:#ad4e00}.blockS .palatte-orange-9{background:#873800}.blockS .palatte-orange-10{background:#612500}.blockS .palatte-gold-1{background:#fffbe6}.blockS .palatte-gold-2{background:#fff1b8}.blockS .palatte-gold-3{background:#ffe58f}.blockS .palatte-gold-4{background:#ffd666}.blockS .palatte-gold-5{background:#ffc53d}.blockS .palatte-gold-6{background:#faad14}.blockS .palatte-gold-7{background:#d48806}.blockS .palatte-gold-8{background:#ad6800}.blockS .palatte-gold-9{background:#874d00}.blockS .palatte-gold-10{background:#613400}.blockS .palatte-yellow-1{background:#feffe6}.blockS .palatte-yellow-2{background:#ffffb8}.blockS .palatte-yellow-3{background:#fffb8f}.blockS .palatte-yellow-4{background:#fff566}.blockS .palatte-yellow-5{background:#ffec3d}.blockS .palatte-yellow-6{background:#fadb14}.blockS .palatte-yellow-7{background:#d4b106}.blockS .palatte-yellow-8{background:#ad8b00}.blockS .palatte-yellow-9{background:#876800}.blockS .palatte-yellow-10{background:#614700}.blockS .palatte-lime-1{background:#fcffe6}.blockS .palatte-lime-2{background:#f4ffb8}.blockS .palatte-lime-3{background:#eaff8f}.blockS .palatte-lime-4{background:#d3f261}.blockS .palatte-lime-5{background:#bae637}.blockS .palatte-lime-6{background:#a0d911}.blockS .palatte-lime-7{background:#7cb305}.blockS .palatte-lime-8{background:#5b8c00}.blockS .palatte-lime-9{background:#3f6600}.blockS .palatte-lime-10{background:#254000}.blockS .palatte-geekblue-1{background:#f0f5ff}.blockS .palatte-geekblue-2{background:#d6e4ff}.blockS .palatte-geekblue-3{background:#adc6ff}.blockS .palatte-geekblue-4{background:#85a5ff}.blockS .palatte-geekblue-5{background:#597ef7}.blockS .palatte-geekblue-6{background:#2f54eb}.blockS .palatte-geekblue-7{background:#1d39c4}.blockS .palatte-geekblue-8{background:#10239e}.blockS .palatte-geekblue-9{background:#061178}.blockS .palatte-geekblue-10{background:#030852}.blockS .palatte-grey-1{background:#fff}.blockS .palatte-grey-2{background:#fafafa}.blockS .palatte-grey-3{background:#f5f5f5}.blockS .palatte-grey-4{background:#e8e8e8}.blockS .palatte-grey-5{background:#d9d9d9}.blockS .palatte-grey-6{background:#bfbfbf}.blockS .palatte-grey-7{background:#8c8c8c}.blockS .palatte-grey-8{background:#595959}.blockS .palatte-grey-9{background:#262626}.blockS .palatte-grey-10{background:#000}\r\n/*End of ANT COlor*/\r\n\r\nbody.sp_Style.blockS  {\r\n  overflow: hidden;\r\n  padding: 15px;\r\n  background: #EAEBEE;\r\n}\r\n.sp_Style.blockS *.shadow1 {\r\n  box-shadow:5px 10px 13px rgba(10,10,10,0.3);\r\n}\r\n\r\n.sp_Style.blockS .radarScanPanel {\r\n  box-shadow: inset 0px 0px 8px rgba(0,0,0,0.8);\r\n  border-radius: 50%;\r\n}\r\n.sp_Style.blockS .radarScanWave {\r\n  border-radius: 50%;\r\n  border: 5px solid gray;\r\n  animation: scanWave 5s infinite;\r\n}\r\n\r\n@keyframes scanWave{\r\n  0%,40%{\r\n    transform: translate3d(-50%,-50%,0) scale(0.05);\r\n    opacity: 0.4;\r\n  }\r\n  100%{\r\n    transform: translate3d(-50%,-50%,0) scale(0.8);\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\n\r\n\r\n.sp_Style.blockS .SMGraph{\r\n  top: 50%;\r\n  left: 0px;\r\n  opacity: 1;\r\n  transition:opacity 0.5s, transform ease-out 0.3s;\r\n  transform: translate(-0%,-50%);\r\n}\r\n.sp_Style.blockS .SMGraph.hide{\r\n  opacity: 0.1;\r\n  transform: translate(-90%,-50%);\r\n}\r\n\r\n\r\n\r\n.sp_Style.blockS .MenuAnim{\r\n  transition:opacity 0.2s, transform 0.3s;\r\n  background-color: rgba(0,0,0,0.1);\r\n  width:200px;\r\n  transition-timing-function: cubic-bezier(.05,.88,.6,.87);\r\n  transform-origin: -20% 50%;\r\n  perspective: 200px;\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-enter{\r\n  transform: rotateY(-10deg);\r\n  opacity: 0;\r\n\r\n  z-index: 2;\r\n\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-enter.fadeIn-enter-active{\r\n  opacity: 1;\r\n  transform: rotateY(00deg);\r\n  z-index: 2;\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-leave{\r\n  opacity: 1;\r\n  z-index: 1;\r\n}\r\n.sp_Style.blockS .MenuAnim.fadeIn-leave.fadeIn-leave-active{\r\n  opacity: 0;\r\n  z-index: 1;\r\n}\r\n\r\n.sp_Style.blockS{\r\n  perspective:300px;\r\n  -webkit-perspective: 300px;\r\n}\r\n\r\n@font-face {\r\n    font-family: 'roboto_med';\r\n    src: url("+a(n(482))+");\r\n}\r\n\r\n\r\n.sp_Style.blockS .robotoFont  {\r\n  font-family: 'roboto_med';\r\n  color: #000;\r\n}\r\n\r\n.sp_Style.blockS .logoFrame .Title{\r\n  font-family: 'roboto_med';\r\n  color: #000;\r\n  font-size: 30pt;\r\n}\r\n\r\n.sp_Style.blockS .logoFrame .TitleTextCon{\r\n  transform: translate(0%,-50%);\r\n}\r\n.sp_Style.blockS .logoFrame-leave-active .TitleTextCon{\r\n  animation-delay: 0.2s;\r\n  animation-duration: 0.2s;\r\n  animation-name: LOGOTitleAnimation;\r\n  animation-fill-mode: forwards;\r\n  animation-timing-function: ease-in-out;\r\n}\r\n@keyframes LOGOTitleAnimation {\r\n  100% {\r\n      transform: none;\r\n  }\r\n}\r\n\r\n.sp_Style.blockS .logoFrame .LOGOImg{\r\n  transform-origin: 50% 50%;\r\n  animation-duration: 0.4s;\r\n  animation-timing-function: ease-in-out;\r\n  -webkit-filter: grayscale(100%);\r\n  transform: rotateZ(-360deg);\r\n}\r\n\r\n.sp_Style.blockS .logoFrame-leave-active .LOGOImg{\r\n  animation-delay: 0s;\r\n  animation-name: LOGOImgRotateAnimation;\r\n  animation-fill-mode: forwards;\r\n}\r\n\r\n@keyframes LOGOImgRotateAnimation {\r\n\r\n  50%  {\r\n  }\r\n\r\n  100% {\r\n      transform: none;\r\n      -webkit-filter: none;\r\n  }\r\n}\r\n\r\n\r\n\r\n.sp_Style.blockS .logoFrame{\r\n  transform-origin: 50% -120%;\r\n}\r\n.sp_Style.blockS .logoFrame-leave-active{\r\n  animation-delay: 0.7s;\r\n  animation-name: logoFrameAnimation;\r\n  animation-duration: 1.0s;\r\n  animation-timing-function: ease-in-out;\r\n}\r\n@keyframes logoFrameAnimation {\r\n\r\n  15%  {\r\n    transform: translate(-50%,-50%);\r\n  }\r\n  40%  {\r\n    transform: rotateX(2deg) translate(-50%,-50%) ;\r\n  }\r\n  100% {\r\n    transform: rotateX(0deg) translate(-50%,-100%) ;\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n.sp_Style.blockS .scroll::-webkit-scrollbar {\r\n\twidth: 5px;\r\n\theight: 0;\r\n\tbackground-color: #cccccc;\r\n}\r\n.sp_Style.blockS .scroll::-webkit-scrollbar-thumb {\r\n\tbackground-color: #555;\r\n}\r\n.sp_Style.blockS .scroll::-webkit-scrollbar-thumb:hover {\r\n\tborder: 1px solid #333333;\r\n}\r\n.sp_Style.blockS .scroll::-webkit-scrollbar-thumb:active {\r\n\tborder: 1px solid #333333;\r\n}\r\n\r\n.sp_Style.blockS *:not(.nblockS *){\r\n\tfont-size: 0.6cm;\r\n}\r\n\r\n.sp_Style.blockS .sFontSize{\r\n\tfont-size: 0.4cm;\r\n}\r\n.sp_Style.blockS .mFontSize{\r\n\tfont-size: 0.6cm;\r\n}\r\n.sp_Style.blockS .lFontSize{\r\n\tfont-size: 0.7cm;\r\n}\r\n\r\n\r\n.sp_Style.blockS button.sidebar{\r\n  border-bottom : 2px solid #EEE;\r\n  border-right : 4px solid #111;\r\n  background: white;\r\n  color: white;\r\n}\r\n\r\n.sp_Style.blockS button.sidebar:hover {\r\n  background: #222;\r\n}\r\n\r\n.sp_Style.blockS button.sidebar >p {\r\n  padding: 15px;\r\n  text-align: left;\r\n  color: #333;\r\n}\r\n\r\n\r\n.sp_Style.blockS button.sidebar >img {\r\n  width:20px;\r\n  margin-left: 8px;\r\n}\r\n\r\n.sp_Style.blockS button.sidebar:hover>p {\r\n  text-align: center;\r\n  color: white;\r\n\r\n}\r\n\r\n.sp_Style.blockS .pokemonSpriteCon>* {\r\n\r\n\ttransition: transform ease-out 0.5s;\r\n}\r\n\r\n.sp_Style.blockS .sysAPPBtn{\r\n\r\n\ttransition: transform ease-out 0.5s;\r\n}\r\n",""])},482:function(t,e,n){t.exports=n.p+"fe13e4170719c2fc586501e777bde143.ttf"},671:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},i=n(32),r=E(n(74)),o=n(43),s=n(174),l=n(39),u=S(n(672)),d=E(n(44)),c=S(n(82)),h=(n(673),S(n(674))),p=S(n(247)),f=S(n(759));function S(t){return t&&t.__esModule?t:{default:t}}function E(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}var v=d.getLogger("UICtrlReducer"),_=i.UI_SM_STATES,b=i.UI_SM_EVENT;function y(t){var e={inspReport:void 0,reportStatisticState:{trackingWindow:[],historyReport:[],newAddedReport:[],statisticValue:void 0},sig360info:[],img:null,DefFileName:"",DefFileHash:"",list:[],inherentShapeList:[],edit_tar_info:null,edit_tar_ele_trace:null,edit_tar_ele_cand:null,mouseLocation:void 0};t.edit_info=Object.assign({},t.edit_info,e),t.edit_info._obj.reset(),t.edit_info.edit_tar_info=null,t.edit_info.list=t.edit_info._obj.shapeList,t.edit_info.inherentShapeList=t.edit_info._obj.UpdateInherentShapeList()}function m(t,e){if(t.state_count++,"ev_state_update"==e.type&&(t.c_state=e.data.c_state,t.p_state=e.data.p_state,t.sm=e.data.sm,t.state_count=0,v.info(t.p_state.value," + ",e.data.action," > ",t.c_state.value)),e.type===b.Control_SM_Panel)return t.showSM_graph=e.data,t;switch(e.type){case b.Connected:return t.WS_CH=e.data,v.info("Connected",t.WS_CH),t;case b.Version_Map_Update:v.info("Version_Map_Update",e.data);var n=e.data;n.webUI_info=u.default;var s=n.core_info;n.recommend_ver={};var d=s.version;void 0===d&&(d="0.0.0");var S=n.core2wui[d];if(void 0!==S&&void 0!==S.ver){var E=S.ver,m="http://hyv.idcircle.me";void 0!==s.webUI_resource&&(m=s.webUI_resource);var g=f.default.clean(u.default.version),k=E.map(function(t){return f.default.clean(t)}).reduce(function(t,e){return f.default.gt(t,e)?t:e});f.default.gt(k,g)&&(n.recommend_info={versions:E,url:m+"/"+E[E.length-1]})}return t=a({},t,{version_map_info:n});case b.Disonnected:return t.WS_CH=void 0,t;case b.Control_SM_Panel:return t.showSM_graph=e.data,t}switch(t.c_state.value){case _.SPLASH:return t.showSplash=!0,t}var T=(0,o.xstate_GetCurrentMainState)(t.c_state),C=T.substate;function A(t,e){return t.measureList.forEach(function(t){var n=e.judgeReports.find(function(e){return e.id==t.id}),a=t.statistic;if(void 0===n)return a.count_stat.NA++,void v.error("The incoming inspection report doesn't match the defFile");if(n.status==l.INSPECTION_STATUS.NA)return a.count_stat.NA++,void v.error("The measure["+n.name+"] is NA");var i=n.value;void 0===a.count_stat[n.detailStatus]?a.count_stat[n.detailStatus]=0:a.count_stat[n.detailStatus]++,a.count++,a.sum+=i,a.mean=a.sum/a.count,a.sqSum+=i*i,a.variance=a.sqSum/a.count-a.mean*a.mean,a.sigma=Math.sqrt(a.variance),a.CPU=(t.USL-a.mean)/(3*a.sigma),a.CPL=(a.mean-t.LSL)/(3*a.sigma),a.CP=Math.min(a.CPU,a.CPL),a.CK=(a.mean-t.value)/((t.USL-t.LSL)/2),a.CPK=a.CP*(1-Math.abs(a.CK)),a.histogram=function(t,e){if(e<t.xmin)return t.histo[0]++,t;if(e>t.xmax)return t.histo[t.histo.length-1]++,t;var n=t.histo.length-2,a=Math.floor(n*(e-t.xmin)/(t.xmax-t.xmin));return a>=n&&(a=n-1),t.histo[a+1]++,t}(a.histogram,i)}),t}switch(T.state){case _.SPLASH:return t.showSplash=!0,t;case _.MAIN:case _.DEFCONF_MODE:case _.INSP_MODE:switch(t.showSplash=!1,e.type){case b.Image_Update:t.edit_info=a({},t.edit_info,{img:e.data});break;case b.Def_Model_Path_Update:t.edit_info=a({},t.edit_info,{defModelPath:e.data});break;case i.UI_SM_EVENT.Canvas_Mouse_Location:t.edit_info.mouseLocation=e.data;break;case b.Inspection_Report:!function(t,e){var n=e.date.getTime(),r=t.edit_info._obj.cameraParam,o=void 0;o=void 0===r?void 0:r.mmpb2b/r.ppb2b;var s=e.data.subFeatureDefSha1;"binary_processing_group"===e.data.type&&e.data.reports.forEach(function(r){switch(r.type){case"sig360_extractor":case"sig360_circle_line":t.edit_info=a({},t.edit_info),t.edit_info._obj.SetInspectionReport(r);var u=t.edit_info._obj.inspreport;if(t.edit_info.inspReport=u,u.time_ms=n,void 0===o)break;var d=t.edit_info.reportStatisticState;if(d.newAddedReport=[],d.trackingWindow.forEach(function(t){t.isCurObj=!1}),d.trackingWindow=d.trackingWindow.filter(function(t){return n-t.time_ms<3e3||(d.statisticValue=A(d.statisticValue,t),d.historyReport.push(t),d.newAddedReport.push(t),!1)}),void 0===u.reports)break;u.reports.forEach(function(e){var a=d.trackingWindow.reduce(function(t,n){if(void 0!==t)return t;if(e.isFlipped!=n.isFlipped)return t;var a=e.area/n.area;if(a>1.2||a<1/1.2)return t;var i=e.rotate-n.rotate;return i>180&&(i-=360),i>5||i<-5?t:Math.hypot(e.cx-n.cx,e.cy-n.cy)>o/2?t:n},void 0);function r(t,e,n){return t+=1/(n+1)*(e-t)}if(void 0!==a)a.area=r(a.area,e.area,a.repeatTime),a.cx=r(a.cx,e.cx,a.repeatTime),a.cy=r(a.cy,e.cy,a.repeatTime),a.judgeReports.forEach(function(n){var r=n.id,o=e.judgeReports.find(function(t){return t.id==r});if(void 0!==o){if(o.status==l.INSPECTION_STATUS.NA||n==l.INSPECTION_STATUS.NA)return n.status=l.INSPECTION_STATUS.NA,void(n.value=NaN);var s=o.value-n.value;n.subtype===i.SHAPE_TYPE.measure_subtype.angle&&s>180&&(s-=360),n.value+=1/(a.repeatTime+1)*s;var u=t.edit_info.list.find(function(t){return t.id==r});void 0!==u&&(n.value!=n.value?n.status=l.INSPECTION_STATUS.NA:n.value<u.USL&&n.value>u.LSL?n.status=l.INSPECTION_STATUS.SUCCESS:n.status=l.INSPECTION_STATUS.FAILURE)}}),a.detectedLines.forEach(function(t){var n=t.id,i=e.detectedLines.find(function(t){return t.id==n});void 0!==i&&(t.cx=r(t.cx,i.cx,a.repeatTime),t.cy=r(t.cy,i.cy,a.repeatTime),t.vx=r(t.vx,i.vx,a.repeatTime),t.vy=r(t.vy,i.vy,a.repeatTime))}),a.detectedCircles.forEach(function(t){var n=t.id,i=e.detectedCircles.find(function(t){return t.id==n});void 0!==i&&(t.x=r(t.x,i.x,a.repeatTime),t.y=r(t.y,i.y,a.repeatTime),t.r=r(t.r,i.r,a.repeatTime),t.s=r(t.s,i.s,a.repeatTime))}),a.searchPoints.forEach(function(t){var n=t.id,i=e.searchPoints.find(function(t){return t.id==n});void 0!==i&&(t.x=r(t.x,i.x,a.repeatTime),t.y=r(t.y,i.y,a.repeatTime))}),a.time_ms=n,a.repeatTime+=1,a.isCurObj=!0;else{var u=(0,c.default)(e);u.time_ms=n,u.add_time_ms=n,u.subFeatureDefSha1=s,u.repeatTime=0,u.isCurObj=!0,d.trackingWindow.push(u)}}),d.trackingWindow=d.trackingWindow.filter(function(t){return t.isCurObj||t.repeatTime>2});break;case"camera_calibration":void 0!==r.error&&0==r.error?(t.edit_info._obj.SetCameraParamInfo(r),t.edit_info.camera_calibration_report=e.data):(t.edit_info._obj.SetCameraParamInfo(void 0),t.edit_info.camera_calibration_report=void 0)}})}(t,e);break;case b.Define_File_Update:var N=e.data;if("binary_processing_group"===N.type){var w=!1,P=p.default.digest(N.featureSet,"sha1","hex");if(void 0!==N.featureSet_sha1)N.featureSet_sha1!==P&&(w=!0);if(t.edit_info.DefFileHash==P)break;if(y(t),w){t.edit_info.DefFileHash=void 0;break}if(t.edit_info.DefFileHash=P,void 0===N.name){var I=new Date,O=(0,h.default)(I,"yyyymmdd_HHMMss");t.edit_info.DefFileName="Sample_"+O}else t.edit_info.DefFileName=N.name;N.featureSet.forEach(function(n){switch(n.type){case"sig360_extractor":case"sig360_circle_line":t.edit_info=Object.assign({},t.edit_info),t.edit_info._obj.SetDefInfo(n);var a=t.edit_info.reportStatisticState;t.edit_info.edit_tar_info=null,t.edit_info.list=t.edit_info._obj.shapeList,t.edit_info.inherentShapeList=t.edit_info._obj.UpdateInherentShapeList(),v.info(t.edit_info.inherentShapeList);var r=(0,c.default)(t.edit_info.list.filter(function(t){return t.type==i.SHAPE_TYPE.measure})).map(function(t){return console.log(t),t.statistic={count_stat:{NA:0,UOK:0,LOK:0,UCNG:0,LCNG:0,USNG:0,LSNG:0},histogram:{xmin:1.2*(t.LSL-t.value)+t.value,xmax:1.2*(t.USL-t.value)+t.value,histo:new Array(502).fill(0)},count:0,sum:0,sqSum:0,mean:0,variance:0,sigma:0,CP:0,CK:0,CPU:0,CPL:0,CPK:0},t});a.statisticValue={measureList:r},v.info(a.statisticValue);break;case"camera_calibration":v.error(e)}})}break;case b.SIG360_Report_Update:case b.SIG360_Extraction:t.edit_info=Object.assign({},t.edit_info),console.log(e.data),t.edit_info._obj.Setsig360info(e.data),t.edit_info.sig360info=t.edit_info._obj.sig360info;break;case r.EVENT.Shape_List_Update:t.edit_info._obj.SetShapeList(e.data),t.edit_info.edit_tar_info=null,t.edit_info.list=t.edit_info._obj.shapeList,t.edit_info.inherentShapeList=t.edit_info._obj.UpdateInherentShapeList();break;case r.EVENT.Edit_Tar_Update:t.edit_info.edit_tar_info=null==e.data?null:Object.assign({},e.data),t.edit_info.edit_tar_ele_trace=null,t.edit_info.edit_tar_ele_cand=null;break;case r.EVENT.Edit_Tar_Ele_Trace_Update:t.edit_info.edit_tar_ele_trace=null==e.data?null:e.data.slice();break;case b.EC_Save_Def_Config:if(null==t.WS_CH)break;break;case r.EVENT.Edit_Tar_Ele_Cand_Update:t.edit_info.edit_tar_ele_cand=null==e.data?null:e.data instanceof Object?Object.assign({},e.data):e.data,v.info("DEFCONF_MODE_Edit_Tar_Ele_Cand_Update",t.edit_info.edit_tar_ele_cand);break;case r.EVENT.DefFileName_Update:t.edit_info=Object.assign({},t.edit_info,{DefFileName:e.data});break;case r.EVENT.Shape_Set:var x=e.data.id;v.info("newID:",x);var D=t.edit_info._obj.SetShape(e.data.shape,x);if(t.edit_info.list=t.edit_info._obj.shapeList,t.edit_info.inherentShapeList=t.edit_info._obj.UpdateInherentShapeList(),void 0!==x){var M=t.edit_info._obj.FindShapeIdx(x);v.info(M),t.edit_info.edit_tar_info=void 0===M?null:(0,c.default)(t.edit_info.list[M])}else t.edit_info.edit_tar_info=(0,c.default)(D);t.edit_info=Object.assign({},t.edit_info)}switch(C){case i.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:if(null==t.edit_info.edit_tar_info){t.edit_info.edit_tar_ele_trace=null,t.edit_info.edit_tar_ele_cand=null;break}if(null!=t.edit_info.edit_tar_ele_trace&&null!=t.edit_info.edit_tar_ele_cand){var U=t.edit_info.edit_tar_ele_trace,L=(0,o.GetObjElement)(t.edit_info.edit_tar_info,U,U.length-2),F=t.edit_info.edit_tar_ele_cand;v.info("GetObjElement",L,U[U.length-1]),L[U[U.length-1]]={id:F.shape.id,type:F.shape.type},v.info(L,t.edit_info.edit_tar_info),t.edit_info.edit_tar_info=Object.assign({},t.edit_info.edit_tar_info),t.edit_info.edit_tar_ele_trace=null,t.edit_info.edit_tar_ele_cand=null}break;case i.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:if(null==t.edit_info.edit_tar_info){t.edit_info.edit_tar_info={type:i.SHAPE_TYPE.aux_point,ref:[{},{}]},t.edit_info.edit_tar_ele_trace=null,t.edit_info.edit_tar_ele_cand=null;break}if(v.info(t.edit_info.edit_tar_ele_trace,t.edit_info.edit_tar_ele_cand),null!=t.edit_info.edit_tar_ele_trace&&null!=t.edit_info.edit_tar_ele_cand){var R=t.edit_info.edit_tar_ele_trace,j=(0,o.GetObjElement)(t.edit_info.edit_tar_info,R,R.length-2),W=t.edit_info.edit_tar_ele_cand;v.info("GetObjElement",j,R[R.length-1]),j[R[R.length-1]]={id:W.shape.id,type:W.shape.type},v.info(j,t.edit_info.edit_tar_info),t.edit_info.edit_tar_info=Object.assign({},t.edit_info.edit_tar_info),t.edit_info.edit_tar_ele_trace=null,t.edit_info.edit_tar_ele_cand=null}break;case i.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:if(null==t.edit_info.edit_tar_info&&(t.edit_info.edit_tar_info={type:i.SHAPE_TYPE.measure,subtype:i.SHAPE_TYPE.measure_subtype.NA,docheck:!0},t.edit_info.edit_tar_ele_trace=["subtype"],t.edit_info.edit_tar_ele_cand=null),v.info(t.edit_info.edit_tar_ele_trace,t.edit_info.edit_tar_ele_cand),null!=t.edit_info.edit_tar_ele_trace&&null!=t.edit_info.edit_tar_ele_cand){var B=t.edit_info.edit_tar_ele_trace,H=(0,o.GetObjElement)(t.edit_info.edit_tar_info,B,B.length-2),G=t.edit_info.edit_tar_ele_cand;if("ref"==B[0]&&void 0!==G.shape){var V=!0,X=t.edit_info.edit_tar_info.subtype;switch(X){case i.SHAPE_TYPE.measure_subtype.sigma:break;case i.SHAPE_TYPE.measure_subtype.distance:G.shape.type==i.SHAPE_TYPE.search_point||G.shape.type==i.SHAPE_TYPE.aux_point||G.shape.type==i.SHAPE_TYPE.arc||G.shape.type==i.SHAPE_TYPE.line||(v.info("Error: "+X+" doesn't accept "+G.shape.type),V=!1);break;case i.SHAPE_TYPE.measure_subtype.radius:G.shape.type!=i.SHAPE_TYPE.arc&&(v.info("Error: "+X+" Only accepts arc"),V=!1);break;case i.SHAPE_TYPE.measure_subtype.angle:G.shape.type!=i.SHAPE_TYPE.line&&(v.info("Error: "+X+" Only accepts line"),V=!1);break;default:v.info("Error: "+X+" is not in the measure_subtype list"),V=!1}V&&(v.info("GetObjElement",H,B[B.length-1]),H[B[B.length-1]]={id:G.shape.id,type:G.shape.type})}else if("subtype"==B[0]){var z=!0;switch(G){case i.SHAPE_TYPE.measure_subtype.sigma:case i.SHAPE_TYPE.measure_subtype.radius:t.edit_info.edit_tar_info.ref=[{}];break;case i.SHAPE_TYPE.measure_subtype.distance:t.edit_info.edit_tar_info.ref=[{},{}],t.edit_info.edit_tar_info.ref_baseLine={};break;case i.SHAPE_TYPE.measure_subtype.angle:t.edit_info.edit_tar_info.ref=[{},{}];break;default:v.info("Error: "+G+" is not in the measure_subtype list"),z=!1}t.edit_info.edit_tar_info=Object.assign(t.edit_info.edit_tar_info,{pt1:{x:0,y:0},value:0,USL:0,LSL:0,UCL:0,LCL:0}),z&&(H[B[B.length-1]]=G)}else"ref_baseLine"==B[0]&&(H[B[B.length-1]]={id:G.shape.id,type:G.shape.type});v.info(H,t.edit_info.edit_tar_info),t.edit_info.edit_tar_info=Object.assign({},t.edit_info.edit_tar_info),t.edit_info.edit_tar_ele_trace=null,t.edit_info.edit_tar_ele_cand=null}break;case i.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(null!=t.edit_info.edit_tar_ele_trace&&null!=t.edit_info.edit_tar_ele_cand){var Y=t.edit_info.edit_tar_ele_trace,K=(0,o.GetObjElement)(t.edit_info.edit_tar_info,Y,Y.length-2),J=t.edit_info.edit_tar_ele_cand;v.info("GetObjElement",K,Y[Y.length-1]),K[Y[Y.length-1]]={id:J.shape.id,type:J.shape.type},t.edit_info.edit_tar_info=Object.assign({},t.edit_info.edit_tar_info),t.edit_info.edit_tar_ele_trace=null,t.edit_info.edit_tar_ele_cand=null}}return t}return t}e.default=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(y(t={MENU_EXPEND:!1,showSplash:!0,showSM_graph:!1,WS_CH:void 0,edit_info:{defModelPath:"data/cache_def",_obj:new s.InspectionEditorLogic,inspReport:void 0,reportStatisticState:{trackingWindow:[],historyReport:[],newAddedReport:[],statisticValue:void 0},sig360info:[],img:null,DefFileName:"",list:[],inherentShapeList:[],edit_tar_info:null,edit_tar_ele_trace:null,edit_tar_ele_cand:null,camera_calibration_report:void 0,mouseLocation:void 0},version_map_info:void 0,WebUI_info:u.default,sm:null,c_state:null,p_state:null,state_count:0,WS_ID:"EverCheckWS",InspectionMonitor_URL:"http://gitexp.idcircle.me/hyvision_monitor/0.0.0/"}),t),n=arguments[1];if(void 0===n.type||n.type.includes("@@redux/"))return e;var a=Object.assign({},e),i=new Date;return"ATBundle"===n.type?(a=n.data.reduce(function(t,e){return e.date=i,m(t,e)},a),v.info(a),a):(n.date=i,a=m(a,n),v.debug(a),a)}},672:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={version:"1.0.2"}},676:function(t,e){},678:function(t,e){},712:function(t,e){},713:function(t,e){},74:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Edit_Tar_Update=function(t){return{type:a.Edit_Tar_Update,data:t}},e.Edit_Tar_Ele_Trace_Update=function(t){return{type:a.Edit_Tar_Ele_Trace_Update,data:t}},e.Edit_Tar_Ele_Cand_Update=function(t){return{type:a.Edit_Tar_Ele_Cand_Update,data:t}},e.Shape_List_Update=function(t){return{type:a.Shape_List_Update,data:t}},e.Shape_Set=function(t){return{type:a.Shape_Set,data:{shape:t.shape,id:t.id}}},e.DefFileName_Update=function(t){return{type:a.DefFileName_Update,data:t}},e.SUCCESS=function(){return{type:a.SUCCESS}},e.FAIL=function(){return{type:a.FAIL}},e.ERROR=function(){return{type:a.ERROR}};var a=e.EVENT={Edit_Tar_Update:"Edit_Tar_Update",Edit_Tar_Ele_Trace_Update:"Edit_Tar_Ele_Trace_Update",Edit_Tar_Ele_Cand_Update:"Edit_Tar_Ele_Cand_Update",Shape_List_Update:"Shape_List_Update",Shape_Set:"Shape_Set",DefFileName_Update:"DefFileName_Update",SUCCESS:"DEFCONF_MODE_SUCCESS",FAIL:"DEFCONF_MODE_FAIL",ERROR:"ERROR"}},760:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ActionThrottle=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n(32);(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e})(n(44)).getLogger("ActionThrottle"),e.ActionThrottle=function(t){return function(e){return function(n){return function(i){if(t.ATID!=i.ATID)return n(i);switch(void 0===t.initted&&(a(t.time)!=a(0)&&(t.time=30),a(t.posEdge)!=a(!0)&&(t.posEdge=!0),t.actions=[],t.initted=!0,t.timeout_obj=null),i.ActionThrottle_type){case"express":return i.ATID=t.ExATID,n(i);case"flush":if(clearTimeout(t.timeout_obj),t.timeout_obj=null,0==t.actions.length)return;t.actions.push(i);var r=t.actions;return t.actions=[],r.forEach(function(t){void 0!==t.type&&n(t)}),null;default:return null==t.timeout_obj?(t.timeout_obj=setTimeout(function(){e.dispatch({ActionThrottle_type:"flush"})},t.time),t.posEdge?(i.ATID=t.ExATID,n(i)):void t.actions.push(i)):void t.actions.push(i)}return i.ATID=t.ExATID,n(i)}}}}},761:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ECStateMachine=void 0;n(32);var a=n(974);e.ECStateMachine=function(t){return function(e){return function(e){return function(n){if(void 0!==t.initted&&t.initted||(t.sm=(0,a.Machine)(t.state_config),t.c_state=t.sm.initialState,e({type:t.ev_state_update,data:{p_state:t.c_state,c_state:t.c_state,sm:t.sm,action:{type:t.ev_state_update}}}),t.initted=!0),null==n.type)return e(n);var i=t.sm.transition(t.c_state,n.type);if(JSON.stringify(t.c_state.value)!==JSON.stringify(i.value)){var r=t.c_state;t.c_state=i,e({type:t.ev_state_update,data:{p_state:r,c_state:i,sm:t.sm,action:n}})}return e(n)}}}}},764:function(t,e,n){var a={"./af":283,"./af.js":283,"./ar":284,"./ar-dz":285,"./ar-dz.js":285,"./ar-kw":286,"./ar-kw.js":286,"./ar-ly":287,"./ar-ly.js":287,"./ar-ma":288,"./ar-ma.js":288,"./ar-sa":289,"./ar-sa.js":289,"./ar-tn":290,"./ar-tn.js":290,"./ar.js":284,"./az":291,"./az.js":291,"./be":292,"./be.js":292,"./bg":293,"./bg.js":293,"./bm":294,"./bm.js":294,"./bn":295,"./bn.js":295,"./bo":296,"./bo.js":296,"./br":297,"./br.js":297,"./bs":298,"./bs.js":298,"./ca":299,"./ca.js":299,"./cs":300,"./cs.js":300,"./cv":301,"./cv.js":301,"./cy":302,"./cy.js":302,"./da":303,"./da.js":303,"./de":304,"./de-at":305,"./de-at.js":305,"./de-ch":306,"./de-ch.js":306,"./de.js":304,"./dv":307,"./dv.js":307,"./el":308,"./el.js":308,"./en-SG":309,"./en-SG.js":309,"./en-au":310,"./en-au.js":310,"./en-ca":311,"./en-ca.js":311,"./en-gb":312,"./en-gb.js":312,"./en-ie":313,"./en-ie.js":313,"./en-il":314,"./en-il.js":314,"./en-nz":315,"./en-nz.js":315,"./eo":316,"./eo.js":316,"./es":317,"./es-do":318,"./es-do.js":318,"./es-us":319,"./es-us.js":319,"./es.js":317,"./et":320,"./et.js":320,"./eu":321,"./eu.js":321,"./fa":322,"./fa.js":322,"./fi":323,"./fi.js":323,"./fo":324,"./fo.js":324,"./fr":325,"./fr-ca":326,"./fr-ca.js":326,"./fr-ch":327,"./fr-ch.js":327,"./fr.js":325,"./fy":328,"./fy.js":328,"./ga":329,"./ga.js":329,"./gd":330,"./gd.js":330,"./gl":331,"./gl.js":331,"./gom-latn":332,"./gom-latn.js":332,"./gu":333,"./gu.js":333,"./he":334,"./he.js":334,"./hi":335,"./hi.js":335,"./hr":336,"./hr.js":336,"./hu":337,"./hu.js":337,"./hy-am":338,"./hy-am.js":338,"./id":339,"./id.js":339,"./is":340,"./is.js":340,"./it":341,"./it-ch":342,"./it-ch.js":342,"./it.js":341,"./ja":343,"./ja.js":343,"./jv":344,"./jv.js":344,"./ka":345,"./ka.js":345,"./kk":346,"./kk.js":346,"./km":347,"./km.js":347,"./kn":348,"./kn.js":348,"./ko":349,"./ko.js":349,"./ku":350,"./ku.js":350,"./ky":351,"./ky.js":351,"./lb":352,"./lb.js":352,"./lo":353,"./lo.js":353,"./lt":354,"./lt.js":354,"./lv":355,"./lv.js":355,"./me":356,"./me.js":356,"./mi":357,"./mi.js":357,"./mk":358,"./mk.js":358,"./ml":359,"./ml.js":359,"./mn":360,"./mn.js":360,"./mr":361,"./mr.js":361,"./ms":362,"./ms-my":363,"./ms-my.js":363,"./ms.js":362,"./mt":364,"./mt.js":364,"./my":365,"./my.js":365,"./nb":366,"./nb.js":366,"./ne":367,"./ne.js":367,"./nl":368,"./nl-be":369,"./nl-be.js":369,"./nl.js":368,"./nn":370,"./nn.js":370,"./pa-in":371,"./pa-in.js":371,"./pl":372,"./pl.js":372,"./pt":373,"./pt-br":374,"./pt-br.js":374,"./pt.js":373,"./ro":375,"./ro.js":375,"./ru":376,"./ru.js":376,"./sd":377,"./sd.js":377,"./se":378,"./se.js":378,"./si":379,"./si.js":379,"./sk":380,"./sk.js":380,"./sl":381,"./sl.js":381,"./sq":382,"./sq.js":382,"./sr":383,"./sr-cyrl":384,"./sr-cyrl.js":384,"./sr.js":383,"./ss":385,"./ss.js":385,"./sv":386,"./sv.js":386,"./sw":387,"./sw.js":387,"./ta":388,"./ta.js":388,"./te":389,"./te.js":389,"./tet":390,"./tet.js":390,"./tg":391,"./tg.js":391,"./th":392,"./th.js":392,"./tl-ph":393,"./tl-ph.js":393,"./tlh":394,"./tlh.js":394,"./tr":395,"./tr.js":395,"./tzl":396,"./tzl.js":396,"./tzm":397,"./tzm-latn":398,"./tzm-latn.js":398,"./tzm.js":397,"./ug-cn":399,"./ug-cn.js":399,"./uk":400,"./uk.js":400,"./ur":401,"./ur.js":401,"./uz":402,"./uz-latn":403,"./uz-latn.js":403,"./uz.js":402,"./vi":404,"./vi.js":404,"./x-pseudo":405,"./x-pseudo.js":405,"./yo":406,"./yo.js":406,"./zh-cn":407,"./zh-cn.js":407,"./zh-hk":408,"./zh-hk.js":408,"./zh-tw":409,"./zh-tw.js":409};function i(t){var e=r(t);return n(e)}function r(t){var e=a[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}i.keys=function(){return Object.keys(a)},i.resolve=r,t.exports=i,i.id=764},765:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();n(101);var r=n(98),o=A(n(1)),s=n(81),l=C(s),u=n(39),d=A(n(766)),c=C(n(32)),h=A(n(787)),p=A(n(798)),f=A(n(921)),S=n(43),E=A(n(192)),v=A(n(199)),_=A(n(45)),b=A(n(953)),y=A(n(957)),m=A(n(460)),g=A(n(15)),k=A(n(52)),T=A(n(968));function C(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function A(t){return t&&t.__esModule?t:{default:t}}function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function P(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}T.default.Header;var I=T.default.Content,O=(T.default.Footer,T.default.Sider),x=(k.default.SubMenu,y.default.Paragraph),D=(m.default.Panel,function(t){function e(t){return N(this,e),w(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return P(e,o.default.Component),i(e,[{key:"ec_canvas_EmitEvent",value:function(t){}},{key:"componentDidMount",value:function(){this.ec_canvas=new E.default.Preview_CanvasComponent(this.refs.canvas),this.ec_canvas.EmitEvent=this.ec_canvas_EmitEvent.bind(this),void 0!==this.props.onCanvasInit&&this.props.onCanvasInit(this.ec_canvas),this.updateCanvas(this.props.c_state)}},{key:"componentWillUnmount",value:function(){this.ec_canvas.resourceClean()}},{key:"updateCanvas",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;void 0!==this.ec_canvas&&(this.ec_canvas.EditDBInfoSync(e.edit_info),this.ec_canvas.SetState(t),this.ec_canvas.draw())}},{key:"onResize",value:function(t,e){void 0!==this.ec_canvas&&this.ec_canvas.resize(t,e)}},{key:"componentDidUpdate",value:function(t,e){console.log("CanvasComponent render",this.props.c_state),console.log(this.props.edit_info.inherentShapeList),this.updateCanvas(this.props.c_state,this.props)}},{key:"render",value:function(){return o.default.createElement("div",{className:this.props.className},o.default.createElement("canvas",{ref:"canvas",className:"width12 HXF"}),o.default.createElement(v.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),e}()),M=function(t){function e(t){N(this,e);var n=w(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.QR_Content="",n.state={canvas:void 0,fUpdateC:0},n}return P(e,o.default.Component),i(e,[{key:"componentDidMount",value:function(){this.setState(a({},this.state,{canvas:this.refs.canvas}))}},{key:"onResize",value:function(t,e){this.refs.canvas.width=t,this.refs.canvas.height=e,this.setState(a({},this.state,{fUpdateC:this.state.fUpdateC++}))}},{key:"componentShouldUpdate",value:function(t,e){return console.log(t,this.QR_Content),t.QR_Content!=this.QR_Content}},{key:"componentDidUpdate",value:function(t,e){this.QR_Content=this.props.QR_Content}},{key:"render",value:function(){return void 0!==this.refs.canvas&&d.default.toCanvas(this.refs.canvas,this.props.QR_Content,{errorCorrectionLevel:"L"},function(t){t&&console.error(t),console.log("success!")}),o.default.createElement("div",{className:this.props.className},o.default.createElement("canvas",{ref:"canvas",className:"width12 HXF",onClick:this.props.onClick}),o.default.createElement(v.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),e}(),U=(0,r.connect)(function(t){return{c_state:t.UIData.c_state,edit_info:t.UIData.edit_info}},function(t,e){return{}})(D);function L(t){return"string"==typeof t||t instanceof String}var F=function(t){function e(t){N(this,e);var n=w(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={fileSelectedCallBack:void 0,menuSelect:"Overview",menuCollapsed:!0},n}return P(e,o.default.Component),i(e,[{key:"componentDidMount",value:function(){var t=this;setTimeout(function(){var e=t.props.defModelPath;t.props.ACT_WS_SEND(t.props.WS_ID,"LD",0,{deffile:e+"."+u.DEF_EXTENSION,imgsrc:e})},1e3)}},{key:"shouldComponentUpdate",value:function(t,e){return!0}},{key:"FrontDoor",value:function(){var t=o.default.createElement("div",{className:"content"},o.default.createElement(x,null,"HYVision 2019 is the most famous vision-check system in the world."),o.default.createElement(x,null,o.default.createElement("p",null,"HYVision 2019 - v1 (http://hyv.idcircle.me)"),o.default.createElement("p",null,"HYVision 2019 - v2 (http://hyv.idcircle.me)"),o.default.createElement("p",null,"HYVision 2019 - v3 (http://hyv.idcircle.me)")),o.default.createElement("p",{className:"contentLink"},o.default.createElement("a",null,o.default.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/MjEImQtenlyueSmVEfUD.svg",alt:"start"})," Quick Start"),o.default.createElement("a",null,o.default.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/NbuDUAuBlIApFuDvWiND.svg",alt:"info"}),"Product Info"),o.default.createElement("a",null,o.default.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/ohOEPSYdDTNnyMbGuyLb.svg",alt:"doc"}),"Product Doc"))),e=o.default.createElement("img",{src:"https://gw.alipayobjects.com/mdn/mpaas_user/afts/img/A*KsfVQbuLRlYAAAAAAAAAAABjAQAAAQ/original",alt:"content"});return o.default.createElement(b.default,{title:"HYVision 2019",breadcrumb:{routes:[{path:"index",breadcrumbName:"HYV"},{path:"first",breadcrumbName:"HOME"},{path:"second",breadcrumbName:"Manual"}]}},o.default.createElement("div",{className:"wrap"},o.default.createElement("div",{className:"content"},t),o.default.createElement("div",{className:"extraContent"},e)))}},{key:"render",value:function(){var t=this,e=[];if(null==this.props.c_state)return null;var n=(0,S.xstate_GetCurrentMainState)(this.props.c_state);if(n.state===c.UI_SM_STATES.MAIN){var i=this.props.defModelPath.substr(0,this.props.defModelPath.lastIndexOf("/")+1),r=function(e){t.setState(a({},t.state,{menuSelect:e.key}))},d=void 0;if(void 0!==this.props.camera_calibration_report){var E=this.props.isp_db.cameraParam;d=E.mmpb2b/E.ppb2b}var v=void 0;L(this.props.defModelHash)&&this.props.defModelHash.length>5&&(v=this.props.InspectionMonitor_URL+"?v=0&name="+this.props.defModelName+"&hash="+this.props.defModelHash,v=encodeURI(v));var b={HOME:{icon:"home",content:this.FrontDoor(),onSelected:r},Overview:{icon:"info-circle",content:o.default.createElement("div",{style:{padding:24,background:"#fff",height:"100%"}},o.default.createElement("div",{className:"s black"},this.props.WebUI_info.version),o.default.createElement("div",{className:"s width7",style:{height:"500px"}},o.default.createElement(_.default,{onClick:function(){t.setState(a({},t.state,{fileSelectedCallBack:function(e,n){e=e.replace("."+u.DEF_EXTENSION,""),t.setState(a({},t.state,{fileSelectedCallBack:void 0})),t.props.ACT_Def_Model_Path_Update(e),t.props.ACT_WS_SEND(t.props.WS_ID,"LD",0,{deffile:e+"."+u.DEF_EXTENSION,imgsrc:e})}}))},className:"height1 width12",key:"1"},this.props.defModelPath,o.default.createElement("br",null),this.props.defModelName),o.default.createElement(U,{className:"height11"})),void 0===d?null:o.default.createElement(_.default,{key:"mmpp",className:"s width5",onClick:function(){t.props.ACT_WS_SEND(t.props.WS_ID,"ST",0,{LoadCameraCalibration:"data/default_camera_param.json"}),t.props.ACT_WS_SEND(t.props.WS_ID,"LD",0,{filename:"data/default_camera_param.json"})}},o.default.createElement(g.default,{type:"camera"})," ",o.default.createElement(g.default,{type:"control"})," ","mmpp:"+d),L(v)?o.default.createElement(M,{className:"s width5 HX6",onClick:function(){return window.open(v)},QR_Content:v}):null,o.default.createElement(s.BPG_FileBrowser,{key:"BPG_FileBrowser",path:i,visible:void 0!==this.state.fileSelectedCallBack,BPG_Channel:function(){for(var e,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.props).ACT_WS_SEND.apply(e,[t.props.WS_ID].concat(a))},onFileSelected:function(e,n){t.setState(a({},t.state,{fileSelectedCallBack:void 0})),t.state.fileSelectedCallBack(e,n)},onCancel:function(){t.setState(a({},t.state,{fileSelectedCallBack:void 0}))},fileFilter:function(t){return"DIR"==t.type||t.name.includes("."+u.DEF_EXTENSION)}})),onSelected:r},EDIT:{icon:"edit",content:null,onSelected:this.props.EV_UI_Edit_Mode},Inspect:{icon:"scan",content:null,onSelected:this.props.EV_UI_Insp_Mode},STA:{icon:"bar-chart",content:null,onSelected:this.props.EV_UI_Analysis_Mode},Setting:{icon:"setting",content:o.default.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},o.default.createElement(_.default,{key:"Reconnect CAM",onClick:function(){t.props.ACT_WS_SEND(t.props.WS_ID,"RC",0,{target:"camera_ez_reconnect"})}},"Reconnect CAM"),o.default.createElement(_.default,{key:"camera Calib",onClick:function(){t.setState(a({},t.state,{fileSelectedCallBack:function(e,n){console.log(e,n),t.props.ACT_WS_SEND(t.props.WS_ID,"II",0,{deffile:"data/cameraCalibration.json",imgsrc:e})}}))}},"camera Calib"),o.default.createElement(s.BPG_FileBrowser,{key:"BPG_FileBrowser",path:i,visible:void 0!==this.state.fileSelectedCallBack,BPG_Channel:function(){for(var e,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.props).ACT_WS_SEND.apply(e,[t.props.WS_ID].concat(a))},onFileSelected:function(e,n){t.setState(a({},t.state,{fileSelectedCallBack:void 0})),t.state.fileSelectedCallBack(e,n)},onCancel:function(){t.setState(a({},t.state,{fileSelectedCallBack:void 0}))},fileFilter:function(t){return"DIR"==t.type||t.name.includes(".bmp")||t.name.includes(".png")}})),onSelected:r},Collapse:{icon:this.state.menuCollapsed?"right":"left",content:null,onSelected:function(){return t.setState(a({},t.state,{menuCollapsed:!t.state.menuCollapsed}))}}},y=this.props.version_map_info,m=(0,S.GetObjElement)(y,["recommend_info","url"]);void 0!==m&&-1==m.indexOf()&&(b.UPDATE={icon:"cloud-upload",content:null,onSelected:function(){window.location.href=m}}),e.push(o.default.createElement(T.default,{className:"HXF"},o.default.createElement(O,{trigger:null,collapsible:!0,collapsed:this.state.menuCollapsed},o.default.createElement(k.default,{theme:"dark",mode:"inline",defaultSelectedKeys:[this.state.menuSelect],onClick:function(t){return b[t.key].onSelected(t)}},Object.keys(b).map(function(t){return o.default.createElement(k.default.Item,{key:t},o.default.createElement(g.default,{type:b[t].icon}),o.default.createElement("span",null,t))}))),o.default.createElement(T.default,null,o.default.createElement(I,null,b[this.state.menuSelect].content))))}else n.state===c.UI_SM_STATES.DEFCONF_MODE?e=o.default.createElement(h.default,null):n.state===c.UI_SM_STATES.INSP_MODE?e=o.default.createElement(p.default,null):n.state===c.UI_SM_STATES.ANALYSIS_MODE&&(e=o.default.createElement(f.default,null));return o.default.createElement(l.CardFrameWarp,{addClass:"width12 height12",fixedFrame:!0},e)}}]),e}(),R=(0,r.connect)(function(t){return{defModelName:t.UIData.edit_info.DefFileName,defModelPath:t.UIData.edit_info.defModelPath,defModelHash:t.UIData.edit_info.DefFileHash,c_state:t.UIData.c_state,camera_calibration_report:t.UIData.edit_info.camera_calibration_report,isp_db:t.UIData.edit_info._obj,WS_CH:t.UIData.WS_CH,WS_ID:t.UIData.WS_ID,version_map_info:t.UIData.version_map_info,WebUI_info:t.UIData.WebUI_info,InspectionMonitor_URL:t.UIData.InspectionMonitor_URL}},function(t,e){return{EV_UI_Edit_Mode:function(e){t(c.EV_UI_Edit_Mode())},EV_UI_Insp_Mode:function(){t(c.EV_UI_Insp_Mode())},EV_UI_Analysis_Mode:function(){t(c.EV_UI_Analysis_Mode())},ACT_Def_Model_Path_Update:function(e){t(c.Def_Model_Path_Update(e))},ACT_WS_SEND:function(e,n,a,i,r,o){return t(c.EV_WS_SEND(e,n,a,i,r,o))}}})(F);e.default=R},787:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=n(98),o=g(n(1)),s=g(n(190)),l=m(n(81)),u=g(n(199)),d=n(39),c=g(n(39)),h=g(n(192)),p=(n(245),m(n(32))),f=m(n(74)),S=n(43),E=g(n(247));n(101);var v=m(n(44)),_=g(n(82)),b=g(n(151)),y=g(n(83));function m(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function g(t){return t&&t.__esModule?t:{default:t}}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function C(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var A=l.BPG_FileBrowser,N=l.BPG_FileSavingBrowser,w=function(t){function e(t){return k(this,e),T(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return C(e,o.default.Component),i(e,[{key:"ec_canvas_EmitEvent",value:function(t){switch(t.type){case f.EVENT.SUCCESS:this.props.ACT_SUCCESS();break;case f.EVENT.FAIL:this.props.ACT_Fail();break;case f.EVENT.Edit_Tar_Update:this.props.ACT_EDIT_TAR_UPDATE(t.data);break;case f.EVENT.Edit_Tar_Ele_Cand_Update:this.props.ACT_EDIT_TAR_ELE_CAND_UPDATE(t.data);break;case f.EVENT.Shape_List_Update:console.log(t),this.props.ACT_EDIT_SHAPELIST_UPDATE(t.data);break;case f.EVENT.Shape_Set:console.log(t),this.props.ACT_EDIT_SHAPE_SET(t.data);break;case f.EVENT.Edit_Tar_Ele_Trace_Update:this.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(t.data)}}},{key:"componentDidMount",value:function(){this.ec_canvas=new h.default.DEFCONF_CanvasComponent(this.refs.canvas),this.ec_canvas.EmitEvent=this.ec_canvas_EmitEvent.bind(this),this.props.onCanvasInit(this.ec_canvas),this.updateCanvas(this.props.c_state)}},{key:"componentWillUnmount",value:function(){this.ec_canvas.resourceClean()}},{key:"updateCanvas",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;void 0!==this.ec_canvas&&(this.ec_canvas.EditDBInfoSync(e.edit_info),this.ec_canvas.SetState(t),this.ec_canvas.draw())}},{key:"onResize",value:function(t,e){void 0!==this.ec_canvas&&(this.ec_canvas.resize(t,e),this.updateCanvas(this.props.c_state),this.ec_canvas.ctrlLogic(),this.ec_canvas.draw())}},{key:"componentWillUpdate",value:function(t,e){console.log("CanvasComponent render",t.c_state),console.log(t.edit_info.inherentShapeList),this.updateCanvas(t.c_state,t)}},{key:"render",value:function(){return o.default.createElement("div",{className:this.props.addClass+" HXF"},o.default.createElement("canvas",{ref:"canvas",className:"width12 HXF"}),o.default.createElement(u.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),e}(),P=(0,r.connect)(function(t){return{c_state:t.UIData.c_state,edit_info:t.UIData.edit_info}},function(t,e){return{ACT_SUCCESS:function(e){t(p.EV_UI_ACT(f.EVENT.SUCCESS))},ACT_Fail:function(e){t(p.EV_UI_ACT(f.EVENT.FAIL))},ACT_EXIT:function(e){t(p.EV_UI_ACT(p.UI_SM_EVENT.EXIT))},ACT_EDIT_TAR_UPDATE:function(e){t(f.Edit_Tar_Update(e))},ACT_EDIT_TAR_ELE_CAND_UPDATE:function(e){t(f.Edit_Tar_Ele_Cand_Update(e))},ACT_EDIT_SHAPELIST_UPDATE:function(e){t(f.Shape_List_Update(e))},ACT_EDIT_SHAPE_SET:function(e){t(f.Shape_Set(e))},ACT_EDIT_TAR_ELE_TRACE_UPDATE:function(e){t(f.Edit_Tar_Ele_Trace_Update(e))}}})(w),I=function(t){function e(t){k(this,e);var n=T(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.ec_canvas=null,n.state={fileSelectedCallBack:void 0,fileSavingCallBack:void 0},n}return C(e,o.default.Component),i(e,[{key:"componentDidMount",value:function(){var t=this,e=this.props.edit_info.defModelPath;new Promise(function(n,a){t.props.ACT_WS_SEND(t.props.WS_ID,"LD",0,{deffile:e+"."+d.DEF_EXTENSION,imgsrc:e},void 0,{resolve:n,reject:a}),setTimeout(function(){return a("Timeout")},1e3)}).then(function(e){t.props.DISPATCH({type:"ATBundle",ActionThrottle_type:"express",data:e.map(function(t){return c.default.map_BPG_Packet2Act(t)}).filter(function(t){return void 0!==t})})}).catch(function(t){v.info(t)});var n=new S.websocket_autoReconnect("ws://hyv.decade.tw:8080/insert/def",1e4);this.WS_DEF_DB_Insert=new S.websocket_reqTrack(n),this.WS_DEF_DB_Insert.onreconnection=function(t){return v.info("onreconnection"+t),!(t>10)},this.WS_DEF_DB_Insert.onopen=function(){return v.info("WS_DEF_DB_Insert:onopen")},this.WS_DEF_DB_Insert.onmessage=function(t){return v.info("WS_DEF_DB_Insert:onmessage::",t)},this.WS_DEF_DB_Insert.onconnectiontimeout=function(){return v.info("WS_DEF_DB_Insert:onconnectiontimeout")},this.WS_DEF_DB_Insert.onclose=function(){return v.info("WS_DEF_DB_Insert:onclose")},this.WS_DEF_DB_Insert.onerror=function(){return v.info("WS_DEF_DB_Insert:onerror")}}},{key:"componentWillUnmount",value:function(){this.WS_DEF_DB_Insert.close(),this.props.ACT_ClearImage()}}]),i(e,[{key:"shouldComponentUpdate",value:function(t,e){return!0}},{key:"genTarEditUI",value:function(t){var e=this;switch(t.type){case p.SHAPE_TYPE.aux_point:case p.SHAPE_TYPE.search_point:case p.SHAPE_TYPE.measure:return o.default.createElement(l.JsonEditBlock,{object:t,dict:y.default,dictTheme:t.type,key:"BASE_COM.JsonEditBlock",whiteListKey:{type:"div",subtype:"div",name:"input",angleDeg:"input-number",value:"input-number",margin:"input-number",USL:"input-number",LSL:"input-number",UCL:"input-number",LCL:"input-number",quadrant:"div",docheck:"checkbox",width:"input-number",ref:{__OBJ__:"div",0:{__OBJ__:"btn",id:"div",element:"div"},1:{__OBJ__:"btn",id:"div",element:"div"}},ref_baseLine:{__OBJ__:"btn",id:"div",element:"div"}},jsonChange:function(t,n,a,i){if("btn"==a)"ref"!=n.keyTrace[0]&&"ref_baseLine"!=n.keyTrace[0]||e.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(n.keyTrace);else{var r=n.keyTrace[n.keyTrace.length-1];switch(a){case"input-number":var o=parseFloat(i.target.value);if(isNaN(o))return;if(n.obj[r]=o,void 0!==n.obj.value){var s=n.obj.value;"LSL"==r?n.obj.LCL=(0,S.round)(s+2*(n.obj.LSL-s)/3,.001):"USL"==r&&(n.obj.UCL=(0,S.round)(s+2*(n.obj.USL-s)/3,.001))}break;case"input":n.obj[r]=i.target.value;break;case"checkbox":n.obj[r]=i.target.checked}e.ec_canvas.SetShape(t,t.id)}}});default:return o.default.createElement(l.JsonEditBlock,{object:t,dict:y.default,dictTheme:t.type,key:"BASE_COM.JsonEditBlock",jsonChange:function(t,n,a,i){var r=n.keyTrace[n.keyTrace.length-1];"input-number"==a?n.obj[r]=parseFloat(i.target.value):"input"==a&&(n.obj[r]=i.target.value),console.log(n.obj);var o=t;e.ec_canvas.SetShape(o,o.id)},whiteListKey:{type:"div",subtype:"div",name:"input",margin:"input-number",direction:"input-number"}})}}},{key:"render",value:function(){var t=this,e=[],n="HXA";console.log("CanvasComponent render");var i=this.props.c_state.value[p.UI_SM_STATES.DEFCONF_MODE],r=this.props.edit_info.defModelPath;switch(i){case p.UI_SM_STATES.DEFCONF_MODE_NEUTRAL:n="HXA",e=[o.default.createElement(l.IconButton,{dict:y.default,key:"<",addClass:"layout black vbox",text:"<",onClick:function(){return t.props.ACT_EXIT()}}),o.default.createElement(l.JsonEditBlock,{object:{DefFileName:this.props.edit_info.DefFileName},dict:y.default,key:"this.props.edit_info.DefFileName",jsonChange:function(e,n,a,i){t.props.ACT_DefFileName_Update(i.target.value)},whiteListKey:{DefFileName:"input"}}),o.default.createElement(l.IconButton,{dict:y.default,addClass:"layout palatte-blue-8 vbox",key:"LINE",text:"line",onClick:function(){return t.props.ACT_Line_Add_Mode()}}),o.default.createElement(l.IconButton,{dict:y.default,addClass:"layout palatte-blue-8 vbox",key:"ARC",text:"arc",onClick:function(){return t.props.ACT_Arc_Add_Mode()}}),o.default.createElement(l.IconButton,{dict:y.default,addClass:"layout palatte-blue-8 vbox",key:"APOINT",text:"apoint",onClick:function(){return t.props.ACT_Aux_Point_Add_Mode()}}),o.default.createElement(l.IconButton,{dict:y.default,addClass:"layout palatte-blue-8 vbox",key:"SPOINT",text:"spoint",onClick:function(){return t.props.ACT_Search_Point_Add_Mode()}}),o.default.createElement(l.IconButton,{iconType:"form",addClass:"layout palatte-blue-8",key:"MEASURE",dict:y.default,text:"measure",onClick:function(){return t.props.ACT_Measure_Add_Mode()}}),o.default.createElement(l.IconButton,{iconType:"edit",dict:y.default,addClass:"layout palatte-blue-5 vbox",key:"EDIT",text:"edit",onClick:function(){return t.props.ACT_Shape_Edit_Mode()}}),o.default.createElement(l.IconButton,{iconType:"save",dict:y.default,addClass:"layout palatte-gold-7 vbox",key:"SAVE",text:"save",onClick:function(){t.setState(a({},t.state,{fileSavingCallBack:function(e,n,i){var r=e.path+"/"+n.replace("."+d.DEF_EXTENSION,"");console.log(r);var o=new TextEncoder,s=t.props.edit_info._obj.GenerateEditReport();s.name=t.props.edit_info.DefFileName;var l=E.default.digest(s.featureSet,"sha1","hex");s.featureSet_sha1=l,console.log("ACT_Report_Save"),t.props.ACT_Report_Save(t.props.WS_ID,r+"."+d.DEF_EXTENSION,o.encode(JSON.stringify(s,null,2))),console.log("ACT_Cache_Img_Save"),t.props.ACT_Cache_Img_Save(t.props.WS_ID,r),t.props.ACT_Def_Model_Path_Update(r),t.setState(a({},t.state,{fileSavingCallBack:void 0}));var u={dbcmd:{db_action:"insert"},data:s};t.WS_DEF_DB_Insert.send_obj(u).then(function(t){return console.log("then",t)}).catch(function(t){return console.log("catch",t)})},fileSelectFooter:o.default.createElement("div",null,"ddd")}))}}),o.default.createElement(l.IconButton,{iconType:"export",dict:y.default,addClass:"layout palatte-gold-7 vbox",key:"LOAD",text:"load",onClick:function(){t.setState(a({},t.state,{fileSelectedCallBack:function(e){var n=e.replace("."+d.DEF_EXTENSION,"");console.log(n),t.props.ACT_Def_Model_Path_Update(n),t.props.ACT_WS_SEND(t.props.WS_ID,"LD",0,{deffile:n+"."+d.DEF_EXTENSION,imgsrc:n}),t.setState(a({},t.state,{fileSelectedCallBack:void 0}))}}))}}),o.default.createElement(l.IconButton,{iconType:"camera",dict:y.default,addClass:"layout palatte-purple-8 vbox",key:"TAKE",text:"take",onClick:function(){new Promise(function(e,n){t.props.ACT_WS_SEND(t.props.WS_ID,"EX",0,{},void 0,{resolve:e,reject:n}),setTimeout(function(){return n("Timeout")},1e3)}).then(function(e){t.props.DISPATCH({type:"ATBundle",ActionThrottle_type:"express",data:e.map(function(t){return c.default.map_BPG_Packet2Act(t)}).filter(function(t){return void 0!==t})})}).catch(function(t){v.info(t)}),t.props.ACT_Shape_List_Reset()}})];var u=r.substr(0,r.lastIndexOf("/")+1);if(void 0!==this.state.fileSelectedCallBack&&e.push(o.default.createElement(A,{key:"BPG_FileBrowser",path:u,visible:void 0!==this.state.fileSelectedCallBack,BPG_Channel:function(){for(var e,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.props).ACT_WS_SEND.apply(e,[t.props.WS_ID].concat(a))},onFileSelected:function(e,n){t.state.fileSelectedCallBack(e,n)},onOk:function(t){console.log(t)},onCancel:function(){t.setState(a({},t.state,{fileSelectedCallBack:void 0}))},fileFilter:function(t){return"DIR"==t.type||t.name.includes("."+d.DEF_EXTENSION)}})),void 0!==this.state.fileSavingCallBack){var h=r.substr(r.lastIndexOf("/")+1);e.push(o.default.createElement(N,{key:"BPG_FileSavingBrowser",path:u,visible:void 0!==this.state.fileSavingCallBack,defaultName:h,BPG_Channel:function(){for(var e,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(e=t.props).ACT_WS_SEND.apply(e,[t.props.WS_ID].concat(a))},onOk:function(e,n,a){t.state.fileSavingCallBack(e,n,a)},onCancel:function(){t.setState(a({},t.state,{fileSavingCallBack:void 0}))},fileFilter:function(t){return"DIR"==t.type||t.name.includes("."+d.DEF_EXTENSION)}}))}break;case p.UI_SM_STATES.DEFCONF_MODE_MEASURE_CREATE:if(e=[o.default.createElement(l.Button,{addClass:"layout black vbox width4",key:"<",text:"<",onClick:function(){return t.props.ACT_Fail()}}),o.default.createElement("div",{key:"MEASURE",className:"s width8 lblue vbox"},"MEASURE")],null!=this.props.edit_tar_info){if(console.log("BASE_COM.JsonEditBlock:",this.props.edit_tar_info),e.push(o.default.createElement(l.JsonEditBlock,{object:this.props.edit_tar_info,dict:y.default,key:"BASE_COM.JsonEditBlock",whiteListKey:{name:"input",subtype:"div",ref:{__OBJ__:"div",0:{__OBJ__:"btn",id:"div",element:"div"},1:{__OBJ__:"btn",id:"div",element:"div"}},ref_baseLine:{__OBJ__:"btn",id:"div",element:"div"}},jsonChange:function(e,n,a,i){if(console.log(n),"btn"==a)"ref"!=n.keyTrace[0]&&"ref_baseLine"!=n.keyTrace[0]||t.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(n.keyTrace);else{var r=n.keyTrace[n.keyTrace.length-1];"input-number"==a?n.obj[r]=parseFloat(i.target.value):"input"==a&&(n.obj[r]=i.target.value),t.ec_canvas.SetShape(e,e.id)}}})),this.props.edit_tar_info.subtype==p.SHAPE_TYPE.measure_subtype.NA)for(var f in p.SHAPE_TYPE.measure_subtype)"NA"!=f&&e.push(o.default.createElement(l.IconButton,{dict:y.default,key:"MSUB__"+f,addClass:"layout red vbox",text:f,onClick:function(e,n){console.log(n.props.text),t.props.ACT_EDIT_TAR_ELE_CAND_UPDATE(n.props.text)}}));var S=this.props.edit_tar_info;if(console.log(S.ref),void 0!==S.ref){var m=!1;S.ref.forEach(function(t){void 0===t.id&&(m=!0)}),m||e.push(o.default.createElement(l.Button,{key:"ADD_BTN",addClass:"layout red vbox",text:"ADD",onClick:function(){t.ec_canvas.SetShape(t.props.edit_tar_info),t.props.ACT_SUCCESS()}}))}}break;case p.UI_SM_STATES.DEFCONF_MODE_LINE_CREATE:e=[o.default.createElement(l.IconButton,{dict:y.default,addClass:"layout black vbox width4",key:"<",text:"<",onClick:function(){return t.props.ACT_Fail()}}),o.default.createElement("div",{key:"LINE",className:"s width8 lred vbox"},"LINE")];break;case p.UI_SM_STATES.DEFCONF_MODE_ARC_CREATE:e=[o.default.createElement(l.IconButton,{dict:y.default,addClass:"layout black vbox width4",key:"<",text:"<",onClick:function(){return t.props.ACT_Fail()}}),o.default.createElement("div",{key:"ARC",className:"s width8 lred vbox"},"ARC")];break;case p.UI_SM_STATES.DEFCONF_MODE_SEARCH_POINT_CREATE:if(e=[o.default.createElement(l.IconButton,{dict:y.default,addClass:"layout black vbox",key:"<",text:"<",onClick:function(){return t.props.ACT_Fail()}}),o.default.createElement("div",{key:"SEARCH_POINT",className:"s lred vbox"},"SPOINT")],null!=this.props.edit_tar_info)console.log("BASE_COM.JsonEditBlock:",this.props.edit_tar_info),e.push(this.genTarEditUI(this.props.edit_tar_info)),void 0!==this.props.edit_tar_info.ref[0].id&&e.push(o.default.createElement(l.Button,{key:"ADD_BTN",addClass:"layout red vbox",text:"ADD",onClick:function(){t.ec_canvas.SetShape(t.props.edit_tar_info),t.props.ACT_SUCCESS()}}));break;case p.UI_SM_STATES.DEFCONF_MODE_AUX_POINT_CREATE:if(e=[o.default.createElement(l.Button,{addClass:"layout black vbox",key:"<",text:"<",onClick:function(){return t.props.ACT_Fail()}}),o.default.createElement("div",{key:"AUX_POINT",className:"s lred vbox"},"APOINT")],null!=this.props.edit_tar_info){console.log("BASE_COM.JsonEditBlock:",this.props.edit_tar_info),e.push(this.genTarEditUI(this.props.edit_tar_info));var g=this.props.edit_tar_info;console.log(g.ref),void 0!==g.ref[0].id&&void 0!==g.ref[1].id&&g.ref[0].id!=g.ref[1].id&&e.push(o.default.createElement(l.Button,{key:"ADD_BTN",addClass:"layout red vbox",text:"ADD",onClick:function(){t.ec_canvas.SetShape(t.props.edit_tar_info),t.props.ACT_SUCCESS()}}))}break;case p.UI_SM_STATES.DEFCONF_MODE_SHAPE_EDIT:if(e=[o.default.createElement(l.Button,{key:"<",addClass:"layout black vbox width4",text:"<",onClick:function(){return t.props.ACT_Fail()}}),o.default.createElement("div",{key:"EDIT_Text",className:"s width8 lblue vbox"},"EDIT"),o.default.createElement("div",{key:"HLINE",className:"s HX0_1"})],null!=this.props.edit_tar_info){e.push(this.genTarEditUI(this.props.edit_tar_info));void 0!==this.props.edit_tar_info.id&&(e.push(o.default.createElement(l.Button,{key:"COPY_BTN",addClass:"layout blue vbox",text:"COPY",onClick:function(){return e=t.props.edit_tar_info,(n=(0,_.default)(e)).id=void 0,console.log(n),["pt1","pt2","pt3"].forEach(function(t){void 0!==n[t]&&(n[t].x+=1,n[t].y+=1)}),n.name+="_copy",void t.ec_canvas.SetShape(n,void 0);var e,n}})),e.push(o.default.createElement(l.Button,{key:"DEL_BTN",addClass:"layout red vbox",text:"DEL",onClick:function(){t.setState(a({},t.state,{warningInfo:{onOk:function(){var e;e=t.props.edit_tar_info.id,t.ec_canvas.SetShape(null,e),console.log("onOK")},onCancel:function(){console.log("onCancel")},content:"確定要刪除:"+t.props.edit_tar_info.name+" ?"}}))}})))}else console.log(this.props.shape_list),this.props.shape_list.forEach(function(n){e.push(o.default.createElement(l.Button,{key:"shape_listing_"+n.id,addClass:"layout lred vbox",text:n.name,onClick:function(){return t.props.ACT_EDIT_TAR_UPDATE(n)}}))})}return console.log("APP_DEFCONF_MODE render"),o.default.createElement("div",{className:"overlayCon HXF"},o.default.createElement(b.default,{title:null,visible:void 0!==this.state.warningInfo,okText:"Yes",okType:"danger",onCancel:function(e){t.state.warningInfo.onCancel(e),t.setState(a({},t.state,{warningInfo:void 0}))},onOk:function(e){t.state.warningInfo.onOk(e),t.setState(a({},t.state,{warningInfo:void 0}))}},void 0!==this.state.warningInfo?this.state.warningInfo.content:null),o.default.createElement(P,{addClass:"layout width12",onCanvasInit:function(e){t.ec_canvas=e}}),o.default.createElement(s.default,{transitionName:"fadeIn"},o.default.createElement("div",{key:i,className:"s overlay scroll shadow1 MenuAnim "+n},e)))}}]),e}(),O=(0,r.connect)(function(t){return{c_state:t.UIData.c_state,edit_tar_info:t.UIData.edit_info.edit_tar_info,shape_list:t.UIData.edit_info.list,WS_ID:t.UIData.WS_ID,edit_info:t.UIData.edit_info}},function(t,e){return{ACT_Line_Add_Mode:function(e){t(p.EV_UI_ACT(p.UI_SM_EVENT.Line_Create))},ACT_Arc_Add_Mode:function(e){t(p.EV_UI_ACT(p.UI_SM_EVENT.Arc_Create))},ACT_Search_Point_Add_Mode:function(e){t(p.EV_UI_ACT(p.UI_SM_EVENT.Search_Point_Create))},ACT_Aux_Point_Add_Mode:function(e){t(p.EV_UI_ACT(p.UI_SM_EVENT.Aux_Point_Create))},ACT_Shape_Edit_Mode:function(e){t(p.EV_UI_ACT(p.UI_SM_EVENT.Shape_Edit))},ACT_Measure_Add_Mode:function(e){t(p.EV_UI_ACT(p.UI_SM_EVENT.Measure_Create))},ACT_DefFileName_Update:function(e){t(f.DefFileName_Update(e))},ACT_EDIT_TAR_ELE_TRACE_UPDATE:function(e){t(f.Edit_Tar_Ele_Trace_Update(e))},ACT_EDIT_TAR_ELE_CAND_UPDATE:function(e){t(f.Edit_Tar_Ele_Cand_Update(e))},ACT_EDIT_TAR_UPDATE:function(e){t(f.Edit_Tar_Update(e))},ACT_Shape_List_Reset:function(){t(f.Shape_List_Update([]))},ACT_Save_Def_Config:function(e){t(p.EV_UI_EC_Save_Def_Config(e))},ACT_Load_Def_Config:function(e){t(p.EV_UI_EC_Load_Def_Config(e))},ACT_SUCCESS:function(e){t(p.EV_UI_ACT(f.EVENT.SUCCESS))},ACT_Fail:function(e){t(p.EV_UI_ACT(f.EVENT.FAIL))},ACT_EXIT:function(e){t(p.EV_UI_ACT(p.UI_SM_EVENT.EXIT))},ACT_Def_Model_Path_Update:function(e){t(p.Def_Model_Path_Update(e))},ACT_WS_SEND:function(){return t(p.EV_WS_SEND.apply(p,arguments))},ACT_ClearImage:function(){t(p.EV_WS_Image_Update(null))},ACT_Report_Save:function(e,n,a){var i=p.EV_WS_SEND(e,"SV",0,{filename:n},a);console.log(i),t(i)},ACT_Cache_Img_Save:function(e,n){t(p.EV_WS_SEND(e,"SV",0,{filename:n,type:"__CACHE_IMG__"}))},ACT_SIG360_Extraction:function(e){return t(p.EV_WS_SIG360_Extraction(e))},DISPATCH:function(e){t(e)}}})(I);e.default=O},798:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InspectionResultDisplay_FullScren=e.OK_NG_BOX_COLOR_TEXT=void 0;var a,i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(98),s=D(n(1)),l=D(n(190)),u=x(n(81)),d=D(n(199)),c=D(n(192)),h=n(32),p=x(h),f=n(43),S=D(n(83)),E=n(174),v=n(39),_=x(n(44)),b=x(n(74)),y=D(n(799)),m=D(n(807)),g=(D(n(808)),D(n(154))),k=D(n(820)),T=D(n(423)),C=D(n(172)),A=D(n(825)),N=D(n(45)),w=D(n(52)),P=D(n(15)),I=D(n(436));n(914);var O=D(n(151));function x(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function D(t){return t&&t.__esModule?t:{default:t}}function M(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function F(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var R=n(920),j=_.getLogger("InspectionUI"),W=N.default.Group,B={name:"file",onChange:function(t){console.log(t)}},H=C.default.Option,G=(s.default.createElement(C.default,{defaultValue:"Http://",style:{width:90}},s.default.createElement(H,{value:"Http://"},"Http://"),s.default.createElement(H,{value:"Https://"},"Https://")),s.default.createElement(C.default,{defaultValue:".com",style:{width:80}},s.default.createElement(H,{value:".com"},".com"),s.default.createElement(H,{value:".jp"},".jp"),s.default.createElement(H,{value:".cn"},".cn"),s.default.createElement(H,{value:".org"},".org")),w.default.SubMenu),V=(w.default.ItemGroup,function(t){function e(t){U(this,e);var n=L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={},n.WS_DB_Inser=void 0,n.WS_DB_Query=void 0,n}return F(e,s.default.Component),r(e,[{key:"componentWillUnmount",value:function(){this.websocketClose()}},{key:"componentWillMount",value:function(){this.websocketConnect(this.props.url)}},{key:"componentDidUpdate",value:function(t,e,n){if(this.props.reportStatisticState.newAddedReport.length>0){var a=this.props.reportStatisticState.newAddedReport;this.send2WS_Insert(a)}}},{key:"handleLocalStorage",value:function(t){return R?(console.log("Local Storage: Supported"),R.setItem("HYVision",JSON.stringify(t)),R.length):(console.log("Local Storage: Unsupported"),0)}},{key:"send2WS_Query",value:function(t){}},{key:"send2WS_Insert",value:function(t){if(console.log("send2WS_Insert"),void 0!==this.WS_DB_Insert)if(console.log("readyState:"+this.WS_DB_Insert.readyState),this.WS_DB_Insert.readyState===WebSocket.OPEN){var e={dbcmd:{db_action:"insert",checked:!0},data:t};this.WS_DB_Insert.send_obj(e,function(t,e){return e.toFixed?Number(e.toFixed(5)):e}).then(function(t){return console.log("then",t)}).catch(function(t){return console.log("catch",t)})}else console.log("[X][WS]StatusCode="+this.WS_DB_Insert.readyState)}},{key:"websocketClose",value:function(){this.WS_DB_Insert.close(),this.WS_DB_Query.close()}},{key:"websocketConnect",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ws://hyv.decade.tw:8080/";if(void 0===this.WS_DB_Insert){console.log("[init][WS]"+e+"insert/insp");var n=new f.websocket_autoReconnect(e+"insert/insp",1e4);this.WS_DB_Insert=new f.websocket_reqTrack(n),this.WS_DB_Insert.onreconnection=function(t){return j.info("onreconnection"+t),!0},this.WS_DB_Insert.onconnectiontimeout=function(){return j.info("onconnectiontimeout")},this.WS_DB_Insert.onopen=this.onOpen.bind(this),this.WS_DB_Insert.onmessage=this.onMessage.bind(this),this.WS_DB_Insert.onclose=function(){return j.info("WS_DB_Insert:onclose")},this.WS_DB_Insert.onerror=function(){return t.onError.bind(t)}}if(void 0===this.WS_DB_Query){console.log("[init][WS]"+e+"query/insp");var a=new f.websocket_autoReconnect(e+"query/insp",1e4);this.WS_DB_Query=new f.websocket_reqTrack(a),this.WS_DB_Query.onreconnection=function(t){return j.info("onreconnection"+t),!0},this.WS_DB_Query.onconnectiontimeout=function(){return j.info("onconnectiontimeout")},this.WS_DB_Query.onopen=this.onOpen.bind(this),this.WS_DB_Query.onmessage=this.onMessage.bind(this),this.WS_DB_Query.onclose=function(){return j.info("WS_DB_Query:onclose")},this.WS_DB_Query.onerror=function(){return t.onError.bind(t)}}}},{key:"onError",value:function(t){console.log("onError RAW_InspectionReportPull")}},{key:"onOpen",value:function(t){console.log("onOpen RAW_InspectionReportPull")}},{key:"onMessage",value:function(t){console.log(t)}},{key:"render",value:function(){return null}}]),e}()),X=(function(t){function e(t){U(this,e);var n=L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.resultDB=void 0,n.state={db_open:!1,resultX:void 0},n}F(e,s.default.Component),r(e,[{key:"componentDidMount",value:function(){}},{key:"echoTime",value:function(){return""+(new Date).getSeconds()}},{key:"query",value:function(){var t=this;return this.resultDB="[!]",fetch("http://127.0.0.1:4000/gui",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:"{ hello }"})}).then(function(t){return t.json()}).then(function(e){console.log("[O]DB data returned:",JSON.stringify(e)),t.resultDB=JSON.stringify(e)}),this.resultDB}},{key:"render",value:function(){return s.default.createElement("div",{style:{display:"inline-block"}},s.default.createElement("p",null))}}])}(),e.OK_NG_BOX_COLOR_TEXT=(M(a={},E.MEASURERSULTRESION.NA,{COLOR:"#aaa",TEXT:E.MEASURERSULTRESION.NA}),M(a,E.MEASURERSULTRESION.UOK,{COLOR:"#87d068",TEXT:E.MEASURERSULTRESION.UOK}),M(a,E.MEASURERSULTRESION.LOK,{COLOR:"#87d068",TEXT:E.MEASURERSULTRESION.LOK}),M(a,E.MEASURERSULTRESION.UCNG,{COLOR:"#d0d068",TEXT:E.MEASURERSULTRESION.UCNG}),M(a,E.MEASURERSULTRESION.LCNG,{COLOR:"#d0d068",TEXT:E.MEASURERSULTRESION.LCNG}),M(a,E.MEASURERSULTRESION.USNG,{COLOR:"#f50",TEXT:E.MEASURERSULTRESION.USNG}),M(a,E.MEASURERSULTRESION.LSNG,{COLOR:"#f50",TEXT:E.MEASURERSULTRESION.LSNG}),a)),z=e.InspectionResultDisplay_FullScren=function(t){function e(t){U(this,e);var n=L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={folderStruct:{},history:["./"]},n}return F(e,s.default.Component),r(e,[{key:"render",value:function(){var t=this.props.IR;if(!Array.isArray(t))return null;var e=this.props.resultMenuCopy,n=s.default.createElement("div",null,"Object List Window"),a=e.map(function(t,e,n){return"sub1"+e}),i=e.map(function(t){return s.default.createElement(m.default,{span:8},s.default.createElement(w.default,{selectable:!0,defaultSelectedKeys:["functionMenu"],defaultOpenKeys:a,mode:"inline"},t))});return s.default.createElement(O.default,{title:n,visible:this.props.visible,width:void 0===this.props.width?900:this.props.width,onCancel:this.props.onCancel,onOk:this.props.onOk,footer:null},s.default.createElement("div",{style:{height:void 0===this.props.height?400:this.props.height}},s.default.createElement(y.default,{type:"flex",justify:"start",align:"top"},i)))}}]),e}(),Y=function(t){function e(t){U(this,e);var n=L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={},n}return F(e,s.default.Component),r(e,[{key:"clickFullScreen",value:function(){this.props.fullScreenToggleCallback()}},{key:"showResultValueCheck",value:function(t){return t.status==E.MEASURERSULTRESION.NA?"NaN ":t.value===+t.value?t.value.toFixed(3):"NaN "}},{key:"render",value:function(){var t=this.props.singleInspection;return s.default.createElement("div",{className:"s black",style:{borderBottom:"6px solid #A9A9A9",height:70}},s.default.createElement("div",{className:"s width8  HXF"},s.default.createElement("div",{className:"s vbox height4"},s.default.createElement(P.default,{type:"fullscreen",onClick:this.clickFullScreen.bind(this)}),t.name),s.default.createElement("div",{className:"s vbox  height8",style:{fontSize:25}},this.showResultValueCheck(t)+h.DEFAULT_UNIT[t.subtype])),s.default.createElement("div",{className:"s vbox width4 HXF"},s.default.createElement(T.default,{style:{fontSize:18},color:X[t.detailStatus].COLOR},X[t.detailStatus].TEXT)))}}]),e}(),K=function(t){function e(t){U(this,e);var n=L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={},n}return F(e,s.default.Component),r(e,[{key:"render",value:function(){return s.default.createElement("div",{style:{display:"inline-block"}},s.default.createElement(T.default,{style:{fontSize:20},color:X[this.props.detailStatus].COLOR},X[this.props.detailStatus].TEXT),this.props.children)}}]),e}(),J=function(){function t(e){U(this,t),this.data={DoImageTransfer:!0,emptyResultCount:0,cameraSpeedMode:-1,speedSwitchingCount:100},this.ws_ch=e.ws_ch,this.ev_speedModeChange=e.ev_speedModeChange,void 0===this.ev_speedModeChange&&(this.ev_speedModeChange=function(){}),this.ev_emptyResultCountChange=e.ev_emptyResultCountChange,void 0===this.ev_emptyResultCountChange&&(this.ev_emptyResultCountChange=function(){}),this.setSpeedSwitchingCount(1e3),this.setCameraSpeed_HIGH()}return r(t,[{key:"setCameraImageTransfer",value:function(t){void 0===t&&(t=!this.data.DoImageTransfer),this.data.DoImageTransfer=t,this.ws_ch({DoImageTransfer:t})}},{key:"setCameraSpeedMode",value:function(t){this.data.cameraSpeedMode!=t&&(j.info("setCameraSpeedMode:"+t),this.data.cameraSpeedMode=t,this.ev_speedModeChange(t),this.ws_ch({CameraSetting:{framerate_mode:t}}))}},{key:"setSpeedSwitchingCount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;this.data.speedSwitchingCount=t}},{key:"setCameraSpeed_HIGH",value:function(){this.setCameraSpeedMode(2)}},{key:"setCameraSpeed_LOW",value:function(){this.setCameraSpeedMode(0)}},{key:"updateInspectionReport",value:function(t){if(void 0===t||0==t.reports.length)return this.data.emptyResultCount++,this.data.emptyResultCount>this.data.speedSwitchingCount&&this.setCameraSpeed_LOW(),void this.ev_emptyResultCountChange(this.data.emptyResultCount);0!=this.data.emptyResultCount&&(this.ev_emptyResultCountChange(this.data.emptyResultCount),this.data.emptyResultCount=0,this.setCameraSpeed_HIGH())}}]),t}(),q=function(t){function e(t){U(this,e);var n=L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={collapsed:!1,fullScreen:!1},n}return F(e,s.default.Component),r(e,[{key:"toggleCollapsed",value:function(){this.setState(i({},this.state,{collapsed:!this.state.collapsed}))}},{key:"toggleFullscreen",value:function(){console.log("[XLINX2]fullScreen="+this.state.fullScreen),this.setState(i({},this.state,{fullScreen:!this.state.fullScreen}))}},{key:"render",value:function(){var t,e=this,n=this.props.IR;if(!Array.isArray(n))return null;t=n.filter(function(t){return t.isCurObj}).map(function(t,n){var a,i=t.judgeReports;a=i.map(function(t,a){var i;return s.default.createElement(Y,(M(i={key:"i"+n+t.name},"key",a),M(i,"singleInspection",t),M(i,"fullScreenToggleCallback",e.toggleFullscreen.bind(e)),i))});var r=i.reduce(function(t,e){return(0,E.MEASURERSULTRESION_reducer)(t,e.detailStatus)},void 0);return s.default.createElement(G,{style:{textAlign:"left"},key:"sub1"+n,title:s.default.createElement("span",null,s.default.createElement(P.default,{type:"paper-clip"}),s.default.createElement("span",null,n," ",s.default.createElement(K,{detailStatus:r})))},a)});var a=s.default.createElement(z,i({},this.state,{resultMenuCopy:t,IR:n,visible:this.state.fullScreen,onCancel:this.toggleFullscreen.bind(this),width:"90%"}));return s.default.createElement("div",null,s.default.createElement(w.default,{onClick:this.handleClick,selectable:!0,defaultSelectedKeys:["functionMenu"],mode:"inline"},s.default.createElement(G,{style:{textAlign:"left"},key:"functionMenu",title:s.default.createElement("span",null,s.default.createElement(P.default,{type:"setting"}),s.default.createElement("span",null,"平台功能操作"))},s.default.createElement(Q,{url:"ws://192.168.2.2:5213",checkResult2AirAction:this.props.checkResult2AirAction,WSCMD_CB:this.props.WSCMD_CB})),t),a)}}]),e}(),Q=function(t){function e(t){U(this,e);var n=L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={loading:!1,iconLoading:!1,websocketAirTime:10,STOP:!0},n.websocketAir=void 0,n.heartBeat={timer:void 0,PINGcount:0,PONGcount:0,PONGPace:0},n}return F(e,s.default.Component),r(e,[{key:"keyEventX",value:function(t){var e=t.keyCode||t.which,n=String.fromCharCode(e);switch(j.info("keyEvent>>",e,n),n){case"R":this.blowAir_RIGHTa();break;case"L":this.blowAir_LEFTa();break;case"B":this.blowAir_StartStop();break;case"1":this.blowAir_TIMEADD(10);break;case"2":this.blowAir_TIMESUB(10);break;case"T":this.blowAir_TEST();break;case"I":this.getCameraImage_StartStop()}}},{key:"blowAir_TEST",value:function(){console.log("[WS]/cue/TEST"),1===this.websocketAir.readyState?(console.log("[O][WS]/cue/TEST"),this.websocketAir.send("/cue/TEST")):console.log("[X][WS]/cue/TEST")}},{key:"blowAir_LEFTa",value:function(){this.websocketAir.readyState===this.websocketAir.OPEN?this.websocketAir.send("/cue/LEFT"):console.log("[X][WS]/cue/LEFT")}},{key:"blowAir_RIGHTa",value:function(){this.websocketAir.readyState===this.websocketAir.OPEN?this.websocketAir.send("/cue/RIGHT"):console.log("[X][WS]/cue/RIGHT")}},{key:"blowAir_TIMEUpdate",value:function(){this.setState(Object.assign({},this.state)),this.websocketAir.readyState===this.websocketAir.OPEN&&this.websocketAir.send("/cue/TIME/"+this.state.websocketAirTime)}},{key:"blowAir_StartStop",value:function(){this.state.STOP=!this.state.STOP,this.setState(Object.assign({},this.state))}},{key:"blowAir_TIMEADD",value:function(t){this.state.websocketAirTime+=t,this.blowAir_TIMEUpdate()}},{key:"blowAir_TIMESUB",value:function(t){this.state.websocketAirTime-=t,this.state.websocketAirTime<10&&(this.state.websocketAirTime=10),this.blowAir_TIMEUpdate()}},{key:"enterLoading",value:function(){this.setState(i({},this.state,{loading:!0}))}},{key:"sendHeartBeat",value:function(){if(void 0!==this.websocketAir&&this.websocketAir.readyState==this.websocketAir.OPEN){if(j.info("sendHeartBeat: PING:"+this.heartBeat.PINGcount," PONG:"+this.heartBeat.PONGPace+"/"+this.heartBeat.PONGcount),this.heartBeat.PINGcount>this.heartBeat.PONGPace+2)return j.error("Heart beat ERROR: PINGcount > PONGPace+2"),this.websocketAir.reconnect(),void(this.heartBeat.PINGcount=this.heartBeat.PONGPace=0);this.websocketAir.send("/cue/PING"),this.heartBeat.PINGcount++}}},{key:"componentWillMount",value:function(){var t=this;this._keyEventX=this.keyEventX.bind(this),console.log("[init][componentWillMount]"),this.websocketConnect(this.props.url),this.websocketAir=new f.websocket_autoReconnect(this.props.url,1e4),this.websocketAir.onreconnection=function(t){return console.log(t)},this.websocketAir.onmessage=this.onMessage.bind(this),this.websocketAir.onerror=this.onError.bind(this),this.websocketAir.onopen=function(e){t.setState(i({},t.state,{loading:!1})),console.log("onopen:",e),t.heartBeat.PINGcount=0,t.heartBeat.PONGcount=0},this.websocketAir.onclose=function(e){t.setState(i({},t.state,{loading:!0})),3001==e.code?console.log("ws closed",e):console.log("ws connection error",e)},document.addEventListener("keydown",this._keyEventX),this.heartBeat.timer=setInterval(this.sendHeartBeat.bind(this),3e3)}},{key:"componentWillUnmount",value:function(){void 0!==this.websocketAir&&(this.websocketAir.close(),this.websocketAir=void 0),document.removeEventListener("keydown",this._keyEventX),clearInterval(this.heartBeat.timer),this.heartBeat.timer=void 0}},{key:"websocketConnect",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.log("[init][WS][OK]"),console.log(this.websocketAir)}},{key:"onError",value:function(t){this.setState(i({},this.state,{loading:!1})),console.log("onError")}},{key:"onMessage",value:function(t){console.log(t);t.timeStamp;"/rsp/PONG"===t.data&&(this.heartBeat.PONGcount++,this.heartBeat.PONGPace=this.heartBeat.PINGcount)}},{key:"enterIconLoading",value:function(){}},{key:"componentWillReceiveProps",value:function(t){this.state.STOP||t.checkResult2AirAction.ver!=this.props.checkResult2AirAction.ver&&("left"===t.checkResult2AirAction.direction?this.blowAir_LEFTa():"right"===t.checkResult2AirAction.direction&&this.blowAir_RIGHTa())}},{key:"render",value:function(){var t=this;return void 0===this.websocketAir||this.websocketAir.readyState!=this.websocketAir.OPEN?s.default.createElement(u.AButton,{block:!0,text:"ReconnectAirDevice",type:"primary",shape:"round",icon:"loading",size:"large",dict:S.default,onClick:function(){t.websocketConnect(t.props.url)}}):s.default.createElement("div",null,s.default.createElement(N.default,{block:!0,style:{marginTop:2,marginBottom:2},type:"primary",size:"small",onClick:function(){return t.blowAir_StartStop()}},"噴氣功能(B): ",this.state.STOP?" 暫停=":" 啟動=",this.state.websocketAirTime,"ms"),s.default.createElement(W,null,s.default.createElement(N.default,{style:{backgroundColor:"#c41d7f",marginBottom:2},type:"primary",size:"large",onClick:this.blowAir_LEFTa.bind(this)},s.default.createElement(P.default,{type:"double-left"}),"NG左"),s.default.createElement(N.default,{style:{backgroundColor:"#7cb305",marginBottom:2},type:"primary",size:"large",onClick:function(){return t.blowAir_RIGHTa()}},"右OK",s.default.createElement(P.default,{type:"double-right"}))),s.default.createElement(N.default,{block:!0,style:{marginBottom:2},type:"primary",size:"small",onClick:function(){return t.blowAir_TIMEADD(10)}},s.default.createElement(P.default,{type:"up-circle"}),"增加噴氣時間(1)"),s.default.createElement(N.default,{block:!0,style:{marginBottom:2},type:"primary",size:"small",onClick:function(){return t.blowAir_TIMESUB(10)}},s.default.createElement(P.default,{type:"down-circle"}),"漸少噴氣時間(2)"),s.default.createElement(N.default,{block:!0,style:{marginBottom:2},type:"primary",size:"small",onClick:function(){return t.blowAir_TEST()}},s.default.createElement(P.default,{type:"swap"}),"測試左右噴氣(T)",s.default.createElement(P.default,{type:"swap"})),s.default.createElement("br",null),s.default.createElement(A.default,B,s.default.createElement(N.default,{block:!0,style:{marginBottom:3},type:"primary",size:"small"},s.default.createElement(P.default,{type:"thunderbolt"}),"快速切換特徵檔案",s.default.createElement(P.default,{type:"thunderbolt"}))),s.default.createElement("div",null))}}]),e}(),$=function(t){function e(t){U(this,e);var n=L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.windowSize={},n}return F(e,s.default.Component),r(e,[{key:"ec_canvas_EmitEvent",value:function(t){switch(t.type){case b.EVENT.ERROR:j.error(t),this.props.ACT_ERROR()}}},{key:"componentDidMount",value:function(){this.ec_canvas=new c.default.INSP_CanvasComponent(this.refs.canvas),this.ec_canvas.EmitEvent=this.ec_canvas_EmitEvent.bind(this),this.props.onCanvasInit(this.ec_canvas),this.updateCanvas(this.props.c_state)}},{key:"componentWillUnmount",value:function(){this.ec_canvas.resourceClean()}},{key:"updateCanvas",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props;void 0!==this.ec_canvas&&(j.debug("updateCanvas>>",e.edit_info),this.ec_canvas.EditDBInfoSync(e.edit_info),this.ec_canvas.SetState(t),this.ec_canvas.draw())}},{key:"onResize",value:function(t,e){Math.hypot(this.windowSize.width-t,this.windowSize.height-e)<5||void 0!==this.ec_canvas&&(this.ec_canvas.resize(t,e),this.windowSize={width:t,height:e},this.updateCanvas(this.props.c_state))}},{key:"componentWillUpdate",value:function(t,e){this.updateCanvas(t.c_state,t)}},{key:"render",value:function(){return s.default.createElement("div",{className:this.props.addClass},s.default.createElement("canvas",{ref:"canvas",className:"width12 HXF"}),s.default.createElement(d.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),e}(),Z=(0,o.connect)(function(t){return{c_state:t.UIData.c_state,edit_info:t.UIData.edit_info}},function(t,e){return{ACT_EXIT:function(e){t(p.EV_UI_ACT(p.UI_SM_EVENT.EXIT))},ACT_ERROR:function(e){t(p.EV_UI_ACT(p.UI_SM_EVENT.ERROR))}}})($),tt=function(t){function e(t){U(this,e);var n=L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.divID="ControlChart_ID_"+Math.round(1e4*Math.random()),n.charObj=void 0,n.state={chartOpt:{type:"line",data:{labels:[],datasets:[{type:"line",borderColor:"rgb(100, 255, 100)",lineTension:.2,data:[],pointBackgroundColor:[]}]},bezierCurve:!1,options:{scales:{xAxes:[{ticks:{callback:function(t,e,n){return t}}}]},elements:{line:{fill:!1},point:{radius:6}},bezierCurve:!1,animation:{duration:0},maintainAspectRatio:!1,responsive:!0,title:{display:!0,text:""},annotation:{annotations:[]},legend:{display:!1},tooltips:{enabled:!0}}}},n.default_annotationTargets=[{type:"USL",color:"rgba(200, 0, 0,0.2)"},{type:"LSL",color:"rgba(200, 0, 0,0.2)"},{type:"UCL",color:"rgba(100, 100, 0,0.2)"},{type:"LCL",color:"rgba(100, 100, 0,0.2)"},{type:"value",color:"rgba(0, 0, 0,0.2)"}],n}return F(e,s.default.Component),r(e,[{key:"componentWillUpdate",value:function(t,e){this.state.chartOpt.data.labels=[],this.state.chartOpt.data.datasets.forEach(function(t){t.data=[],t.pointBackgroundColor=[]});var n=t.reportArray.length;if(0!=n){var a=t.reportArray[n-1].time_ms;this.state.chartOpt.options.title.text=t.reportArray[0].judgeReports.find(function(e){return e.id==t.targetMeasure.id}).name,t.reportArray.reduce(function(e,n,i){e.labels.push((a-n.time_ms)/1e3);var r=n.judgeReports.find(function(e){return e.id==t.targetMeasure.id}),o=void 0,s=r.value;return void 0===(o=X[r.detailStatus].COLOR)&&(o="#AA0000"),r.detailStatus===E.MEASURERSULTRESION.NA&&(s=void 0),e.datasets[0].pointBackgroundColor.push(o),e.datasets[0].data.push(s),e},this.state.chartOpt.data);var i=this.props.nnotationTargets;void 0===i&&(i=this.default_annotationTargets),this.state.chartOpt.options.annotation.annotations=i.map(function(e){return{type:"line",mode:"horizontal",scaleID:"y-axis-0",value:t.targetMeasure[e.type],borderColor:e.color,borderWidth:4,borderDash:[12,12],label:{position:"right",enabled:!0,content:e.type}}}),this.charObj.update()}}},{key:"componentDidMount",value:function(){var t=document.getElementById(this.divID).getContext("2d");this.charObj=new I.default(t,this.state.chartOpt)}},{key:"onResize",value:function(t,e){}},{key:"render",value:function(){return s.default.createElement("div",{className:this.props.className},s.default.createElement("canvas",{id:this.divID,style:{height:"400px"}}),s.default.createElement(d.default,{handleWidth:!0,handleHeight:!0,onResize:this.onResize.bind(this)}))}}]),e}(),et=function(t){function e(t){U(this,e);var n=L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={drawList:[]},n}return F(e,s.default.Component),r(e,[{key:"render",value:function(){var t=this,e=this.props.reportStatisticState;if(void 0===e.statisticValue)return null;var n=e.statisticValue.measureList,a=n.map(function(t){return{id:t.id,name:t.name,subtype:t.subtype,count:t.statistic.count,mean:(0,f.round)(t.statistic.mean,.001),sigma:(0,f.round)(t.statistic.sigma,.001),CK:(0,f.round)(t.statistic.CK,.001),CPU:(0,f.round)(t.statistic.CPU,.001),CPL:(0,f.round)(t.statistic.CPL,.001),CP:(0,f.round)(t.statistic.CP,.001),CPK:(0,f.round)(t.statistic.CPK,.001)}});if(0==a.length)return null;var i=a,r=["name","subtype","count","mean","sigma","CK","CP","CPU","CPL","CPK"].map(function(t){return{title:t,dataIndex:t,key:t}}).map(function(t){return"number"==typeof a[0][t.title]?Object.assign(t,{sorter:function(e,n){return e[t.title]-n[t.title]}}):t});r.push({title:"Draw Toggle",key:"draw",fixed:"right",render:function(e,n){return s.default.createElement(k.default,{onChange:function(e){t.state.drawList[n.id]=e}})}});var o=Object.keys(this.state.drawList).map(function(a,i){if(1==t.state.drawList[a]){var r=n.find(function(t){return t.id==a}),o=e.historyReport.slice(Math.max(e.historyReport.length-500,1));return s.default.createElement(tt,{reportArray:o,targetMeasure:r})}return null});return s.default.createElement("div",{className:this.props.className},s.default.createElement(g.default,{key:"dat_table",dataSource:i,columns:r,scroll:{x:1e3},pagination:!1}),o)}}]),e}(),nt=(function(t){function e(t){return U(this,e),L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}F(e,s.default.Component),r(e,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}}]),r(e,[{key:"render",value:function(){var t=this.props.inspection_Info.statisticValue;if(void 0===t)return null;var e=t.measureList.map(function(t){return s.default.createElement("div",null,t.statistic.mean)});return s.default.createElement("div",{className:this.props.addClass},e)}}])}(),function(t){function e(t){U(this,e);var n=L(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.ec_canvas=null,n.checkResult2AirAction={direction:"none",ver:0},n.state={GraphUIDisplayMode:0,CanvasWindowRatio:9},n.CameraCtrl=new J({ws_ch:function(t,e){n.props.ACT_WS_SEND(n.props.WS_ID,"ST",0,t,void 0,e)},ev_speedModeChange:function(t){console.log(t)}}),n}return F(e,s.default.Component),r(e,[{key:"componentDidMount",value:function(){this.props.ACT_WS_SEND(this.props.WS_ID,"CI",0,{deffile:this.props.defModelPath+"."+v.DEF_EXTENSION}),this.CameraCtrl.setCameraImageTransfer(!1)}},{key:"componentWillUnmount",value:function(){this.props.ACT_WS_SEND(this.props.WS_ID,"CI",0,{})}}]),r(e,[{key:"componentDidUpdate",value:function(){this.CameraCtrl.updateInspectionReport(this.props.inspectionReport)}},{key:"render",value:function(){var t=this,e=void 0;if(void 0!==this.props.inspectionReport&&(e=this.props.inspectionReport).reports.length>0){var n=e.reports.map(function(t){return t.judgeReports.reduce(function(t,e){return t==v.INSPECTION_STATUS.NA?t:t==v.INSPECTION_STATUS.FAILURE?e.status==v.INSPECTION_STATUS.NA?v.INSPECTION_STATUS.NA:t:e.status},v.INSPECTION_STATUS.SUCCESS)}).reduce(function(t,e){return void 0===t?e:t==v.INSPECTION_STATUS.NA||e==v.INSPECTION_STATUS.NA?v.INSPECTION_STATUS.NA:t!=e?v.INSPECTION_STATUS.NA:e},void 0);n==v.INSPECTION_STATUS.SUCCESS?this.checkResult2AirAction={direction:"right",ver:this.checkResult2AirAction.ver+1}:n==v.INSPECTION_STATUS.FAILURE?this.checkResult2AirAction={direction:"left",ver:this.checkResult2AirAction.ver+1}:j.error("result NA...")}var a=[];j.debug("CanvasComponent render");var i=12,r=1;switch(a=[s.default.createElement(u.IconButton,{dict:S.default,key:"<",addClass:"layout black vbox",text:"<",onClick:this.props.ACT_EXIT}),s.default.createElement(u.IconButton,{iconType:"file",key:"LOADDef",addClass:"layout gray-1 vbox",text:this.props.defModelName,onClick:function(){}}),s.default.createElement(u.IconButton,{dict:S.default,iconType:"bar-chart",key:"Info Graphs",addClass:"layout black vbox",text:"Info Graphs",onClick:function(){t.state.GraphUIDisplayMode=(t.state.GraphUIDisplayMode+1)%3,t.setState(Object.assign({},t.state))}})],this.state.GraphUIDisplayMode){case 0:i=12,r=1;break;case 1:i=3,r=.3;break;case 2:i=0,r=.3;break;case 3:i=3,r=.3}return a.push(s.default.createElement(u.IconButton,{dict:S.default,iconType:"up-square",key:"DoImageTransfer",addClass:"layout palatte-blue-8 vbox",text:"傳輸相機影像(I): "+(this.state.DoImageTransfer?"暫停":"啟動"),onClick:function(){return t.CameraCtrl.setCameraImageTransfer()}})),a.push(s.default.createElement(q,{IR:this.props.reportStatisticState.trackingWindow,checkResult2AirAction:this.checkResult2AirAction,key:"ObjInfoList",WSCMD_CB:function(e,n,a,i){t.props.ACT_WS_SEND(t.props.WS_ID,e,n,a,i)}})),s.default.createElement("div",{className:"overlayCon HXF"},i<=0?null:s.default.createElement(Z,{addClass:"layout WXF height"+i,onCanvasInit:function(e){t.ec_canvas=e}}),i>=12?null:s.default.createElement(et,{className:"s scroll WXF height"+(12-i),reportStatisticState:this.props.reportStatisticState}),s.default.createElement(V,{reportStatisticState:this.props.reportStatisticState,url:"ws://hyv.decade.tw:8080/"}),s.default.createElement(l.default,{transitionName:"fadeIn"},s.default.createElement("div",{key:"MENU",className:"s overlay shadow1 scroll MenuAnim HXA",style:{opacity:r,width:"250px"}},a)))}}]),e}()),at=(0,o.connect)(function(t){return{c_state:t.UIData.c_state,shape_list:t.UIData.edit_info.list,defModelName:t.UIData.edit_info.DefFileName,defModelPath:t.UIData.edit_info.defModelPath,WS_ID:t.UIData.WS_ID,inspectionReport:t.UIData.edit_info.inspReport,reportStatisticState:t.UIData.edit_info.reportStatisticState}},function(t,e){return{ACT_EXIT:function(e){t(p.EV_UI_ACT(p.UI_SM_EVENT.EXIT))},ACT_WS_SEND:function(e,n,a,i,r,o){return t(p.EV_WS_SEND(e,n,a,i,r,o))}}})(nt);e.default=at},81:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SwitchButton=e.ImgSprite=e.Button=e.IconButton=e.AButton=e.DropDown=e.BPG_FileBrowser_proto=e.BPG_FolderBrowser=e.BPG_FileSavingBrowser=e.BPG_FileBrowser=e.DropDownWarp=e.CardFrameWarp=e.JsonEditBlock=e.JsonElement=void 0;var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=_(n(1)),s=_(n(491)),l=n(43),u=_(n(82)),d=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(44)),c=_(n(83)),h=_(n(45)),p=_(n(151)),f=_(n(154)),S=_(n(15)),E=_(n(52)),v=_(n(242));function _(t){return t&&t.__esModule?t:{default:t}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var g=h.default.Group,k=d.getLogger("baseComponent"),T=e.JsonElement=function(t){function e(){return b(this,e),y(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return m(e,o.default.Component),r(e,[{key:"render",value:function(){return void 0!==this.props.type.type?this.renderComplex():this.renderSimple()}},{key:"renderComplex",value:function(){switch(this.props.type.type){case"droplist":return o.default.createElement("div",{key:this.props.id,className:this.props.className},this.props.children)}}},{key:"renderSimple",value:function(){var t=this,e=this.props.children,n=void 0;switch("div"==this.props.type&&void 0===(n=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,e]))&&(n=(0,l.GetObjElement)(this.props.dict,["fallback",e])),void 0===n&&(n=e),this.props.type){case"input-number":return n+="",o.default.createElement("input",{key:this.props.id,className:this.props.className,type:"number",step:"0.1",pattern:"^[-+]?[0-9]*(\\.[0-9]*)?",value:n,onChange:function(e){return t.props.onChange(t.props.target,t.props.type,e)}});case"input":return o.default.createElement("input",{key:this.props.id,className:this.props.className,value:n,onChange:function(e){return t.props.onChange(t.props.target,t.props.type,e)}});case"checkbox":return o.default.createElement("input",{key:this.props.id,className:this.props.className,type:"checkbox",checked:n,onChange:function(e){return t.props.onChange(t.props.target,t.props.type,e)}});case"btn":return o.default.createElement("button",{key:this.props.id,className:this.props.className,onClick:function(e){return t.props.onChange(t.props.target,t.props.type,e)}},n);case"div":default:return o.default.createElement("div",{key:this.props.id,className:this.props.className},n," ")}}}]),e}(),C=(e.JsonEditBlock=function(t){function e(t){b(this,e);var n=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.tmp={object:{}},n}return m(e,o.default.Component),r(e,[{key:"onChangeX",value:function(t,e,n){return this.props.jsonChange(this.tmp.object,t,e,n),!0}},{key:"shouldComponentUpdate",value:function(t,e){return!0}},{key:"composeObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=[],s=null==e?t:e;for(var u in s){var d=t[u],c=null==e?null:e[u];if(void 0!==d&&void 0!==c){var h=a.slice();h.push(u);var p=void 0;switch(void 0===(p=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,u]))&&(p=(0,l.GetObjElement)(this.props.dict,["fallback",u])),void 0===p&&(p=u),void 0===d?"undefined":i(d)){case"string":case"boolean":case"number":null==c&&(c="div"),r.push(o.default.createElement("div",{key:n+"_"+u+"_txt",className:"s HX1 width4 vbox black"},p)),r.push(o.default.createElement(T,{key:n+"_"+u+"_ele",className:"s HX1 width8 vbox blackText",type:c,target:{obj:t,keyTrace:h},dict:this.props.dict,onChange:this.onChangeX.bind(this)},d));break;case"object":r.push(o.default.createElement("div",{key:n+"_"+u+"_HL",className:"s HX0_1 WXF  vbox"}));var f=null==c?"div":c.__OBJ__;null==f&&(f="div"),r.push(o.default.createElement(T,{key:n+"_"+u+"_ele",dict:this.props.dict,className:"s HX1 WXF vbox black",type:f,onChange:this.onChangeX.bind(this),target:{obj:t,keyTrace:h}},p)),r.push(o.default.createElement("div",{key:n+"_"+u+"__",className:"s HX1 width1"})),r.push(o.default.createElement("div",{key:n+"_"+u+"_C",className:"s HXA width11"},this.composeObject(d,c,n+"_"+u,h))),r.push(o.default.createElement("div",{key:n+"_"+u+"_HL2",className:"s HX0_1 WXF  vbox"}));break;default:r.push(o.default.createElement("div",{key:n+"_"+u+"_txt",className:"s HX1 width3 vbox black"},u)),r.push(o.default.createElement("div",{key:n+"_"+u+"_XXX",className:"s HX1 width9 vbox lblue"},"Not supported"))}}}return r}},{key:"render",value:function(){this.tmp.object=(0,u.default)(this.props.object);var t=this.composeObject(this.tmp.object,this.props.whiteListKey);return o.default.createElement("div",{className:"WXF HXA"},t)}}]),e}(),e.CardFrameWarp=(0,s.default)({getDefaultProps:function(){return{boxShadow:"1px 2px 10px #000",addClass:""}},render:function(){var t=this.props.fixedFrame?"HXF":"HXA",e=this.props.addClass+(this.props.fixedFrame?"":" HXA");return o.default.createElement("div",{className:"padding "+e},o.default.createElement("div",{className:t+" white padding ",style:{boxShadow:this.props.boxShadow}},this.props.children))}})),A=e.DropDownWarp=(0,s.default)({render:function(){var t="HXA dropDownContent "+(this.props.ifShowDropDown?"":"hide ")+this.props.dropdownClass;return o.default.createElement("div",{className:"dropDown "+this.props.containerClass},this.props.children[0],o.default.createElement("div",{className:t,style:this.props.dropdownStyle},this.props.children.slice(1,this.props.children.length)))}}),N=(e.BPG_FileBrowser=function(t){function e(){return b(this,e),y(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return m(e,o.default.Component),r(e,[{key:"render",value:function(){return o.default.createElement(N,a({},this.props,{footer:null}))}}]),e}(),e.BPG_FileSavingBrowser=function(t){function e(t){b(this,e);var n=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={fileName:void 0===t.defaultName?"":t.defaultName,folderInfo:void 0},n}return m(e,o.default.Component),r(e,[{key:"isASCII",value:function(t){return(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(t)}},{key:"render",value:function(){var t=this,e=null!=this.state.folderInfo&&void 0!==this.state.folderInfo.files.find(function(e){return e.name==t.state.fileName});return console.log(e),o.default.createElement(N,a({},this.props,{onFileSelected:function(e){var n=e.substr(e.lastIndexOf("/")+1);t.setState(a({},t.state,{fileName:n}))},footer:o.default.createElement("div",null,o.default.createElement(v.default,{className:"width9",placeholder:"File Name",value:this.state.fileName,onChange:function(e){var n=e.target.value;t.isASCII(n)&&t.setState(a({},t.state,{fileName:n}))}}),o.default.createElement(g,{className:"width2"},o.default.createElement(h.default,{onClick:this.props.onCancel},"Cancel"),o.default.createElement(h.default,{onClick:function(){return t.props.onOk(t.state.folderInfo,t.state.fileName,e)},type:e?"danger":"primary",disabled:0==this.state.fileName.length||void 0===this.state.folderInfo},"OK"))),onFolderLoaded:function(e){t.setState(a({},t.state,{folderInfo:e}))}}))}}]),e}(),e.BPG_FolderBrowser=function(t){function e(){return b(this,e),y(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return m(e,o.default.Component),r(e,[{key:"render",value:function(){return o.default.createElement(N,a({},this.props,{footer:null}))}}]),e}(),e.BPG_FileBrowser_proto=function(t){function e(t){b(this,e);var n=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={folderStruct:{},history:["./"]},n}return m(e,o.default.Component),r(e,[{key:"goDir",value:function(t){var e=this;if(void 0===t){if(this.state.history.length<=1)return;this.state.history.pop(),t=this.state.history[this.state.history.length-1]}else{if(t==this.state.history[this.state.history.length-1])return;this.state.history.push(t)}new Promise(function(n,a){e.props.BPG_Channel("FB",0,{path:t,depth:0},void 0,{resolve:n,reject:a}),setTimeout(function(){return a("Timeout")},1e3)}).then(function(t){if(t[1].data.ACK){var n=t[0].data;e.setState(Object.assign(e.state,{folderStruct:n})),void 0!==e.props.onFolderLoaded&&e.props.onFolderLoaded(n)}else setTimeout(function(){return e.goDir()},1e3)}).catch(function(t){console.log(t)})}},{key:"componentWillMount",value:function(){this.goDir(this.props.path)}},{key:"componentDidUpdate",value:function(t){1==this.props.visible&&0==t.visible&&this.goDir(this.props.path)}},{key:"bytesToSize",value:function(t){if(0==t)return"0 Byte";var e=parseInt(Math.floor(Math.log(t)/Math.log(1024)));return Math.round(t/Math.pow(1024,e),2)+" "+["Bytes","KB","MB","GB","TB"][e]}},{key:"render",value:function(){var t=this,e=["type","name","size"].map(function(t){return{title:t,dataIndex:t,key:t}});e[0].render=function(t,e){var n="DIR"==t?"folder":"file";return o.default.createElement(S.default,{type:n})},e[0].width=64;var n=void 0===this.state.folderStruct.files?[]:this.state.folderStruct.files;(n=n.filter(function(e){return"."!=e.name&&".."!=e.name&&(void 0===t.props.fileFilter||t.props.fileFilter(e))})).forEach(function(e){e.size=t.bytesToSize(e.size_bytes),e.key=e.name});var a="string"==typeof this.state.folderStruct.path?this.state.folderStruct.path.replace(/\\+/g,"/").split("/"):[];(a=a.map(function(t){return{name:t}})).reduce(function(t,e){return t=t+e.name+"/",e.path=t,t},"");var i=o.default.createElement("div",null,o.default.createElement(g,null,o.default.createElement(h.default,{type:"primary",onClick:function(){return t.goDir()}},o.default.createElement(S.default,{type:"left"}))),"   ",o.default.createElement(g,null,a.map(function(e,n){return o.default.createElement(h.default,{key:e.name+"_"+n,onClick:function(){return t.goDir(e.path)}},e.name)})));return o.default.createElement(p.default,{title:i,visible:this.props.visible,width:void 0===this.props.width?900:this.props.width,onCancel:this.props.onCancel,onOk:this.props.onOk,footer:this.props.footer},o.default.createElement("div",{style:{height:void 0===this.props.height?400:this.props.height}},o.default.createElement("div",{className:"s height12 width2 scroll",key:"sideMenu"},o.default.createElement(E.default,{onClick:function(e){t.goDir(e.item.props.path)},mode:"inline"},[{name:"origin",path:"./"}].map(function(t){return o.default.createElement(E.default.Item,{key:t.name,path:t.path},t.name)}))),o.default.createElement("div",{className:"height12 width10 scroll",key:"folderView"},o.default.createElement(f.default,{onRow:function(e){return{onClick:function(n){"DIR"!=e.type?t.props.onFileSelected(t.state.folderStruct.path+"/"+e.name,e):t.goDir(t.state.folderStruct.path+"/"+e.name)}}},pagination:!1,columns:e,dataSource:n}))))}}]),e}()),w=(e.DropDown=(0,s.default)({handleClick:function(t,e){this.props.onClick(t,e)},shouldComponentUpdate:function(t,e){return t!=this.props},render:function(){var t=[],e=!0,n=!1,a=void 0;try{for(var i,r=this.props.dropMenu[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var s=i.value,l=[],u=!0,d=!1,c=void 0;try{for(var h,p=s.ele[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var f=h.value;l.push(o.default.createElement(w,{addClass:" textAlignLeft dropDownBtn",key:f.id,id:f.id,text:f.text,onClick:s.callBack}))}}catch(t){d=!0,c=t}finally{try{!u&&p.return&&p.return()}finally{if(d)throw c}}var S="black HX"+s.ele.length+" ";t.push(o.default.createElement("div",{key:s.id+"_div"},o.default.createElement("div",{key:s.text,className:S+"width1 rotateContent"},o.default.createElement("p",null,s.text)),o.default.createElement("div",{key:s.id+"_block",className:S+"width11"},l))),t.push(o.default.createElement("div",{key:s.id+"_",className:"black HX0_1 "}))}}catch(t){n=!0,a=t}finally{try{!e&&r.return&&r.return()}finally{if(n)throw a}}return o.default.createElement(A,{containerClass:this.props.className,ifShowDropDown:this.props.ifShowDropDown,dropdownClass:"aniFlipin",dropdownStyle:{width:"300px"}},o.default.createElement(w,{addClass:"HXF lgreen",text:"...",onClick:this.handleClick}),o.default.createElement(C,{boxShadow:"1px 2px 20px #333"},t))}}),e.AButton=(0,s.default)({handleClick:function(t){this.props.onClick(t,this)},render:function(){var t=void 0;return void 0===(t=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,this.props.text]))&&(t=(0,l.GetObjElement)(this.props.dict,["fallback",this.props.text])),void 0===t&&(t=this.props.text),o.default.createElement(h.default,{block:!0,type:this.props.type,shape:"round",icon:this.props.icon,size:this.props.size,dict:c.default,onClick:this.handleClick},t)}}),e.IconButton=(0,s.default)({handleClick:function(t){this.props.onClick(t,this)},render:function(){k.debug(this.props),k.debug(this.context);var t="button s "+this.props.addClass,e=void 0;return void 0!==this.props.dict&&void 0===(e=(0,l.GetObjElement)(this.props.dict,[this.props.dictTheme,this.props.text]))&&(e=(0,l.GetObjElement)(this.props.dict,["fallback",this.props.text])),void 0===e&&(e=this.props.text),o.default.createElement("div",{onClick:this.handleClick,className:t},void 0===this.props.iconType?null:o.default.createElement(S.default,{className:"layout iconButtonSize veleY",type:this.props.iconType}),o.default.createElement("p",{className:"layout veleY iconTextPadding"},e))}}),e.Button=(0,s.default)({handleClick:function(t){this.props.onClick(t,this)},render:function(){var t="button s vbox "+this.props.addClass;return o.default.createElement("div",{onClick:this.handleClick,className:t},o.default.createElement("p",null,this.props.text))}}));e.ImgSprite=(0,s.default)({shouldComponentUpdate:function(t,e){return t.position!=this.props.position||t.id!=this.props.id||t.style!=this.props.style||t.offset!=this.props.offset},render:function(){var t=this.props.spriteInfo,e=null!=this.props.spriteScale?this.props.spriteScale:1,n=null!=this.props.offset?this.props.offset:{x:0,y:0},a=-this.props.id%t.xLimit,i=-Math.floor(this.props.id/t.xLimit),r=Object.assign({},this.props.style,{width:t.sWidth*e+"px",height:t.sHeight*e+"px",background:"url("+t.url+") "+(n.x+t.sWidth*a)*e+"px "+(n.y+t.sHeight*i)*e+"px",backgroundSize:t.width*e+"px "+t.height*e+"px"});return o.default.createElement("div",{style:r,className:this.props.className})}}),e.SwitchButton=(0,s.default)({handleClick:function(t){this.props.onClick(t,this)},render:function(){var t="lgray vbox "+this.props.addClass;return o.default.createElement("button",{onClick:this.handleClick,className:t},o.default.createElement("p",null,this.props.text))}})},83:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={fallback:{ReconnectAirDevice:"重新連接噴氣裝置",line:"量測線段/Line",arc:"量測弧/Arc",spoint:"搜尋點/SPOINT",search_point:"搜尋點",apoint:"交點/APOINT",aux_point:"交點","<":"< 返回",measure:"測量定義/MEASURE",edit:"編輯測量定義/Edit",save:"儲存定義/SAVE",load:"讀取定義/LOAD",take:"重新設定/TAKE",type:"類型",subtype:"次類型",value:"出貨目標",margin:"範圍",submargin1:"生產目標",margin2:"次範圍",direction:"方向",angleDeg:"角度°",width:"寬",ref:"參考物件",ref_baseLine:"參考線",id:"編號",sigma:"標準差",distance:"距離/D",angle:"角度/A",radius:"半徑/R",name:"名稱",docheck:"必要判定",DefFileName:"設定檔名","Info Graphs":"資料圖表"},measure:{value:"目標",USL:"規格上限",LSL:"規格下限",UCL:"管制上限",LCL:"管制下限",docheck:"必要判定",quadrant:"量測象限"}}},921:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=n(98),o=_(n(1)),s=v(n(81)),l=_(n(190)),u=v(n(32)),d=v(n(74)),c=n(43);n(101);var h=_(n(83)),p=_(n(154)),f=_(n(45)),S=v(n(44)),E=v(n(922));_(n(242));function v(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function _(t){return t&&t.__esModule?t:{default:t}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var g=_(n(926)).default.RangePicker;S.getLogger("AnalysisUI");function k(t,e){var n=e,a=t.map(function(t){var e=n.map(function(e){return e.judgeReports.find(function(e){return e.id==t.id}).value}),a=e.reduce(function(t,e){return t+e},0)/e.length,i=Math.sqrt(e.reduce(function(t,e){return t+(a-e)*(a-e)},0)/e.length),r=(t.USL-a)/(3*i),o=(a-t.LSL)/(3*i),s=Math.min(r,o),l=(a-t.value)/((t.USL-t.LSL)/2),u=s*(1-Math.abs(l)),d=t.id,h=t.name,p=t.subtype;return r=(0,c.round)(r,.001),o=(0,c.round)(o,.001),s=(0,c.round)(s,.001),l=(0,c.round)(l,.001),u=(0,c.round)(u,.001),{id:d,name:h,subtype:p,measure:t,valArr:e,mean:a,sigma:i,CPU:r,CPL:o,CP:s,CA:l,CPK:u}});return console.log(a),a}var T=function(t){function e(){return b(this,e),y(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return m(e,o.default.Component),i(e,[{key:"render",value:function(){var t=this.props.inspectionResults,e=k(this.props.reportStatisticState.statisticValue.measureList,t),n=["id","name","subtype","CA","CPU","CPL","CP","CPK"].map(function(t){return{title:t,dataIndex:t,key:t}});return o.default.createElement(p.default,{dataSource:e,columns:n})}}]),e}();function C(t){return"string"==typeof t||t instanceof String}function A(t,e){var n=k(t,e),a=[],i=n.reduce(function(t,e){return-1==t?e.valArr.length:t==e.valArr.length?t:NaN},-1);if(-1==i||i!=i)return[];function r(t,e,n,i){C(n)&&(n=[n]),void 0===i&&(i=n[n.length-1]),a.push(i+","),e.forEach(function(t){var e=(0,c.GetObjElement)(t,n);void 0===e&&(e=""),a.push(e+",")}),a.push("\n")}["name","subtype"].forEach(function(t){return r(0,n,t)}),["value","LCL","UCL","LSL","USL"].forEach(function(t){return r(0,n,["measure",t])}),["mean","sigma","CA","CPU","CPL","CP","CPK"].forEach(function(t){return r(0,n,t)}),n.forEach(function(t){a.push(",")}),a.push("\n");for(var o=n[0].valArr.length,s=0;s<o;s++)r(0,n,["valArr",s],e[s].time_ms);return a}var N=function(t){function e(t){b(this,e);var n=y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.ec_canvas=null,n.state={defFileSearchName:"",dateRange:[],inspectionRec:[]},n}return m(e,o.default.Component),i(e,[{key:"componentDidMount",value:function(){this.props.edit_info.defModelPath}}]),i(e,[{key:"shouldComponentUpdate",value:function(t,e){return!0}},{key:"genTarEditUI",value:function(t){var e=this;switch(t.type){case u.SHAPE_TYPE.aux_point:case u.SHAPE_TYPE.search_point:case u.SHAPE_TYPE.measure:return o.default.createElement(s.JsonEditBlock,{object:t,dict:h.default,dictTheme:t.type,key:"BASE_COM.JsonEditBlock",whiteListKey:{type:"div",subtype:"div",name:"input",angleDeg:"input-number",value:"input-number",margin:"input-number",USL:"input-number",LSL:"input-number",UCL:"input-number",LCL:"input-number",quadrant:"div",docheck:"checkbox",width:"input-number",ref:{__OBJ__:"div",0:{__OBJ__:"btn",id:"div",element:"div"},1:{__OBJ__:"btn",id:"div",element:"div"}}},jsonChange:function(t,n,a,i){if("btn"==a)"ref"==n.keyTrace[0]&&e.props.ACT_EDIT_TAR_ELE_TRACE_UPDATE(n.keyTrace);else{var r=n.keyTrace[n.keyTrace.length-1];switch(a){case"input-number":var o=parseFloat(i.target.value);if(isNaN(o))return;if(n.obj[r]=o,void 0!==n.obj.value){var s=n.obj.value;"LSL"==r?n.obj.LCL=(0,c.round)(s+(n.obj.LSL-s)/3,.001):"USL"==r&&(n.obj.UCL=(0,c.round)(s+(n.obj.USL-s)/3,.001))}break;case"input":n.obj[r]=i.target.value;break;case"checkbox":n.obj[r]=i.target.checked}e.ec_canvas.SetShape(t,t.id)}}});default:return o.default.createElement(s.JsonEditBlock,{object:t,dict:h.default,dictTheme:t.type,key:"BASE_COM.JsonEditBlock",jsonChange:function(t,n,a,i){var r=n.keyTrace[n.keyTrace.length-1];"input-number"==a?n.obj[r]=parseFloat(i.target.value):"input"==a&&(n.obj[r]=i.target.value),console.log(n.obj);var o=t;e.ec_canvas.SetShape(o,o.id)},whiteListKey:{type:"div",subtype:"div",name:"input",margin:"input-number",direction:"input-number"}})}}},{key:"stateUpdate",value:function(t){return this.setState(a({},this.state,t))}},{key:"render",value:function(){var t=this,e=[o.default.createElement(s.IconButton,{dict:h.default,key:"<",addClass:"layout black vbox",text:"<",onClick:function(){return t.props.ACT_EXIT()}})],n=2==this.state.dateRange.length&&this.state.dateRange.reduce(function(t,e){return t&&void 0!==e._d&&void 0!==e._d.getTime},!0),a=this.state.dateRange.map(function(t){return t._d}),i=this.props.edit_info.DefFileHash,r=this.props.edit_info.DefFileName,u=C(this.props.edit_info.DefFileHash)&&this.props.edit_info.DefFileHash.length>5;return o.default.createElement("div",{className:"HXF"},o.default.createElement("div",{className:"overlayCon s overlayCon width12 HXF"},o.default.createElement("div",{className:"s height12"},o.default.createElement(g,{key:"RP",onChange:function(e){return t.stateUpdate({dateRange:e})}}),o.default.createElement(f.default,{type:"primary",icon:"search",disabled:!n||!u,onClick:function(){E.inspectionQuery(i,a[0],a[1]).then(function(e){console.log(e);var n=e.map(function(t){return t.InspectionData[0]});t.stateUpdate({inspectionRec:n});A(t.props.reportStatisticState.statisticValue.measureList,n)}).catch(function(t){console.log(t)})}}),o.default.createElement(f.default,{type:"primary",icon:"download",disabled:!n||!u||0==this.state.inspectionRec.length,onClick:function(){var e,n,a,i,o,s,l,u,d=A(t.props.reportStatisticState.statisticValue.measureList,t.state.inspectionRec);e=d.join(""),n="text/csv",a=r+"_"+(s=new Date,l=s.getMonth()+1,u=s.getDate(),[s.getFullYear(),(l>9?"":"0")+l,(u>9?"":"0")+u].join(""))+".csv",i=new Blob([e],{type:n}),(o=document.createElement("a")).download=a,o.href=URL.createObjectURL(i),o.dataset.downloadurl=[n,o.download,o.href].join(":"),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(function(){URL.revokeObjectURL(o.href)},1500)}}),o.default.createElement(T,{reportStatisticState:this.props.reportStatisticState,inspectionResults:this.state.inspectionRec})),o.default.createElement(l.default,{transitionName:"fadeIn"},o.default.createElement("div",{key:"k1",className:"s overlay scroll MenuAnim HXA",style:{top:"0px",width:"100px"}},e))))}}]),e}(),w=(0,r.connect)(function(t){return{c_state:t.UIData.c_state,edit_tar_info:t.UIData.edit_info.edit_tar_info,shape_list:t.UIData.edit_info.list,WS_ID:t.UIData.WS_ID,edit_info:t.UIData.edit_info,reportStatisticState:t.UIData.edit_info.reportStatisticState}},function(t,e){return{ACT_SUCCESS:function(e){t(u.EV_UI_ACT(d.EVENT.SUCCESS))},ACT_Fail:function(e){t(u.EV_UI_ACT(d.EVENT.FAIL))},ACT_EXIT:function(e){t(u.EV_UI_ACT(u.UI_SM_EVENT.EXIT))},ACT_WS_SEND:function(e,n,a,i,r){return t(u.EV_WS_SEND(e,n,a,i,r))},ACT_Report_Save:function(e,n,a){t(u.EV_WS_SEND(e,"SV",0,{filename:n},a))},ACT_Cache_Img_Save:function(e,n){t(u.EV_WS_SEND(e,"SV",0,{filename:n,type:"__CACHE_IMG__"}))}}})(N);e.default=w},922:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.inspectionQuery=e.defFileQuery=void 0;var a,i=n(444),r=(a=i)&&a.__esModule?a:{default:a};var o="http://hyv.decade.tw:8080/";e.defFileQuery=function(t,e){var n=o+"query/deffile?";return n+="limit=1000",void 0!==t&&(n+="&name="+t),void 0!==e&&(n+="&featureSet_sha1="+e),new Promise(function(t,e){(0,r.default)(n,function(n,a){null===n?t(a):e(n),console.log(n,a)})})},e.inspectionQuery=function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=o+"query/inspection?";return i+="tStart="+e.toString()+"&tEnd="+n.toString()+"&",i+="limit="+a+"&page=1&",i+="subFeatureDefSha1="+t+"&",i+="projection="+JSON.stringify({_id:0,"InspectionData.time_ms":1,"InspectionData.subFeatureDefSha1":1,"InspectionData.judgeReports.id":1,"InspectionData.judgeReports.value":1,"InspectionData.judgeReports.status":1}),i+="",new Promise(function(t,e){(0,r.default)(i,function(n,a){null===n?t(a):e(n),console.log(n,a)})})}}});